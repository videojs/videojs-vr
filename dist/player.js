(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";function _classCallCheck(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,s){for(var a=0;a<s.length;a++){var i=s[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(s,a,i){return a&&e(s.prototype,a),i&&e(s,i),s}}(),precompute=function(){var e=[[[],[],[],[],[]],[[],[],[],[],[]]],s=e[0],a=e[1],i=s[4],l=a[4],o=void 0,t=void 0,r=void 0,n=[],c=[],v=void 0,u=void 0,d=void 0,f=void 0,b=void 0,h=void 0;for(o=0;o<256;o++)c[(n[o]=o<<1^283*(o>>7))^o]=o;for(t=r=0;!i[t];t^=v||1,r=c[r]||1)for(f=r^r<<1^r<<2^r<<3^r<<4,f=f>>8^255&f^99,i[t]=f,l[f]=t,d=n[u=n[v=n[t]]],h=16843009*d^65537*u^257*v^16843008*t,b=257*n[f]^16843008*f,o=0;o<4;o++)s[o][t]=b=b<<24^b>>>8,a[o][f]=h=h<<24^h>>>8;for(o=0;o<5;o++)s[o]=s[o].slice(0),a[o]=a[o].slice(0);return e},aesTables=null,AES=function(){function e(s){_classCallCheck(this,e),aesTables||(aesTables=precompute()),this._tables=[[aesTables[0][0].slice(),aesTables[0][1].slice(),aesTables[0][2].slice(),aesTables[0][3].slice(),aesTables[0][4].slice()],[aesTables[1][0].slice(),aesTables[1][1].slice(),aesTables[1][2].slice(),aesTables[1][3].slice(),aesTables[1][4].slice()]];var a=void 0,i=void 0,l=void 0,o=void 0,t=void 0,r=this._tables[0][4],n=this._tables[1],c=s.length,v=1;if(4!==c&&6!==c&&8!==c)throw new Error("Invalid aes key size");for(o=s.slice(0),t=[],this._key=[o,t],a=c;a<4*c+28;a++)l=o[a-1],(a%c===0||8===c&&a%c===4)&&(l=r[l>>>24]<<24^r[l>>16&255]<<16^r[l>>8&255]<<8^r[255&l],a%c===0&&(l=l<<8^l>>>24^v<<24,v=v<<1^283*(v>>7))),o[a]=o[a-c]^l;for(i=0;a;i++,a--)l=o[3&i?a:a-4],a<=4||i<4?t[i]=l:t[i]=n[0][r[l>>>24]]^n[1][r[l>>16&255]]^n[2][r[l>>8&255]]^n[3][r[255&l]]}return _createClass(e,[{key:"decrypt",value:function(e,s,a,i,l,o){var t=this._key[1],r=e^t[0],n=i^t[1],c=a^t[2],v=s^t[3],u=void 0,d=void 0,f=void 0,b=t.length/4-2,h=void 0,p=4,T=this._tables[1],_=T[0],y=T[1],k=T[2],C=T[3],m=T[4];for(h=0;h<b;h++)u=_[r>>>24]^y[n>>16&255]^k[c>>8&255]^C[255&v]^t[p],d=_[n>>>24]^y[c>>16&255]^k[v>>8&255]^C[255&r]^t[p+1],f=_[c>>>24]^y[v>>16&255]^k[r>>8&255]^C[255&n]^t[p+2],v=_[v>>>24]^y[r>>16&255]^k[n>>8&255]^C[255&c]^t[p+3],p+=4,r=u,n=d,c=f;for(h=0;h<4;h++)l[(3&-h)+o]=m[r>>>24]<<24^m[n>>16&255]<<16^m[c>>8&255]<<8^m[255&v]^t[p++],u=r,r=n,n=c,c=v,v=u}}]),e}();exports.default=AES,module.exports=exports.default;
},{}],2:[function(require,module,exports){
"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,r,o){return r&&t(e.prototype,r),o&&t(e,o),e}}(),_get=function(t,e,r){for(var o=!0;o;){var i=t,n=e,s=r;o=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,n);if(void 0!==u){if("value"in u)return u.value;var a=u.get;if(void 0===a)return;return a.call(s)}var l=Object.getPrototypeOf(i);if(null===l)return;t=l,e=n,r=s,o=!0,u=l=void 0}},_stream=require("./stream"),_stream2=_interopRequireDefault(_stream),AsyncStream=function(t){function e(){_classCallCheck(this,e),_get(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,_stream2.default),this.jobs=[],this.delay=1,this.timeout_=null}return _inherits(e,t),_createClass(e,[{key:"processJob_",value:function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null}},{key:"push",value:function(t){this.jobs.push(t),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))}}]),e}(_stream2.default);exports.default=AsyncStream,module.exports=exports.default;
},{"./stream":5}],3:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_aes=require("./aes"),_aes2=_interopRequireDefault(_aes),_asyncStream=require("./async-stream"),_asyncStream2=_interopRequireDefault(_asyncStream),_pkcs7=require("pkcs7"),ntoh=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},decrypt=function(e,t,r){var n=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),a=new _aes2.default(Array.prototype.slice.call(t)),o=new Uint8Array(e.byteLength),u=new Int32Array(o.buffer),c=void 0,s=void 0,i=void 0,y=void 0,f=void 0,p=void 0,h=void 0,l=void 0,d=void 0;for(c=r[0],s=r[1],i=r[2],y=r[3],d=0;d<n.length;d+=4)f=ntoh(n[d]),p=ntoh(n[d+1]),h=ntoh(n[d+2]),l=ntoh(n[d+3]),a.decrypt(f,p,h,l,u,d),u[d]=ntoh(u[d]^c),u[d+1]=ntoh(u[d+1]^s),u[d+2]=ntoh(u[d+2]^i),u[d+3]=ntoh(u[d+3]^y),c=f,s=p,i=h,y=l;return o};exports.decrypt=decrypt;var Decrypter=function(){function e(t,r,n,a){_classCallCheck(this,e);var o=e.STEP,u=new Int32Array(t.buffer),c=new Uint8Array(t.byteLength),s=0;for(this.asyncStream_=new _asyncStream2.default,this.asyncStream_.push(this.decryptChunk_(u.subarray(s,s+o),r,n,c)),s=o;s<u.length;s+=o)n=new Uint32Array([ntoh(u[s-4]),ntoh(u[s-3]),ntoh(u[s-2]),ntoh(u[s-1])]),this.asyncStream_.push(this.decryptChunk_(u.subarray(s,s+o),r,n,c));this.asyncStream_.push(function(){a(null,(0,_pkcs7.unpad)(c))})}return _createClass(e,[{key:"decryptChunk_",value:function(e,t,r,n){return function(){var a=decrypt(e,t,r);n.set(a,e.byteOffset)}}}],[{key:"STEP",get:function(){return 32e3}}]),e}();exports.Decrypter=Decrypter,exports.default={Decrypter:Decrypter,decrypt:decrypt};
},{"./aes":1,"./async-stream":2,"pkcs7":210}],4:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _decrypter=require("./decrypter"),_asyncStream=require("./async-stream"),_asyncStream2=_interopRequireDefault(_asyncStream);exports.default={decrypt:_decrypter.decrypt,Decrypter:_decrypter.Decrypter,AsyncStream:_asyncStream2.default},module.exports=exports.default;
},{"./async-stream":2,"./decrypter":3}],5:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),Stream=function(){function e(){_classCallCheck(this,e),this.listeners={}}return _createClass(e,[{key:"on",value:function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}},{key:"off",value:function(e,t){var n=void 0;return!!this.listeners[e]&&(n=this.listeners[e].indexOf(t),this.listeners[e].splice(n,1),n>-1)}},{key:"trigger",value:function(e){var t=void 0,n=void 0,s=void 0,i=void 0;if(t=this.listeners[e])if(2===arguments.length)for(s=t.length,n=0;n<s;++n)t[n].call(this,arguments[1]);else for(i=Array.prototype.slice.call(arguments,1),s=t.length,n=0;n<s;++n)t[n].apply(this,i)}},{key:"dispose",value:function(){this.listeners={}}},{key:"pipe",value:function(e){this.on("data",function(t){e.push(t)})}}]),e}();exports.default=Stream,module.exports=exports.default;
},{}],6:[function(require,module,exports){

},{}],7:[function(require,module,exports){
var ISOBoxer={};ISOBoxer.parseBuffer=function(t){return new ISOFile(t).parse()},ISOBoxer.addBoxParser=function(t,e){"string"==typeof t&&"function"==typeof e&&(ISOBox.prototype._boxParsers[t]=e)},ISOBoxer.Utils={},ISOBoxer.Utils.dataViewToString=function(t,e){var i=e||"utf-8";if("undefined"!=typeof TextDecoder)return new TextDecoder(i).decode(t);var s=[],r=0;if("utf-8"===i)for(;r<t.byteLength;){var a=t.getUint8(r++);a<128||(a<224?(a=(31&a)<<6,a|=63&t.getUint8(r++)):a<240?(a=(15&a)<<12,a|=(63&t.getUint8(r++))<<6,a|=63&t.getUint8(r++)):(a=(7&a)<<18,a|=(63&t.getUint8(r++))<<12,a|=(63&t.getUint8(r++))<<6,a|=63&t.getUint8(r++))),s.push(String.fromCharCode(a))}else for(;r<t.byteLength;)s.push(String.fromCharCode(t.getUint8(r++)));return s.join("")},"undefined"!=typeof exports&&(exports.parseBuffer=ISOBoxer.parseBuffer,exports.addBoxParser=ISOBoxer.addBoxParser,exports.Utils=ISOBoxer.Utils),ISOBoxer.Cursor=function(t){this.offset="undefined"==typeof t?0:t};var ISOFile=function(t){this._raw=new DataView(t),this._cursor=new ISOBoxer.Cursor,this.boxes=[]};ISOFile.prototype.fetch=function(t){var e=this.fetchAll(t,!0);return e.length?e[0]:null},ISOFile.prototype.fetchAll=function(t,e){var i=[];return ISOFile._sweep.call(this,t,i,e),i},ISOFile.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var t=ISOBox.parse(this);if("undefined"==typeof t.type)break;this.boxes.push(t)}return this},ISOFile._sweep=function(t,e,i){this.type&&this.type==t&&e.push(this);for(var s in this.boxes){if(e.length&&i)return;ISOFile._sweep.call(this.boxes[s],t,e,i)}};var ISOBox=function(){this._cursor=new ISOBoxer.Cursor};ISOBox.parse=function(t){var e=new ISOBox;return e._offset=t._cursor.offset,e._root=t._root?t._root:t,e._raw=t._raw,e._parent=t,e._parseBox(),t._cursor.offset=e._raw.byteOffset+e._raw.byteLength,e},ISOBox.prototype._readInt=function(t){var e=null;switch(t){case 8:e=this._raw.getInt8(this._cursor.offset-this._raw.byteOffset);break;case 16:e=this._raw.getInt16(this._cursor.offset-this._raw.byteOffset);break;case 32:e=this._raw.getInt32(this._cursor.offset-this._raw.byteOffset);break;case 64:var i=this._raw.getInt32(this._cursor.offset-this._raw.byteOffset),s=this._raw.getInt32(this._cursor.offset-this._raw.byteOffset+4);e=i*Math.pow(2,32)+s}return this._cursor.offset+=t>>3,e},ISOBox.prototype._readUint=function(t){var e=null;switch(t){case 8:e=this._raw.getUint8(this._cursor.offset-this._raw.byteOffset);break;case 16:e=this._raw.getUint16(this._cursor.offset-this._raw.byteOffset);break;case 24:var i=this._raw.getUint16(this._cursor.offset-this._raw.byteOffset),s=this._raw.getUint8(this._cursor.offset-this._raw.byteOffset+2);e=(i<<8)+s;break;case 32:e=this._raw.getUint32(this._cursor.offset-this._raw.byteOffset);break;case 64:var i=this._raw.getUint32(this._cursor.offset-this._raw.byteOffset),s=this._raw.getUint32(this._cursor.offset-this._raw.byteOffset+4);e=i*Math.pow(2,32)+s}return this._cursor.offset+=t>>3,e},ISOBox.prototype._readString=function(t){for(var e="",i=0;i<t;i++){var s=this._readUint(8);e+=String.fromCharCode(s)}return e},ISOBox.prototype._readTerminatedString=function(){for(var t="";this._cursor.offset-this._offset<this._raw.byteLength;){var e=this._readUint(8);if(0==e)break;t+=String.fromCharCode(e)}return t},ISOBox.prototype._readTemplate=function(t){var e=this._readUint(t/2),i=this._readUint(t/2);return e+i/Math.pow(2,t/2)},ISOBox.prototype._parseBox=function(){if(this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength)return void(this._root._incomplete=!0);switch(this.size=this._readUint(32),this.type=this._readString(4),1==this.size&&(this.largesize=this._readUint(64)),"uuid"==this.type&&(this.usertype=this._readString(16)),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset,this._raw.byteLength-this._cursor.offset);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}!this._incomplete&&this._boxParsers[this.type]&&this._boxParsers[this.type].call(this)},ISOBox.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},ISOBox.prototype._boxParsers={},ISOBox.prototype._boxParsers.avc1=function(){this.version=this._readUint(16),this.revision_level=this._readUint(16),this.vendor=this._readUint(32),this.temporal_quality=this._readUint(32),this.spatial_quality=this._readUint(32),this.width=this._readUint(16),this.height=this._readUint(16),this.horizontal_resolution=this._readUint(32),this.vertical_resolution=this._readUint(32),this.data_size=this._readUint(32),this.frame_count=this._readUint(16),this.compressor_name=this._readUint(32),this.depth=this._readUint(16),this.color_table_id=this._readUint(16)},["moov","trak","tref","mdia","minf","stbl","edts","dinf","mvex","moof","traf","mfra","udta","meco","strk","vttc"].forEach(function(t){ISOBox.prototype._boxParsers[t]=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(ISOBox.parse(this))}}),ISOBox.prototype._boxParsers.elst=function(){this._parseFullBox(),this.entry_count=this._readUint(32),this.entries=[];for(var t=1;t<=this.entry_count;t++){var e={};1==this.version?(e.segment_duration=this._readUint(64),e.media_time=this._readInt(64)):(e.segment_duration=this._readUint(32),e.media_time=this._readInt(32)),e.media_rate_integer=this._readInt(16),e.media_rate_fraction=this._readInt(16),this.entries.push(e)}},ISOBox.prototype._boxParsers.emsg=function(){this._parseFullBox(),this.scheme_id_uri=this._readTerminatedString(),this.value=this._readTerminatedString(),this.timescale=this._readUint(32),this.presentation_time_delta=this._readUint(32),this.event_duration=this._readUint(32),this.id=this._readUint(32),this.message_data=new DataView(this._raw.buffer,this._cursor.offset,this._raw.byteLength-(this._cursor.offset-this._offset))},ISOBox.prototype._boxParsers.free=ISOBox.prototype._boxParsers.skip=function(){this.data=new DataView(this._raw.buffer,this._cursor.offset,this._raw.byteLength-(this._cursor.offset-this._offset))},ISOBox.prototype._boxParsers.ftyp=ISOBox.prototype._boxParsers.styp=function(){for(this.major_brand=this._readString(4),this.minor_versions=this._readUint(32),this.compatible_brands=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.compatible_brands.push(this._readString(4))},ISOBox.prototype._boxParsers.hdlr=function(){this._parseFullBox(),this.pre_defined=this._readUint(32),this.handler_type=this._readString(4),this.reserved=[this._readUint(32),this._readUint(32),this._readUint(32)],this.name=this._readTerminatedString()},ISOBox.prototype._boxParsers.mdat=function(){this.data=new DataView(this._raw.buffer,this._cursor.offset,this._raw.byteLength-(this._cursor.offset-this._offset))},ISOBox.prototype._boxParsers.mdhd=function(){this._parseFullBox(),1==this.version?(this.creation_time=this._readUint(64),this.modification_time=this._readUint(64),this.timescale=this._readUint(32),this.duration=this._readUint(64)):(this.creation_time=this._readUint(32),this.modification_time=this._readUint(32),this.timescale=this._readUint(32),this.duration=this._readUint(32));var t=this._readUint(16);this.pad=t>>15,this.language=String.fromCharCode((t>>10&31)+96,(t>>5&31)+96,(31&t)+96),this.pre_defined=this._readUint(16)},ISOBox.prototype._boxParsers.mehd=function(){this._parseFullBox(),1==this.version?this.fragment_duration=this._readUint(64):this.fragment_duration=this._readUint(32)},ISOBox.prototype._boxParsers.mfhd=function(){this._parseFullBox(),this.sequence_number=this._readUint(32)},ISOBox.prototype._boxParsers.mfro=function(){this._parseFullBox(),this.mfra_size=this._readUint(32)},ISOBox.prototype._boxParsers.mp4a=function(){this.reserved1=[this._readUint(32),this._readUint(32)],this.channelcount=this._readUint(16),this.samplesize=this._readUint(16),this.pre_defined=this._readUint(16),this.reserved2=this._readUint(16),this.sample_rate=this._readUint(32)},ISOBox.prototype._boxParsers.mvhd=function(){this._parseFullBox(),1==this.version?(this.creation_time=this._readUint(64),this.modification_time=this._readUint(64),this.timescale=this._readUint(32),this.duration=this._readUint(64)):(this.creation_time=this._readUint(32),this.modification_time=this._readUint(32),this.timescale=this._readUint(32),this.duration=this._readUint(32)),this.rate=this._readTemplate(32),this.volume=this._readTemplate(16),this.reserved1=this._readUint(16),this.reserved2=[this._readUint(32),this._readUint(32)],this.matrix=[];for(var t=0;t<9;t++)this.matrix.push(this._readTemplate(32));this.pre_defined=[];for(var t=0;t<6;t++)this.pre_defined.push(this._readUint(32));this.next_track_ID=this._readUint(32)},ISOBox.prototype._boxParsers.payl=function(){var t=new DataView(this._raw.buffer,this._cursor.offset,this._raw.byteLength-(this._cursor.offset-this._offset));this.cue_text=ISOBoxer.Utils.dataViewToString(t)},ISOBox.prototype._boxParsers.sidx=function(){this._parseFullBox(),this.reference_ID=this._readUint(32),this.timescale=this._readUint(32),0==this.version?(this.earliest_presentation_time=this._readUint(32),this.first_offset=this._readUint(32)):(this.earliest_presentation_time=this._readUint(64),this.first_offset=this._readUint(64)),this.reserved=this._readUint(16),this.reference_count=this._readUint(16),this.references=[];for(var t=0;t<this.reference_count;t++){var e={},i=this._readUint(32);e.reference_type=i>>31&1,e.referenced_size=2147483647&i,e.subsegment_duration=this._readUint(32);var s=this._readUint(32);e.starts_with_SAP=s>>31&1,e.SAP_type=s>>28&7,e.SAP_delta_time=268435455&s,this.references.push(e)}},ISOBox.prototype._boxParsers.ssix=function(){this._parseFullBox(),this.subsegment_count=this._readUint(32),this.subsegments=[];for(var t=0;t<this.subsegment_count;t++){var e={};e.ranges_count=this._readUint(32),e.ranges=[];for(var i=0;i<e.ranges_count;i++){var s={};s.level=this._readUint(8),s.range_size=this._readUint(24),e.ranges.push(s)}this.subsegments.push(e)}},ISOBox.prototype._boxParsers.stsd=function(){this._parseFullBox(),this.entry_count=this._readUint(32),this.entries=[];for(var t=0;t<this.entry_count;t++)this.entries.push(ISOBox.parse(this))},ISOBox.prototype._boxParsers.subs=function(){this._parseFullBox(),this.entry_count=this._readUint(32),this.samples_with_subsamples=[];for(var t=0,e=0;e<this.entry_count;e++){var i=this._readUint(32);t+=i;var s=this._readUint(16);if(s>0){for(var r={nr:t,subsamples:[]},a=0;a<s;a++){var h={};1&this.version?h.size=this._readUint(32):h.size=this._readUint(16),h.priority=this._readUint(8),h.discardable=this._readUint(8),h.codec_specific_parameters=this._readUint(32),r.subsamples.push(h)}this.samples_with_subsamples.push(r)}}},ISOBox.prototype._boxParsers.tfdt=function(){this._parseFullBox(),1==this.version?this.baseMediaDecodeTime=this._readUint(64):this.baseMediaDecodeTime=this._readUint(32)},ISOBox.prototype._boxParsers.tfhd=function(){this._parseFullBox(),this.track_ID=this._readUint(32),1&this.flags&&(this.base_data_offset=this._readUint(64)),2&this.flags&&(this.sample_description_offset=this._readUint(32)),8&this.flags&&(this.default_sample_duration=this._readUint(32)),16&this.flags&&(this.default_sample_size=this._readUint(32)),32&this.flags&&(this.default_sample_flags=this._readUint(32))},ISOBox.prototype._boxParsers.tfra=function(){this._parseFullBox(),this.track_ID=this._readUint(32),this._packed=this._readUint(32),this.reserved=this._packed>>>6,this.length_size_of_traf_num=(this._packed&&0xffff00000000)>>>4,this.length_size_of_trun_num=(this._packed&&4294901760)>>>2,this.length_size_of_sample_num=this._packed&&255,this.number_of_entry=this._readUint(32),this.entries=[];for(var t=0;t<this.number_of_entry;t++){var e={};1==this.version?(e.time=this._readUint(64),e.moof_offset=this._readUint(64)):(e.time=this._readUint(32),e.moof_offset=this._readUint(32)),e.traf_number=this._readUint(8*(this.length_size_of_traf_num+1)),e.trun_number=this._readUint(8*(this.length_size_of_trun_num+1)),e.sample_number=this._readUint(8*(this.length_size_of_sample_num+1)),this.entries.push(e)}},ISOBox.prototype._boxParsers.tkhd=function(){this._parseFullBox(),1==this.version?(this.creation_time=this._readUint(64),this.modification_time=this._readUint(64),this.track_ID=this._readUint(32),this.reserved1=this._readUint(32),this.duration=this._readUint(64)):(this.creation_time=this._readUint(32),this.modification_time=this._readUint(32),this.track_ID=this._readUint(32),this.reserved1=this._readUint(32),this.duration=this._readUint(32)),this.reserved2=[this._readUint(32),this._readUint(32)],this.layer=this._readUint(16),this.alternate_group=this._readUint(16),this.volume=this._readTemplate(16),this.reserved3=this._readUint(16),this.matrix=[];for(var t=0;t<9;t++)this.matrix.push(this._readTemplate(32));this.width=this._readUint(32),this.height=this._readUint(32)},ISOBox.prototype._boxParsers.trex=function(){this._parseFullBox(),this.track_ID=this._readUint(32),this.default_sample_description_index=this._readUint(32),this.default_sample_duration=this._readUint(32),this.default_sample_size=this._readUint(32),this.default_sample_flags=this._readUint(32)},ISOBox.prototype._boxParsers.trun=function(){this._parseFullBox(),this.sample_count=this._readUint(32),1&this.flags&&(this.data_offset=this._readInt(32)),4&this.flags&&(this.first_sample_flags=this._readUint(32)),this.samples=[];for(var t=0;t<this.sample_count;t++){var e={};256&this.flags&&(e.sample_duration=this._readUint(32)),512&this.flags&&(e.sample_size=this._readUint(32)),1024&this.flags&&(e.sample_flags=this._readUint(32)),2048&this.flags&&(0==this.version?e.sample_composition_time_offset=this._readUint(32):e.sample_composition_time_offset=this._readInt(32)),this.samples.push(e)}},ISOBox.prototype._boxParsers.vlab=function(){var t=new DataView(this._raw.buffer,this._cursor.offset,this._raw.byteLength-(this._cursor.offset-this._offset));this.source_label=ISOBoxer.Utils.dataViewToString(t)},ISOBox.prototype._boxParsers.vttC=function(){var t=new DataView(this._raw.buffer,this._cursor.offset,this._raw.byteLength-(this._cursor.offset-this._offset));this.config=ISOBoxer.Utils.dataViewToString(t)},ISOBox.prototype._boxParsers.vtte=function(){};
},{}],8:[function(require,module,exports){
"use strict";var UTF8={};UTF8.encode=function(r){for(var e=[],n=0;n<r.length;++n){var t=r.charCodeAt(n);t<128?e.push(t):t<2048?(e.push(192|t>>6),e.push(128|63&t)):t<65536?(e.push(224|t>>12),e.push(128|63&t>>6),e.push(128|63&t)):(e.push(240|t>>18),e.push(128|63&t>>12),e.push(128|63&t>>6),e.push(128|63&t))}return e},UTF8.decode=function(r){for(var e=[],n=0;n<r.length;){var t=r[n++];t<128||(t<224?(t=(31&t)<<6,t|=63&r[n++]):t<240?(t=(15&t)<<12,t|=(63&r[n++])<<6,t|=63&r[n++]):(t=(7&t)<<18,t|=(63&r[n++])<<12,t|=(63&r[n++])<<6,t|=63&r[n++])),e.push(String.fromCharCode(t))}return e.join("")};var BASE64={};!function(r){var e=function(e){for(var n=0,t=[],o=0|e.length/3;0<o--;){var h=(e[n]<<16)+(e[n+1]<<8)+e[n+2];n+=3,t.push(r.charAt(63&h>>18)),t.push(r.charAt(63&h>>12)),t.push(r.charAt(63&h>>6)),t.push(r.charAt(63&h))}if(2==e.length-n){var h=(e[n]<<16)+(e[n+1]<<8);t.push(r.charAt(63&h>>18)),t.push(r.charAt(63&h>>12)),t.push(r.charAt(63&h>>6)),t.push("=")}else if(1==e.length-n){var h=e[n]<<16;t.push(r.charAt(63&h>>18)),t.push(r.charAt(63&h>>12)),t.push("==")}return t.join("")},n=function(){for(var e=[],n=0;n<r.length;++n)e[r.charCodeAt(n)]=n;return e["=".charCodeAt(0)]=0,e}(),t=function(r){for(var e=0,t=[],o=0|r.length/4;0<o--;){var h=(n[r.charCodeAt(e)]<<18)+(n[r.charCodeAt(e+1)]<<12)+(n[r.charCodeAt(e+2)]<<6)+n[r.charCodeAt(e+3)];t.push(255&h>>16),t.push(255&h>>8),t.push(255&h),e+=4}return t&&("="==r.charAt(e-2)?(t.pop(),t.pop()):"="==r.charAt(e-1)&&t.pop()),t},o={};o.encode=function(r){for(var e=[],n=0;n<r.length;++n)e.push(r.charCodeAt(n));return e},o.decode=function(r){for(var e=0;e<s.length;++e)a[e]=String.fromCharCode(a[e]);return a.join("")},BASE64.decodeArray=function(r){var e=t(r);return new Uint8Array(e)},BASE64.encodeASCII=function(r){var n=o.encode(r);return e(n)},BASE64.decodeASCII=function(r){var e=t(r);return o.decode(e)},BASE64.encode=function(r){var n=UTF8.encode(r);return e(n)},BASE64.decode=function(r){var e=t(r);return UTF8.decode(e)}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),"undefined"!=typeof exports&&(exports.decode=BASE64.decode,exports.decodeArray=BASE64.decodeArray);
},{}],9:[function(require,module,exports){
"use strict";!function(t){var e={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},i=function(t){var i=t;return e.hasOwnProperty(t)&&(i=e[t]),String.fromCharCode(i)},s=15,r=32,n={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},o={17:2,18:4,21:6,22:8,23:10,19:13,20:15},a={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},h={25:2,26:4,29:6,30:8,31:10,27:13,28:15},l=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],u={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(t){this.time=t},log:function(t,e){var i=this.verboseFilter[t];this.verboseLevel>=i&&console.log(this.time+" ["+t+"] "+e)}},c=function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i].toString(16));return e},d=function(t,e,i,s,r){this.foreground=t||"white",this.underline=e||!1,this.italics=i||!1,this.background=s||"black",this.flash=r||!1};d.prototype={reset:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},setStyles:function(t){for(var e=["foreground","underline","italics","background","flash"],i=0;i<e.length;i++){var s=e[i];t.hasOwnProperty(s)&&(this[s]=t[s])}},isDefault:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},equals:function(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash},copy:function(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash},toString:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}};var p=function(t,e,i,s,r,n){this.uchar=t||" ",this.penState=new d(e,i,s,r,n)};p.prototype={reset:function(){this.uchar=" ",this.penState.reset()},setChar:function(t,e){this.uchar=t,this.penState.copy(e)},setPenState:function(t){this.penState.copy(t)},equals:function(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)},copy:function(t){this.uchar=t.uchar,this.penState.copy(t.penState)},isEmpty:function(){return" "===this.uchar&&this.penState.isDefault()}};var f=function(){this.chars=[];for(var t=0;t<r;t++)this.chars.push(new p);this.pos=0,this.currPenState=new d};f.prototype={equals:function(t){for(var e=!0,i=0;i<r;i++)if(!this.chars[i].equals(t.chars[i])){e=!1;break}return e},copy:function(t){for(var e=0;e<r;e++)this.chars[e].copy(t.chars[e])},isEmpty:function(){for(var t=!0,e=0;e<r;e++)if(!this.chars[e].isEmpty()){t=!1;break}return t},setCursor:function(t){this.pos!==t&&(this.pos=t),this.pos<0?(u.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>r&&(u.log("ERROR","Too large cursor position "+this.pos),this.pos=r)},moveCursor:function(t){var e=this.pos+t;if(t>1)for(var i=this.pos+1;i<e+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(e)},backSpace:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},insertChar:function(t){t>=144&&this.backSpace();var e=i(t);return this.pos>=r?void u.log("ERROR","Cannot insert "+t.toString(16)+" ("+e+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(e,this.currPenState),void this.moveCursor(1))},clearFromPos:function(t){var e;for(e=t;e<r;e++)this.chars[e].reset()},clear:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},clearToEndOfRow:function(){this.clearFromPos(this.pos)},getTextString:function(){for(var t=[],e=!0,i=0;i<r;i++){var s=this.chars[i].uchar;" "!==s&&(e=!1),t.push(s)}return e?"":t.join("")},setPenStyles:function(t){this.currPenState.setStyles(t);var e=this.chars[this.pos];e.setPenState(this.currPenState)}};var g=function(){this.rows=[];for(var t=0;t<s;t++)this.rows.push(new f);this.currRow=s-1,this.nrRollUpRows=null,this.reset()};g.prototype={reset:function(){for(var t=0;t<s;t++)this.rows[t].clear();this.currRow=s-1},equals:function(t){for(var e=!0,i=0;i<s;i++)if(!this.rows[i].equals(t.rows[i])){e=!1;break}return e},copy:function(t){for(var e=0;e<s;e++)this.rows[e].copy(t.rows[e])},isEmpty:function(){for(var t=!0,e=0;e<s;e++)if(!this.rows[e].isEmpty()){t=!1;break}return t},backSpace:function(){var t=this.rows[this.currRow];t.backSpace()},clearToEndOfRow:function(){var t=this.rows[this.currRow];t.clearToEndOfRow()},insertChar:function(t){var e=this.rows[this.currRow];e.insertChar(t)},setPen:function(t){var e=this.rows[this.currRow];e.setPenStyles(t)},moveCursor:function(t){var e=this.rows[this.currRow];e.moveCursor(t)},setCursor:function(t){u.log("INFO","setCursor: "+t);var e=this.rows[this.currRow];e.setCursor(t)},setPAC:function(t){u.log("INFO","pacData = "+JSON.stringify(t));var e=t.row-1;this.nrRollUpRows&&e<this.nrRollUpRows-1&&(e=this.nrRollUpRows-1),this.currRow=e;var i=this.rows[this.currRow];if(null!==t.indent){var s=t.indent,r=Math.max(s-1,0);i.setCursor(t.indent),t.color=i.chars[r].penState.foreground}var n={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1};this.setPen(n)},setBkgData:function(t){u.log("INFO","bkgData = "+JSON.stringify(t)),this.backSpace(),this.setPen(t),this.insertChar(32)},setRollUpRows:function(t){this.nrRollUpRows=t},rollUp:function(){if(null===this.nrRollUpRows)return void u.log("DEBUG","roll_up but nrRollUpRows not set yet");u.log("TEXT",this.getDisplayText());var t=this.currRow+1-this.nrRollUpRows,e=this.rows.splice(t,1)[0];e.clear(),this.rows.splice(this.currRow,0,e),u.log("INFO","Rolling up")},getDisplayText:function(t){t=t||!1;for(var e=[],i="",r=-1,n=0;n<s;n++){var o=this.rows[n].getTextString();o&&(r=n+1,t?e.push("Row "+r+': "'+o+'"'):e.push(o.trim()))}return e.length>0&&(i=t?"["+e.join(" | ")+"]":e.join("\n")),i},getTextAndFormat:function(){return this.rows}};var m=function(t,e){this.chNr=t,this.outputFilter=e,this.mode=null,this.verbose=0,this.displayedMemory=new g,this.nonDisplayedMemory=new g,this.lastOutputScreen=new g,this.currRollUpRow=this.displayedMemory.rows[s-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null};m.prototype={modes:["MODE_ROLL-UP","MODE_POP-ON","MODE_PAINT-ON","MODE_TEXT"],reset:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[s-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},getHandler:function(){return this.outputFilter},setHandler:function(t){this.outputFilter=t},setPAC:function(t){this.writeScreen.setPAC(t)},setBkgData:function(t){this.writeScreen.setBkgData(t)},setMode:function(t){t!==this.mode&&(this.mode=t,u.log("INFO","MODE="+t),"MODE_POP-ON"==this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)},insertChars:function(t){for(var e=0;e<t.length;e++)this.writeScreen.insertChar(t[e]);var i=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";u.log("INFO",i+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(u.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},cc_RCL:function(){u.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},cc_BS:function(){u.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},cc_AOF:function(){},cc_AON:function(){},cc_DER:function(){u.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},cc_RU:function(t){u.log("INFO","RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)},cc_FON:function(){u.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},cc_RDC:function(){u.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},cc_TR:function(){u.log("INFO","TR"),this.setMode("MODE_TEXT")},cc_RTD:function(){u.log("INFO","RTD"),this.setMode("MODE_TEXT")},cc_EDM:function(){u.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()},cc_CR:function(){u.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()},cc_ENM:function(){u.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},cc_EOC:function(){if(u.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,u.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()},cc_TO:function(t){u.log("INFO","TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)},cc_MIDROW:function(t){var e={flash:!1};if(e.underline=t%2===1,e.italics=t>=46,e.italics)e.foreground="white";else{var i=Math.floor(t/2)-16,s=["white","green","blue","cyan","red","yellow","magenta"];e.foreground=s[i]}u.log("INFO","MIDROW: "+JSON.stringify(e)),this.writeScreen.setPen(e)},outputDataUpdate:function(){var t=u.time;null!==t&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(t,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},cueSplitAtTime:function(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))}};var y=function(t,e,i){this.field=t||1,this.outputs=[e,i],this.channels=[new m(1,e),new m(2,i)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}};y.prototype={getHandler:function(t){return this.channels[t].getHandler()},setHandler:function(t,e){this.channels[t].setHandler(e)},addData:function(t,e){var i,s,r,n=!1;this.lastTime=t,u.setTime(t);for(var o=0;o<e.length;o+=2)if(s=127&e[o],r=127&e[o+1],0!==s||0!==r){if(u.log("DATA","["+c([e[o],e[o+1]])+"] -> ("+c([s,r])+")"),i=this.parseCmd(s,r),i||(i=this.parseMidrow(s,r)),i||(i=this.parsePAC(s,r)),i||(i=this.parseBackgroundAttributes(s,r)),!i&&(n=this.parseChars(s,r)))if(this.currChNr&&this.currChNr>=0){var a=this.channels[this.currChNr-1];a.insertChars(n)}else u.log("WARNING","No channel found yet. TEXT-MODE?");i?this.dataCounters.cmd+=2:n?this.dataCounters.char+=2:(this.dataCounters.other+=2,u.log("WARNING","Couldn't parse cleaned data "+c([s,r])+" orig: "+c([e[o],e[o+1]])))}else this.dataCounters.padding+=2},parseCmd:function(t,e){var i=null,s=(20===t||28===t)&&32<=e&&e<=47,r=(23===t||31===t)&&33<=e&&e<=35;if(!s&&!r)return!1;if(t===this.lastCmdA&&e===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,u.log("DEBUG","Repeated command ("+c([t,e])+") is dropped"),!0;i=20===t||23===t?1:2;var n=this.channels[i-1];return 20===t||28===t?32===e?n.cc_RCL():33===e?n.cc_BS():34===e?n.cc_AOF():35===e?n.cc_AON():36===e?n.cc_DER():37===e?n.cc_RU(2):38===e?n.cc_RU(3):39===e?n.cc_RU(4):40===e?n.cc_FON():41===e?n.cc_RDC():42===e?n.cc_TR():43===e?n.cc_RTD():44===e?n.cc_EDM():45===e?n.cc_CR():46===e?n.cc_ENM():47===e&&n.cc_EOC():n.cc_TO(e-32),this.lastCmdA=t,this.lastCmdB=e,this.currChNr=i,!0},parseMidrow:function(t,e){var i=null;if((17===t||25===t)&&32<=e&&e<=47){if(i=17===t?1:2,i!==this.currChNr)return u.log("ERROR","Mismatch channel in midrow parsing"),!1;var s=this.channels[i-1];return s.cc_MIDROW(e),u.log("DEBUG","MIDROW ("+c([t,e])+")"),!0}return!1},parsePAC:function(t,e){var i=null,s=null,r=(17<=t&&t<=23||25<=t&&t<=31)&&64<=e&&e<=127,l=(16===t||24===t)&&64<=e&&e<=95;if(!r&&!l)return!1;if(t===this.lastCmdA&&e===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,!0;i=t<=23?1:2,s=64<=e&&e<=95?1===i?n[t]:a[t]:1===i?o[t]:h[t];var u=this.interpretPAC(s,e),c=this.channels[i-1];return c.setPAC(u),this.lastCmdA=t,this.lastCmdB=e,this.currChNr=i,!0},interpretPAC:function(t,e){var i=e,s={color:null,italics:!1,indent:null,underline:!1,row:t};return i=e>95?e-96:e-64,s.underline=1===(1&i),i<=13?s.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(s.italics=!0,s.color="white"):s.indent=4*Math.floor((i-16)/2),s},parseChars:function(t,e){var s=null,r=null,n=null;if(t>=25?(s=2,n=t-8):(s=1,n=t),17<=n&&n<=19){var o=e;o=17===n?e+80:18===n?e+112:e+144,u.log("INFO","Special char '"+i(o)+"' in channel "+s),r=[o]}else 32<=t&&t<=127&&(r=0===e?[t]:[t,e]);if(r){var a=c(r);u.log("DEBUG","Char codes =  "+a.join(",")),this.lastCmdA=null,this.lastCmdB=null}return r},parseBackgroundAttributes:function(t,e){var i,s,r,n,o=(16===t||24===t)&&32<=e&&e<=47,a=(23===t||31===t)&&45<=e&&e<=47;return!(!o&&!a)&&(i={},16===t||24===t?(s=Math.floor((e-32)/2),i.background=l[s],e%2===1&&(i.background=i.background+"_semi")):45===e?i.background="transparent":(i.foreground="black",47===e&&(i.underline=!0)),r=t<24?1:2,n=this.channels[r-1],n.setBkgData(i),this.lastCmdA=null,this.lastCmdB=null,!0)},reset:function(){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].reset();this.lastCmdA=null,this.lastCmdB=null},cueSplitAtTime:function(t){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].cueSplitAtTime(t)}};var w=function(t,e,i){for(var s=0,r=e,n=0,o=[],a=function(t,e,i,s){if(4!==t||e<8)return null;var r=i.getUint8(s),n=i.getUint16(s+1),o=i.getUint32(s+3),a=i.getUint8(s+7);return 181==r&&49==n&&1195456820==o&&3==a};r<e+i;){if(s=t.getUint32(r),n=31&t.getUint8(r+4),6===n)for(var h=r+5,l=-1;h<r+4+s-1;){l=0;for(var u=255;255===u;)u=t.getUint8(h),l+=u,h++;var c=0;for(u=255;255===u;)u=t.getUint8(h),c+=u,h++;a(l,c,t,h)&&o.push([h,c]),h+=c}r+=s+4}return o},R=function(t,e){var i=e[0],s=[[],[]];i+=8;var r=31&t.getUint8(i);i+=2;for(var n=0;n<r;n++){var o=t.getUint8(i),a=4&o,h=3&o;i++;var l=t.getUint8(i);i++;var u=t.getUint8(i);i++,a&&(127&l)+(127&u)!==0&&(0===h?(s[0].push(l),s[0].push(u)):1===h&&(s[1].push(l),s[1].push(u)))}return s};t.logger=u,t.PenState=d,t.CaptionScreen=g,t.Cea608Parser=y,t.findCea608Nalus=w,t.extractCea608DataFromRange=R}("undefined"==typeof exports?(void 0).cea608parser={}:exports);
},{}],10:[function(require,module,exports){
"use strict";function ObjectIron(e){var r,n,t;for(r=[],t=0,n=e.length;t<n;t+=1)e[t].isRoot?r.push("root"):r.push(e[t].name);var o=function(e,r){var n;if(null!==e&&null!==r)for(n in e)e.hasOwnProperty(n)&&(r.hasOwnProperty(n)||(r[n]=e[n]))},a=function(e,r,n){var t,a,i,l,f;if(null!==e&&0!==e.length)for(t=0,a=e.length;t<a;t+=1)i=e[t],r.hasOwnProperty(i.name)&&(n.hasOwnProperty(i.name)?i.merge&&(l=r[i.name],f=n[i.name],"object"==typeof l&&"object"==typeof f?o(l,f):null!=i.mergeFunction?n[i.name]=i.mergeFunction(l,f):n[i.name]=l+f):n[i.name]=r[i.name])},i=function e(r,n){var t,o,i,l,f,u,s,h=r;if(null!==h.children&&0!==h.children.length)for(t=0,o=h.children.length;t<o;t+=1)if(u=h.children[t],n.hasOwnProperty(u.name))if(u.isArray)for(f=n[u.name+"_asArray"],i=0,l=f.length;i<l;i+=1)s=f[i],a(h.properties,n,s),e(u,s);else s=n[u.name],a(h.properties,n,s),e(u,s)},l=function n(t){var o,a,l,f,u,s,h;if(null===t)return t;if("object"!=typeof t)return t;for(o=0,a=r.length;o<a;o+=1)"root"===r[o]&&(u=e[o],s=t,i(u,s));for(f in t)if(t.hasOwnProperty(f)&&"__children"!=f){if(l=r.indexOf(f),l!==-1)if(u=e[l],u.isArray)for(h=t[f+"_asArray"],o=0,a=h.length;o<a;o+=1)s=h[o],i(u,s);else s=t[f],i(u,s);n(t[f])}return t};return{run:l}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=ObjectIron,module.exports=exports.default;
},{}],11:[function(require,module,exports){
"use strict";function X2JS(e){function t(){void 0===e.escapeMode&&(e.escapeMode=!0),void 0===e.attributePrefix&&(e.attributePrefix="_"),e.arrayAccessForm=e.arrayAccessForm||"none",e.emptyNodeForm=e.emptyNodeForm||"text",void 0===e.enableToStringFunc&&(e.enableToStringFunc=!0),e.arrayAccessFormPaths=e.arrayAccessFormPaths||[],void 0===e.skipEmptyTextNodesForObj&&(e.skipEmptyTextNodesForObj=!0),void 0===e.stripWhitespaces&&(e.stripWhitespaces=!0),e.datetimeAccessFormPaths=e.datetimeAccessFormPaths||[],void 0===e.useDoubleQuotes&&(e.useDoubleQuotes=!1),e.xmlElementsFilter=e.xmlElementsFilter||[],e.jsonPropertiesFilter=e.jsonPropertiesFilter||[],void 0===e.keepCData&&(e.keepCData=!1),void 0===e.ignoreRoot&&(e.ignoreRoot=!1)}function r(){}function n(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!=t||(t=e.nodeName),t}function i(e){return e.prefix}function a(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):e}function s(e,t,r,n){for(var i=0;i<e.length;i++){var a=e[i];if("string"==typeof a){if(a==n)break}else if(a instanceof RegExp){if(a.test(n))break}else if("function"==typeof a&&a(t,r,n))break}return i!=e.length}function o(t,r,n){switch(e.arrayAccessForm){case"property":t[r]instanceof Array?t[r+"_asArray"]=t[r]:t[r+"_asArray"]=[t[r]]}!(t[r]instanceof Array)&&e.arrayAccessFormPaths.length>0&&s(e.arrayAccessFormPaths,t,r,n)&&(t[r]=[t[r]])}function l(e){var t=e.split(/[-T:+Z]/g),r=new Date(t[0],t[1]-1,t[2]),n=t[5].split(".");if(r.setHours(t[3],t[4],n[0]),n.length>1&&r.setMilliseconds(n[1]),t[6]&&t[7]){var i=60*t[6]+Number(t[7]),a=/\d\d-\d\d:\d\d$/.test(e)?"-":"+";i=0+("-"==a?-1*i:i),r.setMinutes(r.getMinutes()-i-r.getTimezoneOffset())}else e.indexOf("Z",e.length-1)!==-1&&(r=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds())));return r}function c(t,r,n){if(e.datetimeAccessFormPaths.length>0){var i=n.split(".#")[0];return s(e.datetimeAccessFormPaths,t,r,i)?l(t):t}return t}function u(t,r,n,i){return!(r==A.ELEMENT_NODE&&e.xmlElementsFilter.length>0)||s(e.xmlElementsFilter,t,n,i)}function f(t,r){if(t.nodeType==A.DOCUMENT_NODE){for(var a=new Object,s=t.childNodes,l=0;l<s.length;l++){var _=s.item(l);if(_.nodeType==A.ELEMENT_NODE)if(e.ignoreRoot)a=f(_);else{a={};var d=n(_);a[d]=f(_)}}return a}if(t.nodeType==A.ELEMENT_NODE){var a=new Object;a.__cnt=0;for(var p=[],s=t.childNodes,l=0;l<s.length;l++){var _=s.item(l),d=n(_);if(_.nodeType!=A.COMMENT_NODE){var m=r+"."+d;if(u(a,_.nodeType,d,m))if(a.__cnt++,null==a[d]){var x=f(_,m);if("#text"!=d||/[^\s]/.test(x)){var g={};g[d]=x,p.push(g)}a[d]=x,o(a,d,m)}else{null!=a[d]&&(a[d]instanceof Array||(a[d]=[a[d]],o(a,d,m)));var x=f(_,m);if("#text"!=d||/[^\s]/.test(x)){var g={};g[d]=x,p.push(g)}a[d][a[d].length]=x}}}a.__children=p;for(var v=n(t),h=0;h<t.attributes.length;h++){var y=t.attributes.item(h);a.__cnt++;for(var O=y.value,E=0,N=e.matchers.length;E<N;E++){var T=e.matchers[E];T.test(y,v)&&(O=T.converter(y.value))}a[e.attributePrefix+y.name]=O}var D=i(t);return null!=D&&""!=D&&(a.__cnt++,a.__prefix=D),null!=a["#text"]&&(a.__text=a["#text"],a.__text instanceof Array&&(a.__text=a.__text.join("\n")),e.stripWhitespaces&&(a.__text=a.__text.trim()),delete a["#text"],"property"==e.arrayAccessForm&&delete a["#text_asArray"],a.__text=c(a.__text,d,r+"."+d)),null!=a["#cdata-section"]&&(a.__cdata=a["#cdata-section"],delete a["#cdata-section"],"property"==e.arrayAccessForm&&delete a["#cdata-section_asArray"]),0==a.__cnt&&"text"==e.emptyNodeForm?a="":1==a.__cnt&&null!=a.__text?a=a.__text:1!=a.__cnt||null==a.__cdata||e.keepCData?a.__cnt>1&&null!=a.__text&&e.skipEmptyTextNodesForObj&&(e.stripWhitespaces&&""==a.__text||""==a.__text.trim())&&delete a.__text:a=a.__cdata,delete a.__cnt,!e.enableToStringFunc||null==a.__text&&null==a.__cdata||(a.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),a}if(t.nodeType==A.TEXT_NODE||t.nodeType==A.CDATA_SECTION_NODE)return t.nodeValue}function _(t,r,n,i){var s="<"+(null!=t&&null!=t.__prefix?t.__prefix+":":"")+r;if(null!=n)for(var o=0;o<n.length;o++){var l=n[o],c=t[l];e.escapeMode&&(c=a(c)),s+=" "+l.substr(e.attributePrefix.length)+"=",s+=e.useDoubleQuotes?'"'+c+'"':"'"+c+"'"}return s+=i?"/>":">"}function d(e,t){return"</"+(null!=e.__prefix?e.__prefix+":":"")+t+">"}function p(e,t){return e.indexOf(t,e.length-t.length)!==-1}function m(t,r){return!!("property"==e.arrayAccessForm&&p(r.toString(),"_asArray")||0==r.toString().indexOf(e.attributePrefix)||0==r.toString().indexOf("__")||t[r]instanceof Function)}function x(e){var t=0;if(e instanceof Object)for(var r in e)m(e,r)||t++;return t}function g(t,r,n){return 0==e.jsonPropertiesFilter.length||""==n||s(e.jsonPropertiesFilter,t,r,n)}function v(t){var r=[];if(t instanceof Object)for(var n in t)n.toString().indexOf("__")==-1&&0==n.toString().indexOf(e.attributePrefix)&&r.push(n);return r}function h(t){var r="";return null!=t.__cdata&&(r+="<![CDATA["+t.__cdata+"]]>"),null!=t.__text&&(r+=e.escapeMode?a(t.__text):t.__text),r}function y(t){var r="";return t instanceof Object?r+=h(t):null!=t&&(r+=e.escapeMode?a(t):t),r}function O(e,t){return""===e?t:e+"."+t}function E(e,t,r,n){var i="";if(0==e.length)i+=_(e,t,r,!0);else for(var a=0;a<e.length;a++)i+=_(e[a],t,v(e[a]),!1),i+=N(e[a],O(n,t)),i+=d(e[a],t);return i}function N(e,t){var r="",n=x(e);if(n>0)for(var i in e)if(!m(e,i)&&(""==t||g(e,i,O(t,i)))){var a=e[i],s=v(a);if(null==a||void 0==a)r+=_(a,i,s,!0);else if(a instanceof Object)if(a instanceof Array)r+=E(a,i,s,t);else if(a instanceof Date)r+=_(a,i,s,!1),r+=a.toISOString(),r+=d(a,i);else{var o=x(a);o>0||null!=a.__text||null!=a.__cdata?(r+=_(a,i,s,!1),r+=N(a,O(t,i)),r+=d(a,i)):r+=_(a,i,s,!0)}else r+=_(a,i,s,!1),r+=y(a),r+=d(a,i)}return r+=y(e)}var T="1.2.0";e=e||{},t(),r();var A={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};this.parseXmlString=function(e){var t=window.ActiveXObject||"ActiveXObject"in window;if(void 0===e)return null;var r;if(window.DOMParser){var n=new window.DOMParser,i=null;if(!t)try{i=n.parseFromString("INVALID","text/xml").getElementsByTagName("parsererror")[0].namespaceURI}catch(e){i=null}try{r=n.parseFromString(e,"text/xml"),null!=i&&r.getElementsByTagNameNS(i,"parsererror").length>0&&(r=null)}catch(e){r=null}}else 0==e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(e);return r},this.asArray=function(e){return void 0===e||null==e?[]:e instanceof Array?e:[e]},this.toXmlDateTime=function(e){return e instanceof Date?e.toISOString():"number"==typeof e?new Date(e).toISOString():null},this.asDateTime=function(e){return"string"==typeof e?l(e):e},this.xml2json=function(e){return f(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);return null!=t?this.xml2json(t):null},this.json2xml_str=function(e){return N(e,"")},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t)},this.getVersion=function(){return T}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=X2JS,module.exports=exports.default;
},{}],12:[function(require,module,exports){
(function (global){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _srcStreamingMediaPlayer=require("./src/streaming/MediaPlayer"),_srcStreamingMediaPlayer2=_interopRequireDefault(_srcStreamingMediaPlayer),_srcStreamingProtectionProtection=require("./src/streaming/protection/Protection"),_srcStreamingProtectionProtection2=_interopRequireDefault(_srcStreamingProtectionProtection),_srcStreamingMetricsMetricsReporting=require("./src/streaming/metrics/MetricsReporting"),_srcStreamingMetricsMetricsReporting2=_interopRequireDefault(_srcStreamingMetricsMetricsReporting),_srcStreamingMediaPlayerFactory=require("./src/streaming/MediaPlayerFactory"),_srcStreamingMediaPlayerFactory2=_interopRequireDefault(_srcStreamingMediaPlayerFactory),_srcCoreVersion=require("./src/core/Version"),context="undefined"!=typeof window&&window||global,dashjs=context.dashjs;dashjs||(dashjs=context.dashjs={}),dashjs.MediaPlayer=_srcStreamingMediaPlayer2.default,dashjs.Protection=_srcStreamingProtectionProtection2.default,dashjs.MetricsReporting=_srcStreamingMetricsMetricsReporting2.default,dashjs.MediaPlayerFactory=_srcStreamingMediaPlayerFactory2.default,dashjs.Version=(0,_srcCoreVersion.getVersionString)(),exports.default=dashjs,exports.MediaPlayer=_srcStreamingMediaPlayer2.default,exports.Protection=_srcStreamingProtectionProtection2.default,exports.MetricsReporting=_srcStreamingMetricsMetricsReporting2.default,exports.MediaPlayerFactory=_srcStreamingMediaPlayerFactory2.default;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./src/core/Version":16,"./src/streaming/MediaPlayer":57,"./src/streaming/MediaPlayerFactory":59,"./src/streaming/metrics/MetricsReporting":81,"./src/streaming/protection/Protection":112}],13:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function Debug(){function e(){i=!0,l=!0,_=(new Date).getTime()}function t(e){l=e}function n(e){i=e}function r(){return i}function o(){var e="",t=null;l&&(t=(new Date).getTime(),e+="["+(t-_)+"]"),e.length>0&&(e+=" "),Array.apply(null,arguments).forEach(function(t){e+=t+" "}),i&&console.log(e),s.trigger(_eventsEvents2.default.LOG,{message:e})}var u=this.context,s=(0,_EventBus2.default)(u).getInstance(),a=void 0,i=void 0,l=void 0,_=void 0;return a={log:o,setLogTimestampVisible:t,setLogToBrowserConsole:n,getLogToBrowserConsole:r},e(),a}Object.defineProperty(exports,"__esModule",{value:!0});var _EventBus=require("./EventBus"),_EventBus2=_interopRequireDefault(_EventBus),_eventsEvents=require("./events/Events"),_eventsEvents2=_interopRequireDefault(_eventsEvents),_FactoryMaker=require("./FactoryMaker"),_FactoryMaker2=_interopRequireDefault(_FactoryMaker);Debug.__dashjs_factory_name="Debug",exports.default=_FactoryMaker2.default.getSingletonFactory(Debug),module.exports=exports.default;
},{"./EventBus":14,"./FactoryMaker":15,"./events/Events":18}],14:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function EventBus(){function e(e,r,t){var n=arguments.length<=3||void 0===arguments[3]?EVENT_PRIORITY_LOW:arguments[3];if(!e)throw new Error("event type cannot be null or undefined");if(!r||"function"!=typeof r)throw new Error("listener must be a function: "+r);if(!(o(e,r,t)>=0)){a[e]=a[e]||[];var i={callback:r,scope:t,priority:n},c=a[e].some(function(r,t){if(n>r.priority)return a[e].splice(t,0,i),!0});c||a[e].push(i)}}function r(e,r,t){if(e&&r&&a[e]){var n=o(e,r,t);n<0||a[e].splice(n,1)}}function t(e,r){if(e&&a[e]){if(r=r||{},r.hasOwnProperty("type"))throw new Error("'type' is a reserved word for event dispatching");r.type=e,a[e].forEach(function(e){return e.callback.call(e.scope,r)})}}function o(e,r,t){var o=-1;return a[e]?(a[e].some(function(e,n){if(e.callback===r&&(!t||t===e.scope))return o=n,!0}),o):o}function n(){a={}}var a={},i={on:e,off:r,trigger:t,reset:n};return i}Object.defineProperty(exports,"__esModule",{value:!0});var _FactoryMaker=require("./FactoryMaker"),_FactoryMaker2=_interopRequireDefault(_FactoryMaker),EVENT_PRIORITY_LOW=0,EVENT_PRIORITY_HIGH=5e3;EventBus.__dashjs_factory_name="EventBus";var factory=_FactoryMaker2.default.getSingletonFactory(EventBus);factory.EVENT_PRIORITY_LOW=EVENT_PRIORITY_LOW,factory.EVENT_PRIORITY_HIGH=EVENT_PRIORITY_HIGH,exports.default=factory,module.exports=exports.default;
},{"./FactoryMaker":15}],15:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var FactoryMaker=function(){function n(n,t,e,r){var a=c(r);!a[n]&&t&&(a[n]={instance:t,override:e})}function t(n,t){for(var e in s){var r=s[e];if(r.context===n&&r.name===t)return r.instance}return null}function e(n,t,e){for(var r in s){var a=s[r];if(a.context===n&&a.name===t)return void(s[r].instance=e)}s.push({name:t,context:n,instance:e})}function r(n){return function(t){return void 0===t&&(t={}),{create:function(){return o(n.__dashjs_factory_name,n.apply({context:t},arguments),t,arguments)}}}}function a(n){return function(e){var r=void 0;return void 0===e&&(e={}),{getInstance:function(){return r||(r=t(e,n.__dashjs_factory_name)),r||(r=o(n.__dashjs_factory_name,n.apply({context:e},arguments),e,arguments),s.push({name:n.__dashjs_factory_name,context:e,instance:r})),r}}}}function o(n,t,e,r){var a=c(e),o=a[n];if(o){var u=o.instance;if(!o.override)return u.apply({context:e,factory:i},r);u=u.apply({context:e,factory:i,parent:t},r);for(var s in u)t.hasOwnProperty(s)&&(t[s]=u[s])}return t}function c(n){var t=void 0;return u.forEach(function(e){e===n&&(t=e)}),t||(t=u.push(n)),t}var i=void 0,u=[],s=[];return i={extend:n,getSingletonInstance:t,setSingletonInstance:e,getSingletonFactory:a,getClassFactory:r}}();exports.default=FactoryMaker,module.exports=exports.default;
},{}],16:[function(require,module,exports){
"use strict";function getVersionString(){return VERSION}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getVersionString=getVersionString;var VERSION="2.4.1";
},{}],17:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _get=function(e,t,E){for(var i=!0;i;){var o=e,r=t,s=E;i=!1,null===o&&(o=Function.prototype);var n=Object.getOwnPropertyDescriptor(o,r);if(void 0!==n){if("value"in n)return n.value;var a=n.get;if(void 0===a)return;return a.call(s)}var _=Object.getPrototypeOf(o);if(null===_)return;e=_,t=r,E=s,i=!0,n=_=void 0}},_EventsBase2=require("./EventsBase"),_EventsBase3=_interopRequireDefault(_EventsBase2),CoreEvents=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.BUFFERING_COMPLETED="bufferingCompleted",this.BUFFER_CLEARED="bufferCleared",this.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",this.BYTES_APPENDED="bytesAppended",this.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",this.CURRENT_TRACK_CHANGED="currentTrackChanged",this.DATA_UPDATE_COMPLETED="dataUpdateCompleted",this.DATA_UPDATE_STARTED="dataUpdateStarted",this.INITIALIZATION_LOADED="initializationLoaded",this.INIT_FRAGMENT_LOADED="initFragmentLoaded",this.INIT_REQUESTED="initRequested",this.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",this.LIVE_EDGE_SEARCH_COMPLETED="liveEdgeSearchCompleted",this.LOADING_COMPLETED="loadingCompleted",this.LOADING_PROGRESS="loadingProgress",this.MANIFEST_UPDATED="manifestUpdated",this.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",this.QUOTA_EXCEEDED="quotaExceeded",this.REPRESENTATION_UPDATED="representationUpdated",this.SEGMENTS_LOADED="segmentsLoaded",this.SERVICE_LOCATION_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",this.SOURCEBUFFER_APPEND_COMPLETED="sourceBufferAppendCompleted",this.SOURCEBUFFER_REMOVE_COMPLETED="sourceBufferRemoveCompleted",this.STREAMS_COMPOSED="streamsComposed",this.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",this.STREAM_COMPLETED="streamCompleted",this.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",this.TIMED_TEXT_REQUESTED="timedTextRequested",this.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",this.URL_RESOLUTION_FAILED="urlResolutionFailed",this.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",this.XLINK_ELEMENT_LOADED="xlinkElementLoaded",this.XLINK_READY="xlinkReady"}return _inherits(t,e),t}(_EventsBase3.default);exports.default=CoreEvents,module.exports=exports.default;
},{"./EventsBase":19}],18:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _get=function(e,t,r){for(var o=!0;o;){var n=e,u=t,i=r;o=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,u);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(i)}var a=Object.getPrototypeOf(n);if(null===a)return;e=a,t=u,r=i,o=!0,s=a=void 0}},_CoreEvents2=require("./CoreEvents"),_CoreEvents3=_interopRequireDefault(_CoreEvents2),Events=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),t}(_CoreEvents3.default),events=new Events;exports.default=events,module.exports=exports.default;
},{"./CoreEvents":17}],19:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),EventsBase=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"extend",value:function(e,t){if(e){var n=!!t&&t.override,r=!!t&&t.publicOnly;for(var a in e)!e.hasOwnProperty(a)||this[a]&&!n||r&&e[a].indexOf("public_")===-1||(this[a]=e[a])}}}]),e}();exports.default=EventsBase,module.exports=exports.default;
},{}],20:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function DashAdapter(){function e(e){e&&e.dashManifestModel&&(C=e.dashManifestModel)}function t(){A=[],S={}}function n(e,t){return t.getRepresentationForQuality(e.quality)}function r(e){return S?S[e.streamInfo.id][e.index]:null}function a(e){for(var t=A.length,n=0;n<t;n++){var r=A[n];if(e.id===r.id)return r}return null}function i(e,t){var n=new _streamingVoTrackInfo2.default,r=t.adaptation.period.mpd.manifest.Period_asArray[t.adaptation.period.index].AdaptationSet_asArray[t.adaptation.index],a=C.getRepresentationFor(t.index,r);return n.id=t.id,n.quality=t.index,n.bandwidth=C.getBandwidth(a),n.DVRWindow=t.segmentAvailabilityRange,n.fragmentDuration=t.segmentDuration||(t.segments&&t.segments.length>0?t.segments[0].duration:NaN),n.MSETimeOffset=t.MSETimeOffset,n.useCalculatedLiveEdgeTime=t.useCalculatedLiveEdgeTime,n.mediaInfo=o(e,t.adaptation),n}function o(e,t){var n,r=new _streamingVoMediaInfo2.default,a=t.period.mpd.manifest.Period_asArray[t.period.index].AdaptationSet_asArray[t.index];return r.id=t.id,r.index=t.index,r.type=t.type,r.streamInfo=s(e,t.period),r.representationCount=C.getRepresentationCount(a),r.lang=C.getLanguageForAdaptation(a),n=C.getViewpointForAdaptation(a),r.viewpoint=n?n.value:void 0,r.accessibility=C.getAccessibilityForAdaptation(a).map(function(e){var t=e.value,n=t;return e.schemeIdUri&&e.schemeIdUri.search("cea-608")>=0&&"undefined"!=typeof _externalsCea608Parser2.default&&(n=t?"cea-608:"+t:"cea-608",r.embeddedCaptions=!0),n}),r.audioChannelConfiguration=C.getAudioChannelConfigurationForAdaptation(a).map(function(e){return e.value}),r.roles=C.getRolesForAdaptation(a).map(function(e){return e.value}),r.codec=C.getCodec(a),r.mimeType=C.getMimeType(a),r.contentProtection=C.getContentProtectionData(a),r.bitrateList=C.getBitrateListForAdaptation(a),r.contentProtection&&r.contentProtection.forEach(function(e){e.KID=C.getKID(e)}),r.isText=C.getIsTextTrack(r.mimeType),r}function d(e,t,n){e.id=t,e.index=100+parseInt(t.substring(2,3)),e.type="embeddedText",e.codec="cea-608-in-SEI",e.isText=!0,e.isEmbedded=!0,e.lang=t+" "+n,e.roles=["caption"]}function s(e,t){var n=new _streamingVoStreamInfo2.default,r=1;return n.id=t.id,n.index=t.index,n.start=t.start,n.duration=t.duration,n.manifestInfo=u(e,t.mpd),n.isLast=1===e.Period_asArray.length||Math.abs(n.start+n.duration-n.manifestInfo.duration)<r,n.isFirst=1===e.Period_asArray.length||C.getRegularPeriods(e,C.getMpd(e))[0].id===t.id,n}function u(e,t){var n=new _streamingVoManifestInfo2.default;return n.DVRWindowSize=t.timeShiftBufferDepth,n.loadedTime=t.manifest.loadedTime,n.availableFrom=t.availabilityStartTime,n.minBufferTime=t.manifest.minBufferTime,n.maxFragmentDuration=t.maxSegmentDuration,n.duration=C.getDuration(e),n.isDynamic=C.getIsDynamic(e),n}function f(e,t,n){var r=C.getAdaptationForType(e,t.index,n,t);if(!r)return null;var i=a(t),d=i.id,s=C.getIndexForAdaptation(r,e,t.index);return S[d]=S[d]||C.getAdaptationsForPeriod(e,i),o(e,S[d][s])}function l(e,t,n){var r,i,s,u,f,l,g=a(t),m=g.id,c=C.getAdaptationsForType(e,t.index,"embeddedText"!==n?n:"video"),p=[];if(!c)return p;for(S[m]=S[m]||C.getAdaptationsForPeriod(e,g),u=0,l=c.length;u<l;u++){if(r=c[u],s=C.getIndexForAdaptation(r,e,t.index),i=o(e,S[m][s]),"embeddedText"===n){var v=i.accessibility.length;for(f=0;f<v;f++)if(i){var _=i.accessibility[f];if(0===_.indexOf("cea-608:")){var I=_.substring(8),x=I.split(";");if("CC"===x[0].substring(0,2))for(f=0;f<x.length;f++)i||(i=o.call(this,e,S[m][s])),d(i,x[f].substring(0,3),x[f].substring(4)),p.push(i),i=null;else for(f=0;f<x.length;f++)i||(i=o.call(this,e,S[m][s])),d(i,"CC"+(f+1),x[f]),p.push(i),i=null}else 0===_.indexOf("cea-608")&&(d(i,"CC1","eng"),p.push(i),i=null)}}i&&"embeddedText"!==n&&p.push(i)}return p}function g(e){if(!e)return null;var t=[],n=C.getMpd(e);A=C.getRegularPeriods(e,n),S={};for(var r=0,a=A.length;r<a;r++)t.push(s(e,A[r]));return t}function m(e){var t=C.getMpd(e);return u(e,t)}function c(e,t){var n=e.getRepresentationController().getRepresentationForQuality(t);return e.getIndexHandler().getInitRequest(n)}function p(e,t){var r=n(t,e.getRepresentationController());return e.getIndexHandler().getNextSegmentRequest(r)}function v(e,t,r,a){var i=n(t,e.getRepresentationController());return e.getIndexHandler().getSegmentRequestForTime(i,r,a)}function _(e,t,r){var a=n(t,e.getRepresentationController());return e.getIndexHandler().generateSegmentRequestForTime(a,r)}function I(e){return e.getIndexHandler().getCurrentTime()}function x(e,t){return e.getIndexHandler().setCurrentTime(t)}function T(e,t){var n,i,o=a(t.getStreamInfo()),d=t.getMediaInfo(),s=r(d),u=t.getType();n=d.id,i=n?C.getAdaptationForId(n,e,o.index):C.getAdaptationForIndex(d.index,e,o.index),t.getRepresentationController().updateData(i,s,u)}function F(e,t,n){var r=t.getRepresentationForQuality(n);return r?i(e,r):null}function y(e,t){var n=t.getCurrentRepresentation();return n?i(e,n):null}function M(e,t,n){var r=new _voEvent2.default,a=e.scheme_id_uri,i=e.value,o=e.timescale,d=e.presentation_time_delta,s=e.event_duration,u=e.id,f=e.message_data,l=n*o+d;return t[a]?(r.eventStream=t[a],r.eventStream.value=i,r.eventStream.timescale=o,r.duration=s,r.id=u,r.presentationTime=l,r.messageData=f,r.presentationTimeDelta=d,r):null}function R(e,t,i){var o=[];return t instanceof _streamingVoStreamInfo2.default?o=C.getEventsForPeriod(e,a(t)):t instanceof _streamingVoMediaInfo2.default?o=C.getEventStreamForAdaptationSet(e,r(t)):t instanceof _streamingVoTrackInfo2.default&&(o=C.getEventStreamForRepresentation(e,n(t,i.getRepresentationController()))),o}function h(){A=[],S={}}var D=void 0,C=void 0,A=void 0,S=void 0;return D={initialize:t,convertDataToTrack:i,convertDataToMedia:o,convertDataToStream:s,getDataForTrack:n,getDataForMedia:r,getDataForStream:a,getStreamsInfo:g,getManifestInfo:m,getMediaInfoForType:f,getAllMediaInfoForType:l,getCurrentRepresentationInfo:y,getRepresentationInfoForQuality:F,updateData:T,getInitRequest:c,getNextFragmentRequest:p,getFragmentRequestForTime:v,generateFragmentRequestForTime:_,getIndexHandlerTime:I,setIndexHandlerTime:x,getEventsFor:R,getEvent:M,setConfig:e,reset:h,metricsList:METRIC_LIST}}Object.defineProperty(exports,"__esModule",{value:!0});var _streamingVoTrackInfo=require("../streaming/vo/TrackInfo"),_streamingVoTrackInfo2=_interopRequireDefault(_streamingVoTrackInfo),_streamingVoMediaInfo=require("../streaming/vo/MediaInfo"),_streamingVoMediaInfo2=_interopRequireDefault(_streamingVoMediaInfo),_streamingVoStreamInfo=require("../streaming/vo/StreamInfo"),_streamingVoStreamInfo2=_interopRequireDefault(_streamingVoStreamInfo),_streamingVoManifestInfo=require("../streaming/vo/ManifestInfo"),_streamingVoManifestInfo2=_interopRequireDefault(_streamingVoManifestInfo),_voEvent=require("./vo/Event"),_voEvent2=_interopRequireDefault(_voEvent),_coreFactoryMaker=require("../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_externalsCea608Parser=require("../../externals/cea608-parser"),_externalsCea608Parser2=_interopRequireDefault(_externalsCea608Parser),_constantsDashMetricsList=require("./constants/DashMetricsList"),METRIC_LIST=_interopRequireWildcard(_constantsDashMetricsList);DashAdapter.__dashjs_factory_name="DashAdapter",exports.default=_coreFactoryMaker2.default.getSingletonFactory(DashAdapter),module.exports=exports.default;
},{"../../externals/cea608-parser":9,"../core/FactoryMaker":15,"../streaming/vo/ManifestInfo":172,"../streaming/vo/MediaInfo":173,"../streaming/vo/StreamInfo":175,"../streaming/vo/TrackInfo":178,"./constants/DashMetricsList":25,"./vo/Event":47}],21:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function DashHandler(e){function t(){P=-1,G=0,k=NaN,b.on(_coreEventsEvents2.default.INITIALIZATION_LOADED,A,O),b.on(_coreEventsEvents2.default.SEGMENTS_LOADED,D,O)}function n(t){w=t,B=w.getType(),C=w.isDynamic(),H=(0,_utilsSegmentsGetter2.default)(q).create(e,C)}function i(){return w}function r(e){G=e}function a(){return G}function s(){return P}function o(){return k}function l(){H=null,G=0,k=NaN,V=NaN,P=-1,C=null,B=null,w=null,b.off(_coreEventsEvents2.default.INITIALIZATION_LOADED,A,O),b.off(_coreEventsEvents2.default.SEGMENTS_LOADED,D,O)}function u(e){return e?e.split("$$").join("$"):e}function m(e,t){if(null===t||null===e||e.indexOf("$RepresentationID$")===-1)return e;var n=t.toString();return e.split("$RepresentationID$").join(n)}function g(e,t,n){var i,r,a=F.resolve(n.path);return a&&t!==a.url&&U.isRelative(t)?(i=a.url,r=a.serviceLocation,t&&(i=U.resolve(t,i))):i=t,!U.isRelative(i)&&(e.url=i,e.serviceLocation=r,!0)}function d(e,t){var n=new _streamingVoFragmentRequest2.default,i=e.adaptation.period,r=i.start;if(n.mediaType=t,n.type=_streamingVoMetricsHTTPRequest.HTTPRequest.INIT_SEGMENT_TYPE,n.range=e.range,n.availabilityStartTime=M.calcAvailabilityStartTimeFromPresentationTime(r,i.mpd,C),n.availabilityEndTime=M.calcAvailabilityEndTimeFromPresentationTime(r+i.duration,i.mpd,C),n.quality=e.index,n.mediaInfo=w.getMediaInfo(),g(n,e.initialization,e))return n}function _(e){if(!e)return null;var t=d(e,B);return t}function v(e){var t=!1;if(C||P!==e.availableSegmentsNumber){var n=(0,_utilsSegmentsUtils.getSegmentByIndex)(P,e);if(n){var i=n.presentationStartTime-e.adaptation.period.start,r=e.adaptation.period.duration;N(e.segmentInfoType+": "+i+" / "+r),t=("SegmentTimeline"!==e.segmentInfoType||!C)&&i>=r}}else t=!0;return t}function c(e){return H.getSegments(e,V,P,f)}function f(e,t){if(e.segments=t,t&&t.length>0&&(k=isNaN(k)?t[0].presentationStartTime:Math.min(t[0].presentationStartTime,k)),C&&isNaN(M.getExpectedLiveEdge())){var n=t[t.length-1],i=n.presentationStartTime,r=L.getMetricsFor("stream");M.setExpectedLiveEdge(i),L.updateManifestUpdateInfo(h.getCurrentManifestUpdate(r),{presentationStartTime:i})}}function E(e){if(!e)throw new _streamingVoError2.default("no representation");return e.segments=null,c(e),e}function p(e,t){var n,i=_voRepresentation2.default.hasInitialization(e),r=_voRepresentation2.default.hasSegments(e);return e.segmentDuration||e.segments||E(e),e.segmentAvailabilityRange=null,e.segmentAvailabilityRange=M.calcSegmentAvailabilityRange(e,C),e.segmentAvailabilityRange.end<e.segmentAvailabilityRange.start&&!e.useCalculatedLiveEdgeTime?(n=new _streamingVoError2.default(SEGMENTS_UNAVAILABLE_ERROR_CODE,"no segments are available yet",{availabilityDelay:e.segmentAvailabilityRange.start-e.segmentAvailabilityRange.end}),void b.trigger(_coreEventsEvents2.default.REPRESENTATION_UPDATED,{sender:this,representation:e,error:n})):(t||(P=-1),e.segmentDuration&&E(e),i||x.loadInitialization(e),r||x.loadSegments(e,B,e.indexRange),void(i&&r&&b.trigger(_coreEventsEvents2.default.REPRESENTATION_UPDATED,{sender:this,representation:e})))}function T(e,t,n){var i,r,a,s,o,l=t.segments,u=l?l.length:null,m=-1;if(l&&u>0)for(o=0;o<u;o++)if(r=l[o],a=r.presentationStartTime,s=r.duration,i=void 0===n||null===n?s/2:n,e+i>=a&&e-i<a+s){m=r.availabilityIdx;break}return m}function R(e){if(null===e||void 0===e)return null;var t=new _streamingVoFragmentRequest2.default,n=e.representation,i=n.adaptation.period.mpd.manifest.Period_asArray[n.adaptation.period.index].AdaptationSet_asArray[n.adaptation.index].Representation_asArray[n.index].bandwidth,r=e.media;return r=(0,_utilsSegmentsUtils.replaceTokenForTemplate)(r,"Number",e.replacementNumber),r=(0,_utilsSegmentsUtils.replaceTokenForTemplate)(r,"Time",e.replacementTime),r=(0,_utilsSegmentsUtils.replaceTokenForTemplate)(r,"Bandwidth",i),r=m(r,n.id),r=u(r),t.mediaType=B,t.type=_streamingVoMetricsHTTPRequest.HTTPRequest.MEDIA_SEGMENT_TYPE,t.range=e.mediaRange,t.startTime=e.presentationStartTime,t.duration=e.duration,t.timescale=n.timescale,t.availabilityStartTime=e.availabilityStartTime,t.availabilityEndTime=e.availabilityEndTime,t.wallStartTime=e.wallStartTime,t.quality=n.index,t.index=e.availabilityIdx,t.mediaInfo=w.getMediaInfo(),t.adaptationIndex=n.adaptation.index,g(t,r,n)?t:void 0}function S(e,t,n){var i,r,a,s=P,o=!!n&&n.keepIdx,l=n?n.timeThreshold:null,u=!(!n||!n.ignoreIsFinished);return e?(V!==t&&(V=t,N("Getting the request for "+B+" time : "+t)),c(e),P=T(t,e,l),P<0&&(c(e),P=T(t,e,l)),P>0&&N("Index for "+B+" time "+t+" is "+P),a=!u&&v(e),a?(i=new _streamingVoFragmentRequest2.default,i.action=_streamingVoFragmentRequest2.default.ACTION_COMPLETE,i.index=P,i.mediaType=B,i.mediaInfo=w.getMediaInfo(),N("Signal complete.",i)):(r=(0,_utilsSegmentsUtils.getSegmentByIndex)(P,e),i=R(r)),o&&s>=0&&(P="SegmentTimeline"===e.segmentInfoType&&C?P:s),i):null}function I(e,t){var n=(e.segmentAvailabilityRange.end-e.segmentAvailabilityRange.start)/2;return e.segments=null,e.segmentAvailabilityRange={start:t-n,end:t+n},S(e,t,{keepIdx:!1,ignoreIsFinished:!0})}function y(e){var t,n,i;return e&&P!==-1?(V=null,P++,N("Getting the next request at index: "+P),i=v(e),i?(t=new _streamingVoFragmentRequest2.default,t.action=_streamingVoFragmentRequest2.default.ACTION_COMPLETE,t.index=P,t.mediaType=B,t.mediaInfo=w.getMediaInfo(),N("Signal complete.")):(c(e),n=(0,_utilsSegmentsUtils.getSegmentByIndex)(P,e),t=R(n),!n&&C&&P--),t):null}function A(e){var t=e.representation;t.segments&&b.trigger(_coreEventsEvents2.default.REPRESENTATION_UPDATED,{sender:this,representation:t})}function D(e){if(!e.error&&B===e.mediaType){var t,n,i,r,a=e.segments,s=e.representation,o=[],l=0;for(t=0,n=a.length;t<n;t++)i=a[t],r=(0,_utilsSegmentsUtils.getTimeBasedSegment)(M,C,s,i.startTime,i.duration,i.timescale,i.media,i.mediaRange,l),o.push(r),r=null,l++;s.segmentAvailabilityRange={start:o[0].presentationStartTime,end:o[n-1].presentationStartTime},s.availableSegmentsNumber=n,f(s,o),_voRepresentation2.default.hasInitialization(s)&&b.trigger(_coreEventsEvents2.default.REPRESENTATION_UPDATED,{sender:this,representation:s})}}var q=this.context,N=(0,_coreDebug2.default)(q).getInstance().log,b=(0,_coreEventBus2.default)(q).getInstance(),U=(0,_streamingUtilsURLUtils2.default)(q).getInstance(),x=e.segmentBaseLoader,M=e.timelineConverter,h=e.dashMetrics,L=e.metricsModel,F=e.baseURLController,O=void 0,P=void 0,V=void 0,C=void 0,B=void 0,G=void 0,k=void 0,w=void 0,H=void 0;return O={initialize:n,getStreamProcessor:i,getInitRequest:_,getSegmentRequestForTime:S,getNextSegmentRequest:y,generateSegmentRequestForTime:I,updateRepresentation:p,setCurrentTime:r,getCurrentTime:a,getCurrentIndex:s,getEarliestTime:o,reset:l},t(),O}Object.defineProperty(exports,"__esModule",{value:!0});var _streamingVoFragmentRequest=require("../streaming/vo/FragmentRequest"),_streamingVoFragmentRequest2=_interopRequireDefault(_streamingVoFragmentRequest),_streamingVoError=require("../streaming/vo/Error"),_streamingVoError2=_interopRequireDefault(_streamingVoError),_streamingVoMetricsHTTPRequest=require("../streaming/vo/metrics/HTTPRequest"),_coreEventsEvents=require("../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_coreEventBus=require("../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreFactoryMaker=require("../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_coreDebug=require("../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug),_streamingUtilsURLUtils=require("../streaming/utils/URLUtils"),_streamingUtilsURLUtils2=_interopRequireDefault(_streamingUtilsURLUtils),_voRepresentation=require("./vo/Representation"),_voRepresentation2=_interopRequireDefault(_voRepresentation),_utilsSegmentsUtils=require("./utils/SegmentsUtils"),_utilsSegmentsGetter=require("./utils/SegmentsGetter"),_utilsSegmentsGetter2=_interopRequireDefault(_utilsSegmentsGetter),SEGMENTS_UNAVAILABLE_ERROR_CODE=1;DashHandler.__dashjs_factory_name="DashHandler";var factory=_coreFactoryMaker2.default.getClassFactory(DashHandler);factory.SEGMENTS_UNAVAILABLE_ERROR_CODE=SEGMENTS_UNAVAILABLE_ERROR_CODE,exports.default=factory,module.exports=exports.default;
},{"../core/Debug":13,"../core/EventBus":14,"../core/FactoryMaker":15,"../core/events/Events":18,"../streaming/utils/URLUtils":164,"../streaming/vo/Error":168,"../streaming/vo/FragmentRequest":169,"../streaming/vo/metrics/HTTPRequest":185,"./utils/SegmentsGetter":40,"./utils/SegmentsUtils":41,"./vo/Representation":51}],22:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function DashMetrics(){function e(e,t){var r,n=L.getValue(),u=n.Period_asArray[t];return r=v(u,e),null===r?null:r.bandwidth}function t(e,t){var r,n=L.getValue(),u=n.Period_asArray[t];return r=h(u,e)}function r(e,t){var r,n=L.getValue(),u=n.Period_asArray[t];return r=R(u,e)}function n(e){return l(e,MetricsList.TRACK_SWITCH)}function u(e){return l(e,MetricsList.BUFFER_LEVEL)}function s(e){var t=u(e);return t?(0,_round10.round10)(t.level/1e3,-3):0}function i(e){return e.RequestsQueue}function a(e){if(null===e)return null;var t,r,n=e.HttpList,u=null;if(null===n||n.length<=0)return null;for(t=n.length,r=t-1;r>=0;){if(n[r].responsecode){u=n[r];break}r--}return u}function o(e){return null===e?[]:e.HttpList?e.HttpList:[]}function l(e,t){if(null===e)return null;var r=e[t];if(null===r)return null;var n=r.length;return n<=0?null:r[n-1]}function f(e){return l(e,MetricsList.DROPPED_FRAMES)}function c(e){return l(e,MetricsList.SCHEDULING_INFO)}function d(e){return l(e,MetricsList.MANIFEST_UPDATE)}function M(e){return l(e,MetricsList.DVR_INFO)}function _(e,t){var r,n,u,s={};if(null===e)return null;for(r=o(e),u=r.length-1;u>=0;u--)if(n=r[u],n.type===_streamingVoMetricsHTTPRequest.HTTPRequest.MPD_TYPE){s=p(n._responseHeaders);break}return void 0===s[t]?null:s[t]}function g(e,t){if(null===e)return null;var r,n=a(e);return null===n||null===n._responseHeaders?null:(r=p(n._responseHeaders),void 0===r[t]?null:r[t])}function p(e){var t={};if(!e)return t;for(var r=e.trim().split("\r\n"),n=0,u=r.length;n<u;n++){var s=r[n],i=s.indexOf(": ");i>0&&(t[s.substring(0,i)]=s.substring(i+2))}return t}function h(e,t){var r=v(e,t,!0);return null!==r?r:-1}function v(e,t,r){var n,u,s,i,a,o;for(u=e.AdaptationSet_asArray,a=0;a<u.length;a+=1)for(n=u[a],i=n.Representation_asArray,o=0;o<i.length;o+=1)if(s=i[o],t===s.id)return r?o:s;return null}function D(e,t){return(0,_modelsDashManifestModel2.default)(y).getInstance().getIsTypeOf(e,t)}function R(e,t){var r,n,u,s;if(!e||!t)return-1;for(n=e.AdaptationSet_asArray,s=0;s<n.length;s+=1)if(r=n[s],u=r.Representation_asArray,D(r,t))return u.length;return-1}var q=void 0,y=this.context,L=(0,_streamingModelsManifestModel2.default)(y).getInstance();return q={getBandwidthForRepresentation:e,getIndexForRepresentation:t,getMaxIndexForBufferType:r,getCurrentRepresentationSwitch:n,getLatestBufferLevelVO:u,getCurrentBufferLevel:s,getCurrentHttpRequest:a,getHttpRequests:o,getCurrentDroppedFrames:f,getCurrentSchedulingInfo:c,getCurrentDVRInfo:M,getCurrentManifestUpdate:d,getLatestFragmentRequestHeaderValueByID:g,getLatestMPDRequestHeaderValueByID:_,getRequestsQueue:i}}Object.defineProperty(exports,"__esModule",{value:!0});var _streamingVoMetricsHTTPRequest=require("../streaming/vo/metrics/HTTPRequest"),_streamingModelsManifestModel=require("../streaming/models/ManifestModel"),_streamingModelsManifestModel2=_interopRequireDefault(_streamingModelsManifestModel),_modelsDashManifestModel=require("./models/DashManifestModel"),_modelsDashManifestModel2=_interopRequireDefault(_modelsDashManifestModel),_coreFactoryMaker=require("../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_constantsDashMetricsList=require("./constants/DashMetricsList"),MetricsList=_interopRequireWildcard(_constantsDashMetricsList),_round10=require("round10");DashMetrics.__dashjs_factory_name="DashMetrics",exports.default=_coreFactoryMaker2.default.getSingletonFactory(DashMetrics),module.exports=exports.default;
},{"../core/FactoryMaker":15,"../streaming/models/ManifestModel":106,"../streaming/vo/metrics/HTTPRequest":185,"./constants/DashMetricsList":25,"./models/DashManifestModel":27,"round10":212}],23:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function SegmentBaseLoader(){function e(){_=(0,_streamingUtilsErrorHandler2.default)(l).getInstance(),c=(0,_streamingUtilsBoxParser2.default)(l).getInstance(),m=(0,_streamingUtilsRequestModifier2.default)(l).getInstance(),E=(0,_streamingXHRLoader2.default)(l).create({errHandler:_,metricsModel:v,requestModifier:m})}function r(e){e.baseURLController&&(q=e.baseURLController),e.metricsModel&&(v=e.metricsModel)}function t(e,r){var n=null,a=null,i=q.resolve(e.path),u=r||{init:!0,url:i?i.url:void 0,range:{start:0,end:1500},searching:!1,bytesLoaded:0,bytesToLoad:1500};g("Start searching for initialization.");var l=o(u),f=function(r){u.bytesLoaded=u.range.end,a=c.parse(r),n=s(a),n?(e.range=n,d.trigger(_coreEventsEvents2.default.INITIALIZATION_LOADED,{representation:e})):(u.range.end=u.bytesLoaded+u.bytesToLoad,t(e,u))},_=function(){d.trigger(_coreEventsEvents2.default.INITIALIZATION_LOADED,{representation:e})};E.load({request:l,success:f,error:_}),g("Perform init search: "+u.url)}function n(e,r,t,a,s){if(t&&(void 0===t.start||void 0===t.end)){var l=t?t.toString().split("-"):null;t=l?{start:parseFloat(l[0]),end:parseFloat(l[1])}:null}s=s?s:u;var d=null,f=null,_=!!t,m=q.resolve(e.path),v={init:!1,url:m?m.url:void 0,range:_?t:{start:0,end:1500},searching:!_,bytesLoaded:a?a.bytesLoaded:0,bytesToLoad:1500},p=o(v),R=function(t){var a=v.bytesToLoad,o=t.byteLength;if(v.bytesLoaded=v.range.end-v.range.start,d=c.parse(t),f=d.getBox("sidx"),f&&f.isComplete){var u,l,_=f.references;if(null!==_&&void 0!==_&&_.length>0&&(u=1===_[0].reference_type),u){g("Initiate multiple SIDX load."),v.range.end=v.range.start+f.size;var m,E,q,p,R,L=[],T=0,D=(f.offset||v.range.start)+f.size,y=function(t){t?(L=L.concat(t),T++,T>=E&&s(L,e,r)):s(null,e,r)};for(m=0,E=_.length;m<E;m++)q=D,p=D+_[m].referenced_size-1,D+=_[m].referenced_size,R={start:q,end:p},n(e,null,R,v,y)}else g("Parsing segments from SIDX."),l=i(f,v),s(l,e,r)}else{if(f)v.range.start=f.offset||v.range.start,v.range.end=v.range.start+(f.size||a);else{if(o<v.bytesLoaded)return void s(null,e,r);var M=d.getLastBox();M&&M.size?(v.range.start=M.offset+M.size,v.range.end=v.range.start+a):v.range.end+=a}n(e,r,v.range,v,s)}},L=function(){s(null,e,r)};E.load({request:p,success:R,error:L}),g("Perform SIDX load: "+v.url)}function a(){E.abort(),E=null,_=null,c=null,m=null}function i(e,r){for(var t,n,a,i,s=e.references,o=s.length,u=e.timescale,l=e.earliest_presentation_time,g=r.range.start+e.offset+e.first_offset+e.size,d=[],f=0;f<o;f++)a=s[f].subsegment_duration,i=s[f].referenced_size,t=new _voSegment2.default,t.duration=a,t.startTime=l,t.timescale=u,n=g+i-1,t.mediaRange=g+"-"+n,d.push(t),l+=a,g+=i;return d}function s(e){var r,t,n=e.getBox("ftyp"),a=e.getBox("moov"),i=null;return g("Searching for initialization."),a&&a.isComplete&&(r=n?n.offset:a.offset,t=a.offset+a.size-1,i=r+"-"+t,g("Found the initialization.  Range: "+i)),i}function o(e){if(e.url){var r=new _streamingVoFragmentRequest2.default;return r.type=e.init?_streamingVoMetricsHTTPRequest.HTTPRequest.INIT_SEGMENT_TYPE:_streamingVoMetricsHTTPRequest.HTTPRequest.MEDIA_SEGMENT_TYPE,r.url=e.url,r.range=e.range.start+"-"+e.range.end,r}}function u(e,r,t){e?d.trigger(_coreEventsEvents2.default.SEGMENTS_LOADED,{segments:e,representation:r,mediaType:t}):d.trigger(_coreEventsEvents2.default.SEGMENTS_LOADED,{segments:null,representation:r,mediaType:t,error:new _streamingVoError2.default(null,"error loading segments",null)})}var l=this.context,g=(0,_coreDebug2.default)(l).getInstance().log,d=(0,_coreEventBus2.default)(l).getInstance(),f=void 0,_=void 0,c=void 0,m=void 0,v=void 0,E=void 0,q=void 0;return f={setConfig:r,initialize:e,loadInitialization:t,loadSegments:n,reset:a}}Object.defineProperty(exports,"__esModule",{value:!0});var _streamingUtilsRequestModifier=require("../streaming/utils/RequestModifier"),_streamingUtilsRequestModifier2=_interopRequireDefault(_streamingUtilsRequestModifier),_voSegment=require("./vo/Segment"),_voSegment2=_interopRequireDefault(_voSegment),_streamingVoError=require("../streaming/vo/Error"),_streamingVoError2=_interopRequireDefault(_streamingVoError),_streamingUtilsErrorHandler=require("../streaming/utils/ErrorHandler"),_streamingUtilsErrorHandler2=_interopRequireDefault(_streamingUtilsErrorHandler),_coreEventsEvents=require("../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_coreEventBus=require("../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_streamingUtilsBoxParser=require("../streaming/utils/BoxParser"),_streamingUtilsBoxParser2=_interopRequireDefault(_streamingUtilsBoxParser),_coreFactoryMaker=require("../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_coreDebug=require("../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug),_streamingVoMetricsHTTPRequest=require("../streaming/vo/metrics/HTTPRequest"),_streamingVoFragmentRequest=require("../streaming/vo/FragmentRequest"),_streamingVoFragmentRequest2=_interopRequireDefault(_streamingVoFragmentRequest),_streamingXHRLoader=require("../streaming/XHRLoader"),_streamingXHRLoader2=_interopRequireDefault(_streamingXHRLoader);SegmentBaseLoader.__dashjs_factory_name="SegmentBaseLoader",exports.default=_coreFactoryMaker2.default.getSingletonFactory(SegmentBaseLoader),module.exports=exports.default;
},{"../core/Debug":13,"../core/EventBus":14,"../core/FactoryMaker":15,"../core/events/Events":18,"../streaming/XHRLoader":64,"../streaming/utils/BoxParser":152,"../streaming/utils/ErrorHandler":157,"../streaming/utils/RequestModifier":162,"../streaming/vo/Error":168,"../streaming/vo/FragmentRequest":169,"../streaming/vo/metrics/HTTPRequest":185,"./vo/Segment":52}],24:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function WebmSegmentBaseLoader(){function e(){v={EBML:{tag:440786851,required:!0},Segment:{tag:408125543,required:!0,SeekHead:{tag:290298740,required:!0},Info:{tag:357149030,required:!0,TimecodeScale:{tag:2807729,required:!0,parse:"getMatroskaUint"},Duration:{tag:17545,required:!0,parse:"getMatroskaFloat"}},Tracks:{tag:374648427,required:!0},Cues:{tag:475249515,required:!0,CuePoint:{tag:187,required:!0,CueTime:{tag:179,required:!0,parse:"getMatroskaUint"},CueTrackPositions:{tag:183,required:!0,CueTrack:{tag:247,required:!0,parse:"getMatroskaUint"},CueClusterPosition:{tag:241,required:!0,parse:"getMatroskaUint"},CueBlockNumber:{tag:21368}}}}},Void:{tag:236,required:!0}}}function r(){_=(0,_streamingUtilsErrorHandler2.default)(d).getInstance(),E=(0,_streamingUtilsRequestModifier2.default)(d).getInstance(),q=(0,_streamingXHRLoader2.default)(d).create({errHandler:_,metricsModel:T,requestModifier:E})}function t(e){if(!e.baseURLController||!e.metricsModel)throw new Error("Missing config parameter(s)");C=e.baseURLController,T=e.metricsModel}function a(e){var r=[],t=void 0,a=void 0,n=void 0,o=(0,_streamingUtilsEBMLParser2.default)(d).create({data:e}),i=void 0;for(o.consumeTag(v.Segment.Cues),a=o.getMatroskaCodedNum();o.moreData()&&o.consumeTagAndSize(v.Segment.Cues.CuePoint,!0);){for(t={},t.CueTime=o.parseTag(v.Segment.Cues.CuePoint.CueTime),t.CueTracks=[];o.moreData()&&o.consumeTagAndSize(v.Segment.Cues.CuePoint.CueTrackPositions,!0);){if(n={},n.Track=o.parseTag(v.Segment.Cues.CuePoint.CueTrackPositions.CueTrack),0===n.Track)throw new Error("Cue track cannot be 0");n.ClusterPosition=o.parseTag(v.Segment.Cues.CuePoint.CueTrackPositions.CueClusterPosition),o.getPos()+4>a||!o.consumeTag(v.Segment.Cues.CuePoint.CueTrackPositions.CueBlockNumber,!0)?t.CueTracks.push(n):(i=o.getMatroskaCodedNum(),n.BlockNumber=o.getMatroskaUint(i),t.CueTracks.push(n))}if(0===t.CueTracks.length)throw new Error("Mandatory cuetrack not found");r.push(t)}if(0===r.length)throw new Error("mandatory cuepoint not found");return r}function n(e,r,t,n){var o=void 0,i=void 0,s=void 0,u=void 0,g=void 0,l=void 0,d=void 0,c=void 0;for(i=a(e),s=[],g=0,l=i.length;g<l;g+=1)u=new _voSegment2.default,o=0,o=g<i.length-1?i[g+1].CueTime-i[g].CueTime:n-i[g].CueTime,u.duration=o,u.startTime=i[g].CueTime,u.timescale=1e3,d=i[g].CueTracks[0].ClusterPosition+r,c=g<i.length-1?i[g+1].CueTracks[0].ClusterPosition+r-1:t-1,u.mediaRange=d+"-"+c,s.push(u);return m("Parsed cues: "+s.length+" cues."),s}function o(e,r,t,a){var o=(0,_streamingUtilsEBMLParser2.default)(d).create({data:e}),i=void 0,s=void 0,u=t.split("-"),l=null,c={url:r,range:{start:parseFloat(u[0]),end:parseFloat(u[1])},request:l},f=void 0,_=void 0;for(m("Parse EBML header: "+c.url),o.skipOverElement(v.EBML),o.consumeTag(v.Segment),f=o.getMatroskaCodedNum(),f+=o.getPos(),_=o.getPos();o.moreData()&&!o.consumeTagAndSize(v.Segment.Info,!0);)if(!(o.skipOverElement(v.Segment.SeekHead,!0)||o.skipOverElement(v.Segment.Tracks,!0)||o.skipOverElement(v.Segment.Cues,!0)||o.skipOverElement(v.Void,!0)))throw new Error("no valid top level element found");for(;void 0===i;){var E=o.getMatroskaCodedNum(!0),T=o.getMatroskaCodedNum();switch(E){case v.Segment.Info.Duration.tag:i=o[v.Segment.Info.Duration.parse](T);break;default:o.setPos(o.getPos()+T)}}l=g(c);var C=function(e){s=n(e,_,f,i),a(s)},p=function(){m("Download Error: Cues "+c.url),a(null)};q.load({request:l,success:C,error:p}),m("Perform cues load: "+c.url+" bytes="+c.range.start+"-"+c.range.end)}function i(e,r){var t=null,a=C.resolve(e.path),n=a?a.url:void 0,o=e.range.split("-"),i=r||{range:{start:parseFloat(o[0]),end:parseFloat(o[1])},request:t,url:n,init:!0};m("Start loading initialization."),t=g(i);var s=function(){c.trigger(_coreEventsEvents2.default.INITIALIZATION_LOADED,{representation:e})},u=function(){c.trigger(_coreEventsEvents2.default.INITIALIZATION_LOADED,{representation:e})};q.load({request:t,success:s,error:u}),m("Perform init load: "+i.url)}function s(e,r,t,a){var n=null,i=C.resolve(e.path),s=i?i.url:void 0,l=8192,d={bytesLoaded:0,bytesToLoad:l,range:{start:0,end:l},request:n,url:s,init:!1};a=a?a:u,n=g(d),m("Parsing ebml header");var c=function(n){o(n,s,t,function(t){a(t,e,r)})},f=function(){a(null,e,r)};q.load({request:n,success:c,error:f})}function u(e,r,t){e?c.trigger(_coreEventsEvents2.default.SEGMENTS_LOADED,{segments:e,representation:r,mediaType:t}):c.trigger(_coreEventsEvents2.default.SEGMENTS_LOADED,{segments:null,representation:r,mediaType:t,error:new Error(null,"error loading segments",null)})}function g(e){var r=new _streamingVoFragmentRequest2.default;return r.type=e.init?_streamingVoMetricsHTTPRequest.HTTPRequest.INIT_SEGMENT_TYPE:_streamingVoMetricsHTTPRequest.HTTPRequest.MEDIA_SEGMENT_TYPE,r.url=e.url,r.range=e.range.start+"-"+e.range.end,r}function l(){_=null,E=null,m=null}var d=this.context,m=(0,_coreDebug2.default)(d).getInstance().log,c=(0,_coreEventBus2.default)(d).getInstance(),f=void 0,v=void 0,_=void 0,E=void 0,T=void 0,q=void 0,C=void 0;return f={setConfig:t,initialize:r,loadInitialization:i,loadSegments:s,reset:l},e(),f}Object.defineProperty(exports,"__esModule",{value:!0});var _coreEventsEvents=require("../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_coreEventBus=require("../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_streamingUtilsEBMLParser=require("../streaming/utils/EBMLParser"),_streamingUtilsEBMLParser2=_interopRequireDefault(_streamingUtilsEBMLParser),_coreFactoryMaker=require("../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_coreDebug=require("../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug),_streamingUtilsErrorHandler=require("../streaming/utils/ErrorHandler"),_streamingUtilsErrorHandler2=_interopRequireDefault(_streamingUtilsErrorHandler),_streamingUtilsRequestModifier=require("../streaming/utils/RequestModifier"),_streamingUtilsRequestModifier2=_interopRequireDefault(_streamingUtilsRequestModifier),_voSegment=require("./vo/Segment"),_voSegment2=_interopRequireDefault(_voSegment),_streamingVoMetricsHTTPRequest=require("../streaming/vo/metrics/HTTPRequest"),_streamingVoFragmentRequest=require("../streaming/vo/FragmentRequest"),_streamingVoFragmentRequest2=_interopRequireDefault(_streamingVoFragmentRequest),_streamingXHRLoader=require("../streaming/XHRLoader"),_streamingXHRLoader2=_interopRequireDefault(_streamingXHRLoader);WebmSegmentBaseLoader.__dashjs_factory_name="WebmSegmentBaseLoader",exports.default=_coreFactoryMaker2.default.getSingletonFactory(WebmSegmentBaseLoader),module.exports=exports.default;
},{"../core/Debug":13,"../core/EventBus":14,"../core/FactoryMaker":15,"../core/events/Events":18,"../streaming/XHRLoader":64,"../streaming/utils/EBMLParser":156,"../streaming/utils/ErrorHandler":157,"../streaming/utils/RequestModifier":162,"../streaming/vo/FragmentRequest":169,"../streaming/vo/metrics/HTTPRequest":185,"./vo/Segment":52}],25:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var TCP_CONNECTION="TcpList";exports.TCP_CONNECTION=TCP_CONNECTION;var HTTP_REQUEST="HttpList";exports.HTTP_REQUEST=HTTP_REQUEST;var TRACK_SWITCH="RepSwitchList";exports.TRACK_SWITCH=TRACK_SWITCH;var BUFFER_LEVEL="BufferLevel";exports.BUFFER_LEVEL=BUFFER_LEVEL;var BUFFER_STATE="BufferState";exports.BUFFER_STATE=BUFFER_STATE;var DVR_INFO="DVRInfo";exports.DVR_INFO=DVR_INFO;var DROPPED_FRAMES="DroppedFrames";exports.DROPPED_FRAMES=DROPPED_FRAMES;var SCHEDULING_INFO="SchedulingInfo";exports.SCHEDULING_INFO=SCHEDULING_INFO;var REQUESTS_QUEUE="RequestsQueue";exports.REQUESTS_QUEUE=REQUESTS_QUEUE;var MANIFEST_UPDATE="ManifestUpdate";exports.MANIFEST_UPDATE=MANIFEST_UPDATE;var MANIFEST_UPDATE_STREAM_INFO="ManifestUpdatePeriodInfo";exports.MANIFEST_UPDATE_STREAM_INFO=MANIFEST_UPDATE_STREAM_INFO;var MANIFEST_UPDATE_TRACK_INFO="ManifestUpdateRepresentationInfo";exports.MANIFEST_UPDATE_TRACK_INFO=MANIFEST_UPDATE_TRACK_INFO;var PLAY_LIST="PlayList";exports.PLAY_LIST=PLAY_LIST;var DVB_ERRORS="DVBErrors";exports.DVB_ERRORS=DVB_ERRORS;
},{}],26:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function RepresentationController(){function e(){P=null,S=-1,q=!0,h=[],F=(0,_streamingControllersAbrController2.default)(C).getInstance(),L=(0,_streamingControllersStreamController2.default)(C).getInstance(),O=(0,_streamingControllersPlaybackController2.default)(C).getInstance(),k=(0,_streamingModelsManifestModel2.default)(C).getInstance(),B=(0,_streamingModelsMetricsModel2.default)(C).getInstance(),Q=(0,_streamingUtilsDOMStorage2.default)(C).getInstance(),V=(0,_utilsTimelineConverter2.default)(C).getInstance(),w=(0,_modelsDashManifestModel2.default)(C).getInstance(),N=(0,_DashMetrics2.default)(C).getInstance(),z=(0,_streamingModelsMediaPlayerModel2.default)(C).getInstance(),A.on(_coreEventsEvents2.default.QUALITY_CHANGE_REQUESTED,R,I),A.on(_coreEventsEvents2.default.REPRESENTATION_UPDATED,p,I),A.on(_coreEventsEvents2.default.WALLCLOCK_TIME_UPDATED,D,I),A.on(_coreEventsEvents2.default.BUFFER_LEVEL_UPDATED,y,I)}function t(e){e.abrController&&(F=e.abrController)}function r(e){b=e,x=b.getIndexHandler()}function n(){return b}function a(){return P}function i(){return S}function o(){return q}function l(){return U}function s(){A.off(_coreEventsEvents2.default.QUALITY_CHANGE_REQUESTED,R,I),A.off(_coreEventsEvents2.default.REPRESENTATION_UPDATED,p,I),A.off(_coreEventsEvents2.default.WALLCLOCK_TIME_UPDATED,D,I),A.off(_coreEventsEvents2.default.BUFFER_LEVEL_UPDATED,y,I),P=null,S=-1,q=!0,h=[],F=null,L=null,O=null,k=null,B=null,Q=null,V=null,w=null,N=null,z=null}function u(e,t,r){var n,a,i=null,o=b.getStreamInfo(),l=F.getTopQualityIndexFor(r,o.id);if(q=!0,A.trigger(_coreEventsEvents2.default.DATA_UPDATE_STARTED,{sender:this}),h=m(t),null===P&&"fragmentedText"!==r?(a=F.getAverageThroughput(r),i=a||F.getInitialBitrateFor(r,o),n=F.getQualityForBitrate(b.getMediaInfo(),i)):n=F.getQualityFor(r,o),n>l&&(n=l),U=f(n),P=e,"video"!==r&&"audio"!==r&&"fragmentedText"!==r)return q=!1,void A.trigger(_coreEventsEvents2.default.DATA_UPDATE_COMPLETED,{sender:this,data:P,currentRepresentation:U});for(var s=0;s<h.length;s++)x.updateRepresentation(h[s],!0)}function d(){var e=new Date,t=l(),r=1e3*O.getTime();B.addRepresentationSwitch(t.adaptation.type,e,r,t.id)}function g(){var e=V.calcSegmentAvailabilityRange(U,b.isDynamic());B.addDVRInfo(b.getType(),O.getTime(),b.getStreamInfo().manifestInfo,e)}function f(e){return h[e]}function _(e){return h.indexOf(e)}function c(){for(var e=0,t=h.length;e<t;e++){var r=h[e].segmentInfoType;if(null===h[e].segmentAvailabilityRange||!_voRepresentation2.default.hasInitialization(h[e])||("SegmentBase"===r||"BaseURL"===r)&&!h[e].segments)return!1}return!0}function m(e){var t,r=k.getValue();return S=w.getIndexForAdaptation(P,r,e.period.index),t=w.getRepresentationsForAdaptation(r,e)}function v(e){for(var t,r=0,n=h.length;r<n;r++)t=h[r],t.segmentAvailabilityRange=V.calcSegmentAvailabilityRange(t,e)}function E(){h.forEach(function(e){e.segmentAvailabilityRange=null})}function M(e){var t=e,r=function(){if(!o()){q=!0,A.trigger(_coreEventsEvents2.default.DATA_UPDATE_STARTED,{sender:I}),E();for(var e=0;e<h.length;e++)x.updateRepresentation(h[e],!0)}};q=!1,A.trigger(_streamingMediaPlayerEvents2.default.AST_IN_FUTURE,{delay:t}),setTimeout(r,t)}function p(e){if(e.sender.getStreamProcessor()===b&&o()){var t,r,n,a=e.representation,i=B.getMetricsFor("stream"),s=B.getMetricsFor(l().adaptation.type),u=N.getCurrentManifestUpdate(i),f=!1,m=0;if("dynamic"===a.adaptation.period.mpd.manifest.type){var v=a.segmentAvailabilityRange.end-a.segmentAvailabilityRange.start,E=O.computeLiveDelay(U.segmentDuration,b.getStreamInfo().manifestInfo.DVRWindowSize);m=1e3*(E-v)}if(m>0)return g(),M(m),r=new _streamingVoError2.default(T,"Segments update failed",null),void A.trigger(_coreEventsEvents2.default.DATA_UPDATE_COMPLETED,{sender:this,data:P,currentRepresentation:U,error:r});if(u){for(var p=0;p<u.trackInfo.length;p++)if(t=u.trackInfo[p],t.index===a.index&&t.mediaType===b.getType()){f=!0;break}f||B.addManifestUpdateRepresentationInfo(u,a.id,a.index,a.adaptation.period.index,b.getType(),a.presentationTimeOffset,a.startNumber,a.segmentInfoType)}c()&&(q=!1,F.setPlaybackQuality(b.getType(),b.getStreamInfo(),_(U)),B.updateManifestUpdateInfo(u,{latency:U.segmentAvailabilityRange.end-O.getTime()}),n=N.getCurrentRepresentationSwitch(s),n||d(),A.trigger(_coreEventsEvents2.default.DATA_UPDATE_COMPLETED,{sender:this,data:P,currentRepresentation:U}))}}function D(e){e.isDynamic&&v(e.isDynamic)}function y(e){e.sender.getStreamProcessor()===b&&g()}function R(e){e.mediaType===b.getType()&&b.getStreamInfo().id===e.streamInfo.id&&e.oldQuality!==e.newQuality&&(U=f(e.newQuality),Q.setSavedBitrateSettings(e.mediaType,U.bandwidth),d())}var T=1,C=this.context,A=(0,_coreEventBus2.default)(C).getInstance(),I=void 0,P=void 0,S=void 0,q=void 0,h=void 0,U=void 0,b=void 0,F=void 0,x=void 0,L=void 0,O=void 0,k=void 0,B=void 0,Q=void 0,V=void 0,w=void 0,N=void 0,z=void 0;return I={initialize:r,setConfig:t,getData:a,getDataIndex:i,isUpdating:o,updateData:u,getStreamProcessor:n,getCurrentRepresentation:l,getRepresentationForQuality:f,reset:s},e(),I}Object.defineProperty(exports,"__esModule",{value:!0});var _modelsDashManifestModel=require("../models/DashManifestModel"),_modelsDashManifestModel2=_interopRequireDefault(_modelsDashManifestModel),_DashMetrics=require("../DashMetrics"),_DashMetrics2=_interopRequireDefault(_DashMetrics),_utilsTimelineConverter=require("../utils/TimelineConverter"),_utilsTimelineConverter2=_interopRequireDefault(_utilsTimelineConverter),_streamingControllersAbrController=require("../../streaming/controllers/AbrController"),_streamingControllersAbrController2=_interopRequireDefault(_streamingControllersAbrController),_streamingControllersPlaybackController=require("../../streaming/controllers/PlaybackController"),_streamingControllersPlaybackController2=_interopRequireDefault(_streamingControllersPlaybackController),_streamingControllersStreamController=require("../../streaming/controllers/StreamController"),_streamingControllersStreamController2=_interopRequireDefault(_streamingControllersStreamController),_streamingModelsManifestModel=require("../../streaming/models/ManifestModel"),_streamingModelsManifestModel2=_interopRequireDefault(_streamingModelsManifestModel),_streamingModelsMetricsModel=require("../../streaming/models/MetricsModel"),_streamingModelsMetricsModel2=_interopRequireDefault(_streamingModelsMetricsModel),_streamingModelsMediaPlayerModel=require("../../streaming/models/MediaPlayerModel"),_streamingModelsMediaPlayerModel2=_interopRequireDefault(_streamingModelsMediaPlayerModel),_streamingUtilsDOMStorage=require("../../streaming/utils/DOMStorage"),_streamingUtilsDOMStorage2=_interopRequireDefault(_streamingUtilsDOMStorage),_streamingVoError=require("../../streaming/vo/Error"),_streamingVoError2=_interopRequireDefault(_streamingVoError),_coreEventBus=require("../../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreEventsEvents=require("../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_streamingMediaPlayerEvents=require("../../streaming/MediaPlayerEvents"),_streamingMediaPlayerEvents2=_interopRequireDefault(_streamingMediaPlayerEvents),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_voRepresentation=require("../vo/Representation"),_voRepresentation2=_interopRequireDefault(_voRepresentation);RepresentationController.__dashjs_factory_name="RepresentationController",exports.default=_coreFactoryMaker2.default.getClassFactory(RepresentationController),module.exports=exports.default;
},{"../../core/EventBus":14,"../../core/FactoryMaker":15,"../../core/events/Events":18,"../../streaming/MediaPlayerEvents":58,"../../streaming/controllers/AbrController":66,"../../streaming/controllers/PlaybackController":74,"../../streaming/controllers/StreamController":77,"../../streaming/models/ManifestModel":106,"../../streaming/models/MediaPlayerModel":107,"../../streaming/models/MetricsModel":108,"../../streaming/utils/DOMStorage":155,"../../streaming/vo/Error":168,"../DashMetrics":22,"../models/DashManifestModel":27,"../utils/TimelineConverter":43,"../vo/Representation":51}],27:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function DashManifestModel(){function e(e,t){var r,n,a,i=!1,o=!1,s=e.ContentComponent_asArray,u="text"!==t?new RegExp(t):new RegExp("(vtt|ttml)");if(e.Representation_asArray.length>0&&e.Representation_asArray[0].hasOwnProperty("codecs")){var d=e.Representation_asArray[0].codecs;if(0===d.search("stpp")||0===d.search("wvtt"))return"fragmentedText"===t}if(s){if(s.length>1)return"muxed"===t;s[0]&&s[0].contentType===t&&(i=!0,o=!0)}if(e.hasOwnProperty("mimeType")&&(i=u.test(e.mimeType),o=!0),!o)for(r=0,n=e.Representation_asArray.length;!o&&r<n;)a=e.Representation_asArray[r],a.hasOwnProperty("mimeType")&&(i=u.test(a.mimeType),o=!0),r++;return i}function t(t){return e(t,"audio")}function r(t){return e(t,"video")}function n(t){return e(t,"fragmentedText")}function a(t){return e(t,"text")}function i(t){return e(t,"muxed")}function o(e){return"text/vtt"===e||"application/ttml+xml"===e}function s(e){var t="";return e.hasOwnProperty("lang")&&(t=e.lang.replace(/[^A-Za-z0-9-]/g,"")),t}function u(e){return e.hasOwnProperty("Viewpoint")?e.Viewpoint:null}function d(e){return e.hasOwnProperty("Role_asArray")?e.Role_asArray:[]}function l(e){return e.hasOwnProperty("Accessibility_asArray")?e.Accessibility_asArray:[]}function p(e){return e.hasOwnProperty("AudioChannelConfiguration_asArray")?e.AudioChannelConfiguration_asArray:[]}function m(e){return d(e).filter(function(e){return"main"===e.value})[0]}function y(){return function(e,t){return e.bandwidth-t.bandwidth}}function f(e){return void 0!==e.Representation_asArray&&null!==e.Representation_asArray&&e.Representation_asArray.sort(y()),e}function h(e,t,r){var n,a,i=t.Period_asArray[r].AdaptationSet_asArray;for(n=0,a=i.length;n<a;n++)if(i[n].hasOwnProperty("id")&&i[n].id===e)return i[n];return null}function v(e,t,r){var n=t.Period_asArray[r].AdaptationSet_asArray;return n[e]}function g(e,t,r){var n,a,i=t.Period_asArray[r].AdaptationSet_asArray;for(n=0,a=i.length;n<a;n++)if(i[n]===e)return n;return-1}function c(t,r,n){var a,i,o=t.Period_asArray[r].AdaptationSet_asArray,s=[];for(a=0,i=o.length;a<i;a++)e(o[a],n)&&s.push(f(o[a]));return s}function _(e,t,r,n){var a=c(e,t,r);if(!a||0===a.length)return null;if(a.length>1&&n)for(var i=J.getCurrentTrackFor(r,n),o=Q.getAllMediaInfoForType(e,n,r),s=0,u=a.length;s<u;s++){if(i&&J.isTracksEqual(i,o[s]))return a[s];if(m(a[s]))return a[s]}return a[0]}function P(e){var t=e.Representation_asArray[0];return t.mimeType+';codecs="'+t.codecs+'"'}function A(e){return e.Representation_asArray[0].mimeType}function w(e){return e&&e.hasOwnProperty("cenc:default_KID")?e["cenc:default_KID"]:null}function T(e){return e&&e.hasOwnProperty("ContentProtection_asArray")&&0!==e.ContentProtection_asArray.length?e.ContentProtection_asArray:null}function O(e){var t=!1;return e.hasOwnProperty("type")&&(t="dynamic"===e.type),t}function R(e){var t,r,n=O(e);return t=!isNaN(e.timeShiftBufferDepth),r=n&&t}function S(e,t){var r=!1;return e.profiles&&e.profiles.length>0&&(r=e.profiles.indexOf(t)!==-1),r}function D(e){return S(e,"urn:mpeg:dash:profile:isoff-on-demand:2011")}function I(e){return S(e,"urn:dvb:dash:profile:dvb-dash:2014")}function U(e){var t;return t=e.hasOwnProperty("mediaPresentationDuration")?e.mediaPresentationDuration:Number.MAX_VALUE}function x(e){return e.bandwidth}function E(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],r=NaN;return e.hasOwnProperty("minimumUpdatePeriod")&&(r=e.minimumUpdatePeriod),isNaN(r)?r:Math.max(r-t,1)}function b(e){return e.Representation_asArray.length}function C(e){if(!e||!e.Representation_asArray||!e.Representation_asArray.length)return null;for(var t=f(e),r=t.Representation_asArray,n=r.length,a=[],i=0;i<n;i++)a.push({bandwidth:r[i].bandwidth,width:r[i].width||0,height:r[i].height||0});return a}function M(e,t){return t.Representation_asArray[e]}function L(e,t){for(var r,n,a,i,s,u=f(e.Period_asArray[t.period.index].AdaptationSet_asArray[t.index]),d=[],l=0;l<u.Representation_asArray.length;l++)i=u.Representation_asArray[l],r=new _voRepresentation2.default,r.index=l,r.adaptation=t,i.hasOwnProperty("id")&&(r.id=i.id),i.hasOwnProperty("bandwidth")&&(r.bandwidth=i.bandwidth),i.hasOwnProperty("maxPlayoutRate")&&(r.maxPlayoutRate=i.maxPlayoutRate),i.hasOwnProperty("SegmentBase")?(a=i.SegmentBase,r.segmentInfoType="SegmentBase"):i.hasOwnProperty("SegmentList")?(a=i.SegmentList,a.hasOwnProperty("SegmentTimeline")?(r.segmentInfoType="SegmentTimeline",s=a.SegmentTimeline.S_asArray[a.SegmentTimeline.S_asArray.length-1],(!s.hasOwnProperty("r")||s.r>=0)&&(r.useCalculatedLiveEdgeTime=!0)):(r.segmentInfoType="SegmentList",r.useCalculatedLiveEdgeTime=!0)):i.hasOwnProperty("SegmentTemplate")?(a=i.SegmentTemplate,a.hasOwnProperty("SegmentTimeline")?(r.segmentInfoType="SegmentTimeline",s=a.SegmentTimeline.S_asArray[a.SegmentTimeline.S_asArray.length-1],(!s.hasOwnProperty("r")||s.r>=0)&&(r.useCalculatedLiveEdgeTime=!0)):r.segmentInfoType="SegmentTemplate",a.hasOwnProperty("initialization")&&(r.initialization=a.initialization.split("$Bandwidth$").join(i.bandwidth).split("$RepresentationID$").join(i.id))):r.segmentInfoType="BaseURL",a&&(a.hasOwnProperty("Initialization")?(n=a.Initialization,n.hasOwnProperty("sourceURL")?r.initialization=n.sourceURL:n.hasOwnProperty("range")&&(r.range=n.range)):i.hasOwnProperty("mimeType")&&o(i.mimeType)&&(r.range=0),a.hasOwnProperty("timescale")&&(r.timescale=a.timescale),a.hasOwnProperty("duration")&&(r.segmentDuration=a.duration/r.timescale),a.hasOwnProperty("startNumber")&&(r.startNumber=a.startNumber),a.hasOwnProperty("indexRange")&&(r.indexRange=a.indexRange),a.hasOwnProperty("presentationTimeOffset")&&(r.presentationTimeOffset=a.presentationTimeOffset/r.timescale)),r.MSETimeOffset=H.calcMSETimeOffset(r),r.path=[t.period.index,t.index,l],d.push(r);return d}function F(e,a){for(var o,s,u=e.Period_asArray[a.index],d=[],l=0;l<u.AdaptationSet_asArray.length;l++)s=u.AdaptationSet_asArray[l],o=new _voAdaptationSet2.default,s.hasOwnProperty("id")&&(o.id=s.id),o.index=l,o.period=a,i(s)?o.type="muxed":t(s)?o.type="audio":r(s)?o.type="video":n(s)?o.type="fragmentedText":o.type="text",d.push(o);return d}function q(e,t){var r,n,a=O(e),i=[],o=null,s=null,u=null,d=null;for(n=0,r=e.Period_asArray.length;n<r;n++)s=e.Period_asArray[n],s.hasOwnProperty("start")?(d=new _voPeriod2.default,d.start=s.start):null!==o&&s.hasOwnProperty("duration")&&null!==u?(d=new _voPeriod2.default,d.start=u.start+u.duration,d.duration=s.duration):0!==n||a||(d=new _voPeriod2.default,d.start=0),null!==u&&isNaN(u.duration)&&(u.duration=d.start-u.start),null!==d&&(d.id=B(s,n)),null!==d&&s.hasOwnProperty("duration")&&(d.duration=s.duration),null!==d&&(d.index=n,d.mpd=t,i.push(d),o=s,u=d),s=null,d=null;return 0===i.length?i:(null!==u&&isNaN(u.duration)&&(u.duration=k(e,u)-u.start),i)}function B(e,t){if(!e)throw new Error("Period cannot be null or undefined");var r=_voPeriod2.default.DEFAULT_ID+"_"+t;return e.hasOwnProperty("id")&&"__proto__"!==e.id&&(r=e.id),r}function N(e){var t=new _voMpd2.default;return t.manifest=e,e.hasOwnProperty("availabilityStartTime")?t.availabilityStartTime=new Date(e.availabilityStartTime.getTime()):t.availabilityStartTime=new Date(e.loadedTime.getTime()),e.hasOwnProperty("availabilityEndTime")&&(t.availabilityEndTime=new Date(e.availabilityEndTime.getTime())),e.hasOwnProperty("minimumUpdatePeriod")&&(t.minimumUpdatePeriod=e.minimumUpdatePeriod),e.hasOwnProperty("mediaPresentationDuration")&&(t.mediaPresentationDuration=e.mediaPresentationDuration),e.hasOwnProperty("suggestedPresentationDelay")&&(t.suggestedPresentationDelay=e.suggestedPresentationDelay),e.hasOwnProperty("timeShiftBufferDepth")&&(t.timeShiftBufferDepth=e.timeShiftBufferDepth),e.hasOwnProperty("maxSegmentDuration")&&(t.maxSegmentDuration=e.maxSegmentDuration),t}function k(e,t){var r=O(e),n=void 0;if(e.mediaPresentationDuration)n=e.mediaPresentationDuration;else if(t.duration)n=t.duration;else{if(!r)throw new Error("Must have @mediaPresentationDuratio on MPD or an explicit @duration on the last period.");n=Number.POSITIVE_INFINITY}return n}function V(e,t){var r=e.Period_asArray,n=r[t.index].EventStream_asArray,a=[];if(n)for(var i=0;i<n.length;i++){var o=new _voEventStream2.default;if(o.period=t,o.timescale=1,!n[i].hasOwnProperty("schemeIdUri"))throw new Error("Invalid EventStream. SchemeIdUri has to be set");o.schemeIdUri=n[i].schemeIdUri,n[i].hasOwnProperty("timescale")&&(o.timescale=n[i].timescale),n[i].hasOwnProperty("value")&&(o.value=n[i].value);for(var s=0;s<n[i].Event_asArray.length;s++){var u=new _voEvent2.default;u.presentationTime=0,u.eventStream=o,n[i].Event_asArray[s].hasOwnProperty("presentationTime")&&(u.presentationTime=n[i].Event_asArray[s].presentationTime),n[i].Event_asArray[s].hasOwnProperty("duration")&&(u.duration=n[i].Event_asArray[s].duration),n[i].Event_asArray[s].hasOwnProperty("id")&&(u.id=n[i].Event_asArray[s].id),a.push(u)}}return a}function z(e,t){var r=[];if(!e)return r;for(var n=0;n<e.length;n++){var a=new _voEventStream2.default;if(a.timescale=1,a.representation=t,!e[n].hasOwnProperty("schemeIdUri"))throw new Error("Invalid EventStream. SchemeIdUri has to be set");a.schemeIdUri=e[n].schemeIdUri,e[n].hasOwnProperty("timescale")&&(a.timescale=e[n].timescale),e[n].hasOwnProperty("value")&&(a.value=e[n].value),r.push(a)}return r}function j(e,t){var r=e.Period_asArray[t.period.index].AdaptationSet_asArray[t.index].InbandEventStream_asArray;return z(r,null)}function $(e,t){var r=e.Period_asArray[t.adaptation.period.index].AdaptationSet_asArray[t.adaptation.index].Representation_asArray[t.index].InbandEventStream_asArray;return z(r,t)}function K(e){var t=O(e),r=e.hasOwnProperty("availabilityStartTime"),n=e.UTCTiming_asArray,a=[];return(t||r)&&n&&n.forEach(function(e){var t=new _voUTCTiming2.default;e.hasOwnProperty("schemeIdUri")&&(t.schemeIdUri=e.schemeIdUri,e.hasOwnProperty("value")&&(t.value=e.value.toString(),a.push(t)))}),a}function X(e){var t=[],r=e.BaseURL_asArray||[e.baseUri],n=!1;return r.some(function(r){if(r){var a=new _voBaseURL2.default,i=r.__text||r;return W.isRelative(i)&&(n=!0,e.baseUri&&(i=e.baseUri+i)),a.url=i,r.hasOwnProperty("serviceLocation")&&r.serviceLocation.length?a.serviceLocation=r.serviceLocation:a.serviceLocation=i,r.hasOwnProperty("dvb:priority")&&(a.dvb_priority=r["dvb:priority"]),r.hasOwnProperty("dvb:weight")&&(a.dvb_weight=r["dvb:weight"]),t.push(a),n}}),t}function Y(e){return e.hasOwnProperty("Location")&&(e.Location=e.Location_asArray[0]),e.Location}var Z=void 0,G=this.context,H=(0,_utilsTimelineConverter2.default)(G).getInstance(),J=(0,_streamingControllersMediaController2.default)(G).getInstance(),Q=(0,_DashAdapter2.default)(G).getInstance(),W=(0,_streamingUtilsURLUtils2.default)(G).getInstance();return Z={getIsTypeOf:e,getIsAudio:t,getIsVideo:r,getIsText:a,getIsMuxed:i,getIsTextTrack:o,getIsFragmentedText:n,getIsMain:m,getLanguageForAdaptation:s,getViewpointForAdaptation:u,getRolesForAdaptation:d,getAccessibilityForAdaptation:l,getAudioChannelConfigurationForAdaptation:p,processAdaptation:f,getAdaptationForIndex:v,getIndexForAdaptation:g,getAdaptationForId:h,getAdaptationsForType:c,getAdaptationForType:_,getCodec:P,getMimeType:A,getKID:w,getContentProtectionData:T,getIsDynamic:O,getIsDVR:R,getIsOnDemand:D,getIsDVB:I,getDuration:U,getBandwidth:x,getManifestUpdatePeriod:E,getRepresentationCount:b,getBitrateListForAdaptation:C,getRepresentationFor:M,getRepresentationsForAdaptation:L,getAdaptationsForPeriod:F,getRegularPeriods:q,getMpd:N,getEventsForPeriod:V,getEventStreams:z,getEventStreamForAdaptationSet:j,getEventStreamForRepresentation:$,getUTCTimingSources:K,getBaseURLsFromElement:X,getRepresentationSortFunction:y,getLocation:Y}}Object.defineProperty(exports,"__esModule",{value:!0});var _voRepresentation=require("../vo/Representation"),_voRepresentation2=_interopRequireDefault(_voRepresentation),_voAdaptationSet=require("../vo/AdaptationSet"),_voAdaptationSet2=_interopRequireDefault(_voAdaptationSet),_voPeriod=require("../vo/Period"),_voPeriod2=_interopRequireDefault(_voPeriod),_voMpd=require("../vo/Mpd"),_voMpd2=_interopRequireDefault(_voMpd),_voUTCTiming=require("../vo/UTCTiming"),_voUTCTiming2=_interopRequireDefault(_voUTCTiming),_utilsTimelineConverter=require("../utils/TimelineConverter"),_utilsTimelineConverter2=_interopRequireDefault(_utilsTimelineConverter),_streamingControllersMediaController=require("../../streaming/controllers/MediaController"),_streamingControllersMediaController2=_interopRequireDefault(_streamingControllersMediaController),_DashAdapter=require("../DashAdapter"),_DashAdapter2=_interopRequireDefault(_DashAdapter),_voEvent=require("../vo/Event"),_voEvent2=_interopRequireDefault(_voEvent),_voBaseURL=require("../vo/BaseURL"),_voBaseURL2=_interopRequireDefault(_voBaseURL),_voEventStream=require("../vo/EventStream"),_voEventStream2=_interopRequireDefault(_voEventStream),_streamingUtilsURLUtils=require("../../streaming/utils/URLUtils"),_streamingUtilsURLUtils2=_interopRequireDefault(_streamingUtilsURLUtils),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);DashManifestModel.__dashjs_factory_name="DashManifestModel",exports.default=_coreFactoryMaker2.default.getSingletonFactory(DashManifestModel),module.exports=exports.default;
},{"../../core/FactoryMaker":15,"../../streaming/controllers/MediaController":72,"../../streaming/utils/URLUtils":164,"../DashAdapter":20,"../utils/TimelineConverter":43,"../vo/AdaptationSet":45,"../vo/BaseURL":46,"../vo/Event":47,"../vo/EventStream":48,"../vo/Mpd":49,"../vo/Period":50,"../vo/Representation":51,"../vo/UTCTiming":53}],28:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function DashParser(){function e(){o=[new _matchersDurationMatcher2.default,new _matchersDateTimeMatcher2.default,new _matchersNumericMatcher2.default,new _matchersStringMatcher2.default],i=new _externalsXml2json2.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:o}),c=new _externalsObjectiron2.default([new _mapsRepresentationBaseValuesMap2.default,new _mapsSegmentValuesMap2.default])}function r(e,r){var t;try{var n=window.performance.now();if(t=i.xml_str2json(e),!t)throw new Error("parser error");var u=window.performance.now();c.run(t);var l=window.performance.now();r.setMatchers(o),r.setIron(c),a("Parsing complete: ( xml2json: "+(u-n).toPrecision(3)+"ms, objectiron: "+(l-u).toPrecision(3)+"ms, total: "+((l-n)/1e3).toPrecision(3)+"s)")}catch(r){return s.manifestError("parsing the manifest failed","parse",e,r),null}return t}var t=this.context,a=(0,_coreDebug2.default)(t).getInstance().log,s=(0,_streamingUtilsErrorHandler2.default)(t).getInstance(),n=void 0,o=void 0,i=void 0,c=void 0;return n={parse:r},e(),n}Object.defineProperty(exports,"__esModule",{value:!0});var _streamingUtilsErrorHandler=require("../../streaming/utils/ErrorHandler"),_streamingUtilsErrorHandler2=_interopRequireDefault(_streamingUtilsErrorHandler),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_coreDebug=require("../../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug),_externalsObjectiron=require("../../../externals/objectiron"),_externalsObjectiron2=_interopRequireDefault(_externalsObjectiron),_externalsXml2json=require("../../../externals/xml2json"),_externalsXml2json2=_interopRequireDefault(_externalsXml2json),_matchersStringMatcher=require("./matchers/StringMatcher"),_matchersStringMatcher2=_interopRequireDefault(_matchersStringMatcher),_matchersDurationMatcher=require("./matchers/DurationMatcher"),_matchersDurationMatcher2=_interopRequireDefault(_matchersDurationMatcher),_matchersDateTimeMatcher=require("./matchers/DateTimeMatcher"),_matchersDateTimeMatcher2=_interopRequireDefault(_matchersDateTimeMatcher),_matchersNumericMatcher=require("./matchers/NumericMatcher"),_matchersNumericMatcher2=_interopRequireDefault(_matchersNumericMatcher),_mapsRepresentationBaseValuesMap=require("./maps/RepresentationBaseValuesMap"),_mapsRepresentationBaseValuesMap2=_interopRequireDefault(_mapsRepresentationBaseValuesMap),_mapsSegmentValuesMap=require("./maps/SegmentValuesMap"),_mapsSegmentValuesMap2=_interopRequireDefault(_mapsSegmentValuesMap);DashParser.__dashjs_factory_name="DashParser",exports.default=_coreFactoryMaker2.default.getClassFactory(DashParser),module.exports=exports.default;
},{"../../../externals/objectiron":10,"../../../externals/xml2json":11,"../../core/Debug":13,"../../core/FactoryMaker":15,"../../streaming/utils/ErrorHandler":157,"./maps/RepresentationBaseValuesMap":31,"./maps/SegmentValuesMap":32,"./matchers/DateTimeMatcher":34,"./matchers/DurationMatcher":35,"./matchers/NumericMatcher":36,"./matchers/StringMatcher":37}],29:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),CommonProperty=function(){function e(t,r){_classCallCheck(this,e);var n=function(e){return e&&e.length&&e.charAt(0)===e.charAt(0).toUpperCase()};this._name=t,this._merge=void 0!==r?r:n(t)}return _createClass(e,[{key:"name",get:function(){return this._name}},{key:"merge",get:function(){return this._merge}}]),e}();exports.default=CommonProperty,module.exports=exports.default;
},{}],30:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),_CommonProperty=require("./CommonProperty"),_CommonProperty2=_interopRequireDefault(_CommonProperty),MapNode=function(){function e(r,t,n,o,i){var s=this;_classCallCheck(this,e),this._name=r||"",this._properties=[],this._children=n||[],this._isRoot=o||!1,this._isArray=i||!0,Array.isArray(t)&&t.forEach(function(e){s._properties.push(new _CommonProperty2.default(e))})}return _createClass(e,[{key:"name",get:function(){return this._name}},{key:"isRoot",get:function(){return this._isRoot}},{key:"isArray",get:function(){return this._isArray}},{key:"children",get:function(){return this._children}},{key:"properties",get:function(){return this._properties}}]),e}();exports.default=MapNode,module.exports=exports.default;
},{"./CommonProperty":29}],31:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _get=function(e,t,o){for(var r=!0;r;){var n=e,a=t,i=o;r=!1,null===n&&(n=Function.prototype);var u=Object.getOwnPropertyDescriptor(n,a);if(void 0!==u){if("value"in u)return u.value;var p=u.get;if(void 0===p)return;return p.call(i)}var l=Object.getPrototypeOf(n);if(null===l)return;e=l,t=a,o=i,r=!0,u=l=void 0}},_MapNode2=require("./MapNode"),_MapNode3=_interopRequireDefault(_MapNode2),RepresentationBaseValuesMap=function(e){function t(){_classCallCheck(this,t);var e=["profiles","width","height","sar","frameRate","audioSamplingRate","mimeType","segmentProfiles","codecs","maximumSAPPeriod","startWithSAP","maxPlayoutRate","codingDependency","scanType","FramePacking","AudioChannelConfiguration","ContentProtection","EssentialProperty","SupplementalProperty","InbandEventStream"];_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,"AdaptationSet",e,[new _MapNode3.default("Representation",e,[new _MapNode3.default("SubRepresentation",e)])])}return _inherits(t,e),t}(_MapNode3.default);exports.default=RepresentationBaseValuesMap,module.exports=exports.default;
},{"./MapNode":30}],32:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _get=function(e,t,o){for(var r=!0;r;){var n=e,a=t,u=o;r=!1,null===n&&(n=Function.prototype);var i=Object.getOwnPropertyDescriptor(n,a);if(void 0!==i){if("value"in i)return i.value;var l=i.get;if(void 0===l)return;return l.call(u)}var p=Object.getPrototypeOf(n);if(null===p)return;e=p,t=a,o=u,r=!0,i=p=void 0}},_MapNode2=require("./MapNode"),_MapNode3=_interopRequireDefault(_MapNode2),SegmentValuesMap=function(e){function t(){_classCallCheck(this,t);var e=["SegmentBase","SegmentTemplate","SegmentList"];_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,"Period",e,[new _MapNode3.default("AdaptationSet",e,[new _MapNode3.default("Representation",e)])])}return _inherits(t,e),t}(_MapNode3.default);exports.default=SegmentValuesMap,module.exports=exports.default;
},{"./MapNode":30}],33:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),BaseMatcher=function(){function e(t,r){_classCallCheck(this,e),this._test=t,this._converter=r}return _createClass(e,[{key:"test",get:function(){return this._test}},{key:"converter",get:function(){return this._converter}}]),e}();exports.default=BaseMatcher,module.exports=exports.default;
},{}],34:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _get=function(e,t,r){for(var a=!0;a;){var n=e,o=t,i=r;a=!1,null===n&&(n=Function.prototype);var u=Object.getOwnPropertyDescriptor(n,o);if(void 0!==u){if("value"in u)return u.value;var c=u.get;if(void 0===c)return;return c.call(i)}var s=Object.getPrototypeOf(n);if(null===s)return;e=s,t=o,r=i,a=!0,u=s=void 0}},_BaseMatcher2=require("./BaseMatcher"),_BaseMatcher3=_interopRequireDefault(_BaseMatcher2),SECONDS_IN_MIN=60,MINUTES_IN_HOUR=60,MILLISECONDS_IN_SECONDS=1e3,datetimeRegex=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/,DateTimeMatcher=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,function(e){return datetimeRegex.test(e.value)},function(e){var t=datetimeRegex.exec(e),r=void 0;if(r=Date.UTC(parseInt(t[1],10),parseInt(t[2],10)-1,parseInt(t[3],10),parseInt(t[4],10),parseInt(t[5],10),t[6]&&parseInt(t[6],10)||0,t[7]&&parseFloat(t[7])*MILLISECONDS_IN_SECONDS||0),t[9]&&t[10]){var a=parseInt(t[9],10)*MINUTES_IN_HOUR+parseInt(t[10],10);r+=("+"===t[8]?-1:1)*a*SECONDS_IN_MIN*MILLISECONDS_IN_SECONDS}return new Date(r)})}return _inherits(t,e),t}(_BaseMatcher3.default);exports.default=DateTimeMatcher,module.exports=exports.default;
},{"./BaseMatcher":33}],35:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _get=function(e,t,r){for(var o=!0;o;){var a=e,n=t,i=r;o=!1,null===a&&(a=Function.prototype);var u=Object.getOwnPropertyDescriptor(a,n);if(void 0!==u){if("value"in u)return u.value;var s=u.get;if(void 0===s)return;return s.call(i)}var l=Object.getPrototypeOf(a);if(null===l)return;e=l,t=n,r=i,o=!0,u=l=void 0}},_BaseMatcher2=require("./BaseMatcher"),_BaseMatcher3=_interopRequireDefault(_BaseMatcher2),durationRegex=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,SECONDS_IN_YEAR=31536e3,SECONDS_IN_MONTH=2592e3,SECONDS_IN_DAY=86400,SECONDS_IN_HOUR=3600,SECONDS_IN_MIN=60,DurationMatcher=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,function(e){for(var t=["minBufferTime","mediaPresentationDuration","minimumUpdatePeriod","timeShiftBufferDepth","maxSegmentDuration","maxSubsegmentDuration","suggestedPresentationDelay","start","starttime","duration"],r=t.length,o=0;o<r;o++)if(e.nodeName===t[o])return durationRegex.test(e.value);return!1},function(e){var t=durationRegex.exec(e),r=parseFloat(t[2]||0)*SECONDS_IN_YEAR+parseFloat(t[4]||0)*SECONDS_IN_MONTH+parseFloat(t[6]||0)*SECONDS_IN_DAY+parseFloat(t[8]||0)*SECONDS_IN_HOUR+parseFloat(t[10]||0)*SECONDS_IN_MIN+parseFloat(t[12]||0);return void 0!==t[1]&&(r=-r),r})}return _inherits(t,e),t}(_BaseMatcher3.default);exports.default=DurationMatcher,module.exports=exports.default;
},{"./BaseMatcher":33}],36:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _get=function(e,t,r){for(var o=!0;o;){var n=e,u=t,a=r;o=!1,null===n&&(n=Function.prototype);var c=Object.getOwnPropertyDescriptor(n,u);if(void 0!==c){if("value"in c)return c.value;var i=c.get;if(void 0===i)return;return i.call(a)}var l=Object.getPrototypeOf(n);if(null===l)return;e=l,t=u,r=a,o=!0,c=l=void 0}},_BaseMatcher2=require("./BaseMatcher"),_BaseMatcher3=_interopRequireDefault(_BaseMatcher2),numericRegex=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,NumericMatcher=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,function(e){return numericRegex.test(e.value)},function(e){return parseFloat(e)})}return _inherits(t,e),t}(_BaseMatcher3.default);exports.default=NumericMatcher,module.exports=exports.default;
},{"./BaseMatcher":33}],37:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _get=function(e,t,n){for(var i=!0;i;){var r=e,a=t,o=n;i=!1,null===r&&(r=Function.prototype);var u=Object.getOwnPropertyDescriptor(r,a);if(void 0!==u){if("value"in u)return u.value;var l=u.get;if(void 0===l)return;return l.call(o)}var c=Object.getPrototypeOf(r);if(null===c)return;e=c,t=a,n=o,i=!0,u=c=void 0}},_BaseMatcher2=require("./BaseMatcher"),_BaseMatcher3=_interopRequireDefault(_BaseMatcher2),StringMatcher=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,function(e,t){var n={MPD:["id","profiles"],Period:["id"],BaseURL:["serviceLocation","byteRange"],SegmentBase:["indexRange"],Initialization:["range"],RepresentationIndex:["range"],SegmentList:["indexRange"],BitstreamSwitching:["range"],SegmentURL:["mediaRange","indexRange"],SegmentTemplate:["indexRange","media","index","initialization","bitstreamSwitching"],AssetIdentifier:["value","id"],EventStream:["value"],AdaptationSet:["profiles","mimeType","segmentProfiles","codecs","contentType"],FramePacking:["value","id"],AudioChannelConfiguration:["value","id"],ContentProtection:["value","id"],EssentialProperty:["value","id"],SupplementalProperty:["value","id"],InbandEventStream:["value","id"],Accessibility:["value","id"],Role:["value","id"],Rating:["value","id"],Viewpoint:["value","id"],ContentComponent:["contentType"],Representation:["id","dependencyId","mediaStreamStructureId"],Subset:["id"],Metrics:["metrics"],Reporting:["value","id"]};if(n.hasOwnProperty(t)){var i=n[t];return void 0!==i&&i.indexOf(e.name)>=0}return!1},function(e){return String(e)})}return _inherits(t,e),t}(_BaseMatcher3.default);exports.default=StringMatcher,module.exports=exports.default;
},{"./BaseMatcher":33}],38:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function FragmentedTextBoxParser(){function e(e){e&&e.boxParser&&(o=e.boxParser)}function s(e){var s,t,a,r,i,u,m,n,_,l,d,f,p,c=o.parse(e),x=c.getBox("tfhd"),b=c.getBox("tfdt"),g=c.getBox("trun"),v=c.getBox("moof"),h=c.getBox("mfhd"),B=c.getBox("subs");for(d=h.sequence_number,a=g.sample_count,i=b.baseMediaDecodeTime,l=(x.base_data_offset||0)+(g.data_offset||0),u=[],p=0,n=0;n<a;n++){m=g.samples[n],s=void 0!==m.sample_duration?m.sample_duration:x.default_sample_duration,r=void 0!==m.sample_size?m.sample_size:x.default_sample_size,t=void 0!==m.sample_composition_time_offset?m.sample_composition_time_offset:0;var F={dts:i,cts:i+t,duration:s,offset:v.offset+l,size:r,subSizes:[r]};if(B&&p<B.samples_with_subsamples.length&&B.samples_with_subsamples[p].nr==n+1){for(F.subSizes=[],_=0;_<B.samples_with_subsamples[p].subsamples.length;_++){var M=B.samples_with_subsamples[p].subsamples[_].size;F.subSizes.push(M)}p++}u.push(F),l+=r,i+=s}return f=i-b.baseMediaDecodeTime,{sampleList:u,sequenceNumber:d,totalDuration:f}}function t(e){var s=o.parse(e),t=s.getBox("mdhd");return t?t.timescale:NaN}var a=void 0,o=void 0;return a={getSamplesInfo:s,getMediaTimescaleFromMoov:t,setConfig:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);FragmentedTextBoxParser.__dashjs_factory_name="FragmentedTextBoxParser",exports.default=_coreFactoryMaker2.default.getSingletonFactory(FragmentedTextBoxParser),module.exports=exports.default;
},{"../../core/FactoryMaker":15}],39:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ListSegmentsGetter(e,t){function a(e,a,n,i){var s,o,d,m,g,u,l,_=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,c=_.SegmentURL_asArray.length,p=[];for(l=e.startNumber,m=(0,_SegmentsUtils.decideSegmentListRangeForTemplate)(r,t,e,a,n,i),g=Math.max(m.start,0),u=Math.min(m.end,_.SegmentURL_asArray.length-1),s=g;s<=u;s++)d=_.SegmentURL_asArray[s],o=(0,_SegmentsUtils.getIndexBasedSegment)(r,t,e,s),o.replacementTime=(l+s-1)*e.segmentDuration,o.media=d.media?d.media:"",o.mediaRange=d.mediaRange,o.index=d.index,o.indexRange=d.indexRange,p.push(o),o=null;return e.availableSegmentsNumber=c,p}var r=e.timelineConverter,n=void 0;return n={getSegments:a}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_SegmentsUtils=require("./SegmentsUtils");ListSegmentsGetter.__dashjs_factory_name="ListSegmentsGetter";var factory=_coreFactoryMaker2.default.getClassFactory(ListSegmentsGetter);exports.default=factory,module.exports=exports.default;
},{"../../core/FactoryMaker":15,"./SegmentsUtils":41}],40:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function SegmentsGetter(e,t){function r(){m=(0,_TimelineSegmentsGetter2.default)(i).create(e,t),o=(0,_TemplateSegmentsGetter2.default)(i).create(e,t),g=(0,_ListSegmentsGetter2.default)(i).create(e,t)}function n(e,t,r,n,i){var s,l=e.segmentInfoType;return"SegmentBase"!==l&&"BaseURL"!==l&&a(e,r)?("SegmentTimeline"===l?s=m.getSegments(e,t,r,i):"SegmentTemplate"===l?s=o.getSegments(e,t,r,i):"SegmentList"===l&&(s=g.getSegments(e,t,r,i)),n&&n(e,s)):s=e.segments,s}function a(e,t){var r,n,a=e.segments,i=!1;return a&&0!==a.length?(n=a[0].availabilityIdx,r=a[a.length-1].availabilityIdx,i=t<n||t>r):i=!0,i}var i=this.context,s=void 0,m=void 0,o=void 0,g=void 0;return s={getSegments:n},r(),s}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_TimelineSegmentsGetter=require("./TimelineSegmentsGetter"),_TimelineSegmentsGetter2=_interopRequireDefault(_TimelineSegmentsGetter),_TemplateSegmentsGetter=require("./TemplateSegmentsGetter"),_TemplateSegmentsGetter2=_interopRequireDefault(_TemplateSegmentsGetter),_ListSegmentsGetter=require("./ListSegmentsGetter"),_ListSegmentsGetter2=_interopRequireDefault(_ListSegmentsGetter);SegmentsGetter.__dashjs_factory_name="SegmentsGetter";var factory=_coreFactoryMaker2.default.getClassFactory(SegmentsGetter);exports.default=factory,module.exports=exports.default;
},{"../../core/FactoryMaker":15,"./ListSegmentsGetter":39,"./TemplateSegmentsGetter":42,"./TimelineSegmentsGetter":44}],41:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function zeroPadToLength(e,t){for(;e.length<t;)e="0"+e;return e}function getNumberForSegment(e,t){return e.representation.startNumber+t}function replaceTokenForTemplate(e,t,a){var i,n,r,m,o,l,d="%0",s=t.length,g=d.length;if(!e)return e;for(;;){if(i=e.indexOf("$"+t),i<0)return e;if(n=e.indexOf("$",i+s),n<0)return e;if(r=e.indexOf(d,i+s),r>i&&r<n)switch(m=e.charAt(n-1),o=parseInt(e.substring(r+g,n-1),10),m){case"d":case"i":case"u":l=zeroPadToLength(a.toString(),o);break;case"x":l=zeroPadToLength(a.toString(16),o);break;case"X":l=zeroPadToLength(a.toString(16),o).toUpperCase();break;case"o":l=zeroPadToLength(a.toString(8),o);break;default:return e}else l=a;e=e.substring(0,i)+l+e.substring(n+1)}}function getIndexBasedSegment(e,t,a,i){var n,r,m,o;return r=a.segmentDuration,isNaN(r)&&(r=a.adaptation.period.duration),m=a.adaptation.period.start+i*r,o=m+r,n=new _voSegment2.default,n.representation=a,n.duration=r,n.presentationStartTime=m,n.mediaStartTime=e.calcMediaTimeFromPresentationTime(n.presentationStartTime,a),n.availabilityStartTime=e.calcAvailabilityStartTimeFromPresentationTime(n.presentationStartTime,a.adaptation.period.mpd,t),n.availabilityEndTime=e.calcAvailabilityEndTimeFromPresentationTime(o,a.adaptation.period.mpd,t),n.wallStartTime=e.calcWallTimeForSegment(n,t),n.replacementNumber=getNumberForSegment(n,i),n.availabilityIdx=i,n}function getTimeBasedSegment(e,t,a,i,n,r,m,o,l){var d,s,g,p=i/r,T=Math.min(n/r,a.adaptation.period.mpd.maxSegmentDuration);return d=e.calcPresentationTimeFromMediaTime(p,a),s=d+T,g=new _voSegment2.default,g.representation=a,g.duration=T,g.mediaStartTime=p,g.presentationStartTime=d,g.availabilityStartTime=a.adaptation.period.mpd.manifest.loadedTime,g.availabilityEndTime=e.calcAvailabilityEndTimeFromPresentationTime(s,a.adaptation.period.mpd,t),g.wallStartTime=e.calcWallTimeForSegment(g,t),g.replacementTime=i,g.replacementNumber=getNumberForSegment(g,l),m=replaceTokenForTemplate(m,"Number",g.replacementNumber),m=replaceTokenForTemplate(m,"Time",g.replacementTime),g.media=m,g.mediaRange=o,g.availabilityIdx=l,g}function getSegmentByIndex(e,t){if(!t||!t.segments)return null;var a,i,n=t.segments.length;if(e<n&&(a=t.segments[e],a&&a.availabilityIdx===e))return a;for(i=0;i<n;i++)if(a=t.segments[i],a&&a.availabilityIdx===e)return a;return null}function decideSegmentListRangeForTimeline(e,t,a,i,n){var r,m,o,l=2,d=n||10,s=0,g=Number.POSITIVE_INFINITY;return t&&!e.isTimeSyncCompleted()?o={start:s,end:g}:!t&&a||i<0?null:(r=Math.max(i-l,s),m=Math.min(i+d,g),o={start:r,end:m})}function decideSegmentListRangeForTemplate(e,t,a,i,n,r){var m,o,l,d=a.segmentDuration,s=a.adaptation.period.mpd.manifest.minBufferTime,g=a.segmentAvailabilityRange,p={start:e.calcPeriodRelativeTimeFromMpdRelativeTime(a,g.start),end:e.calcPeriodRelativeTimeFromMpdRelativeTime(a,g.end)},T=a.segments,u=2*d,c=r||Math.max(2*s,10*d),S=NaN,f=null;return p.start=Math.max(p.start,0),t&&!e.isTimeSyncCompleted()?(m=Math.floor(p.start/d),o=Math.floor(p.end/d),l={start:m,end:o}):(T&&T.length>0?(f=getSegmentByIndex(n,a),S=f?e.calcPeriodRelativeTimeFromMpdRelativeTime(a,f.presentationStartTime):n>0?n*d:e.calcPeriodRelativeTimeFromMpdRelativeTime(a,i)):S=n>0?n*d:t?p.end:p.start,m=Math.floor(Math.max(S-u,p.start)/d),o=Math.floor(Math.min(m+c/d,p.end/d)),l={start:m,end:o})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.replaceTokenForTemplate=replaceTokenForTemplate,exports.getIndexBasedSegment=getIndexBasedSegment,exports.getTimeBasedSegment=getTimeBasedSegment,exports.getSegmentByIndex=getSegmentByIndex,exports.decideSegmentListRangeForTimeline=decideSegmentListRangeForTimeline,exports.decideSegmentListRangeForTemplate=decideSegmentListRangeForTemplate;var _voSegment=require("./../vo/Segment"),_voSegment2=_interopRequireDefault(_voSegment);
},{"./../vo/Segment":52}],42:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function TemplateSegmentsGetter(e,t){function a(e,a,n,i){var s,m,o,l,u,d=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate,p=e.segmentDuration,c=e.segmentAvailabilityRange,g=[],_=null,S=null;for(u=e.startNumber,s=isNaN(p)&&!t?{start:u,end:u}:(0,_SegmentsUtils.decideSegmentListRangeForTemplate)(r,t,e,a,n,i),o=s.start,l=s.end,m=o;m<=l;m++)S=(0,_SegmentsUtils.getIndexBasedSegment)(r,t,e,m),S.replacementTime=(u+m-1)*e.segmentDuration,_=d.media,_=(0,_SegmentsUtils.replaceTokenForTemplate)(_,"Number",S.replacementNumber),_=(0,_SegmentsUtils.replaceTokenForTemplate)(_,"Time",S.replacementTime),S.media=_,g.push(S),S=null;return isNaN(p)?e.availableSegmentsNumber=1:e.availableSegmentsNumber=Math.ceil((c.end-c.start)/p),g}var r=e.timelineConverter,n=void 0;return n={getSegments:a}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_SegmentsUtils=require("./SegmentsUtils");TemplateSegmentsGetter.__dashjs_factory_name="TemplateSegmentsGetter";var factory=_coreFactoryMaker2.default.getClassFactory(TemplateSegmentsGetter);exports.default=factory,module.exports=exports.default;
},{"../../core/FactoryMaker":15,"./SegmentsUtils":41}],43:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function TimelineConverter(){function e(){h=0,D=!1,F=NaN,S.on(_coreEventsEvents2.default.TIME_SYNCHRONIZATION_COMPLETED,E,this)}function t(){return D}function i(e){D=e}function r(){return h}function n(e){h=e}function a(){return F}function o(e){F=e}function s(e,t,i,r){var n=NaN;return n=r?i&&t.timeShiftBufferDepth!=Number.POSITIVE_INFINITY?new Date(t.availabilityStartTime.getTime()+1e3*(e+t.timeShiftBufferDepth)):t.availabilityEndTime:i?new Date(t.availabilityStartTime.getTime()+1e3*(e-h)):t.availabilityStartTime}function u(e,t,i){return s.call(this,e,t,i)}function c(e,t,i){return s.call(this,e,t,i,!0)}function l(e,t){return(e.getTime()-t.mpd.availabilityStartTime.getTime()+1e3*h)/1e3}function m(e,t){var i=t.adaptation.period.start,r=t.presentationTimeOffset;return e+(i-r)}function f(e,t){var i=t.adaptation.period.start,r=t.presentationTimeOffset;return e-i+r}function v(e,t){var i,r,n;return t&&(i=e.representation.adaptation.period.mpd.suggestedPresentationDelay,r=e.presentationStartTime+i,n=new Date(e.availabilityStartTime.getTime()+1e3*r)),n}function d(e,t){var i=e.adaptation.period,r={start:i.start,end:i.start+i.duration};if(!t)return r;if(!D&&e.segmentAvailabilityRange)return e.segmentAvailabilityRange;var n=e.segmentDuration||(e.segments&&e.segments.length?e.segments[e.segments.length-1].duration:0),a=l(new Date,i),o=i.start+i.duration;return r.start=Math.max(a-i.mpd.timeShiftBufferDepth,i.start),r.end=a>=o&&a-n<o?o-n:a-n,r}function T(e,t){var i=e.adaptation.period.start;return t-i}function p(e,t){var i=e.adaptation.period.start;return t+i}function E(e){D||void 0!==e.offset&&(n(e.offset/1e3),D=!0)}function _(e){var t=e.presentationTimeOffset,i=e.adaptation.period.start;return i-t}function g(){S.off(_coreEventsEvents2.default.TIME_SYNCHRONIZATION_COMPLETED,E,this),h=0,D=!1,F=NaN}var y=this.context,S=(0,_coreEventBus2.default)(y).getInstance(),M=void 0,h=void 0,D=void 0,F=void 0;return M={initialize:e,isTimeSyncCompleted:t,setTimeSyncCompleted:i,getClientTimeOffset:r,setClientTimeOffset:n,getExpectedLiveEdge:a,setExpectedLiveEdge:o,calcAvailabilityStartTimeFromPresentationTime:u,calcAvailabilityEndTimeFromPresentationTime:c,calcPresentationTimeFromWallTime:l,calcPresentationTimeFromMediaTime:m,calcPeriodRelativeTimeFromMpdRelativeTime:T,calcMpdRelativeTimeFromPeriodRelativeTime:p,calcMediaTimeFromPresentationTime:f,calcSegmentAvailabilityRange:d,calcWallTimeForSegment:v,calcMSETimeOffset:_,reset:g}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreEventBus=require("../../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreEventsEvents=require("../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);TimelineConverter.__dashjs_factory_name="TimelineConverter",exports.default=_coreFactoryMaker2.default.getSingletonFactory(TimelineConverter),module.exports=exports.default;
},{"../../core/EventBus":14,"../../core/FactoryMaker":15,"../../core/events/Events":18}],44:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function TimelineSegmentsGetter(e,t){function a(e,a,i,n){var o,s,d,m,l,g,c,u,p,f,_,y,S,v,A=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate||e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,T=A.SegmentTimeline,b=A.SegmentURL_asArray,R=e.availableSegmentsNumber>0,h=10,x=0,M=0,F=-1,k=[],P=!1,U=function(a,i){var n=A.media,o=a.mediaRange;return b&&(n=b[i].media||"",o=b[i].mediaRange),(0,_SegmentsUtils.getTimeBasedSegment)(r,t,e,x,a.d,v,n,o,F)};for(v=e.timescale,o=T.S_asArray,p=(0,_SegmentsUtils.decideSegmentListRangeForTimeline)(r,t,a,i,n),p?(y=p.start,S=p.end):_=r.calcMediaTimeFromPresentationTime(a||0,e),d=0,m=o.length;d<m;d++){if(s=o[d],g=0,s.hasOwnProperty("r")&&(g=s.r),s.hasOwnProperty("t")&&(x=s.t,M=x/v),g<0){if(u=o[d+1],u&&u.hasOwnProperty("t"))c=u.t/v;else{var q=e.segmentAvailabilityRange?e.segmentAvailabilityRange.end:r.calcSegmentAvailabilityRange(e,t).end;c=r.calcMediaTimeFromPresentationTime(q,e),e.segmentDuration=s.d/v}g=Math.ceil((c-M)/(s.d/v))-1}if(f){if(R)break;F+=g+1}else for(l=0;l<=g;l++){if(F++,p){if(F>S){if(f=!0,R)break;continue}F>=y&&k.push(U(s,F))}else{if(k.length>h){if(f=!0,R)break;continue}P?k.push(U(s,F)):M>=_-s.d/v*1.5&&(P=!0,k.push(U(s,F)))}x+=s.d,M=x/v}}return R||(e.availableSegmentsNumber=F+1),k}var r=e.timelineConverter,i=void 0;return i={getSegments:a}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_SegmentsUtils=require("./SegmentsUtils");TimelineSegmentsGetter.__dashjs_factory_name="TimelineSegmentsGetter";var factory=_coreFactoryMaker2.default.getClassFactory(TimelineSegmentsGetter);exports.default=factory,module.exports=exports.default;
},{"../../core/FactoryMaker":15,"./SegmentsUtils":41}],45:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var AdaptationSet=function t(){_classCallCheck(this,t),this.period=null,this.index=-1,this.type=null};exports.default=AdaptationSet,module.exports=exports.default;
},{}],46:[function(require,module,exports){
"use strict";function _classCallCheck(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var DEFAULT_DVB_PRIORITY=1,DEFAULT_DVB_WEIGHT=1,BaseURL=function e(s,t,_,a){_classCallCheck(this,e),this.url=s||"",this.serviceLocation=t||s||"",this.dvb_priority=_||DEFAULT_DVB_PRIORITY,this.dvb_weight=a||DEFAULT_DVB_WEIGHT};BaseURL.DEFAULT_DVB_PRIORITY=DEFAULT_DVB_PRIORITY,BaseURL.DEFAULT_DVB_WEIGHT=DEFAULT_DVB_WEIGHT,exports.default=BaseURL,module.exports=exports.default;
},{}],47:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var Event=function e(){_classCallCheck(this,e),this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN};exports.default=Event,module.exports=exports.default;
},{}],48:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var EventStream=function e(){_classCallCheck(this,e),this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri=""};exports.default=EventStream,module.exports=exports.default;
},{}],49:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var Mpd=function t(){_classCallCheck(this,t),this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.minimumUpdatePeriod=NaN,this.mediaPresentationDuration=NaN};exports.default=Mpd,module.exports=exports.default;
},{}],50:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var Period=function t(){_classCallCheck(this,t),this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null};Period.DEFAULT_ID="defaultId",exports.default=Period,module.exports=exports.default;
},{}],51:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),Representation=function(){function e(){_classCallCheck(this,e),this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.segmentAvailabilityRange=null,this.availableSegmentsNumber=0,this.bandwidth=NaN,this.maxPlayoutRate=NaN}return _createClass(e,null,[{key:"hasInitialization",value:function(e){return null!==e.initialization||("BaseURL"!==e.segmentInfoType||"SegmentBase"!==e.segmentInfoType)&&null!==e.range}},{key:"hasSegments",value:function(e){return"BaseURL"!==e.segmentInfoType&&"SegmentBase"!==e.segmentInfoType&&!e.indexRange}}]),e}();exports.default=Representation,module.exports=exports.default;
},{}],52:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var Segment=function t(){_classCallCheck(this,t),this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.availabilityIdx=NaN,this.wallStartTime=NaN,this.representation=null};exports.default=Segment,module.exports=exports.default;
},{}],53:[function(require,module,exports){
"use strict";function _classCallCheck(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var UTCTiming=function e(){_classCallCheck(this,e),this.schemeIdUri="",this.value=""};exports.default=UTCTiming,module.exports=exports.default;
},{}],54:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function FragmentLoader(e){function r(){a=(0,_XHRLoader2.default)(u).create({errHandler:e.errHandler,metricsModel:e.metricsModel,requestModifier:e.requestModifier})}function t(e){var r=function(r){n.trigger(_coreEventsEvents2.default.CHECK_FOR_EXISTENCE_COMPLETED,{request:e,exists:r})};if(e){var t=new _voHeadRequest2.default(e.url);a.load({request:t,success:function(){r(!0)},error:function(){r(!1)}})}else r(!1)}function o(e){var r=function(r,t){n.trigger(_coreEventsEvents2.default.LOADING_COMPLETED,{request:e,response:r||null,error:t||null,sender:R})};e?a.load({request:e,progress:function(){n.trigger(_coreEventsEvents2.default.LOADING_PROGRESS,{request:e})},success:function(e){r(e)},error:function(e,t,o){r(void 0,new _voError2.default(FRAGMENT_LOADER_ERROR_LOADING_FAILURE,o,t))}}):r(void 0,new _voError2.default(FRAGMENT_LOADER_ERROR_NULL_REQUEST,FRAGMENT_LOADER_MESSAGE_NULL_REQUEST))}function _(){a&&a.abort()}function E(){a&&(a.abort(),a=null)}var u=this.context,n=(0,_coreEventBus2.default)(u).getInstance(),R=void 0,a=void 0;return R={checkForExistence:t,load:o,abort:_,reset:E},r(),R}Object.defineProperty(exports,"__esModule",{value:!0});var _XHRLoader=require("./XHRLoader"),_XHRLoader2=_interopRequireDefault(_XHRLoader),_voHeadRequest=require("./vo/HeadRequest"),_voHeadRequest2=_interopRequireDefault(_voHeadRequest),_voError=require("./vo/Error"),_voError2=_interopRequireDefault(_voError),_coreEventBus=require("./../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreEventsEvents=require("./../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_coreFactoryMaker=require("../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),FRAGMENT_LOADER_ERROR_LOADING_FAILURE=1,FRAGMENT_LOADER_ERROR_NULL_REQUEST=2,FRAGMENT_LOADER_MESSAGE_NULL_REQUEST="request is null";FragmentLoader.__dashjs_factory_name="FragmentLoader";var factory=_coreFactoryMaker2.default.getClassFactory(FragmentLoader);factory.FRAGMENT_LOADER_ERROR_LOADING_FAILURE=FRAGMENT_LOADER_ERROR_LOADING_FAILURE,factory.FRAGMENT_LOADER_ERROR_NULL_REQUEST=FRAGMENT_LOADER_ERROR_NULL_REQUEST,exports.default=factory,module.exports=exports.default;
},{"../core/FactoryMaker":15,"./../core/EventBus":14,"./../core/events/Events":18,"./XHRLoader":64,"./vo/Error":168,"./vo/HeadRequest":170}],55:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ManifestLoader(e){function r(){_.on(_coreEventsEvents2.default.XLINK_READY,t,i),u=(0,_XHRLoader2.default)(n).create({errHandler:e.errHandler,metricsModel:e.metricsModel,requestModifier:e.requestModifier}),R=(0,_controllersXlinkController2.default)(n).create({errHandler:e.errHandler,metricsModel:e.metricsModel,requestModifier:e.requestModifier})}function t(e){_.trigger(_coreEventsEvents2.default.INTERNAL_MANIFEST_LOADED,{manifest:e.manifest})}function o(e){var r=new _voTextRequest2.default(e,_voMetricsHTTPRequest.HTTPRequest.MPD_TYPE);u.load({request:r,success:function(r,t,o){var s,n;o.responseURL&&o.responseURL!==e?(n=a.parseBaseUrl(o.responseURL),s=o.responseURL):(a.isRelative(e)&&(e=a.resolve(e,window.location.href)),n=a.parseBaseUrl(e));var i=l.parse(r,R);i?(i.url=s||e,i.originalUrl||(i.originalUrl=i.url),i.baseUri=n,i.loadedTime=new Date,R.resolveManifestOnLoad(i)):_.trigger(_coreEventsEvents2.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new _voError2.default(MANIFEST_LOADER_ERROR_PARSING_FAILURE,MANIFEST_LOADER_MESSAGE_PARSING_FAILURE)})},error:function(r,t,o){_.trigger(_coreEventsEvents2.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new _voError2.default(MANIFEST_LOADER_ERROR_LOADING_FAILURE,"Failed loading manifest: "+e+", "+o)})}})}function s(){_.off(_coreEventsEvents2.default.XLINK_READY,t,i),R&&(R.reset(),R=null),u&&(u.abort(),u=null)}var n=this.context,_=(0,_coreEventBus2.default)(n).getInstance(),a=(0,_utilsURLUtils2.default)(n).getInstance(),l=e.parser,i=void 0,u=void 0,R=void 0;return i={load:o,reset:s},r(),i}Object.defineProperty(exports,"__esModule",{value:!0});var _controllersXlinkController=require("./controllers/XlinkController"),_controllersXlinkController2=_interopRequireDefault(_controllersXlinkController),_XHRLoader=require("./XHRLoader"),_XHRLoader2=_interopRequireDefault(_XHRLoader),_utilsURLUtils=require("./utils/URLUtils"),_utilsURLUtils2=_interopRequireDefault(_utilsURLUtils),_voTextRequest=require("./vo/TextRequest"),_voTextRequest2=_interopRequireDefault(_voTextRequest),_voError=require("./vo/Error"),_voError2=_interopRequireDefault(_voError),_voMetricsHTTPRequest=require("./vo/metrics/HTTPRequest"),_coreEventBus=require("../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreEventsEvents=require("../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_coreFactoryMaker=require("../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),MANIFEST_LOADER_ERROR_PARSING_FAILURE=1,MANIFEST_LOADER_ERROR_LOADING_FAILURE=2,MANIFEST_LOADER_MESSAGE_PARSING_FAILURE="parsing failed";ManifestLoader.__dashjs_factory_name="ManifestLoader";var factory=_coreFactoryMaker2.default.getClassFactory(ManifestLoader);factory.MANIFEST_LOADER_ERROR_PARSING_FAILURE=MANIFEST_LOADER_ERROR_PARSING_FAILURE,factory.MANIFEST_LOADER_ERROR_LOADING_FAILURE=MANIFEST_LOADER_ERROR_LOADING_FAILURE,exports.default=factory,module.exports=exports.default;
},{"../core/EventBus":14,"../core/FactoryMaker":15,"../core/events/Events":18,"./XHRLoader":64,"./controllers/XlinkController":80,"./utils/URLUtils":164,"./vo/Error":168,"./vo/TextRequest":176,"./vo/metrics/HTTPRequest":185}],56:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ManifestUpdater(){function e(e){e&&(e.manifestModel&&(T=e.manifestModel),e.dashManifestModel&&(p=e.dashManifestModel))}function t(e){P=e,g=NaN,A=null,m=!1,h=!0,S=(0,_modelsMediaPlayerModel2.default)(v).getInstance(),M.on(_coreEventsEvents2.default.STREAMS_COMPOSED,_,this),M.on(_coreEventsEvents2.default.PLAYBACK_STARTED,l,this),M.on(_coreEventsEvents2.default.PLAYBACK_PAUSED,c,this),M.on(_coreEventsEvents2.default.INTERNAL_MANIFEST_LOADED,d,this)}function n(e){u(e)}function o(){return P}function r(){M.off(_coreEventsEvents2.default.PLAYBACK_STARTED,l,this),M.off(_coreEventsEvents2.default.PLAYBACK_PAUSED,c,this),M.off(_coreEventsEvents2.default.STREAMS_COMPOSED,_,this),M.off(_coreEventsEvents2.default.INTERNAL_MANIFEST_LOADED,d,this),a(),h=!0,m=!1,g=NaN,S=null}function a(){null!==A&&(clearInterval(A),A=null)}function i(){a(),isNaN(g)||(E("Refresh manifest in "+g+" seconds."),A=setTimeout(f,1e3*g))}function s(){m=!0;var e=T.getValue(),t=e.url,n=p.getLocation(e);n&&(t=n),P.load(t)}function u(e){T.setValue(e);var t=new Date,n=(t.getTime()-e.loadedTime.getTime())/1e3;g=p.getManifestUpdatePeriod(e,n),M.trigger(_coreEventsEvents2.default.MANIFEST_UPDATED,{manifest:e}),E("Manifest has been refreshed at "+t+"["+t.getTime()/1e3+"] "),h||i()}function f(){h&&!S.getScheduleWhilePaused()||m||s()}function d(e){e.error||u(e.manifest)}function l(){h=!1,i()}function c(){h=!0,a()}function _(){m=!1}var v=this.context,E=(0,_coreDebug2.default)(v).getInstance().log,M=(0,_coreEventBus2.default)(v).getInstance(),D=void 0,g=void 0,A=void 0,h=void 0,m=void 0,P=void 0,T=void 0,p=void 0,S=void 0;return D={initialize:t,setManifest:n,getManifestLoader:o,refreshManifest:s,setConfig:e,reset:r}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreEventBus=require("../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreEventsEvents=require("../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_coreFactoryMaker=require("../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_modelsMediaPlayerModel=require("./models/MediaPlayerModel"),_modelsMediaPlayerModel2=_interopRequireDefault(_modelsMediaPlayerModel),_coreDebug=require("../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug);ManifestUpdater.__dashjs_factory_name="ManifestUpdater",exports.default=_coreFactoryMaker2.default.getSingletonFactory(ManifestUpdater),module.exports=exports.default;
},{"../core/Debug":13,"../core/EventBus":14,"../core/FactoryMaker":15,"../core/events/Events":18,"./models/MediaPlayerModel":107}],57:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function MediaPlayer(){function e(){pt=!1,Dt=!1,Ft=!0,qt=null,St=null,wt=null,_coreEventsEvents2.default.extend(_MediaPlayerEvents2.default),Et=(0,_modelsMediaPlayerModel2.default)(mt).getInstance()}function t(e,t,r){return bt=(0,_utilsCapabilities2.default)(mt).getInstance(),Lt=(0,_utilsErrorHandler2.default)(mt).getInstance(),bt.supportsMediaSource()?void(pt||(pt=!0,It=(0,_controllersAbrController2.default)(mt).getInstance(),xt=(0,_controllersPlaybackController2.default)(mt).getInstance(),Bt=(0,_controllersMediaController2.default)(mt).getInstance(),Bt.initialize(),zt=(0,_dashModelsDashManifestModel2.default)(mt).getInstance(),Vt=(0,_dashDashMetrics2.default)(mt).getInstance(),Pt=(0,_modelsMetricsModel2.default)(mt).getInstance(),Pt.setConfig({adapter:at()}),Fe(),x(void 0===r||r),e&&Ke(e),t&&et(t),Tt("[dash.js "+D()+"] MediaPlayer has been initialized"))):void Lt.capabilityError("mediasource")}function r(){return!!Qt&&!!yt}function n(){if(!Dt)throw gt;(!Ft||i()&&Dt)&&xt.play()}function o(){if(!Dt)throw gt;xt.pause()}function i(){if(!Dt)throw gt;return xt.isPaused()}function a(){if(!Dt)throw gt;return xt.isSeeking()}function l(){if(!Dt)throw gt;return xt.getIsDynamic()}function u(e){if(!Qt)throw _t;Ge().muted=e}function s(){if(!Qt)throw _t;return Ge().muted}function c(e){if(!Qt)throw _t;Ge().volume=e}function d(){if(!Qt)throw _t;return Ge().volume}function f(e){var t=["video","audio","fragmentedText"];if(e){if(t.indexOf(e)!==-1){var r=N().getCurrentBufferLevel(W(e));return r?r:NaN}return Tt("Warning  - getBufferLength requested for invalid type"),NaN}return t.map(function(e){return ie(e).length>0?N().getCurrentBufferLevel(W(e)):Number.MAX_VALUE}).reduce(function(e,t){return Math.min(e,t)})}function g(){var e=st();return e?e.manifestInfo.DVRWindowSize:0}function _(e){var t=st();if(!t)return 0;var r=t.range.start+e;return r>t.range.end&&(r=t.range.end),r}function h(e){if(!Dt)throw gt;var t=xt.getIsDynamic()?_(e):e;xt.seek(t)}function M(e){if(!Dt)throw gt;var t=Ge().currentTime;if(void 0!==e)t=Ut.getTimeRelativeToStreamId(t,e);else if(xt.getIsDynamic()){var r=st();t=null===r?0:m()-(r.range.end-r.time)}return t}function m(){if(!Dt)throw gt;var e=Ge().duration;if(xt.getIsDynamic()){var t,r=st();if(!r)return 0;t=r.range.end-r.range.start,e=t<r.manifestInfo.DVRWindowSize?t:r.manifestInfo.DVRWindowSize}return e}function v(){if(!Dt)throw gt;return M()<0?NaN:ct(M())}function C(){if(!Dt)throw gt;return ct(m())}function T(e,t,r){var n=!(arguments.length<=3||void 0===arguments[3])&&arguments[3],o=new Date(1e3*e),i=o.toLocaleDateString(t),a=o.toLocaleTimeString(t,{hour12:r});return n?a+" "+i:a}function R(e){e=Math.max(e,0);var t=Math.floor(e/3600),r=Math.floor(e%3600/60),n=Math.floor(e%3600%60);return(0===t?"":t<10?"0"+t.toString()+":":t.toString()+":")+(r<10?"0"+r.toString():r.toString())+":"+(n<10?"0"+n.toString():n.toString())}function y(e,t,r){_coreFactoryMaker2.default.extend(e,t,r,mt)}function S(e,t,r){vt.on(e,t,r)}function p(e,t,r){vt.off(e,t,r)}function D(){return(0,_coreVersion.getVersionString)()}function F(){return Ct}function I(){if(!Qt)throw _t;return Qt}function B(e){Et.setLiveDelayFragmentCount(e)}function q(e){Et.setLiveDelay(e)}function A(){return Et.getLiveDelay()}function w(e){Et.setUseSuggestedPresentationDelay(e)}function P(e,t){Et.setLastBitrateCachingInfo(e,t)}function E(e,t){Et.setLastMediaSettingsCachingInfo(e,t)}function L(e,t){It.setMaxAllowedBitrateFor(e,t)}function b(e){return It.getMaxAllowedBitrateFor(e)}function U(e,t){It.setMaxAllowedRepresentationRatioFor(e,t)}function k(e){return It.getMaxAllowedRepresentationRatioFor(e)}function x(e){Ft=e}function V(){return Ft}function z(e){Et.setScheduleWhilePaused(e)}function Q(){return Et.getScheduleWhilePaused()}function N(){return Vt}function W(e){return Pt.getReadOnlyMetricsFor(e)}function H(e){if(!Dt)throw gt;return It.getQualityFor(e,Ut.getActiveStreamInfo())}function O(e,t){if(!Dt)throw gt;It.setPlaybackQuality(e,Ut.getActiveStreamInfo(),t)}function X(){It.setElementSize(),It.setWindowResizeEventCalled(!0)}function j(){return It.getLimitBitrateByPortal()}function Y(e){It.setLimitBitrateByPortal(e)}function G(){return It.getUsePixelRatioInLimitBitrateByPortal()}function K(e){It.setUsePixelRatioInLimitBitrateByPortal(e)}function J(e){if(!Dt)throw gt;void 0===Nt&&(Nt=(0,_TextSourceBuffer2.default)(mt).getInstance());for(var t=Ge().textTracks,r=t.length,n=0;n<r;n++){var o=t[n],i=e===n?"showing":"hidden";o.mode!==i&&(o.mode=i)}Nt.setTextTrack()}function Z(){var e=NaN;return Nt&&(e=Nt.getCurrentTrackIdx()),e}function $(e){if(!Dt)throw gt;var t=dt();return t?t.getBitrateListFor(e):[]}function ee(e,t){It.setInitialBitrateFor(e,t)}function te(e){if(!Dt)throw gt;return It.getInitialBitrateFor(e)}function re(e,t){It.setInitialRepresentationRatioFor(e,t)}function ne(e){return It.getInitialRepresentationRatioFor(e)}function oe(e){if(!Dt)throw gt;return wt.getStreamsInfo(e)}function ie(e){if(!Dt)throw gt;var t=Ut.getActiveStreamInfo();return t?Bt.getTracksFor(e,t):[]}function ae(e,t,r){if(!Dt)throw gt;return r=r||wt.getStreamsInfo(t)[0],r?wt.getAllMediaInfoForType(t,r,e):[]}function le(e){if(!Dt)throw gt;var t=Ut.getActiveStreamInfo();return t?Bt.getCurrentTrackFor(e,t):null}function ue(e,t){Bt.setInitialSettings(e,t)}function se(e){return Bt.getInitialSettings(e)}function ce(e){if(!Dt)throw gt;Bt.setTrack(e)}function de(e){return Bt.getSwitchMode(e)}function fe(e,t){Bt.setSwitchMode(e,t)}function ge(e){Bt.setSelectionModeForInitialTrack(e)}function _e(){return Bt.getSelectionModeForInitialTrack()}function he(){return It.getAutoSwitchBitrateFor("video")||It.getAutoSwitchBitrateFor("audio")}function Me(e){It.setAutoSwitchBitrateFor("video",e),It.setAutoSwitchBitrateFor("audio",e)}function me(e){return It.getAutoSwitchBitrateFor(e)}function ve(e,t){It.setAutoSwitchBitrateFor(e,t)}function Ce(e){Et.setFastSwitchEnabled(e)}function Te(){return Et.getFastSwitchEnabled()}function Re(e){Et.setBufferOccupancyABREnabled(e)}function ye(e,t){var r=ot(),n=this,o=function e(o){o.error?t(null,o.error):t(o.manifest),vt.off(_coreEventsEvents2.default.INTERNAL_MANIFEST_LOADED,e,n),r.reset()};vt.on(_coreEventsEvents2.default.INTERNAL_MANIFEST_LOADED,o,n);var i=(0,_modelsURIQueryAndFragmentModel2.default)(mt).getInstance();i.initialize(),r.load(i.parseURI(e))}function Se(e,t){pe(e,t);var r=new _dashVoUTCTiming2.default;r.schemeIdUri=e,r.value=t,Et.getUTCTimingSources().push(r)}function pe(e,t){var r=Et.getUTCTimingSources();r.forEach(function(n,o){n.schemeIdUri===e&&n.value===t&&r.splice(o,1)})}function De(){Et.setUTCTimingSources([])}function Fe(){Se(_modelsMediaPlayerModel2.default.DEFAULT_UTC_TIMING_SOURCE.scheme,_modelsMediaPlayerModel2.default.DEFAULT_UTC_TIMING_SOURCE.value)}function Ie(e){Et.setUseManifestDateHeaderTimeSource(e)}function Be(e){Et.setBufferToKeep(e)}function qe(e){Et.setBufferPruningInterval(e)}function Ae(e){Et.setStableBufferTime(e)}function we(e){Et.setBufferTimeAtTopQuality(e)}function Pe(e){Et.setBufferTimeAtTopQualityLongForm(e)}function Ee(e){Et.setLongFormContentDurationThreshold(e)}function Le(e){Et.setRichBufferThreshold(e)}function be(e){Et.setBandwidthSafetyFactor(e)}function Ue(){return Et.getBandwidthSafetyFactor()}function ke(e){Et.setAbandonLoadTimeout(e)}function xe(e){Et.setFragmentRetryAttempts(e)}function Ve(e){Et.setFragmentRetryInterval(e)}function ze(e){Qe(void 0,e)}function Qe(e,t){Et.setXHRWithCredentialsForType(e,t)}function Ne(e){return Et.getXHRWithCredentialsForType(e)}function We(){return lt()}function He(e){qt=e}function Oe(e){St=e}function Xe(e){var t=(0,_TextTracks2.default)(mt).getInstance();t.setConfig({videoModel:Qt}),t.initialize(),t.displayCConTop(e)}function je(){return Qt?Qt.getVideoContainer():null}function Ye(e){if(!Qt)throw _t;Qt.setVideoContainer(e)}function Ge(){if(!Qt)throw _t;return Qt.getElement()}function Ke(e){if(!pt)throw Mt;Qt=null,e&&(Qt=(0,_modelsVideoModel2.default)(mt).getInstance(),Qt.initialize(),Qt.setElement(e),lt(),ut()),rt()}function Je(){return Qt?Qt.getTTMLRenderingDiv():null}function Ze(e){if(!Qt)throw _t;Qt.setTTMLRenderingDiv(e)}function $e(){if(!yt)throw ht;return yt}function et(e){if(!pt)throw Mt;if("string"==typeof e){var t=(0,_modelsURIQueryAndFragmentModel2.default)(mt).getInstance();t.initialize(),yt=t.parseURI(e)}else yt=e;rt()}function tt(){et(null),Ke(null),St=null,qt=null}function rt(){Dt?(Dt=!1,wt.reset(),Ut.reset(),xt.reset(),It.reset(),kt.reset(),Bt.reset(),Ut=null,At=null,r()&&ft()):r()&&ft()}function nt(){var e=(0,_rulesAbrABRRulesCollection2.default)(mt).getInstance();e.initialize();var t=(0,_controllersSourceBufferController2.default)(mt).getInstance();t.setConfig({dashManifestModel:zt}),Bt.initialize(),Bt.setConfig({errHandler:Lt}),kt=(0,_rulesRulesController2.default)(mt).getInstance(),kt.initialize(),kt.setConfig({abrRulesCollection:e}),Ut=(0,_controllersStreamController2.default)(mt).getInstance(),Ut.setConfig({capabilities:bt,manifestLoader:ot(),manifestModel:(0,_modelsManifestModel2.default)(mt).getInstance(),dashManifestModel:zt,protectionController:qt,adapter:wt,metricsModel:Pt,dashMetrics:Vt,liveEdgeFinder:(0,_utilsLiveEdgeFinder2.default)(mt).getInstance(),mediaSourceController:(0,_controllersMediaSourceController2.default)(mt).getInstance(),timeSyncController:(0,_controllersTimeSyncController2.default)(mt).getInstance(),baseURLController:(0,_controllersBaseURLController2.default)(mt).getInstance(),errHandler:Lt,timelineConverter:(0,_dashUtilsTimelineConverter2.default)(mt).getInstance()}),Ut.initialize(Ft,St),It.setConfig({abrRulesCollection:e,rulesController:kt,streamController:Ut})}function ot(){return(0,_ManifestLoader2.default)(mt).create({errHandler:Lt,parser:it(),metricsModel:Pt,requestModifier:(0,_utilsRequestModifier2.default)(mt).getInstance()})}function it(){return(0,_dashParserDashParser2.default)(mt).create()}function at(){return wt=(0,_dashDashAdapter2.default)(mt).getInstance(),wt.initialize(),wt.setConfig({dashManifestModel:zt}),wt}function lt(){if(qt)return qt;var e=dashjs.Protection;if("function"==typeof e){var t=e(mt).create();return _coreEventsEvents2.default.extend(e.events),_MediaPlayerEvents2.default.extend(e.events,{publicOnly:!0}),qt=t.createProtectionSystem({log:Tt,videoModel:Qt,capabilities:bt,eventBus:vt,adapter:wt})}return null}function ut(){if(At)return At;var e=dashjs.MetricsReporting;if("function"==typeof e){var t=e(mt).create();return At=t.createMetricsReporting({log:Tt,eventBus:vt,mediaElement:Ge(),dashManifestModel:zt,metricsModel:Pt})}return null}function st(){var e=Pt.getReadOnlyMetricsFor("video")||Pt.getReadOnlyMetricsFor("audio");return Vt.getCurrentDVRInfo(e)}function ct(e){var t,r,n=st();return n?(t=n.manifestInfo.availableFrom.getTime()/1e3,r=e+(t+n.range.start)):0}function dt(){if(!Dt)throw gt;var e=Ut.getActiveStreamInfo();return e?Ut.getStreamById(e.id):null}function ft(){Dt||(Dt=!0,Tt("Playback Initialized"),nt(),"string"==typeof yt?Ut.load(yt):Ut.loadWithManifest(yt))}var gt="You must first call play() to init playback before calling this method",_t="You must first call attachView() to set the video element before calling this method",ht="You must first call attachSource() with a valid source before calling this method",Mt="MediaPlayer not initialized!",mt=this.context,vt=(0,_coreEventBus2.default)(mt).getInstance(),Ct=(0,_coreDebug2.default)(mt).getInstance(),Tt=Ct.log,Rt=void 0,yt=void 0,St=void 0,pt=void 0,Dt=void 0,Ft=void 0,It=void 0,Bt=void 0,qt=void 0,At=void 0,wt=void 0,Pt=void 0,Et=void 0,Lt=void 0,bt=void 0,Ut=void 0,kt=void 0,xt=void 0,Vt=void 0,zt=void 0,Qt=void 0,Nt=void 0;return Rt={initialize:t,on:S,off:p,extend:y,attachView:Ke,attachSource:et,isReady:r,play:n,isPaused:i,pause:o,isSeeking:a,isDynamic:l,seek:h,setMute:u,isMuted:s,setVolume:c,getVolume:d,time:M,duration:m,timeAsUTC:v,durationAsUTC:C,getActiveStream:dt,getDVRWindowSize:g,getDVRSeekOffset:_,convertToTimeCode:R,formatUTC:T,getVersion:D,getDebug:F,getBufferLength:f,getVideoModel:I,getVideoContainer:je,getTTMLRenderingDiv:Je,getVideoElement:Ge,getSource:$e,setLiveDelayFragmentCount:B,setLiveDelay:q,getLiveDelay:A,useSuggestedPresentationDelay:w,enableLastBitrateCaching:P,enableLastMediaSettingsCaching:E,setMaxAllowedBitrateFor:L,getMaxAllowedBitrateFor:b,setMaxAllowedRepresentationRatioFor:U,getMaxAllowedRepresentationRatioFor:k,setAutoPlay:x,getAutoPlay:V,setScheduleWhilePaused:z,getScheduleWhilePaused:Q,getDashMetrics:N,getMetricsFor:W,getQualityFor:H,setQualityFor:O,updatePortalSize:X,getLimitBitrateByPortal:j,setLimitBitrateByPortal:Y,getUsePixelRatioInLimitBitrateByPortal:G,setUsePixelRatioInLimitBitrateByPortal:K,setTextTrack:J,getBitrateInfoListFor:$,setInitialBitrateFor:ee,getInitialBitrateFor:te,setInitialRepresentationRatioFor:re,getInitialRepresentationRatioFor:ne,getStreamsFromManifest:oe,getTracksFor:ie,getTracksForTypeFromManifest:ae,getCurrentTrackFor:le,setInitialMediaSettingsFor:ue,getInitialMediaSettingsFor:se,setCurrentTrack:ce,getTrackSwitchModeFor:de,setTrackSwitchModeFor:fe,setSelectionModeForInitialTrack:ge,getSelectionModeForInitialTrack:_e,getAutoSwitchQuality:he,setAutoSwitchQuality:Me,setFastSwitchEnabled:Ce,getFastSwitchEnabled:Te,getAutoSwitchQualityFor:me,setAutoSwitchQualityFor:ve,enableBufferOccupancyABR:Re,setBandwidthSafetyFactor:be,getBandwidthSafetyFactor:Ue,setAbandonLoadTimeout:ke,retrieveManifest:ye,addUTCTimingSource:Se,removeUTCTimingSource:pe,clearDefaultUTCTimingSources:De,restoreDefaultUTCTimingSources:Fe,setBufferToKeep:Be,setBufferPruningInterval:qe,setStableBufferTime:Ae,setBufferTimeAtTopQuality:we,setFragmentLoaderRetryAttempts:xe,setFragmentLoaderRetryInterval:Ve,setXHRWithCredentials:ze,setXHRWithCredentialsForType:Qe,getXHRWithCredentialsForType:Ne,setBufferTimeAtTopQualityLongForm:Pe,setLongFormContentDurationThreshold:Ee,setRichBufferThreshold:Le,getProtectionController:We,attachProtectionController:He,setProtectionData:Oe,enableManifestDateHeaderTimeSource:Ie,displayCaptionsOnTop:Xe,attachVideoContainer:Ye,attachTTMLRenderingDiv:Ze,getCurrentTextTrackIndex:Z,reset:tt},e(),Rt}Object.defineProperty(exports,"__esModule",{value:!0});var _dashVoUTCTiming=require("../dash/vo/UTCTiming"),_dashVoUTCTiming2=_interopRequireDefault(_dashVoUTCTiming),_controllersPlaybackController=require("./controllers/PlaybackController"),_controllersPlaybackController2=_interopRequireDefault(_controllersPlaybackController),_controllersStreamController=require("./controllers/StreamController"),_controllersStreamController2=_interopRequireDefault(_controllersStreamController),_controllersMediaController=require("./controllers/MediaController"),_controllersMediaController2=_interopRequireDefault(_controllersMediaController),_ManifestLoader=require("./ManifestLoader"),_ManifestLoader2=_interopRequireDefault(_ManifestLoader),_utilsLiveEdgeFinder=require("./utils/LiveEdgeFinder"),_utilsLiveEdgeFinder2=_interopRequireDefault(_utilsLiveEdgeFinder),_utilsErrorHandler=require("./utils/ErrorHandler"),_utilsErrorHandler2=_interopRequireDefault(_utilsErrorHandler),_utilsCapabilities=require("./utils/Capabilities"),_utilsCapabilities2=_interopRequireDefault(_utilsCapabilities),_TextTracks=require("./TextTracks"),_TextTracks2=_interopRequireDefault(_TextTracks),_controllersSourceBufferController=require("./controllers/SourceBufferController"),_controllersSourceBufferController2=_interopRequireDefault(_controllersSourceBufferController),_utilsRequestModifier=require("./utils/RequestModifier"),_utilsRequestModifier2=_interopRequireDefault(_utilsRequestModifier),_TextSourceBuffer=require("./TextSourceBuffer"),_TextSourceBuffer2=_interopRequireDefault(_TextSourceBuffer),_modelsURIQueryAndFragmentModel=require("./models/URIQueryAndFragmentModel"),_modelsURIQueryAndFragmentModel2=_interopRequireDefault(_modelsURIQueryAndFragmentModel),_modelsManifestModel=require("./models/ManifestModel"),_modelsManifestModel2=_interopRequireDefault(_modelsManifestModel),_modelsMediaPlayerModel=require("./models/MediaPlayerModel"),_modelsMediaPlayerModel2=_interopRequireDefault(_modelsMediaPlayerModel),_modelsMetricsModel=require("./models/MetricsModel"),_modelsMetricsModel2=_interopRequireDefault(_modelsMetricsModel),_controllersAbrController=require("./controllers/AbrController"),_controllersAbrController2=_interopRequireDefault(_controllersAbrController),_controllersTimeSyncController=require("./controllers/TimeSyncController"),_controllersTimeSyncController2=_interopRequireDefault(_controllersTimeSyncController),_rulesAbrABRRulesCollection=require("./rules/abr/ABRRulesCollection"),_rulesAbrABRRulesCollection2=_interopRequireDefault(_rulesAbrABRRulesCollection),_modelsVideoModel=require("./models/VideoModel"),_modelsVideoModel2=_interopRequireDefault(_modelsVideoModel),_rulesRulesController=require("./rules/RulesController"),_rulesRulesController2=_interopRequireDefault(_rulesRulesController),_controllersMediaSourceController=require("./controllers/MediaSourceController"),_controllersMediaSourceController2=_interopRequireDefault(_controllersMediaSourceController),_controllersBaseURLController=require("./controllers/BaseURLController"),_controllersBaseURLController2=_interopRequireDefault(_controllersBaseURLController),_coreDebug=require("./../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug),_coreEventBus=require("./../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreEventsEvents=require("./../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_MediaPlayerEvents=require("./MediaPlayerEvents"),_MediaPlayerEvents2=_interopRequireDefault(_MediaPlayerEvents),_coreFactoryMaker=require("../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_coreVersion=require("./../core/Version"),_dashDashAdapter=require("../dash/DashAdapter"),_dashDashAdapter2=_interopRequireDefault(_dashDashAdapter),_dashParserDashParser=require("../dash/parser/DashParser"),_dashParserDashParser2=_interopRequireDefault(_dashParserDashParser),_dashModelsDashManifestModel=require("../dash/models/DashManifestModel"),_dashModelsDashManifestModel2=_interopRequireDefault(_dashModelsDashManifestModel),_dashDashMetrics=require("../dash/DashMetrics"),_dashDashMetrics2=_interopRequireDefault(_dashDashMetrics),_dashUtilsTimelineConverter=require("../dash/utils/TimelineConverter"),_dashUtilsTimelineConverter2=_interopRequireDefault(_dashUtilsTimelineConverter);MediaPlayer.__dashjs_factory_name="MediaPlayer";var factory=_coreFactoryMaker2.default.getClassFactory(MediaPlayer);factory.events=_MediaPlayerEvents2.default,exports.default=factory,module.exports=exports.default;
},{"../core/FactoryMaker":15,"../dash/DashAdapter":20,"../dash/DashMetrics":22,"../dash/models/DashManifestModel":27,"../dash/parser/DashParser":28,"../dash/utils/TimelineConverter":43,"../dash/vo/UTCTiming":53,"./../core/Debug":13,"./../core/EventBus":14,"./../core/Version":16,"./../core/events/Events":18,"./ManifestLoader":55,"./MediaPlayerEvents":58,"./TextSourceBuffer":62,"./TextTracks":63,"./controllers/AbrController":66,"./controllers/BaseURLController":67,"./controllers/MediaController":72,"./controllers/MediaSourceController":73,"./controllers/PlaybackController":74,"./controllers/SourceBufferController":76,"./controllers/StreamController":77,"./controllers/TimeSyncController":79,"./models/ManifestModel":106,"./models/MediaPlayerModel":107,"./models/MetricsModel":108,"./models/URIQueryAndFragmentModel":109,"./models/VideoModel":110,"./rules/RulesController":136,"./rules/abr/ABRRulesCollection":139,"./utils/Capabilities":153,"./utils/ErrorHandler":157,"./utils/LiveEdgeFinder":160,"./utils/RequestModifier":162}],58:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _get=function(e,t,a){for(var r=!0;r;){var i=e,s=t,n=a;r=!1,null===i&&(i=Function.prototype);var o=Object.getOwnPropertyDescriptor(i,s);if(void 0!==o){if("value"in o)return o.value;var E=o.get;if(void 0===E)return;return E.call(n)}var A=Object.getPrototypeOf(i);if(null===A)return;e=A,t=s,a=n,r=!0,o=A=void 0}},_coreEventsEventsBase=require("../core/events/EventsBase"),_coreEventsEventsBase2=_interopRequireDefault(_coreEventsEventsBase),MediaPlayerEvents=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.AST_IN_FUTURE="astInFuture",this.BUFFER_EMPTY="bufferStalled",this.BUFFER_LOADED="bufferLoaded",this.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",this.ERROR="error",this.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",this.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",this.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",this.LOG="log",this.MANIFEST_LOADED="manifestLoaded",this.METRICS_CHANGED="metricsChanged",this.METRIC_CHANGED="metricChanged",this.METRIC_ADDED="metricAdded",this.METRIC_UPDATED="metricUpdated",this.PERIOD_SWITCH_COMPLETED="periodSwitchCompleted",this.PERIOD_SWITCH_STARTED="periodSwitchStarted",this.QUALITY_CHANGE_REQUESTED="qualityChangeRequested",this.QUALITY_CHANGE_RENDERED="qualityChangeRendered",this.STREAM_INITIALIZED="streamInitialized",this.TEXT_TRACKS_ADDED="allTextTracksAdded",this.TEXT_TRACK_ADDED="textTrackAdded",this.CAN_PLAY="canPlay",this.PLAYBACK_ENDED="playbackEnded",this.PLAYBACK_ERROR="playbackError",this.PLAYBACK_NOT_ALLOWED="playbackNotAllowed",this.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",this.PLAYBACK_PAUSED="playbackPaused",this.PLAYBACK_PLAYING="playbackPlaying",this.PLAYBACK_PROGRESS="playbackProgress",this.PLAYBACK_RATE_CHANGED="playbackRateChanged",this.PLAYBACK_SEEKED="playbackSeeked",this.PLAYBACK_SEEKING="playbackSeeking",this.PLAYBACK_STARTED="playbackStarted",this.PLAYBACK_TIME_UPDATED="playbackTimeUpdated"}return _inherits(t,e),t}(_coreEventsEventsBase2.default),mediaPlayerEvents=new MediaPlayerEvents;exports.default=mediaPlayerEvents,module.exports=exports.default;
},{"../core/events/EventsBase":19}],59:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function MediaPlayerFactory(){function e(e,a,r){if(!e||"VIDEO"!==e.nodeName)return null;if(e._dashjs_player)return e._dashjs_player;var n,l=e.id||e.name||"video element";if(a=a||[].slice.call(e.querySelectorAll("source")).filter(function(e){return e.type==t})[0],!a&&e.src)a=document.createElement("source"),a.src=e.src;else if(!a&&!e.src)return null;return r=r||{},n=(0,_MediaPlayer2.default)(r).create(),n.initialize(e,a.src,e.autoplay),n.getDebug().log("Converted "+l+" to dash.js player and added content: "+a.src),e._dashjs_player=n,n}function a(a,n){var l=[];a=a||"[data-dashjs-player]",n=n||document;for(var d=n.querySelectorAll(a),o=0;o<d.length;o++){var i=e(d[o],null);l.push(i)}for(var u=n.querySelectorAll('source[type="'+t+'"]'),o=0;o<u.length;o++){var s=r(u[o]),i=e(s,null);l.push(i)}return l}function r(e){for(var a=!0;a;){var r=e;if(a=!1,"video"===r.nodeName.toLowerCase())return r;e=r.parentNode,a=!0}}var t="application/dash+xml";return{create:e,createAll:a}}function loadHandler(){window.removeEventListener("load",loadHandler),instance.createAll()}function loadIntervalHandler(){window.dashjs&&(window.clearInterval(loadInterval),instance.createAll())}Object.defineProperty(exports,"__esModule",{value:!0});var _MediaPlayer=require("./MediaPlayer"),_MediaPlayer2=_interopRequireDefault(_MediaPlayer),instance=MediaPlayerFactory(),loadInterval=void 0,avoidAutoCreate="undefined"!=typeof window&&window&&window.dashjs&&window.dashjs.skipAutoCreate;!avoidAutoCreate&&"undefined"!=typeof window&&window&&window.addEventListener&&("complete"===window.document.readyState?window.dashjs?instance.createAll():loadInterval=window.setInterval(loadIntervalHandler,500):window.addEventListener("load",loadHandler)),exports.default=instance,module.exports=exports.default;
},{"./MediaPlayer":57}],60:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function Stream(e){function t(){G=[],W=!1,Q=!1,j=null,Z={},J=!1,X=!1,ee=(0,_utilsLiveEdgeFinder2.default)(P).getInstance(),te=(0,_controllersPlaybackController2.default)(P).getInstance(),ae=(0,_controllersAbrController2.default)(P).getInstance(),re=(0,_controllersMediaController2.default)(P).getInstance(),ne=(0,_controllersFragmentController2.default)(P).create(),le=(0,_TextSourceBuffer2.default)(P).getInstance(),U.on(_coreEventsEvents2.default.BUFFERING_COMPLETED,q,z),U.on(_coreEventsEvents2.default.DATA_UPDATE_COMPLETED,b,z)}function r(e,t){j=e,$=t,$&&(U.on(_coreEventsEvents2.default.KEY_ERROR,m,z),U.on(_coreEventsEvents2.default.SERVER_CERTIFICATE_UPDATED,m,z),U.on(_coreEventsEvents2.default.LICENSE_REQUEST_COMPLETE,m,z),U.on(_coreEventsEvents2.default.KEY_SYSTEM_SELECTED,m,z),U.on(_coreEventsEvents2.default.KEY_SESSION_CREATED,m,z))}function n(e){W||(U.on(_coreEventsEvents2.default.CURRENT_TRACK_CHANGED,M,z),h(e),W=!0)}function o(){for(var e=G.length,t=0;t<e;t++)G[t].reset();G=[],W=!1,Q=!1,E(),U.off(_coreEventsEvents2.default.CURRENT_TRACK_CHANGED,M,z)}function a(){te&&(te.pause(),te=null),ne&&(ne.reset(),ne=null),o(),re=null,ae=null,V=null,N=null,O=null,H=null,k=null,K=null,J=!1,X=!1,Z={},U.off(_coreEventsEvents2.default.DATA_UPDATE_COMPLETED,b,z),U.off(_coreEventsEvents2.default.BUFFERING_COMPLETED,q,z),U.off(_coreEventsEvents2.default.KEY_ERROR,m,z),U.off(_coreEventsEvents2.default.SERVER_CERTIFICATE_UPDATED,m,z),U.off(_coreEventsEvents2.default.LICENSE_REQUEST_COMPLETE,m,z),U.off(_coreEventsEvents2.default.KEY_SYSTEM_SELECTED,m,z),U.off(_coreEventsEvents2.default.KEY_SESSION_CREATED,m,z)}function l(){return j.duration}function i(){return j.start}function d(){return j.index}function s(){return j.id}function u(){return j}function f(e){return null!==y(e)}function c(e){var t=y(e);return ae.getBitrateList(t)}function _(){oe&&oe.start()}function E(){oe&&oe.clear()}function v(){return W}function g(){return X}function m(e){e.error&&(K.mediaKeySessionError(e.error),k(e.error),a())}function p(e){return"text"===e.type?e.mimeType:e.type}function T(e,t,r){var n,o,a=e.type;if("muxed"===a&&e)return o="Multiplexed representations are intentionally not supported, as they are not compliant with the DASH-AVC/264 guidelines",k(o),K.manifestError(o,"multiplexedrep",N.getValue()),!1;if("text"===a||"fragmentedText"===a||"embeddedText"===a)return!0;if(n=e.codec,k(a+" codec: "+n),e.contentProtection&&!H.supportsEncryptedMedia())K.capabilityError("encryptedmedia");else if(!H.supportsCodec((0,_modelsVideoModel2.default)(P).getInstance().getElement(),n))return o=a+"Codec ("+n+") is not supported.",K.manifestError(o,"codec",r),k(o),!1;return!0}function M(e){if(e.newMediaInfo.streamInfo.id===j.id){var t=L(e.oldMediaInfo);if(t){var r=te.getTime(),n=t.getBuffer(),o=e.newMediaInfo,a=N.getValue(),l=G.indexOf(t),i=t.getMediaSource();"fragmentedText"!==o.type?(t.reset(!0),I(o,a,i,{buffer:n,replaceIdx:l,currentTime:r}),te.seek(te.getTime())):t.updateMediaInfo(a,o)}}}function C(e){var t=e.split("/")[1];return"webm"===t.toLowerCase()}function D(e){var t=C(e.mimeType)?(0,_dashWebmSegmentBaseLoader2.default)(P).getInstance():(0,_dashSegmentBaseLoader2.default)(P).getInstance();t.setConfig({baseURLController:w,metricsModel:(0,_modelsMetricsModel2.default)(P).getInstance()}),t.initialize();var r=(0,_dashDashHandler2.default)(P).create({segmentBaseLoader:t,timelineConverter:Y,dashMetrics:(0,_dashDashMetrics2.default)(P).getInstance(),metricsModel:(0,_modelsMetricsModel2.default)(P).getInstance(),baseURLController:w});return r}function I(e,t,r,n){var o=(0,_StreamProcessor2.default)(P).create({indexHandler:D(e),timelineConverter:Y,adapter:O,manifestModel:N}),a=O.getAllMediaInfoForType(t,j,e.type);if(o.initialize(p(e),ne,r,z,oe),ae.updateTopQualityIndex(e),n?(o.setBuffer(n.buffer),o.getIndexHandler().setCurrentTime(n.currentTime),G[n.replaceIdx]=o):G.push(o),"text"===e.type||"fragmentedText"===e.type){for(var l,i=0;i<a.length;i++)a[i].index===e.index&&(l=i),o.updateMediaInfo(t,a[i]);"fragmentedText"===e.type&&o.updateMediaInfo(t,a[l])}else o.updateMediaInfo(t,e);return o}function S(e,t){var r,n=N.getValue(),o=O.getAllMediaInfoForType(n,j,e),a=null;if(!o||0===o.length)return void k("No "+e+" data.");for(var l=0,i=o.length;l<i;l++)if(a=o[l],"embeddedText"===e)le.addEmbeddedTrack(a);else{if(!T(a,t,n))continue;re.isMultiTrackSupportedByType(a.type)&&re.addTrack(a,j)}"embeddedText"!==e&&0!==re.getTracksFor(e,j).length&&(re.checkInitialMediaSettingsForType(e,j),r=re.getCurrentTrackFor(e,j),I(r,n,t))}function h(e){var t,r=N.getValue();if(oe=(0,_controllersEventController2.default)(P).getInstance(),oe.initialize(),oe.setConfig({manifestModel:N,manifestUpdater:V}),t=O.getEventsFor(r,j),oe.addInlineEvents(t),J=!0,S("video",e),S("audio",e),S("text",e),S("fragmentedText",e),S("embeddedText",e),S("muxed",e),x(),Q=!0,J=!1,0===G.length){var n="No streams to play.";K.manifestError(n,"nostreams",r),k(n)}else ee.initialize(Y,G[0]),R()}function R(){var e=G.length,t=!!Z.audio||!!Z.video,r=t?new Error(A,"Data update failed",null):null,n=0;for(n;n<e;n++)if(G[n].isUpdating()||J)return;X=!0,Q&&($&&$.initialize(N.getValue(),y("audio"),y("video")),U.trigger(_coreEventsEvents2.default.STREAM_INITIALIZED,{streamInfo:j,error:r}))}function y(e){for(var t=G.length,r=null,n=0;n<t;n++)if(r=G[n],r.getType()===e)return r.getMediaInfo();return null}function x(){for(var e=0,t=G.length;e<t;e++)G[e].createBuffer()}function q(e){if(e.streamInfo===j){var t=F(),r=t.length,n=0;for(n;n<r;n++)if(!t[n].isBufferingCompleted())return;U.trigger(_coreEventsEvents2.default.STREAM_BUFFERING_COMPLETED,{streamInfo:j})}}function b(e){var t=e.sender.getStreamProcessor();t.getStreamInfo()===j&&(Z[t.getType()]=e.error,R())}function L(e){if(!e)return!1;var t=F();return t.filter(function(t){return t.getType()===e.type})[0]}function F(){var e,t,r=G.length,n=[],o=0;for(o;o<r;o++)t=G[o],e=t.getType(),"audio"!==e&&"video"!==e&&"fragmentedText"!==e||n.push(t);return n}function B(e){k("Manifest updated... updating data system wide.");var t=N.getValue();if(W=!1,J=!0,X=!1,j=e,oe){var r=O.getEventsFor(t,j);oe.addInlineEvents(r)}for(var n=0,o=G.length;n<o;n++){var a=G[n],l=O.getMediaInfoForType(t,j,a.getType());ae.updateTopQualityIndex(l),a.updateMediaInfo(t,l)}J=!1,R()}var A=1,P=this.context,k=(0,_coreDebug2.default)(P).getInstance().log,U=(0,_coreEventBus2.default)(P).getInstance(),N=e.manifestModel,V=e.manifestUpdater,O=e.adapter,H=e.capabilities,K=e.errHandler,Y=e.timelineConverter,w=e.baseURLController,z=void 0,G=void 0,W=void 0,Q=void 0,j=void 0,Z=void 0,J=void 0,X=void 0,$=void 0,ee=void 0,te=void 0,re=void 0,ne=void 0,oe=void 0,ae=void 0,le=void 0;return z={initialize:r,activate:n,deactivate:o,getDuration:l,getStartTime:i,getStreamIndex:d,getId:s,getStreamInfo:u,hasMedia:f,getBitrateListFor:c,startEventController:_,isActivated:v,isInitialized:g,updateData:B,reset:a,getProcessors:F},t(),z}Object.defineProperty(exports,"__esModule",{value:!0});var _utilsLiveEdgeFinder=require("./utils/LiveEdgeFinder"),_utilsLiveEdgeFinder2=_interopRequireDefault(_utilsLiveEdgeFinder),_StreamProcessor=require("./StreamProcessor"),_StreamProcessor2=_interopRequireDefault(_StreamProcessor),_controllersMediaController=require("./controllers/MediaController"),_controllersMediaController2=_interopRequireDefault(_controllersMediaController),_controllersEventController=require("./controllers/EventController"),_controllersEventController2=_interopRequireDefault(_controllersEventController),_controllersFragmentController=require("./controllers/FragmentController"),_controllersFragmentController2=_interopRequireDefault(_controllersFragmentController),_controllersAbrController=require("./controllers/AbrController"),_controllersAbrController2=_interopRequireDefault(_controllersAbrController),_modelsVideoModel=require("./models/VideoModel"),_modelsVideoModel2=_interopRequireDefault(_modelsVideoModel),_modelsMetricsModel=require("./models/MetricsModel"),_modelsMetricsModel2=_interopRequireDefault(_modelsMetricsModel),_controllersPlaybackController=require("./controllers/PlaybackController"),_controllersPlaybackController2=_interopRequireDefault(_controllersPlaybackController),_dashDashHandler=require("../dash/DashHandler"),_dashDashHandler2=_interopRequireDefault(_dashDashHandler),_dashSegmentBaseLoader=require("../dash/SegmentBaseLoader"),_dashSegmentBaseLoader2=_interopRequireDefault(_dashSegmentBaseLoader),_dashWebmSegmentBaseLoader=require("../dash/WebmSegmentBaseLoader"),_dashWebmSegmentBaseLoader2=_interopRequireDefault(_dashWebmSegmentBaseLoader),_dashDashMetrics=require("../dash/DashMetrics"),_dashDashMetrics2=_interopRequireDefault(_dashDashMetrics),_coreEventBus=require("../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreEventsEvents=require("../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_coreDebug=require("../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug),_coreFactoryMaker=require("../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_TextSourceBuffer=require("./TextSourceBuffer"),_TextSourceBuffer2=_interopRequireDefault(_TextSourceBuffer);Stream.__dashjs_factory_name="Stream",exports.default=_coreFactoryMaker2.default.getClassFactory(Stream),module.exports=exports.default;
},{"../core/Debug":13,"../core/EventBus":14,"../core/FactoryMaker":15,"../core/events/Events":18,"../dash/DashHandler":21,"../dash/DashMetrics":22,"../dash/SegmentBaseLoader":23,"../dash/WebmSegmentBaseLoader":24,"./StreamProcessor":61,"./TextSourceBuffer":62,"./controllers/AbrController":66,"./controllers/EventController":70,"./controllers/FragmentController":71,"./controllers/MediaController":72,"./controllers/PlaybackController":74,"./models/MetricsModel":108,"./models/VideoModel":110,"./utils/LiveEdgeFinder":160}],61:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function StreamProcessor(e){function r(){j=[]}function t(e,r,t,o,l){k=e,O=o,Q=l,J=r,b=O.getStreamInfo().manifestInfo.isDynamic,T.initialize(this),U=(0,_controllersAbrController2.default)(H).getInstance(),U.initialize(k,this),V=F(e),w=(0,_controllersScheduleController2.default)(H).create({metricsModel:(0,_modelsMetricsModel2.default)(H).getInstance(),manifestModel:A,adapter:E,dashMetrics:(0,_dashDashMetrics2.default)(H).getInstance(),dashManifestModel:(0,_dashModelsDashManifestModel2.default)(H).getInstance(),timelineConverter:P,rulesController:(0,_rulesRulesController2.default)(H).getInstance(),mediaPlayerModel:(0,_modelsMediaPlayerModel2.default)(H).getInstance()}),V.initialize(k,t,this),w.initialize(k,this),K=(0,_FragmentLoader2.default)(H).create({metricsModel:(0,_modelsMetricsModel2.default)(H).getInstance(),errHandler:(0,_utilsErrorHandler2.default)(H).getInstance(),requestModifier:(0,_utilsRequestModifier2.default)(H).getInstance()}),N=w.getFragmentModel(),N.setLoader(K),G=(0,_dashControllersRepresentationController2.default)(H).create(),G.initialize(this)}function o(e){T.reset(),V&&(V.reset(e),V=null),w&&(w.reset(),w=null),G&&(G.reset(),G=null),J=null,K=null,Q=null,O=null,b=null,z=null,j=[],k=null}function l(){return G.isUpdating()}function n(){return k}function u(){return U}function i(){return G}function a(){return K}function s(){return T}function d(){return J}function f(){return V.getBuffer()}function c(e){V.setBuffer(e)}function _(){return V}function M(){return N}function C(){return O?O.getStreamInfo():null}function g(e,r){r===z||r&&z&&r.type!==z.type||(z=r),j.indexOf(r)===-1&&j.push(r),E.updateData(e,this)}function m(){return j}function p(){return z}function q(){return V.getMediaSource()}function h(){return w}function R(){return Q}function D(){w.start()}function S(){w.stop()}function B(){return E.getCurrentRepresentationInfo(A.getValue(),G)}function I(e){return E.getRepresentationInfoForQuality(A.getValue(),G,e)}function v(){return V.getIsBufferingCompleted()}function y(){return V.getBuffer()||V.createBuffer(z)}function x(){return b}function F(e){var r=null;return r="video"===e||"audio"===e||"fragmentedText"===e?(0,_controllersBufferController2.default)(H).create({metricsModel:(0,_modelsMetricsModel2.default)(H).getInstance(),manifestModel:A,sourceBufferController:(0,_controllersSourceBufferController2.default)(H).getInstance(),errHandler:(0,_utilsErrorHandler2.default)(H).getInstance(),streamController:(0,_controllersStreamController2.default)(H).getInstance(),mediaController:(0,_controllersMediaController2.default)(H).getInstance(),adapter:E,textSourceBuffer:(0,_TextSourceBuffer2.default)(H).getInstance()}):(0,_controllersTextController2.default)(H).create({errHandler:(0,_utilsErrorHandler2.default)(H).getInstance(),sourceBufferController:(0,_controllersSourceBufferController2.default)(H).getInstance()})}var H=this.context,T=e.indexHandler,P=e.timelineConverter,E=e.adapter,A=e.manifestModel,L=void 0,b=void 0,z=void 0,k=void 0,j=void 0,O=void 0,Q=void 0,U=void 0,V=void 0,w=void 0,G=void 0,J=void 0,K=void 0,N=void 0;return L={initialize:t,isUpdating:l,getType:n,getBufferController:_,getABRController:u,getFragmentLoader:a,getFragmentModel:M,getScheduleController:h,getEventController:R,getFragmentController:d,getRepresentationController:i,getIndexHandler:s,getCurrentRepresentationInfo:B,getRepresentationInfoForQuality:I,isBufferingCompleted:v,createBuffer:y,getStreamInfo:C,updateMediaInfo:g,getMediaInfoArr:m,getMediaInfo:p,getMediaSource:q,getBuffer:f,setBuffer:c,start:D,stop:S,isDynamic:x,reset:o},r(),L}Object.defineProperty(exports,"__esModule",{value:!0});var _controllersAbrController=require("./controllers/AbrController"),_controllersAbrController2=_interopRequireDefault(_controllersAbrController),_controllersBufferController=require("./controllers/BufferController"),_controllersBufferController2=_interopRequireDefault(_controllersBufferController),_controllersStreamController=require("./controllers/StreamController"),_controllersStreamController2=_interopRequireDefault(_controllersStreamController),_controllersMediaController=require("./controllers/MediaController"),_controllersMediaController2=_interopRequireDefault(_controllersMediaController),_controllersTextController=require("./controllers/TextController"),_controllersTextController2=_interopRequireDefault(_controllersTextController),_controllersScheduleController=require("./controllers/ScheduleController"),_controllersScheduleController2=_interopRequireDefault(_controllersScheduleController),_rulesRulesController=require("./rules/RulesController"),_rulesRulesController2=_interopRequireDefault(_rulesRulesController),_modelsMediaPlayerModel=require("./models/MediaPlayerModel"),_modelsMediaPlayerModel2=_interopRequireDefault(_modelsMediaPlayerModel),_modelsMetricsModel=require("./models/MetricsModel"),_modelsMetricsModel2=_interopRequireDefault(_modelsMetricsModel),_FragmentLoader=require("./FragmentLoader"),_FragmentLoader2=_interopRequireDefault(_FragmentLoader),_utilsRequestModifier=require("./utils/RequestModifier"),_utilsRequestModifier2=_interopRequireDefault(_utilsRequestModifier),_controllersSourceBufferController=require("./controllers/SourceBufferController"),_controllersSourceBufferController2=_interopRequireDefault(_controllersSourceBufferController),_TextSourceBuffer=require("./TextSourceBuffer"),_TextSourceBuffer2=_interopRequireDefault(_TextSourceBuffer),_dashModelsDashManifestModel=require("../dash/models/DashManifestModel"),_dashModelsDashManifestModel2=_interopRequireDefault(_dashModelsDashManifestModel),_dashDashMetrics=require("../dash/DashMetrics"),_dashDashMetrics2=_interopRequireDefault(_dashDashMetrics),_dashControllersRepresentationController=require("../dash/controllers/RepresentationController"),_dashControllersRepresentationController2=_interopRequireDefault(_dashControllersRepresentationController),_utilsErrorHandler=require("./utils/ErrorHandler"),_utilsErrorHandler2=_interopRequireDefault(_utilsErrorHandler),_coreFactoryMaker=require("../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);StreamProcessor.__dashjs_factory_name="StreamProcessor",exports.default=_coreFactoryMaker2.default.getClassFactory(StreamProcessor),module.exports=exports.default;
},{"../core/FactoryMaker":15,"../dash/DashMetrics":22,"../dash/controllers/RepresentationController":26,"../dash/models/DashManifestModel":27,"./FragmentLoader":54,"./TextSourceBuffer":62,"./controllers/AbrController":66,"./controllers/BufferController":69,"./controllers/MediaController":72,"./controllers/ScheduleController":75,"./controllers/SourceBufferController":76,"./controllers/StreamController":77,"./controllers/TextController":78,"./models/MediaPlayerModel":107,"./models/MetricsModel":108,"./rules/RulesController":136,"./utils/ErrorHandler":157,"./utils/RequestModifier":162}],62:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function TextSourceBuffer(){function e(e,r){D=!1,S=null,V=null,N=!1,A=NaN,O=[],H=null,y||t();var a=r.getStreamProcessor();if(z=a.getMediaInfoArr(),E.setConfig({videoModel:U}),E.initialize(),R=!I.getIsTextTrack(e),M=(0,_utilsBoxParser2.default)(_).getInstance(),B=(0,_dashUtilsFragmentedTextBoxParser2.default)(_).getInstance(),B.setConfig({boxParser:M}),R){V=a.getFragmentModel(),this.buffered=(0,_utilsCustomTimeRanges2.default)(_).create(),O=P.getTracksFor("fragmentedText",L.getActiveStreamInfo());for(var n=P.getCurrentTrackFor("fragmentedText",L.getActiveStreamInfo()),o=0;o<O.length;o++)if(O[o]===n){W=o;break}}}function t(){j=[],z=[],U=(0,_modelsVideoModel2.default)(_).getInstance(),E=(0,_TextTracks2.default)(_).getInstance(),E.setConfig({videoModel:U}),E.initialize(),M=(0,_utilsBoxParser2.default)(_).getInstance(),B=(0,_dashUtilsFragmentedTextBoxParser2.default)(_).getInstance(),B.setConfig({boxParser:M}),R=!1,W=null,J=!1,$=0,Q=[],K=[],G=null,y=!0}function r(e,t){function r(e,t){var r=new _voTextTrackInfo2.default,a={subtitle:"subtitles",caption:"captions"},n=function(){var e=t.roles.length>0?a[t.roles[0]]:a.caption;return e=e===a.caption||e===a.subtitle?e:a.caption},o=function(){var e=!1;return t.codec&&t.codec.search("stpp")>=0&&(e=!0),t.mimeType&&t.mimeType.search("ttml")>=0&&(e=!0),e};r.captionData=e,r.lang=t.lang,r.label=t.id,r.index=t.index,r.isTTML=o(),r.video=U.getElement(),r.defaultTrack=x(t),r.isFragmented=R,r.isEmbedded=!!t.isEmbedded,r.kind=n();var i=(z?z.length:0)+j.length;E.addTextTrack(r,i)}var n,o,i,s,l,d,c,f=t.mediaInfo,g=f.type,m=f.mimeType,p=f.codec||m;if(!p)return void b("No text type defined");if("fragmentedText"===g)if(N)if(d=B.getSamplesInfo(e),o=d.sampleList,!H&&o.length>0&&(H=o[0].cts-t.start*A),p.search("stpp")>=0)for(S=null!==S?S:h(p),i=0;i<o.length;i++){var v=o[i],T=v.cts,_=T-H;this.buffered.add(_/A,(_+v.duration)/A);var y=new DataView(e,v.offset,v.subSizes[0]);c=_codemIsoboxer2.default.Utils.dataViewToString(y,"utf-8");var C=[],k=v.offset+v.subSizes[0];for(s=1;s<v.subSizes.length;s++){var M=new Uint8Array(e,k,v.subSizes[s]),I=String.fromCharCode.apply(null,M);C.push(I),k+=v.subSizes[s]}try{n=S.parse(c,T/A,(T+v.duration)/A,C),E.addCaptions(W,H/A,n)}catch(e){b("TTML parser error: "+e.message)}}else{var P=[];for(i=0;i<o.length;i++){var D=o[i];D.cts-=H,this.buffered.add(D.cts/A,(D.cts+D.duration)/A);var q=e.slice(D.offset,D.offset+D.size),F=_codemIsoboxer2.default.parseBuffer(q);for(s=0;s<F.boxes.length;s++){var V=F.boxes[s];if(b("VTT box1: "+V.type),"vtte"!==V.type&&"vttc"===V.type)for(b("VTT vttc boxes.length = "+V.boxes.length),l=0;l<V.boxes.length;l++){var O=V.boxes[l];if(b("VTT box2: "+O.type),"payl"===O.type){var L=O.cue_text;b("VTT cue_text = "+L);var J=D.cts/A,X=(D.cts+D.duration)/A;P.push({start:J,end:X,data:L,styles:{}}),b("VTT "+J+"-"+X+" : "+L)}}}}P.length>0&&E.addCaptions(W,0,P)}else{for(N=!0,i=0;i<z.length;i++)r(null,z[i]);A=B.getMediaTimescaleFromMoov(e)}else if("text"===g){var y=new DataView(e,0,e.byteLength);c=_codemIsoboxer2.default.Utils.dataViewToString(y,"utf-8");try{n=h(p).parse(c),r(n,f)}catch(e){w.timedTextError(e,"parse",c)}}else if("video"===g)if("InitializationSegment"===t.segmentType){if(0===$)for($=B.getMediaTimescaleFromMoov(e),i=0;i<j.length;i++)r(null,j[i])}else{if(0===$)return void b("CEA-608: No timescale for embeddedTextTrack yet");var Y=function(e,t){function r(e,r,a){var n=null;if(U.getTTMLRenderingDiv())n=u(U.getElement(),e,r,a);else{var o=a.getDisplayText();n=[{start:e,end:r,data:o,styles:{}}]}n&&E.addCaptions(t,0,n)}return r};d=B.getSamplesInfo(e);var Z=d.sequenceNumber;if(!Q[0]&&!Q[1]){var ee=void 0,te=void 0,re=void 0;for(i=0;i<j.length;i++){if("CC1"===j[i].id?(ee=0,re=E.getTrackIdxForId("CC1")):"CC3"===j[i].id&&(ee=1,re=E.getTrackIdxForId("CC3")),re===-1)return void b("CEA-608: data before track is ready.");te=Y(this,re),Q[i]=new _externalsCea608Parser2.default.Cea608Parser(i,{newCue:te},null)}}if($&&K.indexOf(Z)==-1){if(null!==G&&Z!==G+1)for(i=0;i<Q.length;i++)Q[i]&&Q[i].reset();for(var ae=a(e),ne=0;ne<Q.length;ne++){var oe=ae.fields[ne],ie=Q[ne];if(ie){for(i=0;i<oe.length;i++)ie.addData(oe[i][0]/$,oe[i][1]);ae.endTime&&ie.cueSplitAtTime(ae.endTime/$)}}G=Z,K.push(Z)}}}function a(e){var t=function(e,t,r){var a=e.length;if(a>0){if(t>=e[a-1][0])e.push([t,r]);else for(var n=a-1;n>=0;n--)if(t<e[n][0]){e.splice(n,0,[t,r]);break}}else e.push([t,r])},r=M.parse(e),a=r.getBox("moof"),n=r.getBox("tfdt"),o=r.getBox("tfhd"),i=r.getBoxes("trun"),s=null;if(0===i.length)return null;s=i[0],i.length>1&&b("Warning: Too many truns");for(var l=a.offset+s.data_offset,d=s.sample_count,u=l,c=n.baseMediaDecodeTime,f=new DataView(e),g={startTime:null,endTime:null,fields:[[],[]]},m=0,p=0;p<d;p++){var v=s.samples[p];void 0===v.sample_duration&&(v.sample_duration=o.default_sample_duration),void 0===v.sample_size&&(v.sample_size=o.default_sample_size),void 0===v.sample_composition_time_offset&&(v.sample_composition_time_offset=0);for(var x=c+m+v.sample_composition_time_offset,h=_externalsCea608Parser2.default.findCea608Nalus(f,u,v.sample_size),T=0;T<h.length;T++)for(var _=_externalsCea608Parser2.default.extractCea608DataFromRange(f,h[T]),y=0;y<2;y++)_[y].length>0&&t(g.fields[y],x,_[y]);m+=v.sample_duration,u+=v.sample_size}var C=c+m;return g.startTime=c,g.endTime=C,g}function n(e){for(var t="",r=0;r<e.length;++r){var a=e[r];t+=a.uchar}var n=t.length,o=t.replace(/^\s+/,"").length;return n-o}function o(e){return"left: "+3.125*e.x+"%; top: "+6.66*e.y1+"%; width: "+(100-3.125*e.x)+"%; height: "+6.66*Math.max(e.y2-1-e.y1,1)+"%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;"}function i(e){return"red"==e?"rgb(255, 0, 0)":"green"==e?"rgb(0, 255, 0)":"blue"==e?"rgb(0, 0, 255)":"cyan"==e?"rgb(0, 255, 255)":"magenta"==e?"rgb(255, 0, 255)":"yellow"==e?"rgb(255, 255, 0)":"white"==e?"rgb(255, 255, 255)":"black"==e?"rgb(0, 0, 0)":e}function s(e,t){var r=e.videoHeight/15;return t?"font-size: "+r+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; color: "+(t.foreground?i(t.foreground):"rgb(255, 255, 255)")+"; font-style: "+(t.italics?"italic":"normal")+"; text-decoration: "+(t.underline?"underline":"none")+"; white-space: pre; background-color: "+(t.background?i(t.background):"transparent")+";":"font-size: "+r+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;"}function l(e){var t=e.replace(/^\s+/g,"");return t}function d(e){var t=e.replace(/\s+$/g,"");return t}function u(e,t,r,a){var i=null,u=null,c=!1,f=-1,g={start:t,end:r,spans:[]},m="style_cea608_white_black",p={},v={},x=[],h=void 0,T=void 0;for(h=0;h<15;++h){var _=a.rows[h],b="",y=null;if(!1===_.isEmpty()){var k=n(_.chars);null===i&&(i={x:k,y1:h,y2:h+1,p:[]}),k!==f&&c&&(i.p.push(g),g={start:t,end:r,spans:[]},i.y2=h,i.name="region_"+i.x+"_"+i.y1+"_"+i.y2,!1===p.hasOwnProperty(i.name)?(x.push(i),p[i.name]=i):(u=p[i.name],u.p.contat(i.p)),i={x:k,y1:h,y2:h+1,p:[]});for(var M=0;M<_.chars.length;++M){var w=_.chars[M],I=w.penState;if(null===y||!I.equals(y)){b.trim().length>0&&(g.spans.push({name:m,line:b,row:h}),b="");var P="style_cea608_"+I.foreground+"_"+I.background;I.underline&&(P+="_underline"),I.italics&&(P+="_italics"),v.hasOwnProperty(P)||(v[P]=JSON.parse(JSON.stringify(I))),y=I,m=P}b+=w.uchar}b.trim().length>0&&g.spans.push({name:m,line:b,row:h}),c=!0,f=k}else c=!1,f=-1,i&&(i.p.push(g),g={start:t,end:r,spans:[]},i.y2=h,i.name="region_"+i.x+"_"+i.y1+"_"+i.y2,!1===p.hasOwnProperty(i.name)?(x.push(i),p[i.name]=i):(u=p[i.name],u.p.contat(i.p)),i=null)}i&&(i.p.push(g),i.y2=h+1,i.name="region_"+i.x+"_"+i.y1+"_"+i.y2,!1===p.hasOwnProperty(i.name)?(x.push(i),p[i.name]=i):(u=p[i.name],u.p.contat(i.p)),i=null);var D=[];for(h=0;h<x.length;++h){var S=x[h],q="sub_cea608_"+C++,F=document.createElement("div");F.id=q;var B=o(S);F.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+B;var z=document.createElement("div");z.className="paragraph bodyStyle",z.style.cssText=s(e);var E=document.createElement("div");E.className="cueUniWrapper",E.style.cssText="unicode-bidi: normal; direction: ltr;";for(var R=0;R<S.p.length;++R){var V=S.p[R],N=0;for(T=0;T<V.spans.length;++T){var A=V.spans[T];if(A.line.length>0){if(0!==T&&N!=A.row){var O=document.createElement("br");O.className="lineBreak",E.appendChild(O)}var U=!1;N===A.row&&(U=!0),N=A.row;var L=v[A.name],H=document.createElement("span");H.className="spanPadding "+A.name+" customSpanColor",H.style.cssText=s(e,L),0!==T&&U?T===V.spans.length-1?H.textContent=d(A.line):H.textContent=A.line:0===T&&V.spans.length>1&&A.row===V.spans[1].row?H.textContent=l(A.line):H.textContent=A.line.trim(),E.appendChild(H)}}}z.appendChild(E),F.appendChild(z);var W={bodyStyle:["%",90]};for(T in v)v.hasOwnProperty(T)&&(W[T]=["%",90]);D.push({type:"html",start:t,end:r,cueHTMLElement:F,cueID:q,cellResolution:[32,15],isFromCEA608:!0,regions:x,regionID:S.name,videoHeight:e.videoHeight,videoWidth:e.videoWidth,fontSize:W,lineHeight:{},linePadding:{}})}return D}function c(){E.deleteAllTextTracks(),D=!1,S=null,B=null,z=null,E=null,R=!1,V=null,N=!1,A=NaN,O=[],U=null,L=null,y=!1,j=null}function f(e){y||t(),"CC1"===e.id||"CC3"===e.id?j.push(e):b("Warning: Embedded track "+e.id+" not supported!")}function g(){y=!1,j=[],Q=[null,null],K=[],G=null}function m(){return D}function p(e){e&&(e.errHandler&&(w=e.errHandler),e.dashManifestModel&&(I=e.dashManifestModel),e.mediaController&&(P=e.mediaController),e.videoModel&&(U=e.videoModel),e.streamController&&(L=e.streamController),e.textTracks&&(E=e.textTracks),e.VTTParser&&(q=e.VTTParser),e.TTMLParser&&(F=e.TTMLParser))}function v(){for(var e=U.getElement(),t=e.textTracks,r=t.length,a=r-j.length,n=E.getCurrentTrackIdx(),o=0;o<r;o++){var i=t[o];if(D="showing"!==i.mode,"showing"===i.mode){if(n!==o&&(E.setCurrentTrackIdx(o),E.addCaptions(o,0,null),R&&o<a)){var s=P.getCurrentTrackFor("fragmentedText",L.getActiveStreamInfo()),l=O[o];l!==s&&(V.abortRequests(),E.deleteTrackCues(s),P.setTrack(l),W=o)}break}}D&&E.setCurrentTrackIdx(-1)}function x(e){var t=!1;return j.length>1&&e.isEmbedded?t=e.id&&"CC1"===e.id:1===j.length?e.id&&"CC"===e.id.substring(0,2)&&(t=!0):0===j.length&&(t=e.index===z[0].index),t}function h(e){var t;return e.search("vtt")>=0?t=q:(e.search("ttml")>=0||e.search("stpp")>=0)&&(t=F,t.setConfig({videoModel:U})),t}function T(){return E.getCurrentTrackIdx()}var _=this.context,b=(0,_coreDebug2.default)(_).getInstance().log,y=!1,C=0,k=void 0,M=void 0,w=void 0,I=void 0,P=void 0,D=void 0,S=void 0,q=void 0,F=void 0,B=void 0,z=void 0,E=void 0,R=void 0,V=void 0,N=void 0,A=void 0,O=void 0,U=void 0,L=void 0,H=void 0,W=void 0,j=void 0,J=void 0,$=void 0,G=void 0,K=void 0,Q=void 0;return k={initialize:e,append:r,abort:c,getCurrentTrackIdx:T,getAllTracksAreDisabled:m,setTextTrack:v,setConfig:p,addEmbeddedTrack:f,resetEmbedded:g}}Object.defineProperty(exports,"__esModule",{value:!0});var _voTextTrackInfo=require("./vo/TextTrackInfo"),_voTextTrackInfo2=_interopRequireDefault(_voTextTrackInfo),_dashUtilsFragmentedTextBoxParser=require("../dash/utils/FragmentedTextBoxParser"),_dashUtilsFragmentedTextBoxParser2=_interopRequireDefault(_dashUtilsFragmentedTextBoxParser),_utilsBoxParser=require("./utils/BoxParser"),_utilsBoxParser2=_interopRequireDefault(_utilsBoxParser),_utilsCustomTimeRanges=require("./utils/CustomTimeRanges"),_utilsCustomTimeRanges2=_interopRequireDefault(_utilsCustomTimeRanges),_coreFactoryMaker=require("../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_coreDebug=require("../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug),_modelsVideoModel=require("./models/VideoModel"),_modelsVideoModel2=_interopRequireDefault(_modelsVideoModel),_TextTracks=require("./TextTracks"),_TextTracks2=_interopRequireDefault(_TextTracks),_codemIsoboxer=require("codem-isoboxer"),_codemIsoboxer2=_interopRequireDefault(_codemIsoboxer),_externalsCea608Parser=require("../../externals/cea608-parser"),_externalsCea608Parser2=_interopRequireDefault(_externalsCea608Parser);TextSourceBuffer.__dashjs_factory_name="TextSourceBuffer",exports.default=_coreFactoryMaker2.default.getSingletonFactory(TextSourceBuffer),module.exports=exports.default;
},{"../../externals/cea608-parser":9,"../core/Debug":13,"../core/FactoryMaker":15,"../dash/utils/FragmentedTextBoxParser":38,"./TextTracks":63,"./models/VideoModel":110,"./utils/BoxParser":152,"./utils/CustomTimeRanges":154,"./vo/TextTrackInfo":177,"codem-isoboxer":7}],63:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function TextTracks(){function e(){b=window.VTTCue||window.TextTrackCue,I=[],S=[],H=-1,F=0,M=0,R=0,A=0,P=null,B=null,O=!1,N=2147483647,q=!!navigator.userAgent.match(/Chrome/)&&!navigator.userAgent.match(/Edge/),void 0!==document.fullscreenElement?L="fullscreenElement":void 0!==document.webkitIsFullScreen?L="webkitIsFullScreen":document.msFullscreenElement?L="msFullscreenElement":document.mozFullScreen&&(L="mozFullScreen")}function t(e){var t=I[e].kind,i=void 0!==I[e].label?I[e].label:I[e].lang,n=I[e].lang,l=q?document.createElement("track"):D.addTextTrack(t,i,n);return q&&(l.kind=t,l.label=i,l.srclang=n),l}function i(e){O=e,P&&!document[L]&&(P.style.zIndex=e?N:null)}function n(e,i){if(I.length===i)return void _("Trying to add too many tracks.");if(I.push(e),void 0===D&&(D=e.video),I.length===i){I.sort(function(e,t){return e.index-t.index}),P=z.getTTMLRenderingDiv();for(var n=-1,l=0;l<I.length;l++){var r=t.call(this,l);S.push(r),I[l].defaultTrack&&(r.default=!0,n=l),q&&D.appendChild(r);var s=D.textTracks[l];s.nonAddedCues=[],P&&(I[l].isTTML||I[l].isEmbedded)?s.renderingType="html":s.renderingType="default",this.addCaptions(l,0,I[l].captionData),E.trigger(_coreEventsEvents2.default.TEXT_TRACK_ADDED)}if(g.call(this,n),n>=0){for(var o=0;o<D.textTracks.length;o++)D.textTracks[o].mode=o===n?"showing":"hidden";this.addCaptions(n,0,null)}E.trigger(_coreEventsEvents2.default.TEXT_TRACKS_ADDED,{index:H,tracks:I})}}function l(e,t,i,n,l,r){var s=e/t,o=i/n,a=0,d=0;s>o?(d=t,a=d/n*i):(a=e,d=a/i*n);var c=0,u=0,h=0,g=0,v=a/d;return v>l?(g=d,h=d/(1/l),c=(e-h)/2,u=0):(h=a,g=a/l,c=0,u=(t-g)/2),r?{x:c+.1*h,y:u+.1*g,w:.8*h,h:.8*g}:{x:c,y:u,w:h,h:g}}function r(){var e=this.getCurrentTextTrack();if(e&&"html"===e.renderingType){var t=D.clientWidth/D.clientHeight,i=!1;e.isFromCEA608&&(t=3.5/3,i=!0);var n=l.call(this,D.clientWidth,D.clientHeight,D.videoWidth,D.videoHeight,t,i),r=n.w,s=n.h;if(r!=R||s!=A){F=n.x,M=n.y,R=r,A=s,P.style.left=F+"px",P.style.top=M+"px",P.style.width=R+"px",P.style.height=A+"px";for(var o=0;e.activeCues&&o<e.activeCues.length;++o){var a=e.activeCues[o];a.scaleCue(a)}L&&document[L]||O?P.style.zIndex=N:P.style.zIndex=null}}}function s(e,t){var i=Math.round(.01*e*t).toString()+"px";return i}function o(e){var t=R,i=A;if(t*i!==0&&e.layout){var n=e.layout,l=s(n.left,t),r=s(n.top,i),o=s(n.width,t),a=s(n.height,i);P.style.left=l,P.style.top=r,P.style.width=o,P.style.height=a;var d=P.firstChild;d&&d.style&&(d.style.left="0px",d.style.top="0px",d.style.width=o,d.style.height=a)}}function a(e){var t,i,n,l,r,s=R,o=A,a=[s/e.cellResolution[0],o/e.cellResolution[1]];if(e.linePadding)for(t in e.linePadding)if(e.linePadding.hasOwnProperty(t)){var d=e.linePadding[t];i=(d*a[0]).toString();for(var c=document.getElementsByClassName("spanPadding"),u=0;u<c.length;u++)c[u].style.cssText=c[u].style.cssText.replace(/(padding-left\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+i),c[u].style.cssText=c[u].style.cssText.replace(/(padding-right\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+i)}if(e.fontSize)for(t in e.fontSize)if(e.fontSize.hasOwnProperty(t)){"%"===e.fontSize[t][0]?n=e.fontSize[t][1]/100:"c"===e.fontSize[t][0]&&(n=e.fontSize[t][1]),i=(n*a[1]).toString(),r="defaultFontSize"!==t?document.getElementsByClassName(t):document.getElementsByClassName("paragraph");for(var h=0;h<r.length;h++)r[h].style.cssText=r[h].style.cssText.replace(/(font-size\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+i)}if(e.lineHeight)for(t in e.lineHeight)if(e.lineHeight.hasOwnProperty(t)){"%"===e.lineHeight[t][0]?l=e.lineHeight[t][1]/100:"c"===e.fontSize[t][0]&&(l=e.lineHeight[t][1]),i=(l*a[1]).toString(),r=document.getElementsByClassName(t);for(var g=0;g<r.length;g++)r[g].style.cssText=r[g].style.cssText.replace(/(line-height\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+i)}}function d(e,t,i){var n=e>=0?D.textTracks[e]:null,l=this;if(n){if("showing"!==n.mode)return void(i&&i.length>0&&(n.nonAddedCues=n.nonAddedCues.concat(i)));if(i||(i=n.nonAddedCues,n.nonAddedCues=[]),i&&0!==i.length)for(var s in i){var d,c=i[s];n.cellResolution=c.cellResolution,n.isFromCEA608=c.isFromCEA608,B||"html"!==c.type&&"image"!==c.type||(B=setInterval(r.bind(this),500)),"image"===c.type?(d=new b(c.start-t,c.end-t,""),d.image=c.data,d.id=c.id,d.size=0,d.type="image",d.layout=c.layout,d.scaleCue=o.bind(l),d.onenter=function(){if(P&&"showing"===n.mode){var e=new Image;e.id="ttmlImage_"+this.id,e.src=this.image,e.style.cssText="z-index: 2147483648; pointer-events: none; display: block; visibility: visible !important; position: relative !important;",P.appendChild(e),o.call(l,this)}},d.onexit=function(){if(P)for(var e=P.childNodes,t=0;t<e.length;t++)e[t].id==="ttmlImage_"+this.id&&P.removeChild(e[t])}):"html"===c.type?(d=new b(c.start-t,c.end-t,""),d.cueHTMLElement=c.cueHTMLElement,d.regions=c.regions,d.regionID=c.regionID,d.cueID=c.cueID,d.videoWidth=c.videoWidth,d.videoHeight=c.videoHeight,d.cellResolution=c.cellResolution,d.fontSize=c.fontSize,d.lineHeight=c.lineHeight,d.linePadding=c.linePadding,d.scaleCue=a.bind(l),P.style.left=F+"px",P.style.top=M+"px",P.style.width=R+"px",P.style.height=A+"px",d.onenter=function(){"showing"===n.mode&&(_("Cue "+this.startTime+"-"+this.endTime+" : "+this.cueHTMLElement.id+" : "+this.cueHTMLElement.innerText),P.appendChild(this.cueHTMLElement),a.call(l,this))},d.onexit=function(){for(var e=P.childNodes,t=0;t<e.length;++t)e[t].id===this.cueID&&P.removeChild(e[t])}):(d=new b(c.start-t,c.end-t,c.data),c.styles&&(void 0!==c.styles.align&&d.hasOwnProperty("align")&&(d.align=c.styles.align),void 0!==c.styles.line&&d.hasOwnProperty("line")&&(d.line=c.styles.line),void 0!==c.styles.position&&d.hasOwnProperty("position")&&(d.position=c.styles.position),void 0!==c.styles.size&&d.hasOwnProperty("size")&&(d.size=c.styles.size))),n.addCue(d)}}}function c(){return H>=0?D.textTracks[H]:null}function u(){return H}function h(e){for(var t=-1,i=0;i<D.textTracks.length;i++)if(D.textTracks[i].label===e){t=i;break}return t}function g(e){if(H=e,x.call(this),e>=0){var t=D.textTracks[e];"html"===t.renderingType?m.call(this):T.call(this)}else T.call(this)}function v(e){return D.textTracks[e]}function f(e){if(e.cues){for(var t=e.cues,i=t.length-1,n=i;n>=0;n--)e.removeCue(t[n]);e.mode="disabled"}}function p(){for(var e=S.length,t=0;t<e;t++)if(q)D.removeChild(S[t]);else{var i=v.call(this,t);i.nonAddedCues=[],f.call(this,i)}S=[],I=[],B&&(clearInterval(B),B=null),x.call(this)}function y(e){D.removeChild(S[e]),S.splice(e,1)}function m(){if(q){var e=document.getElementById("native-cue-style");if(!e){e=document.createElement("style"),e.id="native-cue-style",document.head.appendChild(e);var t=e.sheet;D.id?t.insertRule("#"+D.id+"::cue {background: transparent}",0):0!==D.classList.length?t.insertRule("."+D.className+"::cue {background: transparent}",0):t.insertRule("video::cue {background: transparent}",0)}}}function T(){if(q){var e=document.getElementById("native-cue-style");e&&document.head.removeChild(e)}}function x(){if(P)for(;P.firstChild;)P.removeChild(P.firstChild)}function C(e){e&&e.videoModel&&(z=e.videoModel)}var k=this.context,E=(0,_coreEventBus2.default)(k).getInstance(),_=(0,_coreDebug2.default)(k).getInstance().log,w=void 0,b=void 0,z=void 0,D=void 0,I=void 0,S=void 0,H=void 0,F=void 0,M=void 0,R=void 0,A=void 0,P=void 0,B=void 0,q=void 0,L=void 0,O=void 0,N=void 0;return w={initialize:e,displayCConTop:i,addTextTrack:n,addCaptions:d,getTextTrack:v,getCurrentTextTrack:c,getCurrentTrackIdx:u,setCurrentTrackIdx:g,getTrackIdxForId:h,deleteTrackCues:f,deleteAllTextTracks:p,deleteTextTrack:y,setConfig:C}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreEventBus=require("../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreEventsEvents=require("../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_coreFactoryMaker=require("../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_coreDebug=require("../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug);TextTracks.__dashjs_factory_name="TextTracks",exports.default=_coreFactoryMaker2.default.getSingletonFactory(TextTracks),module.exports=exports.default;
},{"../core/Debug":13,"../core/EventBus":14,"../core/FactoryMaker":15,"../core/events/Events":18}],64:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XHRLoader(e){function t(){var e;T=[],_=[],c=[],e={},_defineProperty(e,_voMetricsHTTPRequest.HTTPRequest.MPD_TYPE,_utilsErrorHandlerJs2.default.DOWNLOAD_ERROR_ID_MANIFEST),_defineProperty(e,_voMetricsHTTPRequest.HTTPRequest.XLINK_EXPANSION_TYPE,_utilsErrorHandlerJs2.default.DOWNLOAD_ERROR_ID_XLINK),_defineProperty(e,_voMetricsHTTPRequest.HTTPRequest.INIT_SEGMENT_TYPE,_utilsErrorHandlerJs2.default.DOWNLOAD_ERROR_ID_INITIALIZATION),_defineProperty(e,_voMetricsHTTPRequest.HTTPRequest.MEDIA_SEGMENT_TYPE,_utilsErrorHandlerJs2.default.DOWNLOAD_ERROR_ID_CONTENT),_defineProperty(e,_voMetricsHTTPRequest.HTTPRequest.INDEX_SEGMENT_TYPE,_utilsErrorHandlerJs2.default.DOWNLOAD_ERROR_ID_CONTENT),_defineProperty(e,_voMetricsHTTPRequest.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,_utilsErrorHandlerJs2.default.DOWNLOAD_ERROR_ID_CONTENT),_defineProperty(e,_voMetricsHTTPRequest.HTTPRequest.OTHER_TYPE,_utilsErrorHandlerJs2.default.DOWNLOAD_ERROR_ID_CONTENT),f=e}function r(e,t){var o=e.request,s=new XMLHttpRequest,a=[],d=!0,R=!0,p=new Date,y=p,E=0,D=function(e){R=!1,o.requestStartDate=p,o.requestEndDate=new Date,o.firstByteDate=o.firstByteDate||p,o.checkExistenceOnly||i.addHttpRequest(o.mediaType,null,o.type,o.url,s.responseURL||null,o.serviceLocation||null,o.range||null,o.requestStartDate,o.firstByteDate,o.requestEndDate,s.status,o.duration,s.getAllResponseHeaders(),e?a:null)},H=function(){T.indexOf(s)!==-1&&(T.splice(T.indexOf(s),1),R&&(D(!1),t>0?(t--,c.push(setTimeout(function(){r(e,t)},n.getRetryIntervalForType(o.type)))):(u.downloadError(f[o.type],o.url,o),e.error&&e.error(o,"error",s.statusText),e.complete&&e.complete(o,s.statusText))))},P=function(t){var r=new Date;d&&(d=!1,(!t.lengthComputable||t.lengthComputable&&t.total!==t.loaded)&&(o.firstByteDate=r)),t.lengthComputable&&(o.bytesLoaded=t.loaded,o.bytesTotal=t.total),a.push({s:y,d:r.getTime()-y.getTime(),b:[t.loaded?t.loaded-E:0]}),y=r,E=t.loaded,e.progress&&e.progress()},q=function(){s.status>=200&&s.status<=299&&(D(!0),e.success&&e.success(s.response,s.statusText,s),e.complete&&e.complete(o,s.statusText))};try{var M=l.modifyRequestURL(o.url),O=o.checkExistenceOnly?"HEAD":"GET";s.open(O,M,!0),o.responseType&&(s.responseType=o.responseType),o.range&&s.setRequestHeader("Range","bytes="+o.range),o.requestStartDate||(o.requestStartDate=p),s=l.modifyRequestHeader(s),s.withCredentials=n.getXHRWithCredentialsForType(o.type),s.onload=q,s.onloadend=H,s.onerror=H,s.onprogress=P;var m=(new Date).getTime();isNaN(o.delayLoadingTime)||m>=o.delayLoadingTime?(T.push(s),s.send()):!function(){var e={xhr:s};_.push(e),e.delayTimeout=setTimeout(function(){if(_.indexOf(e)!==-1){_.splice(_.indexOf(e),1);try{T.push(e.xhr),e.xhr.send()}catch(t){e.xhr.onerror()}}},o.delayLoadingTime-m)}()}catch(e){s.onerror()}}function o(e){e.request&&r(e,n.getRetryAttemptsForType(e.request.type))}function s(){c.forEach(function(e){return clearTimeout(e)}),c=[],_.forEach(function(e){return clearTimeout(e.delayTimeout)}),_=[],T.forEach(function(e){e.onloadend=e.onerror=e.onprogress=void 0,e.abort()}),T=[]}var a=this.context,n=(0,_modelsMediaPlayerModel2.default)(a).getInstance(),u=e.errHandler,i=e.metricsModel,l=e.requestModifier,d=void 0,T=void 0,_=void 0,c=void 0,f=void 0;return d={load:o,abort:s},t(),d}Object.defineProperty(exports,"__esModule",{value:!0});var _voMetricsHTTPRequest=require("./vo/metrics/HTTPRequest"),_coreFactoryMaker=require("../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_modelsMediaPlayerModel=require("./models/MediaPlayerModel"),_modelsMediaPlayerModel2=_interopRequireDefault(_modelsMediaPlayerModel),_utilsErrorHandlerJs=require("./utils/ErrorHandler.js"),_utilsErrorHandlerJs2=_interopRequireDefault(_utilsErrorHandlerJs);XHRLoader.__dashjs_factory_name="XHRLoader";var factory=_coreFactoryMaker2.default.getClassFactory(XHRLoader);exports.default=factory,module.exports=exports.default;
},{"../core/FactoryMaker":15,"./models/MediaPlayerModel":107,"./utils/ErrorHandler.js":157,"./vo/metrics/HTTPRequest":185}],65:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function XlinkLoader(e){function r(e,r,t){var u=function(o,u){r.resolved=!0,r.resolvedContent=o?o:null,n.trigger(_coreEventsEvents2.default.XLINK_ELEMENT_LOADED,{element:r,resolveObject:t,error:o||u?null:new _voError2.default(XLINK_LOADER_ERROR_LOADING_FAILURE,"Failed loading Xlink element: "+e)})};if(e===o)u(null,!0);else{var a=new _voTextRequest2.default(e,_voMetricsHTTPRequest.HTTPRequest.XLINK_TYPE);_.load({request:a,success:function(e){u(e)},error:function(){u(null)}})}}function t(){_&&(_.abort(),_=null)}var o="urn:mpeg:dash:resolve-to-zero:2013",u=this.context,n=(0,_coreEventBus2.default)(u).getInstance(),_=(0,_XHRLoader2.default)(u).create({errHandler:e.errHandler,metricsModel:e.metricsModel,requestModifier:e.requestModifier}),a=void 0;return a={load:r,reset:t}}Object.defineProperty(exports,"__esModule",{value:!0});var _voError=require("./vo/Error"),_voError2=_interopRequireDefault(_voError),_XHRLoader=require("./XHRLoader"),_XHRLoader2=_interopRequireDefault(_XHRLoader),_voMetricsHTTPRequest=require("./vo/metrics/HTTPRequest"),_voTextRequest=require("./vo/TextRequest"),_voTextRequest2=_interopRequireDefault(_voTextRequest),_coreEventBus=require("../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreEventsEvents=require("../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_coreFactoryMaker=require("../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),XLINK_LOADER_ERROR_LOADING_FAILURE=1;XlinkLoader.__dashjs_factory_name="XlinkLoader";var factory=_coreFactoryMaker2.default.getClassFactory(XlinkLoader);factory.XLINK_LOADER_ERROR_LOADING_FAILURE=XLINK_LOADER_ERROR_LOADING_FAILURE,exports.default=factory,module.exports=exports.default;
},{"../core/EventBus":14,"../core/FactoryMaker":15,"../core/events/Events":18,"./XHRLoader":64,"./vo/Error":168,"./vo/TextRequest":176,"./vo/metrics/HTTPRequest":185}],66:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function AbrController(){function e(){W={video:!0,audio:!0},z={},K={},X={},Z={},$={},te={},ee={},ve={},oe=!1,ie=!1,void 0===ae&&(ae=!1),ce=(0,_utilsDOMStorage2.default)(U).getInstance(),fe=(0,_modelsMediaPlayerModel2.default)(U).getInstance(),ue=(0,_modelsManifestModel2.default)(U).getInstance(),le=(0,_dashModelsDashManifestModel2.default)(U).getInstance(),de=(0,_modelsVideoModel2.default)(U).getInstance(),he=(0,_modelsMetricsModelJs2.default)(U).getInstance(),Me=(0,_dashDashMetricsJs2.default)(U).getInstance(),me=(new Date).getTime()/1e3}function t(e,t){ve[e]=(0,_rulesSwitchRequestHistoryJs2.default)(U).create(),ee[e]=t,te[e]=te[e]||{},te[e].state=ALLOW_LOAD,G.on(_coreEventsEvents2.default.LOADING_PROGRESS,Q,this),"video"==e&&(G.on(_MediaPlayerEventsJs2.default.QUALITY_CHANGE_RENDERED,i,this),ge=(0,_rulesDroppedFramesHistoryJs2.default)(U).create(),C())}function r(){G.off(_coreEventsEvents2.default.LOADING_PROGRESS,Q,this),G.off(_MediaPlayerEventsJs2.default.QUALITY_CHANGE_RENDERED,i,this),_e=void 0,ge=void 0,clearTimeout(re),re=null,e()}function o(e){e&&(e.abrRulesCollection&&(j=e.abrRulesCollection),e.streamController&&(Y=e.streamController))}function i(e){"video"===e.mediaType&&(_e=e.newQuality,ge.push(_e,de.getPlaybackQuality()))}function a(e,t){var r;return z[t]=z[t]||{},z[t].hasOwnProperty(e)||(z[t][e]=0),r=S(z[t][e],e),r=N(r,e,z[t][e]),r=J(r,e)}function n(e){var t=ce.getSavedBitrateSettings(e);if(!X.hasOwnProperty(e))if(Z.hasOwnProperty(e)){var r=ue.getValue(),o=le.getAdaptationForType(r,0,e).Representation;if(Array.isArray(o)){var i=Math.max(Math.round(o.length*Z[e])-1,0);X[e]=o[i].bandwidth}else X[e]=0}else isNaN(t)?X[e]="video"===e?DEFAULT_VIDEO_BITRATE:DEFAULT_AUDIO_BITRATE:X[e]=t;return X[e]}function s(e,t){X[e]=t}function u(e){return Z.hasOwnProperty(e)?Z[e]:null}function l(e,t){Z[e]=t}function d(e){return X.hasOwnProperty("max")&&X.max.hasOwnProperty(e)?X.max[e]:NaN}function f(e,t){X.max=X.max||{},X.max[e]=t}function c(e){return Z.hasOwnProperty("max")&&Z.max.hasOwnProperty(e)?Z.max[e]:1}function _(e,t){Z.max=Z.max||{},Z.max[e]=t}function v(e){return W[e]}function g(e,t){W[e]=t}function h(){return oe}function M(e){oe=e}function m(){return ie}function y(e){ie=e}function D(e){var t=e.getType(),r=e.getStreamInfo(),o=r.id,i=B(t,r),n=(0,_rulesRulesContextJs2.default)(U).create({streamProcessor:e,currentValue:i,playbackIndex:_e,switchHistory:ve[t],droppedFramesHistory:ge,hasRichBuffer:I(t)});if(ge&&ge.push(_e,de.getPlaybackQuality()),v(t)){var s=a(t,o),u=j.getMaxQuality(n),l=u.value;if(l>s&&(l=s),ve[t].push({oldValue:i,newValue:l}),l>_rulesSwitchRequestJs2.default.NO_CHANGE&&l!=i)(te[t].state===ALLOW_LOAD||l>i)&&A(t,r,i,l,s,u.reason);else if(H.getLogToBrowserConsole()){var d=Me.getCurrentBufferLevel(he.getReadOnlyMetricsFor(t));V("AbrController ("+t+") stay on "+i+"/"+s+" (buffer: "+d+")")}}}function p(e,t,r,o){var i=t.id,n=B(e,t),s=null!==r&&!isNaN(r)&&r%1===0;if(!s)throw new Error("argument is not an integer");var u=a(e,i);r!==n&&r>=0&&r<=u&&A(e,t,n,r,u,o)}function A(e,t,r,o,i,a){if(H.getLogToBrowserConsole()){var n=Me.getCurrentBufferLevel(he.getReadOnlyMetricsFor(e));V("AbrController ("+e+") switch from "+r+" to "+o+"/"+i+" (buffer: "+n+")\n"+JSON.stringify(a))}P(e,t.id,o),G.trigger(_coreEventsEvents2.default.QUALITY_CHANGE_REQUESTED,{mediaType:e,streamInfo:t,oldQuality:r,newQuality:o,reason:a})}function R(e,t){te[e].state=t}function E(e){return te[e].state}function q(e,t,r){if(r&&ee[e.type].getCurrentRepresentationInfo()&&ee[e.type].getCurrentRepresentationInfo().fragmentDuration){r/=1e3;var o=ee[e.type].getCurrentRepresentationInfo().fragmentDuration;if(r>o)return 0;var i=r/o;t*=1-i}var a=w(e);if(!a||0===a.length)return QUALITY_DEFAULT;for(var n=a.length-1;n>=0;n--){var s=a[n];if(1e3*t>=s.bitrate)return n}return 0}function w(e){if(!e||!e.bitrateList)return null;for(var t,r=e.bitrateList,o=e.type,i=[],a=0,n=r.length;a<n;a++)t=new _voBitrateInfo2.default,t.mediaType=o,t.qualityIndex=a,t.bitrate=r[a].bandwidth,t.width=r[a].width,t.height=r[a].height,i.push(t);return i}function I(e){var t=he.getReadOnlyMetricsFor(e),r=Me.getCurrentBufferLevel(t),o=t.BufferState.length>0?t.BufferState[t.BufferState.length-1]:null,i=!1;return o&&r>o.target&&(i=r>o.target+fe.getRichBufferThreshold()),i}function L(e,t){$[e]=t}function F(e){return $[e]}function O(e){var t=e.type,r=e.streamInfo.id,o=e.representationCount-1;return x(t,r,o),o}function T(e){var t,r=e.id,o=B("audio",e),i=B("video",e);return t=o===a("audio",r)&&i===a("video",r)}function B(e,t){var r,o=t.id;return K[o]=K[o]||{},K[o].hasOwnProperty(e)||(K[o][e]=QUALITY_DEFAULT),r=K[o][e]}function P(e,t,r){K[t]=K[t]||{},K[t][e]=r}function x(e,t,r){z[t]=z[t]||{},z[t][e]=r}function S(e,t){var r=d(t);if(isNaN(r)||!ee[t])return e;var o=q(ee[t].getMediaInfo(),r);return Math.min(e,o)}function N(e,t,r){var o=c(t);return isNaN(o)||o>=1||o<0?e:Math.min(e,Math.round(r*o))}function b(e){ae=e}function C(){var e=de.getElement();if(void 0!==e){var t=ie&&window.hasOwnProperty("devicePixelRatio"),r=t?window.devicePixelRatio:1;ne=e.clientWidth*r,se=e.clientHeight*r}}function J(e,t){if("video"!==t||!oe||!ee[t])return e;ae||C();var r=ue.getValue(),o=le.getAdaptationForType(r,0,t).Representation,i=e;if(ne>0&&se>0){for(;i>0&&o[i]&&ne<o[i].width&&ne-o[i-1].width<o[i].width-ne;)i-=1;o.length-2>=i&&o[i].width===o[i+1].width&&(i=Math.min(e,i+1))}return i}function Q(e){var t=e.request.mediaType;if(v(t)){var r=ee[t].getScheduleController();if(!r)return;var o=(0,_rulesRulesContextJs2.default)(U).create({streamProcessor:ee[t],currentRequest:e.request,currentValue:B(t,Y.getActiveStreamInfo()),hasRichBuffer:I(t)}),i=j.shouldAbandonFragment(o);if(i.value>_rulesSwitchRequestJs2.default.NO_CHANGE){var a=r.getFragmentModel(),n=a.getRequests({state:_modelsFragmentModel2.default.FRAGMENT_MODEL_LOADING,index:e.request.index})[0];n&&(a.abortRequests(),R(t,ABANDON_LOAD),ve[t].reset(),ve[t].push({oldValue:B(t,Y.getActiveStreamInfo()),newValue:i.value,confidence:1,reason:i.reason}),p(t,Y.getActiveStreamInfo(),i.value,i.reason),G.trigger(_coreEventsEvents2.default.FRAGMENT_LOADING_ABANDONED,{streamProcessor:ee[t],request:n,mediaType:t}),clearTimeout(re),re=setTimeout(function(){R(t,ALLOW_LOAD),re=null},fe.getAbandonLoadTimeout()))}}}var U=this.context,H=(0,_coreDebug2.default)(U).getInstance(),V=H.log,G=(0,_coreEventBus2.default)(U).getInstance(),k=void 0,j=void 0,Y=void 0,W=void 0,z=void 0,K=void 0,X=void 0,Z=void 0,$=void 0,ee=void 0,te=void 0,re=void 0,oe=void 0,ie=void 0,ae=void 0,ne=void 0,se=void 0,ue=void 0,le=void 0,de=void 0,fe=void 0,ce=void 0,_e=void 0,ve=void 0,ge=void 0,he=void 0,Me=void 0,me=void 0;return k={isPlayingAtTopQuality:T,updateTopQualityIndex:O,getAverageThroughput:F,getBitrateList:w,getQualityForBitrate:q,getMaxAllowedBitrateFor:d,setMaxAllowedBitrateFor:f,getMaxAllowedRepresentationRatioFor:c,setMaxAllowedRepresentationRatioFor:_,getInitialBitrateFor:n,setInitialBitrateFor:s,getInitialRepresentationRatioFor:u,setInitialRepresentationRatioFor:l,setAutoSwitchBitrateFor:g,getAutoSwitchBitrateFor:v,setLimitBitrateByPortal:M,getLimitBitrateByPortal:h,getUsePixelRatioInLimitBitrateByPortal:m,setUsePixelRatioInLimitBitrateByPortal:y,getQualityFor:B,getAbandonmentStateFor:E,setAbandonmentStateFor:R,setPlaybackQuality:p,getPlaybackQuality:D,setAverageThroughput:L,getTopQualityIndexFor:a,setElementSize:C,setWindowResizeEventCalled:b,initialize:t,setConfig:o,reset:r},e(),k}Object.defineProperty(exports,"__esModule",{value:!0});var _voBitrateInfo=require("../vo/BitrateInfo"),_voBitrateInfo2=_interopRequireDefault(_voBitrateInfo),_utilsDOMStorage=require("../utils/DOMStorage"),_utilsDOMStorage2=_interopRequireDefault(_utilsDOMStorage),_modelsMediaPlayerModel=require("../models/MediaPlayerModel"),_modelsMediaPlayerModel2=_interopRequireDefault(_modelsMediaPlayerModel),_modelsFragmentModel=require("../models/FragmentModel"),_modelsFragmentModel2=_interopRequireDefault(_modelsFragmentModel),_coreEventBus=require("../../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreEventsEvents=require("../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_MediaPlayerEventsJs=require("../MediaPlayerEvents.js"),_MediaPlayerEventsJs2=_interopRequireDefault(_MediaPlayerEventsJs),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_modelsManifestModel=require("../models/ManifestModel"),_modelsManifestModel2=_interopRequireDefault(_modelsManifestModel),_dashModelsDashManifestModel=require("../../dash/models/DashManifestModel"),_dashModelsDashManifestModel2=_interopRequireDefault(_dashModelsDashManifestModel),_modelsVideoModel=require("../models/VideoModel"),_modelsVideoModel2=_interopRequireDefault(_modelsVideoModel),_rulesRulesContextJs=require("../rules/RulesContext.js"),_rulesRulesContextJs2=_interopRequireDefault(_rulesRulesContextJs),_rulesSwitchRequestJs=require("../rules/SwitchRequest.js"),_rulesSwitchRequestJs2=_interopRequireDefault(_rulesSwitchRequestJs),_rulesSwitchRequestHistoryJs=require("../rules/SwitchRequestHistory.js"),_rulesSwitchRequestHistoryJs2=_interopRequireDefault(_rulesSwitchRequestHistoryJs),_rulesDroppedFramesHistoryJs=require("../rules/DroppedFramesHistory.js"),_rulesDroppedFramesHistoryJs2=_interopRequireDefault(_rulesDroppedFramesHistoryJs),_modelsMetricsModelJs=require("../models/MetricsModel.js"),_modelsMetricsModelJs2=_interopRequireDefault(_modelsMetricsModelJs),_dashDashMetricsJs=require("../../dash/DashMetrics.js"),_dashDashMetricsJs2=_interopRequireDefault(_dashDashMetricsJs),_coreDebug=require("../../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug),ABANDON_LOAD="abandonload",ALLOW_LOAD="allowload",DEFAULT_VIDEO_BITRATE=1e3,DEFAULT_AUDIO_BITRATE=100,QUALITY_DEFAULT=0;AbrController.__dashjs_factory_name="AbrController";var factory=_coreFactoryMaker2.default.getSingletonFactory(AbrController);factory.ABANDON_LOAD=ABANDON_LOAD,factory.QUALITY_DEFAULT=QUALITY_DEFAULT,exports.default=factory,module.exports=exports.default;
},{"../../core/Debug":13,"../../core/EventBus":14,"../../core/FactoryMaker":15,"../../core/events/Events":18,"../../dash/DashMetrics.js":22,"../../dash/models/DashManifestModel":27,"../MediaPlayerEvents.js":58,"../models/FragmentModel":105,"../models/ManifestModel":106,"../models/MediaPlayerModel":107,"../models/MetricsModel.js":108,"../models/VideoModel":110,"../rules/DroppedFramesHistory.js":134,"../rules/RulesContext.js":135,"../rules/SwitchRequest.js":137,"../rules/SwitchRequestHistory.js":138,"../utils/DOMStorage":155,"../vo/BitrateInfo":166}],67:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function BaseURLController(){function e(e){_.invalidateSelectedIndexes(e.entry)}function t(){_=(0,_modelsBaseURLTreeModel2.default)(i).create(),d=(0,_utilsBaseURLSelector2.default)(i).create(),n.on(_coreEventsEvents2.default.SERVICE_LOCATION_BLACKLIST_CHANGED,e,u)}function r(e){e.baseURLTreeModel&&(_=e.baseURLTreeModel),e.baseURLSelector&&(d=e.baseURLSelector)}function o(e){_.update(e),d.chooseSelectorFromManifest(e)}function s(e){var t=_.getForPath(e),r=t.reduce(function(e,t){var r=d.select(t);return r?(c.isRelative(r.url)?e.url=c.resolve(r.url,e.url):(e.url=r.url,e.serviceLocation=r.serviceLocation),e):new _dashVoBaseURL2.default},new _dashVoBaseURL2.default);if(!c.isRelative(r.url))return r}function a(){_.reset(),d.reset()}function l(e){o(e)}var u=void 0,i=this.context,n=(0,_coreEventBus2.default)(i).getInstance(),c=(0,_utilsURLUtils2.default)(i).getInstance(),_=void 0,d=void 0;return u={reset:a,initialize:l,resolve:s,setConfig:r},t(),u}Object.defineProperty(exports,"__esModule",{value:!0});var _modelsBaseURLTreeModel=require("../models/BaseURLTreeModel"),_modelsBaseURLTreeModel2=_interopRequireDefault(_modelsBaseURLTreeModel),_utilsBaseURLSelector=require("../utils/BaseURLSelector"),_utilsBaseURLSelector2=_interopRequireDefault(_utilsBaseURLSelector),_utilsURLUtils=require("../utils/URLUtils"),_utilsURLUtils2=_interopRequireDefault(_utilsURLUtils),_dashVoBaseURL=require("../../dash/vo/BaseURL"),_dashVoBaseURL2=_interopRequireDefault(_dashVoBaseURL),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_coreEventBus=require("../../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreEventsEvents=require("../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents);BaseURLController.__dashjs_factory_name="BaseURLController",exports.default=_coreFactoryMaker2.default.getSingletonFactory(BaseURLController),module.exports=exports.default;
},{"../../core/EventBus":14,"../../core/FactoryMaker":15,"../../core/events/Events":18,"../../dash/vo/BaseURL":46,"../models/BaseURLTreeModel":104,"../utils/BaseURLSelector":151,"../utils/URLUtils":164}],68:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function BlackListController(e){function t(e){return!!(u.length&&e&&e.length)&&u.indexOf(e)!==-1}function r(e){u.indexOf(e)===-1&&(u.push(e),c.trigger(i,{entry:e}))}function o(e){e.error&&r(e.request.serviceLocation)}function n(){l&&c.on(l,o,this)}function a(){u=[]}var u=[],c=(0,_coreEventBus2.default)(this.context).getInstance(),i=e.updateEventName,l=e.loadFailedEventName;return n(),{add:r,contains:t,reset:a}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_coreEventBus=require("../../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus);BlackListController.__dashjs_factory_name="BlackListController",exports.default=_coreFactoryMaker2.default.getClassFactory(BlackListController),module.exports=exports.default;
},{"../../core/EventBus":14,"../../core/FactoryMaker":15}],69:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function BufferController(e){function t(){ee=_AbrController2.default.QUALITY_DEFAULT,te=!1,re=0,ne=Number.POSITIVE_INFINITY,ae=0,fe=Number.POSITIVE_INFINITY,ie=null,le=BUFFER_EMPTY,se=0,de=!1,_e=!1,ce=!1,ve=!1}function r(e,t,r){ue=e,Y(t),Te=r,me=(0,_modelsMediaPlayerModel2.default)(k).getInstance(),ge=(0,_PlaybackController2.default)(k).getInstance(),De=(0,_AbrController2.default)(k).getInstance(),Ce=(0,_utilsInitCache2.default)(k).getInstance(),Ae=Te.getScheduleController(),ee=De.getQualityFor(ue,Te.getStreamInfo()),H.on(_coreEventsEvents2.default.DATA_UPDATE_COMPLETED,B,this),H.on(_coreEventsEvents2.default.INIT_FRAGMENT_LOADED,a,this),H.on(_coreEventsEvents2.default.MEDIA_FRAGMENT_LOADED,u,this),H.on(_coreEventsEvents2.default.QUALITY_CHANGE_REQUESTED,E,this),H.on(_coreEventsEvents2.default.STREAM_COMPLETED,h,this),H.on(_coreEventsEvents2.default.PLAYBACK_PROGRESS,d,this),H.on(_coreEventsEvents2.default.PLAYBACK_TIME_UPDATED,d,this),H.on(_coreEventsEvents2.default.PLAYBACK_RATE_CHANGED,S,this),H.on(_coreEventsEvents2.default.PLAYBACK_SEEKING,s,this),H.on(_coreEventsEvents2.default.WALLCLOCK_TIME_UPDATED,L,this),H.on(_coreEventsEvents2.default.CURRENT_TRACK_CHANGED,P,this,_coreEventBus2.default.EVENT_PRIORITY_HIGH),H.on(_coreEventsEvents2.default.SOURCEBUFFER_APPEND_COMPLETED,l,this),H.on(_coreEventsEvents2.default.SOURCEBUFFER_REMOVE_COMPLETED,I,this)}function n(e){if(!e||!oe||!Te)return null;var t=null;try{t=W.createSourceBuffer(oe,e),t&&t.hasOwnProperty("initialize")&&t.initialize(ue,this)}catch(e){X.mediaSourceError("Error creating "+ue+" source buffer.")}return y(t),F(Te.getRepresentationInfoForQuality(ee).MSETimeOffset),t}function o(){return Te.getStreamInfo().id===z.getActiveStreamInfo().id}function a(e){e.fragmentModel===Te.getFragmentModel()&&(K("Init fragment finished loading saving to",ue+"'s init cache"),Ce.save(e.chunk),i(e.chunk))}function f(e,t){var r=Ce.extract(e,ue,t);r?i(r):H.trigger(_coreEventsEvents2.default.INIT_REQUESTED,{sender:$})}function u(e){if(e.fragmentModel===Te.getFragmentModel()){var t=e.chunk,r=t.bytes,n=t.quality,o=Te.getRepresentationInfoForQuality(n),a=V.getValue(),f=J.getEventsFor(a,o.mediaInfo,Te),u=J.getEventsFor(a,o,Te);if(f&&f.length>0||u&&u.length>0){var l=Te.getFragmentModel().getRequests({state:_modelsFragmentModel2.default.FRAGMENT_MODEL_EXECUTED,quality:n,index:t.index})[0],E=D(r,l,f,u);Te.getEventController().addInbandEvents(E)}t.bytes=A(r),i(t)}}function i(e){_e=!0,Ee=e,W.append(ie,e),"video"===e.mediaInfo.type&&e.mediaInfo.embeddedCaptions&&Z.append(e.bytes,e)}function l(e){if(ie===e.buffer){if(e.error||!m())return e.error.code===_SourceBufferController2.default.QUOTA_EXCEEDED_ERROR_CODE&&(ne=.8*W.getTotalBufferedTime(ie)),void(e.error.code!==_SourceBufferController2.default.QUOTA_EXCEEDED_ERROR_CODE&&m()||(H.trigger(_coreEventsEvents2.default.QUOTA_EXCEEDED,{sender:$,criticalBufferLevel:ne}),R(M())));isNaN(Ee.index)||(ae=Math.max(Ee.index,ae),v());var t=W.getAllRanges(ie);if(t&&t.length>0)for(var r=0,n=t.length;r<n;r++)K("Buffered Range for type:",ue,":",t.start(r)," - ",t.end(r));d(),_e=!1,H.trigger(_coreEventsEvents2.default.BYTES_APPENDED,{sender:$,quality:Ee.quality,startTime:Ee.start,index:Ee.index,bufferedRanges:t})}}function E(e){ee!==e.newQuality&&ue===e.mediaType&&Te.getStreamInfo().id===e.streamInfo.id&&(F(Te.getRepresentationInfoForQuality(e.newQuality).MSETimeOffset),ee=e.newQuality)}function s(){fe=Number.POSITIVE_INFINITY,te=!1,d()}function d(){_(),c()}function _(){re=W.getBufferLength(ie,ge.getTime()),H.trigger(_coreEventsEvents2.default.BUFFER_LEVEL_UPDATED,{sender:$,bufferLevel:re}),g()}function c(){o()&&(w.addBufferState(ue,le,Ae.getBufferTarget()),w.addBufferLevel(ue,new Date,1e3*re))}function v(){var e=ae>=fe-1;e&&!te&&(te=!0,H.trigger(_coreEventsEvents2.default.BUFFERING_COMPLETED,{sender:$,streamInfo:Te.getStreamInfo()}))}function g(){T(re<STALL_THRESHOLD&&!te?BUFFER_EMPTY:BUFFER_LOADED)}function T(e){le===e||"fragmentedText"===ue&&Z.getAllTracksAreDisabled()||(le=e,c(),H.trigger(_coreEventsEvents2.default.BUFFER_LEVEL_STATE_CHANGED,{sender:$,state:e,mediaType:ue,streamInfo:Te.getStreamInfo()}),H.trigger(e===BUFFER_LOADED?_coreEventsEvents2.default.BUFFER_LOADED:_coreEventsEvents2.default.BUFFER_EMPTY,{mediaType:ue}),K(e===BUFFER_LOADED?"Got enough buffer to start.":"Waiting for more buffer before starting playback."))}function D(e,t,r,n){var o=Math.max(isNaN(t.startTime)?0:t.startTime,0),a=[],f=[];ve=!1;for(var u=r.concat(n),i=0,l=u.length;i<l;i++)a[u[i].schemeIdUri]=u[i];for(var E=(0,_utilsBoxParser2.default)(k).getInstance().parse(e),s=E.getBoxes("emsg"),i=0,l=s.length;i<l;i++){var d=J.getEvent(s[i],a,o);d&&f.push(d)}return f}function A(e){if(!ve)return e;for(var t=e.length,r=Math.pow(256,2),n=Math.pow(256,3),o=new Uint8Array(e.length),a=0,f=0;a<t;){var u=String.fromCharCode(e[a+4],e[a+5],e[a+6],e[a+7]),i=e[a]*n+e[a+1]*r+256*e[a+2]+1*e[a+3];if("emsg"!=u)for(var l=a;l<a+i;l++)o[f]=e[l],f++;a+=i}return o.subarray(0,f)}function m(){var e=W.getTotalBufferedTime(ie);return e<ne}function C(){if(ie&&"fragmentedText"!==ue){var e=ie.buffered.length?ie.buffered.start(0):0,t=ge.getTime()-e-me.getBufferToKeep();t>0&&(K("pruning buffer: "+t+" seconds."),ce=!0,W.remove(ie,0,Math.round(e+t),oe))}}function M(){if(!ie)return null;var e=ge.getTime(),t=Te.getFragmentModel().getRequests({state:_modelsFragmentModel2.default.FRAGMENT_MODEL_EXECUTED,time:e})[0],r=W.getBufferRange(ie,e),n=t&&!isNaN(t.startTime)?t.startTime:Math.floor(e);return null===r&&ie.buffered.length>0&&(n=ie.buffered.end(ie.buffered.length-1)),{start:ie.buffered.start(0),end:n}}function R(e){e&&ie&&W.remove(ie,e.start,e.end,oe)}function I(e){ie===e.buffer&&(ce&&(ce=!1),_(),H.trigger(_coreEventsEvents2.default.BUFFER_CLEARED,{sender:$,from:e.from,to:e.to,hasEnoughSpaceToAppend:m()}))}function F(e){ie&&ie.timestampOffset!==e&&!isNaN(e)&&(ie.timestampOffset=e)}function B(e){e.sender.getStreamProcessor()!==Te||e.error||F(e.currentRepresentation.MSETimeOffset)}function h(e){e.fragmentModel===Te.getFragmentModel()&&(fe=e.request.index,v())}function P(e){ie&&e.newMediaInfo.type===ue&&e.newMediaInfo.streamInfo.id===Te.getStreamInfo().id&&j.getSwitchMode(ue)===_MediaController2.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE&&R(M())}function L(){se++;var e=se*(me.getWallclockTimeUpdateInterval()/1e3);e>=me.getBufferPruningInterval()&&!_e&&(se=0,C())}function S(){g()}function O(){return ue}function U(){return Te}function p(e){Te=e}function b(){return ie}function y(e){ie=e}function N(){return re}function q(){return ne}function Y(e){oe=e}function x(){return oe}function G(){return te}function Q(e){H.off(_coreEventsEvents2.default.DATA_UPDATE_COMPLETED,B,this),H.off(_coreEventsEvents2.default.QUALITY_CHANGE_REQUESTED,E,this),H.off(_coreEventsEvents2.default.INIT_FRAGMENT_LOADED,a,this),H.off(_coreEventsEvents2.default.MEDIA_FRAGMENT_LOADED,u,this),H.off(_coreEventsEvents2.default.STREAM_COMPLETED,h,this),H.off(_coreEventsEvents2.default.CURRENT_TRACK_CHANGED,P,this),H.off(_coreEventsEvents2.default.PLAYBACK_PROGRESS,d,this),H.off(_coreEventsEvents2.default.PLAYBACK_TIME_UPDATED,d,this),H.off(_coreEventsEvents2.default.PLAYBACK_RATE_CHANGED,S,this),H.off(_coreEventsEvents2.default.PLAYBACK_SEEKING,s,this),H.off(_coreEventsEvents2.default.WALLCLOCK_TIME_UPDATED,L,this),H.off(_coreEventsEvents2.default.SOURCEBUFFER_APPEND_COMPLETED,l,this),H.off(_coreEventsEvents2.default.SOURCEBUFFER_REMOVE_COMPLETED,I,this),ne=Number.POSITIVE_INFINITY,le=BUFFER_EMPTY,ee=_AbrController2.default.QUALITY_DEFAULT,fe=Number.POSITIVE_INFINITY,ae=0,Ee=null,de=!1,te=!1,_e=!1,ce=!1,ge=null,Te=null,De=null,Ae=null,e||(W.abort(oe,ie),W.removeSourceBuffer(oe,ie)),ie=null}var k=this.context,K=(0,_coreDebug2.default)(k).getInstance().log,H=(0,_coreEventBus2.default)(k).getInstance(),w=e.metricsModel,V=e.manifestModel,W=e.sourceBufferController,X=e.errHandler,z=e.streamController,j=e.mediaController,J=e.adapter,Z=e.textSourceBuffer,$=void 0,ee=void 0,te=void 0,re=void 0,ne=void 0,oe=void 0,ae=void 0,fe=void 0,ue=void 0,ie=void 0,le=void 0,Ee=void 0,se=void 0,de=void 0,_e=void 0,ce=void 0,ve=void 0,ge=void 0,Te=void 0,De=void 0,Ae=void 0,me=void 0,Ce=void 0;return $={initialize:r,createBuffer:n,getType:O,getStreamProcessor:U,setStreamProcessor:p,getBuffer:b,setBuffer:y,getBufferLevel:N,getCriticalBufferLevel:q,setMediaSource:Y,getMediaSource:x,getIsBufferingCompleted:G,switchInitData:f,reset:Q},t(),$}Object.defineProperty(exports,"__esModule",{value:!0});var _modelsFragmentModel=require("../models/FragmentModel"),_modelsFragmentModel2=_interopRequireDefault(_modelsFragmentModel),_modelsMediaPlayerModel=require("../models/MediaPlayerModel"),_modelsMediaPlayerModel2=_interopRequireDefault(_modelsMediaPlayerModel),_SourceBufferController=require("./SourceBufferController"),_SourceBufferController2=_interopRequireDefault(_SourceBufferController),_AbrController=require("./AbrController"),_AbrController2=_interopRequireDefault(_AbrController),_PlaybackController=require("./PlaybackController"),_PlaybackController2=_interopRequireDefault(_PlaybackController),_MediaController=require("./MediaController"),_MediaController2=_interopRequireDefault(_MediaController),_coreEventBus=require("../../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreEventsEvents=require("../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_utilsBoxParser=require("../utils/BoxParser"),_utilsBoxParser2=_interopRequireDefault(_utilsBoxParser),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_coreDebug=require("../../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug),_utilsInitCache=require("../utils/InitCache"),_utilsInitCache2=_interopRequireDefault(_utilsInitCache),BUFFER_LOADED="bufferLoaded",BUFFER_EMPTY="bufferStalled",STALL_THRESHOLD=.5;BufferController.__dashjs_factory_name="BufferController";var factory=_coreFactoryMaker2.default.getClassFactory(BufferController);factory.BUFFER_LOADED=BUFFER_LOADED,factory.BUFFER_EMPTY=BUFFER_EMPTY,exports.default=factory,module.exports=exports.default;
},{"../../core/Debug":13,"../../core/EventBus":14,"../../core/FactoryMaker":15,"../../core/events/Events":18,"../models/FragmentModel":105,"../models/MediaPlayerModel":107,"../utils/BoxParser":152,"../utils/InitCache":158,"./AbrController":66,"./MediaController":72,"./PlaybackController":74,"./SourceBufferController":76}],70:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function EventController(){function e(){q=!1,p={},y={},b={},h=null,E=100,k=E/1e3,M=(0,_controllersPlaybackController2.default)(f).getInstance()}function t(){null!==h&&q&&(clearInterval(h),h=null,q=!1)}function r(){_("Start Event Controller"),q||isNaN(E)||(q=!0,h=setInterval(l,E))}function n(e){if(p={},e)for(var t=0;t<e.length;t++){var r=e[t];p[r.id]=r,_("Add inline event with id "+r.id)}_("Added "+e.length+" inline events")}function o(e){for(var t=0;t<e.length;t++){var r=e[t];r.id in y?_("Repeated event with id "+r.id):(y[r.id]=r,_("Add inband event with id "+r.id))}}function a(){if(b)for(var e=M.getTime(),t=Object.keys(b),r=0;r<t.length;r++){var n=t[r],o=b[n];null!==o&&(o.duration+o.presentationTime)/o.eventStream.timescale<e&&(_("Remove Event "+n+" at time "+e),o=null,delete b[n])}}function l(){u(y),u(p),a()}function i(){var e=C.getValue(),t=e.url;e.hasOwnProperty("Location")&&(t=e.Location),_("Refresh manifest @ "+t),D.getManifestLoader().load(t)}function u(e){var t,r=M.getTime();if(e)for(var n=Object.keys(e),o=0;o<n.length;o++){var a=n[o],l=e[a];void 0!==l&&(t=l.presentationTime/l.eventStream.timescale,(0===t||t<=r&&t+k>r)&&(_("Start Event "+a+" at "+r),l.duration>0&&(b[a]=l),l.eventStream.schemeIdUri==v&&l.eventStream.value==s?i():g.trigger(l.eventStream.schemeIdUri,{event:l}),delete e[a]))}}function c(e){e&&(e.manifestModel&&(C=e.manifestModel),e.manifestUpdater&&(D=e.manifestUpdater))}function d(){t(),p=null,y=null,b=null,M=null}var v="urn:mpeg:dash:event:2012",s=1,f=this.context,_=(0,_coreDebug2.default)(f).getInstance().log,g=(0,_coreEventBus2.default)(f).getInstance(),m=void 0,p=void 0,y=void 0,b=void 0,h=void 0,E=void 0,k=void 0,C=void 0,D=void 0,M=void 0,q=void 0;return m={initialize:e,addInlineEvents:n,addInbandEvents:o,clear:t,start:r,setConfig:c,reset:d}}Object.defineProperty(exports,"__esModule",{value:!0});var _controllersPlaybackController=require("../controllers/PlaybackController"),_controllersPlaybackController2=_interopRequireDefault(_controllersPlaybackController),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_coreDebug=require("../../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug),_coreEventBus=require("../../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus);EventController.__dashjs_factory_name="EventController",exports.default=_coreFactoryMaker2.default.getSingletonFactory(EventController),module.exports=exports.default;
},{"../../core/Debug":13,"../../core/EventBus":14,"../../core/FactoryMaker":15,"../controllers/PlaybackController":74}],71:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function FragmentController(){function e(){d={},i.on(_coreEventsEvents2.default.FRAGMENT_LOADING_COMPLETED,a,l)}function t(e){var t=d[e];return t||(t=(0,_modelsFragmentModel2.default)(u).create({metricsModel:(0,_modelsMetricsModel2.default)(u).getInstance()}),d[e]=t),t}function r(e){return e&&e.type&&e.type===_voMetricsHTTPRequest.HTTPRequest.INIT_SEGMENT_TYPE}function o(){i.off(_coreEventsEvents2.default.FRAGMENT_LOADING_COMPLETED,a,this);for(var e in d)d[e].reset();d={}}function n(e,t,r){var o=new _voDataChunk2.default;return o.streamId=r,o.mediaInfo=t.mediaInfo,o.segmentType=t.type,o.start=t.startTime,o.duration=t.duration,o.end=o.start+o.duration,o.bytes=e,o.index=t.index,o.quality=t.quality,o}function a(e){if(d[e.request.mediaType]===e.sender){var t=e.sender.getScheduleController(),o=e.request,a=e.response,u=r(o),l=t.getStreamProcessor().getStreamInfo();if(!a||!l)return void s("No "+o.mediaType+" bytes to push or stream is inactive.");var _=n(a,o,l.id);i.trigger(u?_coreEventsEvents2.default.INIT_FRAGMENT_LOADED:_coreEventsEvents2.default.MEDIA_FRAGMENT_LOADED,{chunk:_,fragmentModel:e.sender})}}var u=this.context,s=(0,_coreDebug2.default)(u).getInstance().log,i=(0,_coreEventBus2.default)(u).getInstance(),l=void 0,d=void 0;return l={getModel:t,isInitializationRequest:r,reset:o},e(),l}Object.defineProperty(exports,"__esModule",{value:!0});var _voMetricsHTTPRequest=require("../vo/metrics/HTTPRequest"),_voDataChunk=require("../vo/DataChunk"),_voDataChunk2=_interopRequireDefault(_voDataChunk),_modelsFragmentModel=require("../models/FragmentModel"),_modelsFragmentModel2=_interopRequireDefault(_modelsFragmentModel),_modelsMetricsModel=require("../models/MetricsModel"),_modelsMetricsModel2=_interopRequireDefault(_modelsMetricsModel),_coreEventBus=require("../../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreEventsEvents=require("../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_coreDebug=require("../../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug);FragmentController.__dashjs_factory_name="FragmentController",exports.default=_coreFactoryMaker2.default.getClassFactory(FragmentController),module.exports=exports.default;
},{"../../core/Debug":13,"../../core/EventBus":14,"../../core/FactoryMaker":15,"../../core/events/Events":18,"../models/FragmentModel":105,"../models/MetricsModel":108,"../vo/DataChunk":167,"../vo/metrics/HTTPRequest":185}],72:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function MediaController(){function e(){y={},R(),I()}function t(e,t){var n=c(e),i=r(e,t),o=[];return"fragmentedText"===e?void a(i[0]):(n||(n=h.getSavedMediaSettings(e),u(e,n)),void(i&&0!==i.length&&(n&&i.forEach(function(e){S(n,e)&&o.push(e)}),a(0===o.length?A(i):o.length>1?A(o):o[0]))))}function n(e){var t=e?e.type:null,n=e?e.streamInfo.id:null,r=c(t);return!(!e||!f(t))&&(y[n]=y[n]||v(),!(y[n][t].list.indexOf(e)>=0)&&(y[n][t].list.push(e),r&&S(r,e)&&!i(t,e.streamInfo)&&a(e),!0))}function r(e,t){if(!e||!t)return[];var n=t.id;return y[n]&&y[n][e]?y[n][e].list:[]}function i(e,t){return!e||!t||t&&!y[t.id]?null:y[t.id][e].current}function o(e){var t=e.type,n=e.streamInfo.id;return y[n]&&y[n][t]&&T(y[n][t].current,e)}function a(e){if(e){var t=e.type,n=e.streamInfo,r=n.id,o=i(t,n);if(y[r]&&y[r][t]&&(!o||!T(e,o))){y[r][t].current=e,o&&O.trigger(_coreEventsEvents2.default.CURRENT_TRACK_CHANGED,{oldMediaInfo:o,newMediaInfo:e,switchMode:H[t]});var a=g(e);a&&y[r][t].storeLastSettings&&(a.roles&&(a.role=a.roles[0],delete a.roles),a.accessibility&&(a.accessibility=a.accessibility[0]),a.audioChannelConfiguration&&(a.audioChannelConfiguration=a.audioChannelConfiguration[0]),h.setSavedMediaSettings(t,a))}}}function u(e,t){e&&t&&(N[e]=t)}function c(e){return e?N[e]:null}function l(e,t){var n=k.indexOf(t)!==-1;return n?void(H[e]=t):void D("track switch mode is not supported: "+t)}function _(e){return H[e]}function s(e){var t=W.indexOf(e)!==-1;return t?void(K=e):void D("track selection mode is not supported: "+e)}function E(){return K||DEFAULT_INIT_TRACK_SELECTION_MODE}function f(e){return"audio"===e||"video"===e||"text"===e||"fragmentedText"===e}function T(e,t){var n=e.id===t.id,r=e.viewpoint===t.viewpoint,i=e.lang===t.lang,o=e.roles.toString()===t.roles.toString(),a=e.accessibility.toString()===t.accessibility.toString(),u=e.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString();return n&&r&&i&&o&&a&&u}function d(e){e&&e.errHandler&&(b=e.errHandler)}function C(){e(),p.resetEmbedded()}function g(e){var t={lang:e.lang,viewpoint:e.viewpoint,roles:e.roles,accessibility:e.accessibility,audioChannelConfiguration:e.audioChannelConfiguration},n=t.lang||t.viewpoint||t.role&&t.role.length>0||t.accessibility&&t.accessibility.length>0||t.audioChannelConfiguration&&t.audioChannelConfiguration.length>0;return n?t:null}function S(e,t){var n=!e.lang||e.lang===t.lang,r=!e.viewpoint||e.viewpoint===t.viewpoint,i=!e.role||!!t.roles.filter(function(t){return t===e.role})[0],o=!e.accessibility||!!t.accessibility.filter(function(t){return t===e.accessibility})[0],a=!e.audioChannelConfiguration||!!t.audioChannelConfiguration.filter(function(t){return t===e.audioChannelConfiguration})[0];return n&&r&&i&&o&&a}function I(){H={audio:TRACK_SWITCH_MODE_ALWAYS_REPLACE,video:TRACK_SWITCH_MODE_NEVER_REPLACE}}function R(){N={audio:null,video:null}}function A(e){var t=E(),n=[],r=function(e){var t,n=0,r=[];return e.forEach(function(e){t=Math.max.apply(Math,e.bitrateList.map(function(e){return e.bandwidth})),t>n?(n=t,r=[e]):t===n&&r.push(e)}),r},i=function(e){var t,n=0,r=[];return e.forEach(function(e){t=e.representationCount,t>n?(n=t,r=[e]):t===n&&r.push(e)}),r};switch(t){case TRACK_SELECTION_MODE_HIGHEST_BITRATE:n=r(e),n.length>1&&(n=i(n));break;case TRACK_SELECTION_MODE_WIDEST_RANGE:n=i(e),n.length>1&&(n=r(e));break;default:D("track selection mode is not supported: "+t)}return n[0]}function v(){return{audio:{list:[],storeLastSettings:!0,current:null},video:{list:[],storeLastSettings:!0,current:null},text:{list:[],storeLastSettings:!0,current:null},fragmentedText:{list:[],storeLastSettings:!0,current:null}}}var M=this.context,D=(0,_coreDebug2.default)(M).getInstance().log,O=(0,_coreEventBus2.default)(M).getInstance(),p=(0,_TextSourceBuffer2.default)(M).getInstance(),h=(0,_utilsDOMStorage2.default)(M).getInstance(),L=void 0,y=void 0,N=void 0,K=void 0,H=void 0,b=void 0,k=[TRACK_SWITCH_MODE_ALWAYS_REPLACE,TRACK_SWITCH_MODE_NEVER_REPLACE],W=[TRACK_SELECTION_MODE_HIGHEST_BITRATE,TRACK_SELECTION_MODE_WIDEST_RANGE];return L={initialize:e,checkInitialMediaSettingsForType:t,addTrack:n,getTracksFor:r,getCurrentTrackFor:i,isCurrentTrack:o,setTrack:a,setInitialSettings:u,getInitialSettings:c,setSwitchMode:l,getSwitchMode:_,setSelectionModeForInitialTrack:s,getSelectionModeForInitialTrack:E,isMultiTrackSupportedByType:f,isTracksEqual:T,setConfig:d,reset:C}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreEventsEvents=require("../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_coreEventBus=require("../../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_coreDebug=require("../../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug),_TextSourceBuffer=require("../TextSourceBuffer"),_TextSourceBuffer2=_interopRequireDefault(_TextSourceBuffer),_utilsDOMStorage=require("../utils/DOMStorage"),_utilsDOMStorage2=_interopRequireDefault(_utilsDOMStorage),TRACK_SWITCH_MODE_NEVER_REPLACE="neverReplace",TRACK_SWITCH_MODE_ALWAYS_REPLACE="alwaysReplace",TRACK_SELECTION_MODE_HIGHEST_BITRATE="highestBitrate",TRACK_SELECTION_MODE_WIDEST_RANGE="widestRange",DEFAULT_INIT_TRACK_SELECTION_MODE=TRACK_SELECTION_MODE_HIGHEST_BITRATE;MediaController.__dashjs_factory_name="MediaController";var factory=_coreFactoryMaker2.default.getSingletonFactory(MediaController);factory.TRACK_SWITCH_MODE_NEVER_REPLACE=TRACK_SWITCH_MODE_NEVER_REPLACE,factory.TRACK_SWITCH_MODE_ALWAYS_REPLACE=TRACK_SWITCH_MODE_ALWAYS_REPLACE,factory.TRACK_SELECTION_MODE_HIGHEST_BITRATE=TRACK_SELECTION_MODE_HIGHEST_BITRATE,factory.TRACK_SELECTION_MODE_WIDEST_RANGE=TRACK_SELECTION_MODE_WIDEST_RANGE,factory.DEFAULT_INIT_TRACK_SELECTION_MODE=DEFAULT_INIT_TRACK_SELECTION_MODE,exports.default=factory,module.exports=exports.default;
},{"../../core/Debug":13,"../../core/EventBus":14,"../../core/FactoryMaker":15,"../../core/events/Events":18,"../TextSourceBuffer":62,"../utils/DOMStorage":155}],73:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function MediaSourceController(){function e(){var e="WebKitMediaSource"in window,r="MediaSource"in window;return r?new MediaSource:e?new WebKitMediaSource:null}function r(e,r){var t=window.URL.createObjectURL(e);return r.setSource(t),t}function t(e){e.setSource(null)}function o(e,r){return e.duration!=r&&(e.duration=r),e.duration}function a(e){var r=e.sourceBuffers,t=r.length,o=0;if("open"===e.readyState){for(o;o<t;o++){if(r[o].updating)return;if(0===r[o].buffered.length)return}e.endOfStream()}}var n=void 0;return n={createMediaSource:e,attachMediaSource:r,detachMediaSource:t,setDuration:o,signalEndOfStream:a}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);MediaSourceController.__dashjs_factory_name="MediaSourceController",exports.default=_coreFactoryMaker2.default.getSingletonFactory(MediaSourceController),module.exports=exports.default;
},{"../../core/FactoryMaker":15}],74:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function PlaybackController(){function e(){ae=0,ie=NaN,oe=null,le=null,ve=!1,se={},ue=(0,_streamingModelsMediaPlayerModel2.default)(W).getInstance()}function t(e){de=e,z=re.getElement(),V(),le=de.manifestInfo.isDynamic,ie=de.start,H.on(_coreEventsEvents2.default.DATA_UPDATE_COMPLETED,R,this),H.on(_coreEventsEvents2.default.BYTES_APPENDED,x,this),H.on(_coreEventsEvents2.default.BUFFER_LEVEL_STATE_CHANGED,G,this),H.on(_coreEventsEvents2.default.PERIOD_SWITCH_STARTED,n,this),ve&&(ve=!1,o())}function n(e){!le&&e.fromStreamInfo&&se[e.fromStreamInfo.id]&&delete se[e.fromStreamInfo.id]}function r(){var e=L(!0),t=le?e-de.start:0;return e+(de.duration-t)-v()}function a(){return v()>0}function i(){return de.id}function o(){if(z){z.autoplay=!0;var e=z.play();e&&"undefined"!=typeof Promise&&e instanceof Promise&&e.catch(function(e){"NotAllowedError"===e.name&&H.trigger(_coreEventsEvents2.default.PLAYBACK_NOT_ALLOWED),w("Caught pending play exception - continuing ("+e+")")})}else ve=!0}function s(){if(z)return z.paused}function d(){z&&(z.pause(),z.autoplay=!1)}function l(){if(z)return z.seeking}function u(e){re&&(w("Requesting seek to time: "+e),re.setCurrentTime(e))}function v(){if(z)return z.currentTime}function f(){if(z)return z.playbackRate}function c(){if(z)return z.played}function E(){if(z)return z.ended}function m(){return le}function g(e){ie=e}function _(){return ie}function y(e,t){var n=te.getMpd(ee.getValue()),r=void 0,a=10;r=ue.getUseSuggestedPresentationDelay()&&n.hasOwnProperty("suggestedPresentationDelay")?n.suggestedPresentationDelay:ue.getLiveDelay()?ue.getLiveDelay():isNaN(e)?2*de.manifestInfo.minBufferTime:e*ue.getLiveDelayFragmentCount();var i=Math.max(t-a,t/2);return Math.min(r,i)}function A(){re&&z&&(H.off(_coreEventsEvents2.default.DATA_UPDATE_COMPLETED,R,this),H.off(_coreEventsEvents2.default.BUFFER_LEVEL_STATE_CHANGED,G,this),H.off(_coreEventsEvents2.default.BYTES_APPENDED,x,this),P(),Q()),re=null,de=null,z=null,le=null,e()}function D(e){e&&(e.streamController&&(J=e.streamController),e.timelineConverter&&(X=e.timelineConverter),e.metricsModel&&(Z=e.metricsModel),e.dashMetrics&&($=e.dashMetrics),e.manifestModel&&(ee=e.manifestModel),e.dashManifestModel&&(te=e.dashManifestModel),e.adapter&&(ne=e.adapter),e.videoModel&&(re=e.videoModel))}function L(e){var t=void 0,n=(0,_modelsURIQueryAndFragmentModel2.default)(W).getInstance().getURIFragmentData(),r=parseInt(n.s,10),a=parseInt(n.t,10),i=NaN;if(e||(i=isNaN(r)?a:r),le)!isNaN(i)&&i>1262304e3&&(t=i-de.manifestInfo.availableFrom.getTime()/1e3,(t>ie||t<ie-de.manifestInfo.DVRWindowSize)&&(t=null)),t=t||ie;else if(!isNaN(i)&&i<Math.max(de.manifestInfo.duration,de.duration)&&i>=0)t=i;else{var o=se[de.id];void 0===o&&(o=J.getActiveStreamCommonEarliestTime()),t=Math.max(o,de.start)}return t}function p(e){var t,n=Z.getReadOnlyMetricsFor("video")||Z.getReadOnlyMetricsFor("audio"),r=$.getCurrentDVRInfo(n),a=r?r.range:null;if(!a)return NaN;if(e>a.end)t=Math.max(a.end-2*de.manifestInfo.minBufferTime,a.start);else{if(!(e<a.start))return e;t=a.start}return t}function M(){if(null===oe){var e=function(){O()};oe=setInterval(e,ue.getWallclockTimeUpdateInterval())}}function P(){clearInterval(oe),oe=null}function T(){var e=L(!1);e>0&&(u(e),w("Starting playback at offset: "+e))}function C(){if(!s()&&le&&0!==z.readyState){var e=v(),t=p(e),n=!isNaN(t)&&t!==e;n&&u(t)}}function R(e){if(!e.error){var t=ne.convertDataToTrack(ee.getValue(),e.currentRepresentation),n=t.mediaInfo.streamInfo;de.id===n.id&&(de=n,C())}}function I(){H.trigger(_coreEventsEvents2.default.CAN_PLAY)}function N(){w("Native video element event: play"),C(),M(),H.trigger(_coreEventsEvents2.default.PLAYBACK_STARTED,{startTime:v()})}function S(){w("Native video element event: playing"),H.trigger(_coreEventsEvents2.default.PLAYBACK_PLAYING,{playingTime:v()})}function B(){w("Native video element event: pause"),H.trigger(_coreEventsEvents2.default.PLAYBACK_PAUSED,{ended:E()})}function h(){var e=v();w("Seeking to: "+e),M(),H.trigger(_coreEventsEvents2.default.PLAYBACK_SEEKING,{seekTime:e})}function k(){w("Native video element event: seeked"),H.trigger(_coreEventsEvents2.default.PLAYBACK_SEEKED)}function F(){var e=v();e!==ae&&(ae=e,H.trigger(_coreEventsEvents2.default.PLAYBACK_TIME_UPDATED,{timeToEnd:r(),time:e}))}function b(){H.trigger(_coreEventsEvents2.default.PLAYBACK_PROGRESS)}function Y(){var e=f();w("Native video element event: ratechange: ",e),H.trigger(_coreEventsEvents2.default.PLAYBACK_RATE_CHANGED,{playbackRate:e})}function q(){w("Native video element event: loadedmetadata"),(!le&&de.isFirst||X.isTimeSyncCompleted())&&T(),H.trigger(_coreEventsEvents2.default.PLAYBACK_METADATA_LOADED),M()}function U(){w("Native video element event: ended"),d(),P(),H.trigger(_coreEventsEvents2.default.PLAYBACK_ENDED)}function K(e){var t=e.target||e.srcElement;H.trigger(_coreEventsEvents2.default.PLAYBACK_ERROR,{error:t.error})}function O(){H.trigger(_coreEventsEvents2.default.WALLCLOCK_TIME_UPDATED,{isDynamic:le,time:new Date})}function x(e){var t=e.bufferedRanges;if(t&&t.length){var n=Math.max(t.start(0),de.start),r=void 0===se[de.id]?n:Math.max(se[de.id],n);r!==se[de.id]&&(!le&&L(!0)<r&&v()<r&&u(r),se[de.id]=r)}}function G(e){e.streamInfo.id===de.id&&re.setStallState(e.mediaType,e.state===_BufferController2.default.BUFFER_EMPTY)}function V(){z.addEventListener("canplay",I),z.addEventListener("play",N),z.addEventListener("playing",S),z.addEventListener("pause",B),z.addEventListener("error",K),z.addEventListener("seeking",h),z.addEventListener("seeked",k),z.addEventListener("timeupdate",F),z.addEventListener("progress",b),z.addEventListener("ratechange",Y),z.addEventListener("loadedmetadata",q),z.addEventListener("ended",U)}function Q(){z.removeEventListener("canplay",I),z.removeEventListener("play",N),z.removeEventListener("playing",S),z.removeEventListener("pause",B),z.removeEventListener("error",K),z.removeEventListener("seeking",h),z.removeEventListener("seeked",k),z.removeEventListener("timeupdate",F),z.removeEventListener("progress",b),z.removeEventListener("ratechange",Y),z.removeEventListener("loadedmetadata",q),z.removeEventListener("ended",U)}var W=this.context,w=(0,_coreDebug2.default)(W).getInstance().log,H=(0,_coreEventBus2.default)(W).getInstance(),j=void 0,z=void 0,J=void 0,X=void 0,Z=void 0,$=void 0,ee=void 0,te=void 0,ne=void 0,re=void 0,ae=void 0,ie=void 0,oe=void 0,se=void 0,de=void 0,le=void 0,ue=void 0,ve=void 0;return j={initialize:t,setConfig:D,getStreamStartTime:L,getTimeToStreamEnd:r,isPlaybackStarted:a,getStreamId:i,getTime:v,getPlaybackRate:f,getPlayedRanges:c,getEnded:E,getIsDynamic:m,setLiveStartTime:g,getLiveStartTime:_,computeLiveDelay:y,play:o,isPaused:s,pause:d,isSeeking:l,seek:u,reset:A},e(),j}Object.defineProperty(exports,"__esModule",{value:!0});var _BufferController=require("./BufferController"),_BufferController2=_interopRequireDefault(_BufferController),_modelsURIQueryAndFragmentModel=require("../models/URIQueryAndFragmentModel"),_modelsURIQueryAndFragmentModel2=_interopRequireDefault(_modelsURIQueryAndFragmentModel),_streamingModelsMediaPlayerModel=require("../../streaming/models/MediaPlayerModel"),_streamingModelsMediaPlayerModel2=_interopRequireDefault(_streamingModelsMediaPlayerModel),_coreEventBus=require("../../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreEventsEvents=require("../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_coreDebug=require("../../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug);PlaybackController.__dashjs_factory_name="PlaybackController",exports.default=_coreFactoryMaker2.default.getSingletonFactory(PlaybackController),module.exports=exports.default;
},{"../../core/Debug":13,"../../core/EventBus":14,"../../core/FactoryMaker":15,"../../core/events/Events":18,"../../streaming/models/MediaPlayerModel":107,"../models/URIQueryAndFragmentModel":109,"./BufferController":69}],75:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ScheduleController(e){function t(){ne=!0,Me=NaN,Se=NaN,Ce={},Ie=[],ie=!1,se=null,ae=null,le=!0,ue=!1,fe=0,de=NaN}function r(e,t){ee=e,Te=t,Ee=(0,_PlaybackController2.default)(w).getInstance(),_e=(0,_MediaController2.default)(w).getInstance(),ve=(0,_AbrController2.default)(w).getInstance(),ge=(0,_controllersStreamController2.default)(w).getInstance(),De=Te.getFragmentController(),me=Te.getBufferController(),te=De.getModel(ee),te.setScheduleController(this),re=Te.isDynamic(),Re=J.getScheduleWhilePaused(),he=(0,_rulesSchedulingBufferLevelRule2.default)(w).create({dashMetrics:(0,_dashDashMetrics2.default)(w).getInstance(),metricsModel:(0,_modelsMetricsModel2.default)(w).getInstance(),textSourceBuffer:(0,_TextSourceBuffer2.default)(w).getInstance()}),Ae=(0,_rulesSchedulingNextFragmentRequestRule2.default)(w).create({adapter:(0,_dashDashAdapter2.default)(w).getInstance(),sourceBufferController:(0,_controllersSourceBufferController2.default)(w).getInstance(),textSourceBuffer:(0,_TextSourceBuffer2.default)(w).getInstance()}),j.getIsTextTrack(ee)&&H.on(_coreEventsEvents2.default.TIMED_TEXT_REQUESTED,q,this),H.on(_coreEventsEvents2.default.QUALITY_CHANGE_REQUESTED,d,this),H.on(_coreEventsEvents2.default.DATA_UPDATE_STARTED,R,this),H.on(_coreEventsEvents2.default.DATA_UPDATE_COMPLETED,_,this),H.on(_coreEventsEvents2.default.FRAGMENT_LOADING_COMPLETED,D,this),H.on(_coreEventsEvents2.default.STREAM_COMPLETED,g,this),H.on(_coreEventsEvents2.default.STREAM_INITIALIZED,v,this),H.on(_coreEventsEvents2.default.BUFFER_LEVEL_STATE_CHANGED,C,this),H.on(_coreEventsEvents2.default.BUFFER_CLEARED,S,this),H.on(_coreEventsEvents2.default.BYTES_APPENDED,h,this),H.on(_coreEventsEvents2.default.INIT_REQUESTED,u,this),H.on(_coreEventsEvents2.default.QUOTA_EXCEEDED,M,this),H.on(_coreEventsEvents2.default.BUFFER_LEVEL_STATE_CHANGED,C,this),H.on(_coreEventsEvents2.default.PLAYBACK_SEEKING,L,this),H.on(_coreEventsEvents2.default.PLAYBACK_STARTED,p,this),H.on(_coreEventsEvents2.default.PLAYBACK_RATE_CHANGED,y,this),H.on(_coreEventsEvents2.default.PLAYBACK_TIME_UPDATED,m,this),H.on(_coreEventsEvents2.default.URL_RESOLUTION_FAILED,I,this),H.on(_coreEventsEvents2.default.FRAGMENT_LOADING_ABANDONED,A,this)}function o(){oe&&!me.getIsBufferingCompleted()&&(Q(),ie=!1,ne?(ne=!1,f(oe.quality)):l(0),K("Schedule controller starting for "+ee))}function n(){ie||(ie=!0,clearTimeout(ce),K("Schedule controller stopping for "+ee))}function i(e,t){Ce[t]=Ce[t]||{};var r=ve.getTopQualityIndexFor(e,t);return Ce[t][e]!=r&&(K("Top quality"+e+" index has changed from "+Ce[t][e]+" to "+r),Ce[t][e]=r,!0)}function s(){if(!(ie||ue||!me||Ee.isPaused()&&!Re)){a();var e=Ie.length>0;if(e||i(oe.mediaInfo.type,Te.getStreamInfo().id)||he.execute(Te,ee,ge.isVideoTrackPresent())){var t=function(){if(oe.quality!==Me)Me=oe.quality,me.switchInitData(Te.getStreamInfo().id,oe.quality);else{var e=Ie.shift();if(De.isInitializationRequest(e))f(e.quality);else{var t=Ae.execute(Te,e);t?te.executeRequest(t):(ue=!1,l(500))}}};ue=!0,e?t():(ve.getPlaybackQuality(Te),t())}else l(500)}}function a(){var e=1.5*oe.fragmentDuration,t=te.getRequests({state:_modelsFragmentModel2.default.FRAGMENT_MODEL_EXECUTED,time:Ee.getTime()+e,threshold:0})[0];t&&Ie.indexOf(t)===-1&&!j.getIsTextTrack(ee)&&(!_e.isCurrentTrack(t.mediaInfo)||J.getFastSwitchEnabled()&&t.quality<oe.quality&&me.getBufferLevel()>=e&&ve.getAbandonmentStateFor(ee)!==_AbrController2.default.ABANDON_LOAD?(c(t),K("Reloading outdated fragment at index: ",t.index)):t.quality>oe.quality&&B(Ee.getTime()+me.getBufferLevel()))}function l(e){clearTimeout(ce),ce=setTimeout(s,e)}function u(e){e.sender.getStreamProcessor()===Te&&f(oe.quality)}function f(e){Me=e;var t=W.getInitRequest(Te,e);t&&(ue=!0,te.executeRequest(t))}function c(e){Ie.push(e)}function d(e){if(ee===e.mediaType&&Te.getStreamInfo().id===e.streamInfo.id){if(oe=Te.getRepresentationInfoForQuality(e.newQuality),null===oe||void 0===oe)throw new Error("Unexpected error! - currentRepresentationInfo is null or undefined");G(new Date,_voMetricsPlayList.PlayListTrace.REPRESENTATION_SWITCH_STOP_REASON),Q()}}function E(e){var t=te.getRequests({state:_modelsFragmentModel2.default.FRAGMENT_MODEL_EXECUTED,time:Ee.getTime(),threshold:0})[0];t&&Ee.getTime()>=t.startTime&&(t.quality!==Se&&e&&H.trigger(_coreEventsEvents2.default.QUALITY_CHANGE_RENDERED,{mediaType:ee,oldQuality:Se,newQuality:t.quality}),Se=t.quality)}function _(e){e.error||e.sender.getStreamProcessor()!==Te||(oe=W.convertDataToTrack(X.getValue(),e.currentRepresentation))}function v(e){e.error||Te.getStreamInfo().id!==e.streamInfo.id||(oe=Te.getCurrentRepresentationInfo(),re&&ne&&(Z.setTimeSyncCompleted(!0),T()),ie&&o())}function T(){var e=(0,_utilsLiveEdgeFinder2.default)(w).getInstance().getLiveEdge(),t=oe.mediaInfo.streamInfo.manifestInfo.DVRWindowSize/2,r=e-Ee.computeLiveDelay(oe.fragmentDuration,t),o=W.getFragmentRequestForTime(Te,oe,r,{ignoreIsFinished:!0});de=Ee.getLiveStartTime(),(isNaN(de)||o.startTime>de)&&(Ee.setLiveStartTime(o.startTime),de=o.startTime);var n=z.getCurrentManifestUpdate(V.getMetricsFor("stream"));V.updateManifestUpdateInfo(n,{currentTime:de,presentationStartTime:e,latency:e-de,clientTimeOffset:Z.getClientTimeOffset()})}function g(e){e.fragmentModel===te&&(n(),ue=!1,K("Stream is complete"))}function D(e){e.sender===te&&(j.getIsTextTrack(ee)&&(ue=!1),e.error&&e.request.serviceLocation&&!ie&&(c(e.request),ue=!1,l(0)))}function m(){E(!0)}function h(e){e.sender.getStreamProcessor()===Te&&(ue=!1,l(0))}function A(e){e.streamProcessor===Te&&(c(e.request),ue=!1,l(0))}function R(e){e.sender.getStreamProcessor()===Te&&n()}function S(e){e.sender.getStreamProcessor()===Te&&(te.removeExecutedRequestsBeforeTime(e.to),e.hasEnoughSpaceToAppend&&ie&&o())}function C(e){e.sender.getStreamProcessor()!==Te||e.state!==_BufferController2.default.BUFFER_EMPTY||Ee.isSeeking()||(K("Buffer is empty! Stalling!"),G(new Date,_voMetricsPlayList.PlayListTrace.REBUFFERING_REASON))}function M(e){e.sender.getStreamProcessor()===Te&&n()}function I(){te.abortRequests(),n()}function q(e){e.sender.getStreamProcessor()===Te&&f(e.index)}function p(){!ie&&Re||o()}function L(e){de=e.seekTime,F(0),ie&&o();var t=z.getCurrentManifestUpdate(V.getMetricsFor("stream")),r=oe.DVRWindow?oe.DVRWindow.end-Ee.getTime():NaN;V.updateManifestUpdateInfo(t,{latency:r})}function y(e){ae&&(ae.playbackspeed=e.playbackRate.toString())}function P(){return de}function B(e){de=e}function N(){return te}function F(e){fe=e}function U(){return fe}function x(){return Te}function O(){return he.getBufferTarget(Te,ee,ge.isVideoTrackPresent())}function k(e){se=e}function b(e,t){G(e,t),se=null}function G(e,t){if(se&&le===!1){var r=ae.start,o=e.getTime()-r.getTime();ae.duration=o,ae.stopreason=t,se.trace.push(ae),le=!0}}function Q(){se&&le===!0&&oe&&(le=!1,ae=new _voMetricsPlayList.PlayListTrace,ae.representationid=oe.id,ae.start=new Date,ae.mstart=1e3*Ee.getTime(),ae.playbackspeed=Ee.getPlaybackRate().toString())}function Y(){H.off(_coreEventsEvents2.default.DATA_UPDATE_STARTED,R,this),H.off(_coreEventsEvents2.default.DATA_UPDATE_COMPLETED,_,this),H.off(_coreEventsEvents2.default.BUFFER_LEVEL_STATE_CHANGED,C,this),H.off(_coreEventsEvents2.default.QUALITY_CHANGE_REQUESTED,d,this),H.off(_coreEventsEvents2.default.FRAGMENT_LOADING_COMPLETED,D,this),H.off(_coreEventsEvents2.default.STREAM_COMPLETED,g,this),H.off(_coreEventsEvents2.default.STREAM_INITIALIZED,v,this),H.off(_coreEventsEvents2.default.QUOTA_EXCEEDED,M,this),H.off(_coreEventsEvents2.default.BYTES_APPENDED,h,this),H.off(_coreEventsEvents2.default.BUFFER_CLEARED,S,this),H.off(_coreEventsEvents2.default.INIT_REQUESTED,u,this),H.off(_coreEventsEvents2.default.PLAYBACK_RATE_CHANGED,y,this),H.off(_coreEventsEvents2.default.PLAYBACK_SEEKING,L,this),H.off(_coreEventsEvents2.default.PLAYBACK_STARTED,p,this),H.off(_coreEventsEvents2.default.PLAYBACK_TIME_UPDATED,m,this),H.off(_coreEventsEvents2.default.URL_RESOLUTION_FAILED,I,this),H.off(_coreEventsEvents2.default.FRAGMENT_LOADING_ABANDONED,A,this),j.getIsTextTrack(ee)&&H.off(_coreEventsEvents2.default.TIMED_TEXT_REQUESTED,q,this),n(),E(!1),ue=!1,fe=0,de=NaN,Ee=null,se=null}var w=this.context,K=(0,_coreDebug2.default)(w).getInstance().log,H=(0,_coreEventBus2.default)(w).getInstance(),V=e.metricsModel,X=e.manifestModel,W=e.adapter,z=e.dashMetrics,j=e.dashManifestModel,Z=e.timelineConverter,J=e.mediaPlayerModel,$=void 0,ee=void 0,te=void 0,re=void 0,oe=void 0,ne=void 0,ie=void 0,se=void 0,ae=void 0,le=void 0,ue=void 0,fe=void 0,ce=void 0,de=void 0,Ee=void 0,_e=void 0,ve=void 0,Te=void 0,ge=void 0,De=void 0,me=void 0,he=void 0,Ae=void 0,Re=void 0,Se=void 0,Ce=void 0,Me=void 0,Ie=void 0;return $={initialize:r,getStreamProcessor:x,getSeekTarget:P,setSeekTarget:B,getFragmentModel:N,setTimeToLoadDelay:F,getTimeToLoadDelay:U,replaceRequest:c,start:o,stop:n,reset:Y,setPlayList:k,getBufferTarget:O,finalisePlayList:b},t(),$}Object.defineProperty(exports,"__esModule",{value:!0});var _voMetricsPlayList=require("../vo/metrics/PlayList"),_PlaybackController=require("./PlaybackController"),_PlaybackController2=_interopRequireDefault(_PlaybackController),_AbrController=require("./AbrController"),_AbrController2=_interopRequireDefault(_AbrController),_BufferController=require("./BufferController"),_BufferController2=_interopRequireDefault(_BufferController),_MediaController=require("./MediaController"),_MediaController2=_interopRequireDefault(_MediaController),_rulesSchedulingBufferLevelRule=require("../rules/scheduling/BufferLevelRule"),_rulesSchedulingBufferLevelRule2=_interopRequireDefault(_rulesSchedulingBufferLevelRule),_rulesSchedulingNextFragmentRequestRule=require("../rules/scheduling/NextFragmentRequestRule"),_rulesSchedulingNextFragmentRequestRule2=_interopRequireDefault(_rulesSchedulingNextFragmentRequestRule),_TextSourceBuffer=require("../TextSourceBuffer"),_TextSourceBuffer2=_interopRequireDefault(_TextSourceBuffer),_modelsMetricsModel=require("../models/MetricsModel"),_modelsMetricsModel2=_interopRequireDefault(_modelsMetricsModel),_modelsFragmentModel=require("../models/FragmentModel"),_modelsFragmentModel2=_interopRequireDefault(_modelsFragmentModel),_dashDashMetrics=require("../../dash/DashMetrics"),_dashDashMetrics2=_interopRequireDefault(_dashDashMetrics),_dashDashAdapter=require("../../dash/DashAdapter"),_dashDashAdapter2=_interopRequireDefault(_dashDashAdapter),_controllersSourceBufferController=require("../controllers/SourceBufferController"),_controllersSourceBufferController2=_interopRequireDefault(_controllersSourceBufferController),_utilsLiveEdgeFinder=require("../utils/LiveEdgeFinder"),_utilsLiveEdgeFinder2=_interopRequireDefault(_utilsLiveEdgeFinder),_coreEventBus=require("../../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreEventsEvents=require("../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_controllersStreamController=require("../controllers/StreamController"),_controllersStreamController2=_interopRequireDefault(_controllersStreamController),_coreDebug=require("../../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug);ScheduleController.__dashjs_factory_name="ScheduleController",exports.default=_coreFactoryMaker2.default.getClassFactory(ScheduleController),module.exports=exports.default;
},{"../../core/Debug":13,"../../core/EventBus":14,"../../core/FactoryMaker":15,"../../core/events/Events":18,"../../dash/DashAdapter":20,"../../dash/DashMetrics":22,"../TextSourceBuffer":62,"../controllers/SourceBufferController":76,"../controllers/StreamController":77,"../models/FragmentModel":105,"../models/MetricsModel":108,"../rules/scheduling/BufferLevelRule":149,"../rules/scheduling/NextFragmentRequestRule":150,"../utils/LiveEdgeFinder":160,"../vo/metrics/PlayList":187,"./AbrController":66,"./BufferController":69,"./MediaController":72,"./PlaybackController":74}],76:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function SourceBufferController(){function e(e,r){var t=r.codec,n=null;try{if(t.match(/application\/mp4;\s*codecs="(stpp|wvtt).*"/i))throw new _voError2.default("not really supported");n=e.addSourceBuffer(t)}catch(e){if(!r.isText&&t.indexOf('codecs="stpp')===-1&&t.indexOf('codecs="wvtt')===-1)throw e;n=(0,_TextSourceBuffer2.default)(c).getInstance(),n.setConfig({errHandler:(0,_utilsErrorHandler2.default)(c).getInstance(),adapter:(0,_dashDashAdapter2.default)(c).getInstance(),dashManifestModel:v,mediaController:(0,_MediaController2.default)(c).getInstance(),videoModel:(0,_modelsVideoModel2.default)(c).getInstance(),streamController:(0,_StreamController2.default)(c).getInstance(),textTracks:(0,_TextTracks2.default)(c).getInstance(),VTTParser:(0,_utilsVTTParser2.default)(c).getInstance(),TTMLParser:(0,_utilsTTMLParser2.default)(c).getInstance()})}return n}function r(e,r){try{e.removeSourceBuffer(r)}catch(e){}}function t(e,r,t){var n,a,o=null,u=0,l=0,s=null,f=null,i=0,d=t||.15;try{o=e.buffered}catch(e){return null}if(null!==o&&void 0!==o){for(a=0,n=o.length;a<n;a++)if(u=o.start(a),l=o.end(a),null===s)i=Math.abs(u-r),r>=u&&r<l?(s=u,f=l):i<=d&&(s=u,f=l);else{if(i=u-f,!(i<=d))break;f=l}if(null!==s)return{start:s,end:f}}return null}function n(e){var r=null;try{return r=e.buffered}catch(e){return null}}function a(e){var r,t,a=n(e),o=0;if(!a)return o;for(t=0,r=a.length;t<r;t++)o+=a.end(t)-a.start(t);return o}function o(e,r,n){var a,o;return a=t(e,r,n),o=null===a?0:a.end-r}function u(e,r){if(!r)return null;var t,a,o,u,l,s,f,i,d,c=n(r);if(!c)return null;for(var _=0,E=c.length;_<E;_++){if(i=e.length>_,l=i?{start:e.start(_),end:e.end(_)}:null,t=c.start(_),a=c.end(_),!l)return d={start:t,end:a};if(o=l.start===t,u=l.end===a,!o||!u){if(o)d={start:l.end,end:a};else{if(!u)return d={start:t,end:a};d={start:t,end:l.start}}return s=e.length>_+1?{start:e.start(_+1),end:e.end(_+1)}:null,f=_+1<E?{start:c.start(_+1),end:c.end(_+1)}:null,!s||f&&f.start===s.start&&f.end===s.end||(d.end=s.start),d}}return null}function l(e,r){var t=r.bytes,n="append"in e?"append":"appendBuffer"in e?"appendBuffer":null,a="Object"===Object.prototype.toString.call(e).slice(8,-1);if(n)try{d(e,function(){a?e[n](t,r):e[n](t),d(e,function(){_.trigger(_coreEventsEvents2.default.SOURCEBUFFER_APPEND_COMPLETED,{buffer:e,bytes:t})})})}catch(r){_.trigger(_coreEventsEvents2.default.SOURCEBUFFER_APPEND_COMPLETED,{buffer:e,bytes:t,error:new _voError2.default(r.code,r.message,null)})}}function s(e,r,t,n){try{d(e,function(){r>=0&&t>r&&"ended"!==n.readyState&&e.remove(r,t),d(e,function(){_.trigger(_coreEventsEvents2.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:e,from:r,to:t})})})}catch(n){_.trigger(_coreEventsEvents2.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:e,from:r,to:t,error:new _voError2.default(n.code,n.message,null)})}}function f(e,r){try{"open"===e.readyState?r.abort():r.setTextTrack&&"ended"===e.readyState&&r.abort()}catch(e){}}function i(e){e&&e.dashManifestModel&&(v=e.dashManifestModel)}function d(e,r){var t,n=50,a=function(){e.updating||(clearInterval(t),r())},o=function t(){e.updating||(e.removeEventListener("updateend",t,!1),r())};if(!e.updating)return void r();if("function"==typeof e.addEventListener)try{e.addEventListener("updateend",o,!1)}catch(e){t=setInterval(a,n)}else t=setInterval(a,n)}var c=this.context,_=(0,_coreEventBus2.default)(c).getInstance(),E=void 0,v=void 0;return E={append:l,remove:s,abort:f,createSourceBuffer:e,removeSourceBuffer:r,getBufferRange:t,getAllRanges:n,getTotalBufferedTime:a,getBufferLength:o,getRangeDifference:u,setConfig:i}}Object.defineProperty(exports,"__esModule",{value:!0});var _TextSourceBuffer=require("../TextSourceBuffer"),_TextSourceBuffer2=_interopRequireDefault(_TextSourceBuffer),_MediaController=require("./MediaController"),_MediaController2=_interopRequireDefault(_MediaController),_dashDashAdapter=require("../../dash/DashAdapter"),_dashDashAdapter2=_interopRequireDefault(_dashDashAdapter),_utilsErrorHandler=require("../utils/ErrorHandler"),_utilsErrorHandler2=_interopRequireDefault(_utilsErrorHandler),_StreamController=require("./StreamController"),_StreamController2=_interopRequireDefault(_StreamController),_TextTracks=require("../TextTracks"),_TextTracks2=_interopRequireDefault(_TextTracks),_utilsVTTParser=require("../utils/VTTParser"),_utilsVTTParser2=_interopRequireDefault(_utilsVTTParser),_utilsTTMLParser=require("../utils/TTMLParser"),_utilsTTMLParser2=_interopRequireDefault(_utilsTTMLParser),_modelsVideoModel=require("../models/VideoModel"),_modelsVideoModel2=_interopRequireDefault(_modelsVideoModel),_voError=require("../vo/Error"),_voError2=_interopRequireDefault(_voError),_coreEventBus=require("../../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreEventsEvents=require("../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),QUOTA_EXCEEDED_ERROR_CODE=22;SourceBufferController.__dashjs_factory_name="SourceBufferController";var factory=_coreFactoryMaker2.default.getSingletonFactory(SourceBufferController);factory.QUOTA_EXCEEDED_ERROR_CODE=QUOTA_EXCEEDED_ERROR_CODE,exports.default=factory,module.exports=exports.default;
},{"../../core/EventBus":14,"../../core/FactoryMaker":15,"../../core/events/Events":18,"../../dash/DashAdapter":20,"../TextSourceBuffer":62,"../TextTracks":63,"../models/VideoModel":110,"../utils/ErrorHandler":157,"../utils/TTMLParser":163,"../utils/VTTParser":165,"../vo/Error":168,"./MediaController":72,"./StreamController":77}],77:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function StreamController(){function e(){te=null,$=[],ce=(0,_modelsMediaPlayerModel2.default)(F).getInstance(),oe=!0,ne=!1,ie=!1,fe=!1,Ee=!0,_e=null,ae=!1,se=!1}function t(e,t){oe=e,re=t,X.initialize(),Z=(0,_utilsInitCache2.default)(F).getInstance(),K=(0,_ManifestUpdater2.default)(F).getInstance(),K.setConfig({log:b,manifestModel:x,dashManifestModel:w}),K.initialize(Y),de=(0,_modelsVideoModel2.default)(F).getInstance(),ue=(0,_PlaybackController2.default)(F).getInstance(),ue.setConfig({streamController:q,timelineConverter:X,metricsModel:V,dashMetrics:Q,manifestModel:x,dashManifestModel:w,adapter:H,videoModel:de}),k.on(_coreEventsEvents2.default.TIME_SYNCHRONIZATION_COMPLETED,M,this),k.on(_coreEventsEvents2.default.PLAYBACK_SEEKING,o,this),k.on(_coreEventsEvents2.default.PLAYBACK_TIME_UPDATED,r,this),k.on(_coreEventsEvents2.default.PLAYBACK_ENDED,u,this),k.on(_coreEventsEvents2.default.PLAYBACK_ERROR,A,this),k.on(_coreEventsEvents2.default.PLAYBACK_STARTED,n,this),k.on(_coreEventsEvents2.default.PLAYBACK_PAUSED,i,this),k.on(_coreEventsEvents2.default.MANIFEST_UPDATED,S,this),k.on(_coreEventsEvents2.default.STREAM_BUFFERING_COMPLETED,a,this)}function r(e){if(T()){var t=de.getPlaybackQuality();t&&V.addDroppedFrames("video",t)}ue.isSeeking()||e.timeToEnd<=N&&u()}function o(e){var t=s(e.seekTime);t&&t!==ee?(R(_voMetricsPlayList.PlayListTrace.END_OF_PERIOD_STOP_REASON),f(ee,t,e.seekTime)):R(_voMetricsPlayList.PlayListTrace.USER_REQUEST_STOP_REASON),I(_voMetricsPlayList.PlayList.SEEK_START_REASON)}function n(){Ee?(Ee=!1,I(_voMetricsPlayList.PlayList.INITIAL_PLAYOUT_START_REASON)):fe&&(fe=!1,I(_voMetricsPlayList.PlayList.RESUME_FROM_PAUSE_START_REASON))}function i(e){e.ended||(fe=!0,R(_voMetricsPlayList.PlayListTrace.USER_REQUEST_STOP_REASON))}function a(){var e=D().isLast;le&&e&&W.signalEndOfStream(le)}function s(e){var t=0,r=null,o=$.length;o>0&&(t+=$[0].getStartTime());for(var n=0;n<o;n++)if(r=$[n],t+=r.getDuration(),e<t)return r;return null}function l(e,t){for(var r=null,o=0,n=0,i=null,a=$.length,s=0;s<a;s++){if(r=$[s],n=r.getStartTime(),i=r.getDuration(),Number.isFinite(n)&&(o=n),r.getId()===t)return e-o;Number.isFinite(i)&&(o+=i)}return null}function d(){var e=[];return ee.getProcessors().forEach(function(t){e.push(t.getIndexHandler().getEarliestTime())}),Math.min.apply(Math,e)}function u(){var e=c();e&&f(ee,e,NaN),R(e?_voMetricsPlayList.PlayListTrace.END_OF_PERIOD_STOP_REASON:_voMetricsPlayList.PlayListTrace.END_OF_CONTENT_STOP_REASON)}function c(){if(ee){var e=function(){var e=ee.getStreamInfo().start,t=ee.getStreamInfo().duration;return{v:$.filter(function(r){return r.getStreamInfo().start===e+t})[0]}}();if("object"==typeof e)return e.v}}function f(e,t,r){!ne&&t&&e!==t&&(ne=!0,k.trigger(_coreEventsEvents2.default.PERIOD_SWITCH_STARTED,{fromStreamInfo:e?e.getStreamInfo():null,toStreamInfo:t.getStreamInfo()}),e&&e.deactivate(),ee=t,ue.initialize(ee.getStreamInfo()),ve=P(),E(r))}function E(e){function t(){b("MediaSource is open!"),window.URL.revokeObjectURL(r),le.removeEventListener("sourceopen",t),le.removeEventListener("webkitsourceopen",t),v(),_(e)}var r=void 0;le?W.detachMediaSource(de):le=W.createMediaSource(),le.addEventListener("sourceopen",t,!1),le.addEventListener("webkitsourceopen",t,!1),r=W.attachMediaSource(le,de),b("MediaSource attached to element.  Waiting on open...")}function _(e){ee.activate(le),Ee||(isNaN(e)?!function(){var e=ue.getStreamStartTime(!0);ee.getProcessors().forEach(function(t){H.setIndexHandlerTime(t,e)}),ue.seek(e)}():ue.seek(e)),ee.startEventController(),!oe&&Ee||ue.play(),ne=!1,k.trigger(_coreEventsEvents2.default.PERIOD_SWITCH_COMPLETED,{toStreamInfo:ee.getStreamInfo()})}function v(){var e=ee.getStreamInfo().manifestInfo.duration,t=W.setDuration(le,e);b("Duration successfully set to: "+t)}function m(e){for(var t=0,r=$.length;t<r;t++)if($[t].getId()===e.id)return $[t];return null}function g(e){try{var t=H.getStreamsInfo(e);if(0===t.length)throw new Error("There are no streams");var r=Q.getCurrentManifestUpdate(V.getMetricsFor("stream"));V.updateManifestUpdateInfo(r,{currentTime:ue.getTime(),buffered:de.getElement().buffered,presentationStartTime:t[0].start,clientTimeOffset:X.getClientTimeOffset()});for(var o=0,n=t.length;o<n;o++){var i=t[o],a=m(i);a?a.updateData(i):(a=(0,_Stream2.default)(F).create({manifestModel:x,manifestUpdater:K,adapter:H,timelineConverter:X,capabilities:B,errHandler:J,baseURLController:j}),$.push(a),a.initialize(i,te)),V.addManifestUpdateStreamInfo(r,i.id,i.index,i.start,i.duration)}ee||f(null,$[0],NaN),k.trigger(_coreEventsEvents2.default.STREAMS_COMPOSED)}catch(t){J.manifestError(t.message,"nostreamscomposed",e),se=!0,U()}}function M(){var e=x.getValue();te&&(k.trigger(_coreEventsEvents2.default.PROTECTION_CREATED,{controller:te,manifest:e}),te.setMediaElement(de.getElement()),re&&te.setProtectionData(re)),g(e)}function S(e){if(e.error)se=!0,U();else{var t,r,o=e.manifest,n=H.getStreamsInfo(o)[0],i=H.getMediaInfoForType(o,n,"video")||H.getMediaInfoForType(o,n,"audio");i&&(t=H.getDataForMedia(i),r=w.getRepresentationsForAdaptation(o,t)[0].useCalculatedLiveEdgeTime,r&&(b("SegmentTimeline detected using calculated Live Edge Time"),ce.setUseManifestDateHeaderTimeSource(!1)));var a=w.getUTCTimingSources(e.manifest),s=!w.getIsDynamic(o)||r?a:a.concat(ce.getUTCTimingSources()),l=(0,_modelsURIQueryAndFragmentModel2.default)(F).getInstance().isManifestHTTPS();s.forEach(function(e){e.value.replace(/.*?:\/\//g,"")===_modelsMediaPlayerModel2.default.DEFAULT_UTC_TIMING_SOURCE.value.replace(/.*?:\/\//g,"")&&(e.value=e.value.replace(l?new RegExp(/^(http:)?\/\//i):new RegExp(/^(https:)?\/\//i),l?"https://":"http://"),b("Matching default timing source protocol to manifest protocol: ",e.value))}),j.initialize(o),G.setConfig({metricsModel:V,dashMetrics:Q}),G.initialize(s,ce.getUseManifestDateHeaderTimeSource())}}function T(){return void 0===ve&&(ve=P()),ve}function P(){var e=!1;return ee.getProcessors().forEach(function(t){"video"===t.getMediaInfo().type&&(e=!0)}),e}function R(e,t){t=t||new Date,_e&&(ee&&ee.getProcessors().forEach(function(r){var o=r.getScheduleController();o&&o.finalisePlayList(t,e)}),V.addPlayList(_e),_e=null)}function I(e){_e=new _voMetricsPlayList.PlayList,_e.start=new Date,_e.mstart=1e3*ue.getTime(),_e.starttype=e,ee&&ee.getProcessors().forEach(function(e){var t=e.getScheduleController();t&&t.setPlayList(_e)})}function A(e){if(e.error){var t="";switch(e.error.code){case 1:t="MEDIA_ERR_ABORTED";break;case 2:t="MEDIA_ERR_NETWORK";break;case 3:t="MEDIA_ERR_DECODE";break;case 4:t="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:t="MEDIA_ERR_ENCRYPTED";break;default:t="UNKNOWN"}ae=!0,e.error.message&&(t+=" ("+e.error.message+")"),e.error.msExtendedCode&&(t+=" (0x"+(e.error.msExtendedCode>>>0).toString(16).toUpperCase()+")"),b("Video Element Error: "+t),e.error&&b(e.error),J.mediaSourceError(t),U()}}function C(){return oe}function D(){return ee?ee.getStreamInfo():null}function p(e){return ee.getId()===e.id}function y(e){return $.filter(function(t){return t.getId()===e})[0]}function h(e){Y.load(e)}function L(e){K.setManifest(e)}function O(e){e&&(e.capabilities&&(B=e.capabilities),e.manifestLoader&&(Y=e.manifestLoader),e.manifestModel&&(x=e.manifestModel),e.dashManifestModel&&(w=e.dashManifestModel),e.protectionController&&(te=e.protectionController),e.adapter&&(H=e.adapter),e.metricsModel&&(V=e.metricsModel),e.dashMetrics&&(Q=e.dashMetrics),e.liveEdgeFinder&&(z=e.liveEdgeFinder),e.mediaSourceController&&(W=e.mediaSourceController),e.timeSyncController&&(G=e.timeSyncController),e.baseURLController&&(j=e.baseURLController),e.errHandler&&(J=e.errHandler),e.timelineConverter&&(X=e.timelineConverter))}function U(){G.reset(),R(ae||se?_voMetricsPlayList.PlayListTrace.FAILURE_STOP_REASON:_voMetricsPlayList.PlayListTrace.USER_REQUEST_STOP_REASON);for(var e=0,t=$.length;e<t;e++){var s=$[e];s.reset(ae)}$=[],k.off(_coreEventsEvents2.default.PLAYBACK_TIME_UPDATED,r,this),k.off(_coreEventsEvents2.default.PLAYBACK_SEEKING,o,this),k.off(_coreEventsEvents2.default.PLAYBACK_ERROR,A,this),k.off(_coreEventsEvents2.default.PLAYBACK_STARTED,n,this),k.off(_coreEventsEvents2.default.PLAYBACK_PAUSED,i,this),k.off(_coreEventsEvents2.default.PLAYBACK_ENDED,u,this),k.off(_coreEventsEvents2.default.MANIFEST_UPDATED,S,this),k.off(_coreEventsEvents2.default.STREAM_BUFFERING_COMPLETED,a,this),j.reset(),K.reset(),V.clearAllCurrentMetrics(),x.setValue(null),Y.reset(),X.reset(),z.reset(),H.reset(),Z.reset(),ne=!1,ie=!1,ee=null,ae=!1,se=!1,ve=void 0,Ee=!0,fe=!1,le&&(W.detachMediaSource(de),le=null),de=null,te&&(te.setMediaElement(null),te=null,re=null,x.getValue()&&k.trigger(_coreEventsEvents2.default.PROTECTION_DESTROYED,{data:x.getValue().url})),k.trigger(_coreEventsEvents2.default.STREAM_TEARDOWN_COMPLETE)}var N=.1,F=this.context,b=(0,_coreDebug2.default)(F).getInstance().log,k=(0,_coreEventBus2.default)(F).getInstance(),q=void 0,B=void 0,K=void 0,Y=void 0,x=void 0,w=void 0,H=void 0,V=void 0,Q=void 0,z=void 0,W=void 0,G=void 0,j=void 0,Z=void 0,J=void 0,X=void 0,$=void 0,ee=void 0,te=void 0,re=void 0,oe=void 0,ne=void 0,ie=void 0,ae=void 0,se=void 0,le=void 0,de=void 0,ue=void 0,ce=void 0,fe=void 0,Ee=void 0,_e=void 0,ve=void 0;return q={initialize:t,getAutoPlay:C,getActiveStreamInfo:D,isStreamActive:p,isVideoTrackPresent:T,getStreamById:y,getTimeRelativeToStreamId:l,load:h,loadWithManifest:L,getActiveStreamCommonEarliestTime:d,setConfig:O,reset:U},e(),q}Object.defineProperty(exports,"__esModule",{value:!0});var _PlaybackController=require("./PlaybackController"),_PlaybackController2=_interopRequireDefault(_PlaybackController),_Stream=require("../Stream"),_Stream2=_interopRequireDefault(_Stream),_ManifestUpdater=require("../ManifestUpdater"),_ManifestUpdater2=_interopRequireDefault(_ManifestUpdater),_coreEventBus=require("../../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreEventsEvents=require("../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_modelsURIQueryAndFragmentModel=require("../models/URIQueryAndFragmentModel"),_modelsURIQueryAndFragmentModel2=_interopRequireDefault(_modelsURIQueryAndFragmentModel),_modelsVideoModel=require("../models/VideoModel"),_modelsVideoModel2=_interopRequireDefault(_modelsVideoModel),_modelsMediaPlayerModel=require("../models/MediaPlayerModel"),_modelsMediaPlayerModel2=_interopRequireDefault(_modelsMediaPlayerModel),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_voMetricsPlayList=require("../vo/metrics/PlayList"),_coreDebug=require("../../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug),_utilsInitCache=require("../utils/InitCache"),_utilsInitCache2=_interopRequireDefault(_utilsInitCache);StreamController.__dashjs_factory_name="StreamController",exports.default=_coreFactoryMaker2.default.getSingletonFactory(StreamController),module.exports=exports.default;
},{"../../core/Debug":13,"../../core/EventBus":14,"../../core/FactoryMaker":15,"../../core/events/Events":18,"../ManifestUpdater":56,"../Stream":60,"../models/MediaPlayerModel":107,"../models/URIQueryAndFragmentModel":109,"../models/VideoModel":110,"../utils/InitCache":158,"../vo/metrics/PlayList":187,"./PlaybackController":74}],78:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function TextController(e){function r(){M=!1,g=null,p=null,B=null,h=null,y=null,D=!1,_.on(_coreEventsEvents2.default.DATA_UPDATE_COMPLETED,a,this),_.on(_coreEventsEvents2.default.INIT_FRAGMENT_LOADED,f,this)}function t(e,r,t){B=e,i(r),h=t,y=h.getRepresentationController()}function n(e){try{p=v.createSourceBuffer(g,e),M||(p.hasOwnProperty("initialize")&&p.initialize(B,this),M=!0)}catch(e){d.mediaSourceError("Error creating "+B+" source buffer.")}return p}function o(){return p}function u(e){p=e}function i(e){g=e}function c(){return h}function s(e){_.off(_coreEventsEvents2.default.DATA_UPDATE_COMPLETED,a,this),_.off(_coreEventsEvents2.default.INIT_FRAGMENT_LOADED,f,this),e||(v.abort(g,p),v.removeSourceBuffer(g,p))}function a(e){e.sender.getStreamProcessor()===h&&_.trigger(_coreEventsEvents2.default.TIMED_TEXT_REQUESTED,{index:0,sender:e.sender})}function f(e){e.fragmentModel===h.getFragmentModel()&&e.chunk.bytes&&v.append(p,e.chunk)}function l(){return D}var E=this.context,_=(0,_coreEventBus2.default)(E).getInstance(),v=e.sourceBufferController,d=e.errHandler,T=void 0,D=void 0,M=void 0,g=void 0,p=void 0,B=void 0,h=void 0,y=void 0;return T={initialize:t,createBuffer:n,getBuffer:o,setBuffer:u,getStreamProcessor:c,getIsBufferingCompleted:l,setMediaSource:i,reset:s},r(),T}Object.defineProperty(exports,"__esModule",{value:!0});var _coreEventBus=require("../../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreEventsEvents=require("../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);TextController.__dashjs_factory_name="TextController",exports.default=_coreFactoryMaker2.default.getClassFactory(TextController),module.exports=exports.default;
},{"../../core/EventBus":14,"../../core/FactoryMaker":15,"../../core/events/Events":18}],79:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function TimeSyncController(){function e(e,t){N=t,R=0,y=!1,O=!1,C={"urn:mpeg:dash:utc:http-head:2014":v,"urn:mpeg:dash:utc:http-xsdate:2014":p.bind(null,s),"urn:mpeg:dash:utc:http-iso:2014":p.bind(null,_),"urn:mpeg:dash:utc:direct:2014":l,"urn:mpeg:dash:utc:http-head:2012":v,"urn:mpeg:dash:utc:http-xsdate:2012":p.bind(null,s),"urn:mpeg:dash:utc:http-iso:2012":p.bind(null,_),"urn:mpeg:dash:utc:direct:2012":l,"urn:mpeg:dash:utc:http-ntp:2014":f,"urn:mpeg:dash:utc:ntp:2014":f,"urn:mpeg:dash:utc:sntp:2014":f},o()||(T(e),u(!0))}function t(e){e&&(e.metricsModel&&(S=e.metricsModel),e.dashMetrics&&(q=e.dashMetrics))}function r(){return i()}function n(e){y=e}function o(){return y}function u(e){O=e}function a(e){R=e}function i(){return R}function c(e){var t,r,n=60,o=60,u=1e3,a=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/,i=a.exec(e);return t=Date.UTC(parseInt(i[1],10),parseInt(i[2],10)-1,parseInt(i[3],10),parseInt(i[4],10),parseInt(i[5],10),i[6]&&(parseInt(i[6],10)||0),i[7]&&parseFloat(i[7])*u||0),i[9]&&i[10]&&(r=parseInt(i[9],10)*o+parseInt(i[10],10),t+=("+"===i[8]?-1:1)*r*n*u),new Date(t).getTime()}function s(e){var t=Date.parse(e);return isNaN(t)&&(t=c(e)),t}function _(e){return Date.parse(e)}function d(e){return Date.parse(e)}function f(e,t,r){r()}function l(e,t,r){var n=s(e);return isNaN(n)?void r():void t(n)}function p(e,t,r,n,o){var u,a,i=!1,c=new XMLHttpRequest,s=o?"HEAD":"GET",_=t.match(/\S+/g);t=_.shift(),u=function(){i||(i=!0,_.length?p(e,_.join(" "),r,n,o):n())},a=function(){var t,n;200===c.status&&(t=o?c.getResponseHeader("Date"):c.response,n=e(t),isNaN(n)||(r(n),i=!0))},c.open(s,t),c.timeout=HTTP_TIMEOUT_MS||0,c.onload=a,c.onloadend=u,c.send()}function v(e,t,r){p(d,e,t,r,!0)}function E(){var e=S.getReadOnlyMetricsFor("stream"),t=q.getLatestMPDRequestHeaderValueByID(e,"Date"),r=null!==t?new Date(t).getTime():Number.NaN;isNaN(r)?D(!0):(a(r-(new Date).getTime()),D(!1,r/1e3,R))}function D(e,t,r){n(!1),M.trigger(_coreEventsEvents2.default.TIME_SYNCHRONIZATION_COMPLETED,{time:t,offset:r,error:e?new _voError2.default(TIME_SYNC_FAILED_ERROR_CODE):null})}function T(e,t){var r=t||0,o=e[r],u=function(e,t){var r=!e||!t;r&&N?E():D(r,e,t)};n(!0),o?C.hasOwnProperty(o.schemeIdUri)?C[o.schemeIdUri](o.value,function(e){var t=(new Date).getTime(),r=e-t;a(r),h("Local time:      "+new Date(t)),h("Server time:     "+new Date(e)),h("Difference (ms): "+r),u(e,r)},function(){T(e,r+1)}):T(e,r+1):(a(0),u())}function g(){u(!1),n(!1)}var m=this.context,h=(0,_coreDebug2.default)(m).getInstance().log,M=(0,_coreEventBus2.default)(m).getInstance(),I=void 0,R=void 0,y=void 0,O=void 0,N=void 0,C=void 0,S=void 0,q=void 0;return I={initialize:e,getOffsetToDeviceTimeMs:r,setConfig:t,reset:g}}Object.defineProperty(exports,"__esModule",{value:!0});var _voError=require("./../vo/Error"),_voError2=_interopRequireDefault(_voError),_coreEventBus=require("./../../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreEventsEvents=require("./../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_coreDebug=require("../../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug),TIME_SYNC_FAILED_ERROR_CODE=1,HTTP_TIMEOUT_MS=5e3;TimeSyncController.__dashjs_factory_name="TimeSyncController";var factory=_coreFactoryMaker2.default.getSingletonFactory(TimeSyncController);factory.TIME_SYNC_FAILED_ERROR_CODE=TIME_SYNC_FAILED_ERROR_CODE,factory.HTTP_TIMEOUT_MS=HTTP_TIMEOUT_MS,exports.default=factory,module.exports=exports.default;
},{"../../core/Debug":13,"../../core/FactoryMaker":15,"./../../core/EventBus":14,"./../../core/events/Events":18,"./../vo/Error":168}],80:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function XlinkController(e){function t(){d.on(_coreEventsEvents2.default.XLINK_ELEMENT_LOADED,l,L),N=(0,_XlinkLoader2.default)(f).create({errHandler:e.errHandler,metricsModel:e.metricsModel,requestModifier:e.requestModifier})}function r(e){O=e}function n(e){A=e}function o(e){var t;p=new _externalsXml2json2.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:O}),P=e,t=i(P.Period_asArray,P,ELEMENT_TYPE_PERIOD,RESOLVE_TYPE_ONLOAD),s(t,ELEMENT_TYPE_PERIOD,RESOLVE_TYPE_ONLOAD)}function E(){d.off(_coreEventsEvents2.default.XLINK_ELEMENT_LOADED,l,L),N&&(N.reset(),N=null)}function s(e,t,r){var n,o,E,s={};for(s.elements=e,s.type=t,s.resolveType=r,0===s.elements.length&&a(s),E=0;E<s.elements.length;E++)n=s.elements[E],o=v.isHTTPURL(n.url)?n.url:n.originalContent.BaseURL+n.url,N.load(o,n,s)}function l(e){var t,r,n,o="<response>",E="</response>",s="";t=e.element,r=e.resolveObject,t.resolvedContent&&(n=t.resolvedContent.indexOf(">")+1,s=t.resolvedContent.substr(0,n)+o+t.resolvedContent.substr(n)+E,t.resolvedContent=p.xml_str2json(s)),T(r)&&a(r)}function a(e){var t,r,n=[];if(_(e),e.resolveType===RESOLVE_TYPE_ONACTUATE&&d.trigger(_coreEventsEvents2.default.XLINK_READY,{manifest:P}),e.resolveType===RESOLVE_TYPE_ONLOAD)switch(e.type){case ELEMENT_TYPE_PERIOD:for(t=0;t<P[ELEMENT_TYPE_PERIOD+"_asArray"].length;t++)r=P[ELEMENT_TYPE_PERIOD+"_asArray"][t],r.hasOwnProperty(ELEMENT_TYPE_ADAPTATIONSET+"_asArray")&&(n=n.concat(i(r[ELEMENT_TYPE_ADAPTATIONSET+"_asArray"],r,ELEMENT_TYPE_ADAPTATIONSET,RESOLVE_TYPE_ONLOAD))),r.hasOwnProperty(ELEMENT_TYPE_EVENTSTREAM+"_asArray")&&(n=n.concat(i(r[ELEMENT_TYPE_EVENTSTREAM+"_asArray"],r,ELEMENT_TYPE_EVENTSTREAM,RESOLVE_TYPE_ONLOAD)));s(n,ELEMENT_TYPE_ADAPTATIONSET,RESOLVE_TYPE_ONLOAD);break;case ELEMENT_TYPE_ADAPTATIONSET:d.trigger(_coreEventsEvents2.default.XLINK_READY,{manifest:P})}}function i(e,t,r,n){var o,E,s,l=[];for(E=e.length-1;E>=0;E--)o=e[E],o.hasOwnProperty("xlink:href")&&o["xlink:href"]===RESOLVE_TO_ZERO&&e.splice(E,1);for(E=0;E<e.length;E++)o=e[E],o.hasOwnProperty("xlink:href")&&o.hasOwnProperty("xlink:actuate")&&o["xlink:actuate"]===n&&(s=u(o["xlink:href"],t,r,E,n,o),l.push(s));return l}function _(e){var t,r,n,o,E,s,l=[];for(o=e.elements.length-1;o>=0;o--){if(t=e.elements[o],r=t.type+"_asArray",!t.resolvedContent||c())delete t.originalContent["xlink:actuate"],delete t.originalContent["xlink:href"],l.push(t.originalContent);else if(t.resolvedContent)for(E=0;E<t.resolvedContent[r].length;E++)n=t.resolvedContent[r][E],l.push(n);for(t.parentElement[r].splice(t.index,1),s=0;s<l.length;s++)t.parentElement[r].splice(t.index+s,0,l[s]);l=[]}e.elements.length>0&&A.run(P)}function u(e,t,r,n,o,E){return{url:e,parentElement:t,type:r,index:n,resolveType:o,originalContent:E,resolvedContent:null,resolved:!1}}function T(e){var t,r;for(t=0;t<e.elements.length;t++)if(r=e.elements[t],r.resolved===!1)return!1;return!0}function c(){return!1}var f=this.context,d=(0,_coreEventBus2.default)(f).getInstance(),v=(0,_utilsURLUtils2.default)(f).getInstance(),L=void 0,O=void 0,A=void 0,P=void 0,p=void 0,N=void 0;return L={resolveManifestOnLoad:o,setMatchers:r,setIron:n,reset:E},t(),L}Object.defineProperty(exports,"__esModule",{value:!0});var _XlinkLoader=require("../XlinkLoader"),_XlinkLoader2=_interopRequireDefault(_XlinkLoader),_coreEventBus=require("../../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreEventsEvents=require("../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_externalsXml2json=require("../../../externals/xml2json"),_externalsXml2json2=_interopRequireDefault(_externalsXml2json),_utilsURLUtils=require("../utils/URLUtils"),_utilsURLUtils2=_interopRequireDefault(_utilsURLUtils),RESOLVE_TYPE_ONLOAD="onLoad",RESOLVE_TYPE_ONACTUATE="onActuate",ELEMENT_TYPE_PERIOD="Period",ELEMENT_TYPE_ADAPTATIONSET="AdaptationSet",ELEMENT_TYPE_EVENTSTREAM="EventStream",RESOLVE_TO_ZERO="urn:mpeg:dash:resolve-to-zero:2013";XlinkController.__dashjs_factory_name="XlinkController",exports.default=_coreFactoryMaker2.default.getClassFactory(XlinkController),module.exports=exports.default;
},{"../../../externals/xml2json":11,"../../core/EventBus":14,"../../core/FactoryMaker":15,"../../core/events/Events":18,"../XlinkLoader":65,"../utils/URLUtils":164}],81:[function(require,module,exports){
"use strict";function _interopRequireDefault(r){return r&&r.__esModule?r:{default:r}}function MetricsReporting(){function r(r){return n=(0,_utilsDVBErrorsTranslator2.default)(o).getInstance({eventBus:r.eventBus,metricsModel:r.metricsModel}),(0,_controllersMetricsCollectionController2.default)(o).create(r)}function e(){return(0,_reportingReportingFactory2.default)(o).getInstance()}function t(){return(0,_metricsMetricsHandlerFactory2.default)(o).getInstance()}var o=this.context,i=void 0,n=void 0;return i={createMetricsReporting:r,getReportingFactory:e,getMetricsHandlerFactory:t}}Object.defineProperty(exports,"__esModule",{value:!0});var _utilsDVBErrorsTranslator=require("./utils/DVBErrorsTranslator"),_utilsDVBErrorsTranslator2=_interopRequireDefault(_utilsDVBErrorsTranslator),_MetricsReportingEvents=require("./MetricsReportingEvents"),_MetricsReportingEvents2=_interopRequireDefault(_MetricsReportingEvents),_controllersMetricsCollectionController=require("./controllers/MetricsCollectionController"),_controllersMetricsCollectionController2=_interopRequireDefault(_controllersMetricsCollectionController),_metricsMetricsHandlerFactory=require("./metrics/MetricsHandlerFactory"),_metricsMetricsHandlerFactory2=_interopRequireDefault(_metricsMetricsHandlerFactory),_reportingReportingFactory=require("./reporting/ReportingFactory"),_reportingReportingFactory2=_interopRequireDefault(_reportingReportingFactory),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);MetricsReporting.__dashjs_factory_name="MetricsReporting";var factory=_coreFactoryMaker2.default.getClassFactory(MetricsReporting);factory.events=_MetricsReportingEvents2.default,exports.default=factory,module.exports=exports.default;
},{"../../core/FactoryMaker":15,"./MetricsReportingEvents":82,"./controllers/MetricsCollectionController":83,"./metrics/MetricsHandlerFactory":88,"./reporting/ReportingFactory":93,"./utils/DVBErrorsTranslator":95}],82:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _get=function(e,t,r){for(var n=!0;n;){var o=e,i=t,s=r;n=!1,null===o&&(o=Function.prototype);var c=Object.getOwnPropertyDescriptor(o,i);if(void 0!==c){if("value"in c)return c.value;var a=c.get;if(void 0===a)return;return a.call(s)}var u=Object.getPrototypeOf(o);if(null===u)return;e=u,t=i,r=s,n=!0,c=u=void 0}},_coreEventsEventsBase=require("../../core/events/EventsBase"),_coreEventsEventsBase2=_interopRequireDefault(_coreEventsEventsBase),MetricsReportingEvents=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.METRICS_INITIALISATION_COMPLETE="internal_metricsReportingInitialized",this.BECAME_REPORTING_PLAYER="internal_becameReportingPlayer"}return _inherits(t,e),t}(_coreEventsEventsBase2.default),metricsReportingEvents=new MetricsReportingEvents;exports.default=metricsReportingEvents,module.exports=exports.default;
},{"../../core/events/EventsBase":19}],83:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function MetricsCollectionController(e){function t(t){if(!t.error){var r=Object.keys(o),n=(0,_utilsManifestParsing2.default)(i).getInstance({dashManifestModel:e.dashManifestModel}).getMetrics(t.manifest);n.forEach(function(t){var n=JSON.stringify(t);if(o.hasOwnProperty(n))r.splice(n,1);else try{var s=(0,_MetricsController2.default)(i).create(e);s.initialize(t),o[n]=s}catch(e){}}),r.forEach(function(e){o[e].reset(),delete o[e]}),s.trigger(_MetricsReportingEvents2.default.METRICS_INITIALISATION_COMPLETE)}}function r(){Object.keys(o).forEach(function(e){o[e].reset()}),o={}}function n(){s.on(_coreEventsEvents2.default.MANIFEST_UPDATED,t),s.on(_coreEventsEvents2.default.STREAM_TEARDOWN_COMPLETE,r)}var o={},i=this.context,s=e.eventBus;return n(),{}}Object.defineProperty(exports,"__esModule",{value:!0});var _MetricsController=require("./MetricsController"),_MetricsController2=_interopRequireDefault(_MetricsController),_utilsManifestParsing=require("../utils/ManifestParsing"),_utilsManifestParsing2=_interopRequireDefault(_utilsManifestParsing),_coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_MetricsReportingEvents=require("../MetricsReportingEvents"),_MetricsReportingEvents2=_interopRequireDefault(_MetricsReportingEvents),_coreEventsEvents=require("../../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents);MetricsCollectionController.__dashjs_factory_name="MetricsCollectionController",exports.default=_coreFactoryMaker2.default.getClassFactory(MetricsCollectionController),module.exports=exports.default;
},{"../../../core/FactoryMaker":15,"../../../core/events/Events":18,"../MetricsReportingEvents":82,"../utils/ManifestParsing":97,"./MetricsController":84}],84:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function MetricsController(e){function r(r){try{n=(0,_RangeController2.default)(a).create({mediaElement:e.mediaElement}),n.initialize(r.Range),l=(0,_ReportingController2.default)(a).create({log:e.log}),l.initialize(r.Reporting,n),o=(0,_MetricsHandlersController2.default)(a).create({log:e.log,eventBus:e.eventBus}),o.initialize(r.metrics,l)}catch(e){throw t(),e}}function t(){o&&o.reset(),l&&l.reset(),n&&n.reset()}var o=void 0,l=void 0,n=void 0,i=void 0,a=this.context;return i={initialize:r,reset:t}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_RangeController=require("./RangeController"),_RangeController2=_interopRequireDefault(_RangeController),_ReportingController=require("./ReportingController"),_ReportingController2=_interopRequireDefault(_ReportingController),_MetricsHandlersController=require("./MetricsHandlersController"),_MetricsHandlersController2=_interopRequireDefault(_MetricsHandlersController);MetricsController.__dashjs_factory_name="MetricsController",exports.default=_coreFactoryMaker2.default.getClassFactory(MetricsController),module.exports=exports.default;
},{"../../../core/FactoryMaker":15,"./MetricsHandlersController":85,"./RangeController":86,"./ReportingController":87}],85:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function MetricsHandlersController(e){function r(e){n.forEach(function(r){r.handleNewMetric(e.metric,e.value,e.mediaType)})}function t(e,t){e.split(",").forEach(function(e,r,a){var i;if(e.indexOf("(")!==-1&&e.indexOf(")")===-1){var o=a[r+1];o&&o.indexOf("(")===-1&&o.indexOf(")")!==-1&&(e+=","+o,delete a[r+1])}i=c.create(e,t),i&&n.push(i)}),l.on(_MediaPlayerEvents2.default.METRIC_ADDED,r,i),l.on(_MediaPlayerEvents2.default.METRIC_UPDATED,r,i)}function a(){l.off(_MediaPlayerEvents2.default.METRIC_ADDED,r,i),l.off(_MediaPlayerEvents2.default.METRIC_UPDATED,r,i),n.forEach(function(e){return e.reset()}),n=[]}var n=[],i=void 0,o=this.context,l=e.eventBus,c=(0,_metricsMetricsHandlerFactory2.default)(o).getInstance({log:e.log,eventBus:e.eventBus});return i={initialize:t,reset:a}}Object.defineProperty(exports,"__esModule",{value:!0});var _metricsMetricsHandlerFactory=require("../metrics/MetricsHandlerFactory"),_metricsMetricsHandlerFactory2=_interopRequireDefault(_metricsMetricsHandlerFactory),_coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_MediaPlayerEvents=require("../../MediaPlayerEvents"),_MediaPlayerEvents2=_interopRequireDefault(_MediaPlayerEvents);MetricsHandlersController.__dashjs_factory_name="MetricsHandlersController",exports.default=_coreFactoryMaker2.default.getClassFactory(MetricsHandlersController),module.exports=exports.default;
},{"../../../core/FactoryMaker":15,"../../MediaPlayerEvents":58,"../metrics/MetricsHandlerFactory":88}],86:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function RangeController(e){function t(e){e&&e.length&&(e.forEach(function(e){var t=e.starttime,r=t+e.duration;l.add(t,r)}),n=!!e[0]._useWallClockTime)}function r(){l.clear()}function a(){l=(0,_utilsCustomTimeRanges2.default)(i).create()}function o(){var e,t=l.length;if(!t)return!0;e=n?(new Date).getTime()/1e3:s.currentTime;for(var r=0;r<t;r+=1){var a=l.start(r),o=l.end(r);if(a<=e&&e<o)return!0}return!1}var n=!1,i=this.context,u=void 0,l=void 0,s=e.mediaElement;return u={initialize:t,reset:r,isEnabled:o},a(),u}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_utilsCustomTimeRanges=require("../../utils/CustomTimeRanges"),_utilsCustomTimeRanges2=_interopRequireDefault(_utilsCustomTimeRanges);RangeController.__dashjs_factory_name="RangeController",exports.default=_coreFactoryMaker2.default.getClassFactory(RangeController),module.exports=exports.default;
},{"../../../core/FactoryMaker":15,"../../utils/CustomTimeRanges":154}],87:[function(require,module,exports){
"use strict";function _interopRequireDefault(r){return r&&r.__esModule?r:{default:r}}function ReportingController(r){function e(r,e){r.some(function(r){var t=a.create(r,e);if(t)return n.push(t),!0})}function t(){n.forEach(function(r){return r.reset()}),n=[]}function o(r,e){n.forEach(function(t){return t.report(r,e)})}var n=[],i=void 0,a=(0,_reportingReportingFactory2.default)(this.context).getInstance({log:r.log});return i={initialize:e,reset:t,report:o}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_reportingReportingFactory=require("../reporting/ReportingFactory"),_reportingReportingFactory2=_interopRequireDefault(_reportingReportingFactory);ReportingController.__dashjs_factory_name="ReportingController",exports.default=_coreFactoryMaker2.default.getClassFactory(ReportingController),module.exports=exports.default;
},{"../../../core/FactoryMaker":15,"../reporting/ReportingFactory":93}],88:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function MetricsHandlerFactory(e){function r(r,t){var a,n=r.match(d);if(n){try{a=s[n[1]](i).create({eventBus:e.eventBus}),a.initialize(n[1],t,n[3],n[5])}catch(e){a=null,l("MetricsHandlerFactory: Could not create handler for type "+n[1]+" with args "+n[3]+", "+n[5]+" ("+e.message+")")}return a}}function t(e,r){s[e]=r}function a(e){delete s[e]}var n=void 0,l=e.log,d=/([a-zA-Z]*)(\(([0-9]*)(\,\s*([a-zA-Z]*))?\))?/,i=this.context,s={BufferLevel:_handlersBufferLevelHandler2.default,DVBErrors:_handlersDVBErrorsHandler2.default,HttpList:_handlersHttpListHandler2.default,PlayList:_handlersGenericMetricHandler2.default,RepSwitchList:_handlersGenericMetricHandler2.default,TcpList:_handlersGenericMetricHandler2.default};return n={create:r,register:t,unregister:a}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_handlersBufferLevelHandler=require("./handlers/BufferLevelHandler"),_handlersBufferLevelHandler2=_interopRequireDefault(_handlersBufferLevelHandler),_handlersDVBErrorsHandler=require("./handlers/DVBErrorsHandler"),_handlersDVBErrorsHandler2=_interopRequireDefault(_handlersDVBErrorsHandler),_handlersHttpListHandler=require("./handlers/HttpListHandler"),_handlersHttpListHandler2=_interopRequireDefault(_handlersHttpListHandler),_handlersGenericMetricHandler=require("./handlers/GenericMetricHandler"),_handlersGenericMetricHandler2=_interopRequireDefault(_handlersGenericMetricHandler);MetricsHandlerFactory.__dashjs_factory_name="MetricsHandlerFactory",exports.default=_coreFactoryMaker2.default.getSingletonFactory(MetricsHandlerFactory),module.exports=exports.default;
},{"../../../core/FactoryMaker":15,"./handlers/BufferLevelHandler":89,"./handlers/DVBErrorsHandler":90,"./handlers/GenericMetricHandler":91,"./handlers/HttpListHandler":92}],89:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function BufferLevelHandler(){function e(){try{return Object.keys(v).map(function(e){return v[e]}).reduce(function(e,r){return e.level<r.level?e:r})}catch(e){return}}function r(){var r=e();r&&f!==r.t&&(f=r.t,a.report(i,r))}function t(e,t,l){t&&(o=s.validateN(l),a=t,i=s.reconstructFullMetricName(e,l),c=setInterval(r,o))}function l(){clearInterval(c),c=null,o=0,a=null,f=null}function n(e,r,t){"BufferLevel"===e&&(v[t]=r)}var u=void 0,a=void 0,o=void 0,i=void 0,c=void 0,f=void 0,d=this.context,s=(0,_utilsHandlerHelpers2.default)(d).getInstance(),v=[];return u={initialize:t,reset:l,handleNewMetric:n}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_utilsHandlerHelpers=require("../../utils/HandlerHelpers"),_utilsHandlerHelpers2=_interopRequireDefault(_utilsHandlerHelpers);BufferLevelHandler.__dashjs_factory_name="BufferLevelHandler",exports.default=_coreFactoryMaker2.default.getClassFactory(BufferLevelHandler),module.exports=exports.default;
},{"../../../../core/FactoryMaker":15,"../../utils/HandlerHelpers":96}],90:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function DVBErrorsHandler(e){function r(){u.off(_MetricsReportingEvents2.default.METRICS_INITIALISATION_COMPLETE,r,this),u.trigger(_MetricsReportingEvents2.default.BECAME_REPORTING_PLAYER)}function t(e,t){t&&(s=t,u.on(_MetricsReportingEvents2.default.METRICS_INITIALISATION_COMPLETE,r,this))}function o(){s=null}function i(e,r){"DVBErrors"===e&&s&&s.report(e,r)}var n=void 0,s=void 0,u=e.eventBus;return n={initialize:t,reset:o,handleNewMetric:i}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_MetricsReportingEvents=require("../../MetricsReportingEvents"),_MetricsReportingEvents2=_interopRequireDefault(_MetricsReportingEvents);exports.default=_coreFactoryMaker2.default.getClassFactory(DVBErrorsHandler),module.exports=exports.default;
},{"../../../../core/FactoryMaker":15,"../../MetricsReportingEvents":82}],91:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function GenericMetricHandler(){function e(e,r){a=e,i=r}function r(){i=null,a=void 0}function t(e,r){e===a&&i&&i.report(a,r)}var o=void 0,a=void 0,i=void 0;return o={initialize:e,reset:r,handleNewMetric:t}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);GenericMetricHandler.__dashjs_factory_name="GenericMetricHandler",exports.default=_coreFactoryMaker2.default.getClassFactory(GenericMetricHandler),module.exports=exports.default;
},{"../../../../core/FactoryMaker":15}],92:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function HttpListHandler(){function e(){var e=c;e.length&&n&&n.report(u,e),c=[]}function t(t,r,l,a){r&&(i=d.validateN(l),n=r,a&&a.length&&(o=a),u=d.reconstructFullMetricName(t,l,a),s=setInterval(e,i))}function r(){clearInterval(s),s=null,i=null,o=null,c=[],n=null}function l(e,t){"HttpList"===e&&(o&&o!==t.type||c.push(t))}var a=void 0,n=void 0,i=void 0,o=void 0,u=void 0,s=void 0,c=[],d=(0,_utilsHandlerHelpers2.default)(this.context).getInstance();return a={initialize:t,reset:r,handleNewMetric:l}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_utilsHandlerHelpers=require("../../utils/HandlerHelpers"),_utilsHandlerHelpers2=_interopRequireDefault(_utilsHandlerHelpers);HttpListHandler.__dashjs_factory_name="HttpListHandler",exports.default=_coreFactoryMaker2.default.getClassFactory(HttpListHandler),module.exports=exports.default;
},{"../../../../core/FactoryMaker":15,"../../utils/HandlerHelpers":96}],93:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ReportingFactory(e){function r(e,r){var t;try{t=i[e.schemeIdUri](a).create(),t.initialize(e,r)}catch(r){t=null,n("ReportingFactory: could not create Reporting with schemeIdUri "+e.schemeIdUri+" ("+r.message+")")}return t}function t(e,r){i[e]=r}function o(e){delete i[e]}var i={"urn:dvb:dash:reporting:2014":_reportersDVBReporting2.default},a=this.context,n=e.log,c=void 0;return c={create:r,register:t,unregister:o}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_reportersDVBReporting=require("./reporters/DVBReporting"),_reportersDVBReporting2=_interopRequireDefault(_reportersDVBReporting);ReportingFactory.__dashjs_factory_name="ReportingFactory",exports.default=_coreFactoryMaker2.default.getSingletonFactory(ReportingFactory),module.exports=exports.default;
},{"../../../core/FactoryMaker":15,"./reporters/DVBReporting":94}],94:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function DVBReporting(){function e(e,r,t){var i=new XMLHttpRequest,n=function(){var e=p.indexOf(i);e!==-1&&(p.splice(e,1),i.status>=200&&i.status<300?r&&r():t&&t())};p.push(i);try{i.open("GET",e),i.onloadend=n,i.onerror=n,i.send()}catch(e){i.onerror()}}function r(r,t){Array.isArray(t)||(t=[t]),s&&_.isEnabled()&&t.forEach(function(t){var i=a.serialise(t);l&&"DVBErrors"!==r&&(i="metricname="+r+"&"+i),i=f+"?"+i,e(i,null,function(){s=!1})})}function t(e,r){var t;if(_=r,f=e["dvb:reportingUrl"],!f)throw new Error("required parameter missing (dvb:reportingUrl)");c||(t=e["dvb:probability"]||e["dvb:priority"]||0,t&&(1e3===t||t/1e3>=u.random())&&(s=!0),c=!0)}function i(){d||(p.forEach(function(e){return e.abort()}),p=[]),c=!1,s=!1,f=null,_=null}var n=void 0,o=this.context,a=(0,_utilsMetricSerialiser2.default)(o).getInstance(),u=(0,_utilsRNG2.default)(o).getInstance(),l=!0,s=!1,c=!1,f=null,_=null,d=!0,p=[];return n={report:r,initialize:t,reset:i}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_utilsMetricSerialiser=require("../../utils/MetricSerialiser"),_utilsMetricSerialiser2=_interopRequireDefault(_utilsMetricSerialiser),_utilsRNG=require("../../utils/RNG"),_utilsRNG2=_interopRequireDefault(_utilsRNG);DVBReporting.__dashjs_factory_name="DVBReporting",exports.default=_coreFactoryMaker2.default.getClassFactory(DVBReporting),module.exports=exports.default;
},{"../../../../core/FactoryMaker":15,"../../utils/MetricSerialiser":98,"../../utils/RNG":99}],95:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function DVBErrorsTranslator(e){function r(e){var r=new _voDVBErrors2.default;if(d){for(var t in e)e.hasOwnProperty(t)&&(r[t]=e[t]);r.mpdurl||(r.mpdurl=d.originalUrl||d.url),r.terror||(r.terror=new Date),l.addDVBErrors(r)}}function t(e){e.error||(d=e.manifest)}function o(e){r({errorcode:_voDVBErrors2.default.BASE_URL_CHANGED,servicelocation:e.entry})}function n(){r({errorcode:_voDVBErrors2.default.BECAME_REPORTER})}function E(e){(0===e.responsecode||e.responsecode>=400||e.responsecode<100||e.responsecode>=600)&&r({errorcode:e.responsecode||_voDVBErrors2.default.CONNECTION_ERROR,url:e.url,terror:e.tresponse,servicelocation:e._serviceLocation})}function a(e){switch(e.metric){case"HttpList":E(e.value)}}function s(e){var t,o=e.error?e.error.code:0;switch(o){case MediaError.MEDIA_ERR_NETWORK:t=_voDVBErrors2.default.CONNECTION_ERROR;break;case MediaError.MEDIA_ERR_DECODE:t=_voDVBErrors2.default.CORRUPT_MEDIA_OTHER;break;default:return}r({errorcode:t})}function _(){c.on(_coreEventsEvents2.default.MANIFEST_UPDATED,t,u),c.on(_coreEventsEvents2.default.SERVICE_LOCATION_BLACKLIST_CHANGED,o,u),c.on(_MediaPlayerEvents2.default.METRIC_ADDED,a,u),c.on(_MediaPlayerEvents2.default.METRIC_UPDATED,a,u),c.on(_MediaPlayerEvents2.default.PLAYBACK_ERROR,s,u),c.on(_MetricsReportingEvents2.default.BECAME_REPORTING_PLAYER,n,u)}function i(){c.off(_coreEventsEvents2.default.MANIFEST_UPDATED,t,u),c.off(_coreEventsEvents2.default.SERVICE_LOCATION_BLACKLIST_CHANGED,o,u),c.off(_MediaPlayerEvents2.default.METRIC_ADDED,a,u),c.off(_MediaPlayerEvents2.default.METRIC_UPDATED,a,u),c.off(_MediaPlayerEvents2.default.PLAYBACK_ERROR,s,u),c.off(_MetricsReportingEvents2.default.BECAME_REPORTING_PLAYER,n,u)}var u=void 0,c=e.eventBus,l=e.metricsModel,d=void 0;return u={initialise:_,reset:i},_(),u}Object.defineProperty(exports,"__esModule",{value:!0});var _voDVBErrors=require("../vo/DVBErrors"),_voDVBErrors2=_interopRequireDefault(_voDVBErrors),_coreEventsEvents=require("../../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_MediaPlayerEvents=require("../../MediaPlayerEvents"),_MediaPlayerEvents2=_interopRequireDefault(_MediaPlayerEvents),_MetricsReportingEvents=require("../MetricsReportingEvents"),_MetricsReportingEvents2=_interopRequireDefault(_MetricsReportingEvents),_coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);DVBErrorsTranslator.__dashjs_factory_name="DVBErrorsTranslator",exports.default=_coreFactoryMaker2.default.getSingletonFactory(DVBErrorsTranslator),module.exports=exports.default;
},{"../../../core/FactoryMaker":15,"../../../core/events/Events":18,"../../MediaPlayerEvents":58,"../MetricsReportingEvents":82,"../vo/DVBErrors":100}],96:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function HandlerHelpers(){return{reconstructFullMetricName:function(e,r,t){var o=e;return r&&(o+="("+r,t&&t.length&&(o+=","+t),o+=")"),o},validateN:function(e){if(!e)throw new Error("missing n");if(isNaN(e))throw new Error("n is NaN");if(e<0)throw new Error("n must be positive");return e}}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);HandlerHelpers.__dashjs_factory_name="HandlerHelpers",exports.default=_coreFactoryMaker2.default.getSingletonFactory(HandlerHelpers),module.exports=exports.default;
},{"../../../core/FactoryMaker":15}],97:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ManifestParsing(e){function r(e,r,t){var a,o,n=i.getMpd(e),s=0;return r?s=n.availabilityStartTime.getTime()/1e3:(a=this.getRegularPeriods(e,n),a.length&&(s=a[0].start)),o=s,t&&t.hasOwnProperty("starttime")&&(o+=t.starttime),o}function t(e){var t=[];return e.Metrics_asArray&&e.Metrics_asArray.forEach(function(a){var o=new _voMetrics2.default,n=i.getIsDynamic(e);a.hasOwnProperty("metrics")&&(o.metrics=a.metrics,a.Range_asArray&&a.Range_asArray.forEach(function(t){var a=new _voRange2.default;a.starttime=r(e,n,t),t.hasOwnProperty("duration")?a.duration=t.duration:a.duration=i.getDuration(e),a._useWallClockTime=n,o.Range.push(a)}),a.Reporting_asArray&&(a.Reporting_asArray.forEach(function(e){var r=new _voReporting2.default;if(e.hasOwnProperty("schemeIdUri")){r.schemeIdUri=e.schemeIdUri;for(var t in e)e.hasOwnProperty(t)&&(r[t]=e[t]);o.Reporting.push(r)}}),t.push(o)))}),t}var a=void 0,i=e.dashManifestModel;return a={getMetrics:t}}Object.defineProperty(exports,"__esModule",{value:!0});var _voMetrics=require("../vo/Metrics"),_voMetrics2=_interopRequireDefault(_voMetrics),_voRange=require("../vo/Range"),_voRange2=_interopRequireDefault(_voRange),_voReporting=require("../vo/Reporting"),_voReporting2=_interopRequireDefault(_voReporting),_coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);ManifestParsing.__dashjs_factory_name="ManifestParsing",exports.default=_coreFactoryMaker2.default.getSingletonFactory(ManifestParsing),module.exports=exports.default;
},{"../../../core/FactoryMaker":15,"../vo/Metrics":101,"../vo/Range":102,"../vo/Reporting":103}],98:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function MetricSerialiser(){function e(r){var t,o,i=[],n=[];for(t in r)if(r.hasOwnProperty(t)&&0!==t.indexOf("_")){if(o=r[t],void 0!==o&&null!==o||(o=""),Array.isArray(o)){if(!o.length)continue;n=[],o.forEach(function(r){var t="Object"!==Object.prototype.toString.call(r).slice(8,-1);n.push(t?r:e(r))}),o=n.map(encodeURIComponent).join(",")}else"string"==typeof o?o=encodeURIComponent(o):o instanceof Date?o=o.toISOString():"number"==typeof o&&(o=Math.round(o));i.push(t+"="+o)}return i.join("&")}return{serialise:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);MetricSerialiser.__dashjs_factory_name="MetricSerialiser",exports.default=_coreFactoryMaker2.default.getSingletonFactory(MetricSerialiser),module.exports=exports.default;
},{"../../../core/FactoryMaker":15}],99:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function RNG(){function e(){t&&(u||(u=new o(n)),t.getRandomValues(u),c=0)}function r(r,o){var n;return r||(r=0),o||(o=1),t?(c===u.length&&e(),n=u[c]/a,c+=1):n=Math.random(),n*(o-r)+r}var t=window.crypto||window.msCrypto,o=Uint32Array,a=Math.pow(2,8*o.BYTES_PER_ELEMENT)-1,n=10,u=void 0,c=void 0,i=void 0;return i={random:r},e(),i}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);RNG.__dashjs_factory_name="RNG",exports.default=_coreFactoryMaker2.default.getSingletonFactory(RNG),module.exports=exports.default;
},{"../../../core/FactoryMaker":15}],100:[function(require,module,exports){
"use strict";function _classCallCheck(r,s){if(!(r instanceof s))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var DVBErrors=function r(){_classCallCheck(this,r),this.mpdurl=null,this.errorcode=null,this.terror=null,this.url=null,this.ipaddress=null,this.servicelocation=null};DVBErrors.SSL_CONNECTION_FAILED_PREFIX="SSL",DVBErrors.DNS_RESOLUTION_FAILED="C00",DVBErrors.HOST_UNREACHABLE="C01",DVBErrors.CONNECTION_REFUSED="C02",DVBErrors.CONNECTION_ERROR="C03",DVBErrors.CORRUPT_MEDIA_ISOBMFF="M00",DVBErrors.CORRUPT_MEDIA_OTHER="M01",DVBErrors.BASE_URL_CHANGED="F00",DVBErrors.BECAME_REPORTER="S00",exports.default=DVBErrors,module.exports=exports.default;
},{}],101:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var Metrics=function e(){_classCallCheck(this,e),this.metrics="",this.Range=[],this.Reporting=[]};exports.default=Metrics,module.exports=exports.default;
},{}],102:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var Range=function e(){_classCallCheck(this,e),this.starttime=0,this.duration=1/0,this._useWallClockTime=!1};exports.default=Range,module.exports=exports.default;
},{}],103:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var Reporting=function e(){_classCallCheck(this,e),this.schemeIdUri="",this.value=""};exports.default=Reporting,module.exports=exports.default;
},{}],104:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BaseURLTreeModel(){function e(){d=new Node}function t(e,t,a){var r=u.getBaseURLsFromElement(a);e[t]?f.areSimpleEquivalent(r,e[t].data.baseUrls)||(e[t].data.baseUrls=r,e[t].data.selectedIdx=DEFAULT_INDEX):e[t]=new Node(r)}function a(e){var a=u.getBaseURLsFromElement(e);f.areSimpleEquivalent(a,d.data.baseUrls)||(d.data.baseUrls=a,d.data.selectedIdx=DEFAULT_INDEX),e.Period_asArray&&e.Period_asArray.forEach(function(e,a){t(d.children,a,e),e.AdaptationSet_asArray&&e.AdaptationSet_asArray.forEach(function(e,r){t(d.children[a].children,r,e),e.Representation_asArray&&e.Representation_asArray.sort(u.getRepresentationSortFunction()).forEach(function(e,s){t(d.children[a].children[r].children,s,e)})})})}function r(e,t){var a=t||d;e(a.data),a.children&&a.children.forEach(function(t){return r(e,t)})}function s(e){r(function(t){isNaN(t.selectedIdx)||e===t.baseUrls[t.selectedIdx].serviceLocation&&(t.selectedIdx=DEFAULT_INDEX)})}function n(e){a(e)}function o(){d=new Node}function i(e){var t=d,a=[t.data];return e.forEach(function(e){t=t.children[e],t&&a.push(t.data)}),a.filter(function(e){return e.baseUrls.length})}var l=void 0,d=void 0,c=this.context,u=(0,_dashModelsDashManifestModel2.default)(c).getInstance(),f=(0,_utilsObjectUtils2.default)(c).getInstance();return l={reset:o,update:n,getForPath:i,invalidateSelectedIndexes:s},e(),l}Object.defineProperty(exports,"__esModule",{value:!0});var _dashModelsDashManifestModel=require("../../dash/models/DashManifestModel"),_dashModelsDashManifestModel2=_interopRequireDefault(_dashModelsDashManifestModel),_utilsObjectUtils=require("../utils/ObjectUtils"),_utilsObjectUtils2=_interopRequireDefault(_utilsObjectUtils),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),DEFAULT_INDEX=NaN,Node=function e(t,a){_classCallCheck(this,e),this.data={baseUrls:t||null,selectedIdx:a||DEFAULT_INDEX},this.children=[]};BaseURLTreeModel.__dashjs_factory_name="BaseURLTreeModel",exports.default=_coreFactoryMaker2.default.getClassFactory(BaseURLTreeModel),module.exports=exports.default;
},{"../../core/FactoryMaker":15,"../../dash/models/DashManifestModel":27,"../utils/ObjectUtils":161}],105:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function FragmentModel(e){function t(){F=null,g=null,O=[],R=[],T.on(_coreEventsEvents2.default.LOADING_COMPLETED,D,L)}function r(e){g=e}function n(e){F=e}function o(){return F}function a(e){var t=function(e,t){return e.action===_voFragmentRequest2.default.ACTION_COMPLETE&&e.action===t.action},r=function(e,t){return!isNaN(e.index)&&e.startTime===t.startTime&&e.adaptationIndex===t.adaptationIndex},n=function(e,t){return isNaN(e.index)&&isNaN(t.index)&&e.quality===t.quality},o=function(o){var a=!1;return o.some(function(o){if(r(e,o)||n(e,o)||t(e,o))return a=!0}),a};return o(O)}function u(e){var t=e.state instanceof Array?e.state:[e.state],r=[];return t.forEach(function(t){var n=d(t);r=r.concat(f(n,e))}),r}function i(e){O=O.filter(function(t){return isNaN(t.startTime)||t.startTime>=e})}function s(){g.abort(),R=[]}function E(e){switch(e.action){case _voFragmentRequest2.default.ACTION_COMPLETE:O.push(e),l(e,FRAGMENT_MODEL_EXECUTED),T.trigger(_coreEventsEvents2.default.STREAM_COMPLETED,{request:e,fragmentModel:this});break;case _voFragmentRequest2.default.ACTION_DOWNLOAD:l(e,FRAGMENT_MODEL_LOADING),R.push(e),c(e);break;default:v("Unknown request action.")}}function c(e){T.trigger(_coreEventsEvents2.default.FRAGMENT_LOADING_STARTED,{sender:L,request:e}),g.load(e)}function _(e,t,r){for(var n=e.length-1,o=n;o>=0;o--){var a=e[o],u=a.startTime,i=u+a.duration;if(r=void 0!==r?r:a.duration/2,!isNaN(u)&&!isNaN(i)&&t+r>=u&&t-r<i||isNaN(u)&&isNaN(t))return a}return null}function f(e,t){return t.hasOwnProperty("time")?[_(e,t.time,t.threshold)]:e.filter(function(e){for(var r in t)if("state"!==r&&t.hasOwnProperty(r)&&e[r]!=t[r])return!1;return!0})}function d(e){var t=void 0;switch(e){case FRAGMENT_MODEL_LOADING:t=R;break;case FRAGMENT_MODEL_EXECUTED:t=O;break;default:t=[]}return t}function l(e,t){A.addSchedulingInfo(e.mediaType,new Date,e.type,e.startTime,e.availabilityStartTime,e.duration,e.quality,e.range,t),A.addRequestsQueue(e.mediaType,R,O)}function D(e){e.sender===g&&(R.splice(R.indexOf(e.request),1),e.response&&!e.error&&O.push(e.request),l(e.request,e.error?FRAGMENT_MODEL_FAILED:FRAGMENT_MODEL_EXECUTED),T.trigger(_coreEventsEvents2.default.FRAGMENT_LOADING_COMPLETED,{request:e.request,response:e.response,error:e.error,sender:this}))}function M(){T.off(_coreEventsEvents2.default.LOADING_COMPLETED,D,this),g&&(g.reset(),g=null),O=[],R=[]}var N=this.context,v=(0,_coreDebug2.default)(N).getInstance().log,T=(0,_coreEventBus2.default)(N).getInstance(),A=e.metricsModel,L=void 0,F=void 0,O=void 0,R=void 0,g=void 0;return L={setLoader:r,setScheduleController:n,getScheduleController:o,getRequests:u,isFragmentLoaded:a,removeExecutedRequestsBeforeTime:i,abortRequests:s,executeRequest:E,reset:M},t(),L}Object.defineProperty(exports,"__esModule",{value:!0});var _coreEventBus=require("../../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreEventsEvents=require("../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_voFragmentRequest=require("../vo/FragmentRequest"),_voFragmentRequest2=_interopRequireDefault(_voFragmentRequest),_coreDebug=require("../../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug),FRAGMENT_MODEL_LOADING="loading",FRAGMENT_MODEL_EXECUTED="executed",FRAGMENT_MODEL_CANCELED="canceled",FRAGMENT_MODEL_FAILED="failed";FragmentModel.__dashjs_factory_name="FragmentModel";var factory=_coreFactoryMaker2.default.getClassFactory(FragmentModel);factory.FRAGMENT_MODEL_LOADING=FRAGMENT_MODEL_LOADING,factory.FRAGMENT_MODEL_EXECUTED=FRAGMENT_MODEL_EXECUTED,factory.FRAGMENT_MODEL_CANCELED=FRAGMENT_MODEL_CANCELED,factory.FRAGMENT_MODEL_FAILED=FRAGMENT_MODEL_FAILED,exports.default=factory,module.exports=exports.default;
},{"../../core/Debug":13,"../../core/EventBus":14,"../../core/FactoryMaker":15,"../../core/events/Events":18,"../vo/FragmentRequest":169}],106:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ManifestModel(){function e(){return a}function t(e){a=e,e&&o.trigger(_coreEventsEvents2.default.MANIFEST_LOADED,{data:e})}var r=this.context,o=(0,_coreEventBus2.default)(r).getInstance(),n=void 0,a=void 0;return n={getValue:e,setValue:t}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreEventBus=require("../../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreEventsEvents=require("../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);ManifestModel.__dashjs_factory_name="ManifestModel",exports.default=_coreFactoryMaker2.default.getSingletonFactory(ManifestModel),module.exports=exports.default;
},{"../../core/EventBus":14,"../../core/FactoryMaker":15,"../../core/events/Events":18}],107:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,t,T){return t in e?Object.defineProperty(e,t,{value:T,enumerable:!0,configurable:!0,writable:!0}):e[t]=T,e}function MediaPlayerModel(){function e(){var e,t;te=[],ee=!1,$=!0,_e=!0,Ne=!1,Fe=!1,Ee={enabled:!0,ttl:DEFAULT_LOCAL_STORAGE_BITRATE_EXPIRATION},ie={enabled:!0,ttl:DEFAULT_LOCAL_STORAGE_MEDIA_SETTINGS_EXPIRATION},Te=LIVE_DELAY_FRAGMENT_COUNT,ne=void 0,re=BUFFER_TO_KEEP,oe=BUFFER_PRUNING_INTERVAL,ue=NaN,Re=BUFFER_TIME_AT_TOP_QUALITY,se=BUFFER_TIME_AT_TOP_QUALITY_LONG_FORM,ae=LONG_FORM_CONTENT_DURATION_THRESHOLD,ce=RICH_BUFFER_THRESHOLD,fe=BANDWIDTH_SAFETY_FACTOR,Ae=ABANDON_LOAD_TIMEOUT,Pe=WALLCLOCK_TIME_UPDATE_INTERVAL,de={default:DEFAULT_XHR_WITH_CREDENTIALS},e={},_defineProperty(e,_voMetricsHTTPRequest.HTTPRequest.MPD_TYPE,MANIFEST_RETRY_ATTEMPTS),_defineProperty(e,_voMetricsHTTPRequest.HTTPRequest.XLINK_EXPANSION_TYPE,XLINK_RETRY_ATTEMPTS),_defineProperty(e,_voMetricsHTTPRequest.HTTPRequest.MEDIA_SEGMENT_TYPE,FRAGMENT_RETRY_ATTEMPTS),_defineProperty(e,_voMetricsHTTPRequest.HTTPRequest.INIT_SEGMENT_TYPE,FRAGMENT_RETRY_ATTEMPTS),_defineProperty(e,_voMetricsHTTPRequest.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,FRAGMENT_RETRY_ATTEMPTS),_defineProperty(e,_voMetricsHTTPRequest.HTTPRequest.INDEX_SEGMENT_TYPE,FRAGMENT_RETRY_ATTEMPTS),_defineProperty(e,_voMetricsHTTPRequest.HTTPRequest.OTHER_TYPE,FRAGMENT_RETRY_ATTEMPTS),Me=e,t={},_defineProperty(t,_voMetricsHTTPRequest.HTTPRequest.MPD_TYPE,MANIFEST_RETRY_INTERVAL),_defineProperty(t,_voMetricsHTTPRequest.HTTPRequest.XLINK_EXPANSION_TYPE,XLINK_RETRY_INTERVAL),_defineProperty(t,_voMetricsHTTPRequest.HTTPRequest.MEDIA_SEGMENT_TYPE,FRAGMENT_RETRY_INTERVAL),_defineProperty(t,_voMetricsHTTPRequest.HTTPRequest.INIT_SEGMENT_TYPE,FRAGMENT_RETRY_INTERVAL),_defineProperty(t,_voMetricsHTTPRequest.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,FRAGMENT_RETRY_INTERVAL),_defineProperty(t,_voMetricsHTTPRequest.HTTPRequest.INDEX_SEGMENT_TYPE,FRAGMENT_RETRY_INTERVAL),_defineProperty(t,_voMetricsHTTPRequest.HTTPRequest.OTHER_TYPE,FRAGMENT_RETRY_INTERVAL),Ie=t}function t(e){Ne=e}function T(){return Ne}function n(e){fe=e}function _(){return fe}function r(e){Ae=e}function o(){return Ae}function E(e){ue=e}function i(){return isNaN(ue)?Fe?DEFAULT_MIN_BUFFER_TIME_FAST_SWITCH:DEFAULT_MIN_BUFFER_TIME:ue}function u(e){Re=e}function R(){return Re}function s(e){se=e}function a(){return se}function c(e){ae=e}function f(){return ae}function A(e){ce=e}function M(){return ce}function I(e){re=e}function P(){return re}function N(e,t){Ee.enabled=e,void 0===t||isNaN(t)||"number"!=typeof t||(Ee.ttl=t)}function d(){return Ee}function F(e,t){ie.enabled=e,void 0===t||isNaN(t)||"number"!=typeof t||(ie.ttl=t)}function L(){return ie}function l(e){oe=e}function S(){return oe}function v(e){Me[_voMetricsHTTPRequest.HTTPRequest.MEDIA_SEGMENT_TYPE]=e}function H(e,t){Me[e]=t}function y(){return Me[_voMetricsHTTPRequest.HTTPRequest.MEDIA_SEGMENT_TYPE]}function O(e){return Me[e]}function D(e){Ie[_voMetricsHTTPRequest.HTTPRequest.MEDIA_SEGMENT_TYPE]=e}function U(e,t){Ie[e]=t}function g(){return Ie[_voMetricsHTTPRequest.HTTPRequest.MEDIA_SEGMENT_TYPE]}function p(e){return Ie[e]}function Y(e){Pe=e}function G(){return Pe}function q(e){_e=e}function B(){return _e}function C(e){Te=e}function m(e){ne=e}function h(){return Te}function b(){return ne}function X(e){$=e}function V(){return $}function W(e){ee=e}function K(){return ee}function k(e){te=e}function Q(){return te}function w(e,t){e?de[e]=!!t:Object.keys(de).forEach(function(e){w(e,t)})}function x(e){var t=de[e];return void 0===t?de.default:t}function j(){return Fe}function z(e){Fe=e}function J(){}var Z=void 0,$=void 0,ee=void 0,te=void 0,Te=void 0,ne=void 0,_e=void 0,re=void 0,oe=void 0,Ee=void 0,ie=void 0,ue=void 0,Re=void 0,se=void 0,ae=void 0,ce=void 0,fe=void 0,Ae=void 0,Me=void 0,Ie=void 0,Pe=void 0,Ne=void 0,de=void 0,Fe=void 0;return Z={setBufferOccupancyABREnabled:t,getBufferOccupancyABREnabled:T,setBandwidthSafetyFactor:n,getBandwidthSafetyFactor:_,setAbandonLoadTimeout:r,getAbandonLoadTimeout:o,setLastBitrateCachingInfo:N,getLastBitrateCachingInfo:d,setLastMediaSettingsCachingInfo:F,getLastMediaSettingsCachingInfo:L,setStableBufferTime:E,getStableBufferTime:i,setBufferTimeAtTopQuality:u,getBufferTimeAtTopQuality:R,setBufferTimeAtTopQualityLongForm:s,getBufferTimeAtTopQualityLongForm:a,setLongFormContentDurationThreshold:c,getLongFormContentDurationThreshold:f,setRichBufferThreshold:A,getRichBufferThreshold:M,setBufferToKeep:I,getBufferToKeep:P,setBufferPruningInterval:l,getBufferPruningInterval:S,setFragmentRetryAttempts:v,getFragmentRetryAttempts:y,setRetryAttemptsForType:H,getRetryAttemptsForType:O,setFragmentRetryInterval:D,getFragmentRetryInterval:g,setRetryIntervalForType:U,getRetryIntervalForType:p,setWallclockTimeUpdateInterval:Y,getWallclockTimeUpdateInterval:G,setScheduleWhilePaused:q,getScheduleWhilePaused:B,getUseSuggestedPresentationDelay:K,setUseSuggestedPresentationDelay:W,setLiveDelayFragmentCount:C,getLiveDelayFragmentCount:h,getLiveDelay:b,setLiveDelay:m,setUseManifestDateHeaderTimeSource:X,getUseManifestDateHeaderTimeSource:V,setUTCTimingSources:k,getUTCTimingSources:Q,setXHRWithCredentialsForType:w,getXHRWithCredentialsForType:x,setFastSwitchEnabled:z,getFastSwitchEnabled:j,reset:J},e(),Z}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_voMetricsHTTPRequest=require("../vo/metrics/HTTPRequest"),DEFAULT_UTC_TIMING_SOURCE={scheme:"urn:mpeg:dash:utc:http-xsdate:2014",value:"http://time.akamai.com/?iso"},LIVE_DELAY_FRAGMENT_COUNT=4,DEFAULT_LOCAL_STORAGE_BITRATE_EXPIRATION=36e4,DEFAULT_LOCAL_STORAGE_MEDIA_SETTINGS_EXPIRATION=36e4,BANDWIDTH_SAFETY_FACTOR=.9,ABANDON_LOAD_TIMEOUT=1e4,BUFFER_TO_KEEP=30,BUFFER_PRUNING_INTERVAL=30,DEFAULT_MIN_BUFFER_TIME=12,DEFAULT_MIN_BUFFER_TIME_FAST_SWITCH=20,BUFFER_TIME_AT_TOP_QUALITY=30,BUFFER_TIME_AT_TOP_QUALITY_LONG_FORM=60,LONG_FORM_CONTENT_DURATION_THRESHOLD=600,RICH_BUFFER_THRESHOLD=20,FRAGMENT_RETRY_ATTEMPTS=3,FRAGMENT_RETRY_INTERVAL=1e3,MANIFEST_RETRY_ATTEMPTS=3,MANIFEST_RETRY_INTERVAL=500,XLINK_RETRY_ATTEMPTS=1,XLINK_RETRY_INTERVAL=500,WALLCLOCK_TIME_UPDATE_INTERVAL=50,DEFAULT_XHR_WITH_CREDENTIALS=!1;MediaPlayerModel.__dashjs_factory_name="MediaPlayerModel";var factory=_coreFactoryMaker2.default.getSingletonFactory(MediaPlayerModel);factory.DEFAULT_UTC_TIMING_SOURCE=DEFAULT_UTC_TIMING_SOURCE,exports.default=factory,module.exports=exports.default;
},{"../../core/FactoryMaker":15,"../vo/metrics/HTTPRequest":185}],108:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function MetricsModel(){function e(){C={}}function t(e){e&&e.adapter&&(F=e.adapter)}function r(){g.trigger(_coreEventsEvents2.default.METRICS_CHANGED)}function i(e){g.trigger(_coreEventsEvents2.default.METRIC_CHANGED,{mediaType:e}),r()}function n(e,t,r){g.trigger(_coreEventsEvents2.default.METRIC_UPDATED,{mediaType:e,metric:t,value:r}),i(e)}function s(e,t,r){g.trigger(_coreEventsEvents2.default.METRIC_ADDED,{mediaType:e,metric:t,value:r}),i(e)}function o(e){delete C[e],i(e)}function a(){C={},r()}function u(e){return C.hasOwnProperty(e)?C[e]:null}function c(e){var t;return C.hasOwnProperty(e)?t=C[e]:(t=new _voMetricsList2.default,C[e]=t),t}function f(e,t,r,i,n,o){var a=new _voMetricsTCPConnection2.default;return a.tcpid=t,a.dest=r,a.topen=i,a.tclose=n,a.tconnect=o,c(e).TcpList.push(a),s(e,F.metricsList.TCP_CONNECTION,a),a}function d(e,t,r,i){var n=new _voMetricsHTTPRequest.HTTPRequestTrace;return n.s=t,n.d=r,n.b=i,e.trace.push(n),e.interval||(e.interval=0),e.interval+=r,n}function l(e,t,r,i,n,o,a,u,f,v,_,p,M,m){var T=new _voMetricsHTTPRequest.HTTPRequest;return n&&n!==i&&(l(e,null,r,i,null,null,a,u,null,null,null,p,null,null),T.actualurl=n),T.tcpid=t,T.type=r,T.url=i,T.range=a,T.trequest=u,T.tresponse=f,T.responsecode=_,T._tfinish=v,T._stream=e,T._mediaduration=p,T._responseHeaders=M,T._serviceLocation=o,m?m.forEach(function(e){d(T,e.s,e.d,e.b)}):(delete T.interval,delete T.trace),c(e).HttpList.push(T),s(e,F.metricsList.HTTP_REQUEST,T),T}function v(e,t,r,i,n){var o=new _voMetricsRepresentationSwitch2.default;return o.t=t,o.mt=r,o.to=i,n?o.lto=n:delete o.lto,c(e).RepSwitchList.push(o),s(e,F.metricsList.TRACK_SWITCH,o),o}function _(e,t,r){var i=new _voMetricsBufferLevel2.default;return i.t=t,i.level=r,c(e).BufferLevel.push(i),s(e,F.metricsList.BUFFER_LEVEL,i),i}function p(e,t,r){var i=new _voMetricsBufferState2.default;return i.target=r,i.state=t,c(e).BufferState.push(i),s(e,F.metricsList.BUFFER_STATE,i),i}function M(e,t,r,i){var n=new _voMetricsDVRInfo2.default;return n.time=t,n.range=i,n.manifestInfo=r,c(e).DVRInfo.push(n),s(e,F.metricsList.DVR_INFO,n),n}function m(e,t){var r=new _voMetricsDroppedFrames2.default,i=c(e).DroppedFrames;return r.time=t.creationTime,r.droppedFrames=t.droppedVideoFrames,i.length>0&&i[i.length-1]==r?i[i.length-1]:(i.push(r),s(e,F.metricsList.DROPPED_FRAMES,r),r)}function T(e,t,r,i,n,o,a,u,f){var d=new _voMetricsSchedulingInfo2.default;return d.mediaType=e,d.t=t,d.type=r,d.startTime=i,d.availabilityStartTime=n,d.duration=o,d.quality=a,d.range=u,d.state=f,c(e).SchedulingInfo.push(d),s(e,F.metricsList.SCHEDULING_INFO,d),d}function R(e,t,r){var i=new _voMetricsRequestsQueue2.default;i.loadingRequests=t,i.executedRequests=r,c(e).RequestsQueue=i,s(e,F.metricsList.REQUESTS_QUEUE,i)}function E(e,t,r,i,n,o,a,u,f,d){var l=new _voMetricsManifestUpdate.ManifestUpdate,v=c("stream");return l.mediaType=e,l.type=t,l.requestTime=r,l.fetchTime=i,l.availabilityStartTime=n,l.presentationStartTime=o,l.clientTimeOffset=a,l.currentTime=u,l.buffered=f,l.latency=d,v.ManifestUpdate.push(l),s(e,F.metricsList.MANIFEST_UPDATE,l),l}function S(e,t){if(e){for(var r in t)e[r]=t[r];n(e.mediaType,F.metricsList.MANIFEST_UPDATE,e)}}function q(e,t,r,i,s){if(e){var o=new _voMetricsManifestUpdate.ManifestUpdateStreamInfo;return o.id=t,o.index=r,o.start=i,o.duration=s,e.streamInfo.push(o),n(e.mediaType,F.metricsList.MANIFEST_UPDATE_STREAM_INFO,e),o}return null}function D(e,t,r,i,s,o,a,u){if(e){var c=new _voMetricsManifestUpdate.ManifestUpdateTrackInfo;return c.id=t,c.index=r,c.streamIndex=i,c.mediaType=s,c.startNumber=a,c.fragmentInfoType=u,c.presentationTimeOffset=o,e.trackInfo.push(c),n(e.mediaType,F.metricsList.MANIFEST_UPDATE_TRACK_INFO,e),c}return null}function h(e){var t="stream";return e.trace&&Array.isArray(e.trace)?e.trace.forEach(function(e){e.hasOwnProperty("subreplevel")&&!e.subreplevel&&delete e.subreplevel}):delete e.trace,c(t).PlayList.push(e),s(t,F.metricsList.PLAY_LIST,e),e}function I(e){var t="stream";return c(t).DVBErrors.push(e),s(t,F.metricsList.DVB_ERRORS,e),e}function L(e,t){var r=new _voMetricsBolaState2.default;return r._s=t,c(e).BolaState=[r],s(e,"BolaState",r),r}var y=this.context,g=(0,_coreEventBus2.default)(y).getInstance(),B=void 0,F=void 0,C=void 0;return B={metricsChanged:r,metricChanged:i,metricUpdated:n,metricAdded:s,clearCurrentMetricsForType:o,clearAllCurrentMetrics:a,getReadOnlyMetricsFor:u,getMetricsFor:c,addTcpConnection:f,addHttpRequest:l,addRepresentationSwitch:v,addBufferLevel:_,addBufferState:p,addDVRInfo:M,addDroppedFrames:m,addSchedulingInfo:T,addRequestsQueue:R,addManifestUpdate:E,updateManifestUpdateInfo:S,addManifestUpdateStreamInfo:q,addManifestUpdateRepresentationInfo:D,addPlayList:h,addDVBErrors:I,updateBolaState:L,setConfig:t},e(),B}Object.defineProperty(exports,"__esModule",{value:!0});var _voMetricsList=require("../vo/MetricsList"),_voMetricsList2=_interopRequireDefault(_voMetricsList),_voMetricsTCPConnection=require("../vo/metrics/TCPConnection"),_voMetricsTCPConnection2=_interopRequireDefault(_voMetricsTCPConnection),_voMetricsHTTPRequest=require("../vo/metrics/HTTPRequest"),_voMetricsRepresentationSwitch=require("../vo/metrics/RepresentationSwitch"),_voMetricsRepresentationSwitch2=_interopRequireDefault(_voMetricsRepresentationSwitch),_voMetricsBufferLevel=require("../vo/metrics/BufferLevel"),_voMetricsBufferLevel2=_interopRequireDefault(_voMetricsBufferLevel),_voMetricsBufferState=require("../vo/metrics/BufferState"),_voMetricsBufferState2=_interopRequireDefault(_voMetricsBufferState),_voMetricsDVRInfo=require("../vo/metrics/DVRInfo"),_voMetricsDVRInfo2=_interopRequireDefault(_voMetricsDVRInfo),_voMetricsDroppedFrames=require("../vo/metrics/DroppedFrames"),_voMetricsDroppedFrames2=_interopRequireDefault(_voMetricsDroppedFrames),_voMetricsManifestUpdate=require("../vo/metrics/ManifestUpdate"),_voMetricsSchedulingInfo=require("../vo/metrics/SchedulingInfo"),_voMetricsSchedulingInfo2=_interopRequireDefault(_voMetricsSchedulingInfo),_coreEventBus=require("../../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_voMetricsRequestsQueue=require("../vo/metrics/RequestsQueue"),_voMetricsRequestsQueue2=_interopRequireDefault(_voMetricsRequestsQueue),_coreEventsEvents=require("../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_voMetricsBolaState=require("../vo/metrics/BolaState"),_voMetricsBolaState2=_interopRequireDefault(_voMetricsBolaState);MetricsModel.__dashjs_factory_name="MetricsModel",exports.default=_coreFactoryMaker2.default.getSingletonFactory(MetricsModel),module.exports=exports.default;
},{"../../core/EventBus":14,"../../core/FactoryMaker":15,"../../core/events/Events":18,"../vo/MetricsList":174,"../vo/metrics/BolaState":180,"../vo/metrics/BufferLevel":181,"../vo/metrics/BufferState":182,"../vo/metrics/DVRInfo":183,"../vo/metrics/DroppedFrames":184,"../vo/metrics/HTTPRequest":185,"../vo/metrics/ManifestUpdate":186,"../vo/metrics/RepresentationSwitch":188,"../vo/metrics/RequestsQueue":189,"../vo/metrics/SchedulingInfo":190,"../vo/metrics/TCPConnection":191}],109:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function URIQueryAndFragmentModel(){function e(){o=new _voURIFragmentData2.default,i=[],l=!1}function t(){return o}function r(){return i}function n(){return l}function a(e){function t(e,t,r,n){var a=n[0].split(/[=]/);return n.push({key:a[0],value:a[1]}),n.shift(),n}function r(e,t,r){return t>0&&(f&&0===i.length?i=r[t].split(/[&]/):s&&(a=r[t].split(/[&]/))),r}if(!e)return null;var n,a=[],u=new RegExp(/[?]/),c=new RegExp(/[#]/),d=new RegExp(/^(https:)?\/\//i),f=u.test(e),s=c.test(e);return l=d.test(e),n=e.split(/[?#]/).map(r),i.length>0&&(i=i.reduce(t,null)),a.length>0&&(a=a.reduce(t,null),a.forEach(function(e){o[e.key]=e.value})),e}var u=void 0,o=void 0,i=void 0,l=void 0;return u={initialize:e,parseURI:a,getURIFragmentData:t,getURIQueryData:r,isManifestHTTPS:n}}Object.defineProperty(exports,"__esModule",{value:!0});var _voURIFragmentData=require("../vo/URIFragmentData"),_voURIFragmentData2=_interopRequireDefault(_voURIFragmentData),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);URIQueryAndFragmentModel.__dashjs_factory_name="URIQueryAndFragmentModel",exports.default=_coreFactoryMaker2.default.getSingletonFactory(URIQueryAndFragmentModel),module.exports=exports.default;
},{"../../core/FactoryMaker":15,"../vo/URIFragmentData":179}],110:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function VideoModel(){function e(){F=[]}function t(){_.playbackRate=M||1,_.removeEventListener("canplay",t)}function n(e){_&&(_.readyState<=2&&e>0?_.addEventListener("canplay",t):_.playbackRate=e)}function o(e){if(_.currentTime!=e)try{_.currentTime=e}catch(t){0===_.readyState&&t.code===t.INVALID_STATE_ERR&&setTimeout(function(){_.currentTime=e},400)}}function i(){return _}function r(e){_=e,_.preload="auto"}function a(e){e?_.src=e:(_.removeAttribute("src"),_.load())}function u(){return _.src}function c(){return E}function d(e){E=e}function l(){return b}function s(e){b=e,b.style.position="absolute",b.style.display="flex",b.style.overflow="hidden",b.style.pointerEvents="none",b.style.top=0,b.style.left=0}function f(e,t){m(e,t)}function p(){return F.length>0}function y(e){var t=void 0;null===e||_.seeking||F.indexOf(e)!==-1||(F.push(e),1===F.length&&(t=document.createEvent("Event"),t.initEvent("waiting",!0,!1),M=_.playbackRate,n(0),_.dispatchEvent(t)))}function v(e){var t=F.indexOf(e),o=void 0;null!==e&&(t!==-1&&F.splice(t,1),p()===!1&&0===_.playbackRate&&(n(M||1),_.paused||(o=document.createEvent("Event"),o.initEvent("playing",!0,!1),_.dispatchEvent(o))))}function m(e,t){t?y(e):v(e)}function k(){var e="webkitDroppedFrameCount"in _&&"webkitDecodedFrameCount"in _,t="getVideoPlaybackQuality"in _,n=null;return t?n=_.getVideoPlaybackQuality():e&&(n={droppedVideoFrames:_.webkitDroppedFrameCount,totalVideoFrames:_.webkitDroppedFrameCount+_.webkitDecodedFrameCount,creationTime:new Date}),n}var g=void 0,_=void 0,b=void 0,E=void 0,F=void 0,M=void 0;return g={initialize:e,setCurrentTime:o,setStallState:f,getElement:i,setElement:r,setSource:a,getSource:u,getVideoContainer:c,setVideoContainer:d,getTTMLRenderingDiv:l,setTTMLRenderingDiv:s,getPlaybackQuality:k}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);VideoModel.__dashjs_factory_name="VideoModel",exports.default=_coreFactoryMaker2.default.getSingletonFactory(VideoModel),module.exports=exports.default;
},{"../../core/FactoryMaker":15}],111:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_externalsBase64=require("../../../externals/base64"),_externalsBase642=_interopRequireDefault(_externalsBase64),CommonEncryption=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"findCencContentProtection",value:function(e){for(var t=null,n=0;n<e.length;++n){var r=e[n];"urn:mpeg:dash:mp4protection:2011"===r.schemeIdUri.toLowerCase()&&"cenc"===r.value.toLowerCase()&&(t=r)}return t}},{key:"getPSSHData",value:function(e){var t=8,n=new DataView(e),r=n.getUint8(t);return t+=20,r>0&&(t+=4+16*n.getUint32(t)),t+=4,e.slice(t)}},{key:"getPSSHForKeySystem",value:function(t,n){var r=e.parsePSSHList(n);return r.hasOwnProperty(t.uuid.toLowerCase())?r[t.uuid.toLowerCase()]:null}},{key:"parseInitDataFromContentProtection",value:function(e){return"pssh"in e?_externalsBase642.default.decodeArray(e.pssh.__text).buffer:null}},{key:"parsePSSHList",value:function(e){if(null===e)return[];for(var t=new DataView(e),n=!1,r={},a=0;!n;){var o,i,u,l,s,f=a;if(a>=t.buffer.byteLength)break;if(o=t.getUint32(a),i=a+o,a+=4,1886614376===t.getUint32(a))if(a+=4,u=t.getUint8(a),0===u||1===u){a++,a+=3,l="";var c,g;for(c=0;c<4;c++)g=t.getUint8(a+c).toString(16),l+=1===g.length?"0"+g:g;for(a+=4,l+="-",c=0;c<2;c++)g=t.getUint8(a+c).toString(16),l+=1===g.length?"0"+g:g;for(a+=2,l+="-",c=0;c<2;c++)g=t.getUint8(a+c).toString(16),l+=1===g.length?"0"+g:g;for(a+=2,l+="-",c=0;c<2;c++)g=t.getUint8(a+c).toString(16),l+=1===g.length?"0"+g:g;for(a+=2,l+="-",c=0;c<6;c++)g=t.getUint8(a+c).toString(16),l+=1===g.length?"0"+g:g;a+=6,l=l.toLowerCase(),s=t.getUint32(a),a+=4,r[l]=t.buffer.slice(f,i),a=i}else a=i;else a=i}return r}}]),e}();exports.default=CommonEncryption,module.exports=exports.default;
},{"../../../externals/base64":8}],112:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function Protection(){function e(e){var o=null,r=(0,_controllersProtectionKeyController2.default)(n).getInstance();r.setConfig({log:e.log}),r.initialize();var l=t(e);return!o&&l&&(o=(0,_controllersProtectionController2.default)(n).create({protectionModel:l,protectionKeyController:r,adapter:e.adapter,eventBus:e.eventBus,log:e.log}),e.capabilities.setEncryptedMediaSupported(!0)),o}function t(e){var t=e.log,r=e.eventBus,l=e.videoModel.getElement();return void 0!==l.onencrypted&&void 0!==l.mediaKeys&&void 0!==navigator.requestMediaKeySystemAccess&&"function"==typeof navigator.requestMediaKeySystemAccess?(t("EME detected on this user agent! (ProtectionModel_21Jan2015)"),(0,_modelsProtectionModel_21Jan20152.default)(n).create({log:t,eventBus:r})):o(l,APIS_ProtectionModel_3Feb2014)?(t("EME detected on this user agent! (ProtectionModel_3Feb2014)"),(0,_modelsProtectionModel_3Feb20142.default)(n).create({log:t,eventBus:r,api:o(l,APIS_ProtectionModel_3Feb2014)})):o(l,APIS_ProtectionModel_01b)?(t("EME detected on this user agent! (ProtectionModel_01b)"),(0,_modelsProtectionModel_01b2.default)(n).create({log:t,eventBus:r,api:o(l,APIS_ProtectionModel_01b)})):(t("No supported version of EME detected on this user agent! - Attempts to play encrypted content will fail!"),null)}function o(e,t){for(var o=0;o<t.length;o++){var r=t[o];if("function"==typeof e[r[Object.keys(r)[0]]])return r}return null}var r=void 0,n=this.context;return r={createProtectionSystem:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _controllersProtectionController=require("./controllers/ProtectionController"),_controllersProtectionController2=_interopRequireDefault(_controllersProtectionController),_controllersProtectionKeyController=require("./controllers/ProtectionKeyController"),_controllersProtectionKeyController2=_interopRequireDefault(_controllersProtectionKeyController),_ProtectionEvents=require("./ProtectionEvents"),_ProtectionEvents2=_interopRequireDefault(_ProtectionEvents),_modelsProtectionModel_21Jan2015=require("./models/ProtectionModel_21Jan2015"),_modelsProtectionModel_21Jan20152=_interopRequireDefault(_modelsProtectionModel_21Jan2015),_modelsProtectionModel_3Feb2014=require("./models/ProtectionModel_3Feb2014"),_modelsProtectionModel_3Feb20142=_interopRequireDefault(_modelsProtectionModel_3Feb2014),_modelsProtectionModel_01b=require("./models/ProtectionModel_01b"),_modelsProtectionModel_01b2=_interopRequireDefault(_modelsProtectionModel_01b),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),APIS_ProtectionModel_01b=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],APIS_ProtectionModel_3Feb2014=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}];Protection.__dashjs_factory_name="Protection";var factory=_coreFactoryMaker2.default.getClassFactory(Protection);factory.events=_ProtectionEvents2.default,exports.default=factory,module.exports=exports.default;
},{"../../core/FactoryMaker":15,"./ProtectionEvents":113,"./controllers/ProtectionController":114,"./controllers/ProtectionKeyController":115,"./models/ProtectionModel_01b":119,"./models/ProtectionModel_21Jan2015":120,"./models/ProtectionModel_3Feb2014":121}],113:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _get=function(e,t,o){for(var r=!0;r;){var s=e,E=t,i=o;r=!1,null===s&&(s=Function.prototype);var n=Object.getOwnPropertyDescriptor(s,E);if(void 0!==n){if("value"in n)return n.value;var c=n.get;if(void 0===c)return;return c.call(i)}var _=Object.getPrototypeOf(s);if(null===_)return;e=_,t=E,o=i,r=!0,n=_=void 0}},_coreEventsEventsBase=require("../../core/events/EventsBase"),_coreEventsEventsBase2=_interopRequireDefault(_coreEventsEventsBase),ProtectionEvents=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.INTERNAL_KEY_MESSAGE="internalKeyMessage",this.INTERNAL_KEY_SYSTEM_SELECTED="internalKeySystemSelected",this.KEY_ADDED="public_keyAdded",this.KEY_ERROR="public_keyError",this.KEY_MESSAGE="public_keyMessage",this.KEY_SESSION_CLOSED="public_keySessionClosed",this.KEY_SESSION_CREATED="public_keySessionCreated",this.KEY_SESSION_REMOVED="public_keySessionRemoved",this.KEY_STATUSES_CHANGED="public_keyStatusesChanged",this.KEY_SYSTEM_ACCESS_COMPLETE="keySystemAccessComplete",this.KEY_SYSTEM_SELECTED="public_keySystemSelected",this.LICENSE_REQUEST_COMPLETE="public_licenseRequestComplete",this.NEED_KEY="needkey",this.PROTECTION_CREATED="public_protectioncreated",this.PROTECTION_DESTROYED="public_protectiondestroyed",this.SERVER_CERTIFICATE_UPDATED="serverCertificateUpdated",this.TEARDOWN_COMPLETE="protectionTeardownComplete",this.VIDEO_ELEMENT_SELECTED="videoElementSelected"}return _inherits(t,e),t}(_coreEventsEventsBase2.default),protectionEvents=new ProtectionEvents;exports.default=protectionEvents,module.exports=exports.default;
},{"../../core/events/EventsBase":19}],114:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ProtectionController(e){function t(){R=p.getKeySystems(),K=[],Y=!1,k="temporary",q="",_coreEventsEvents2.default.extend(_Protection2.default.events)}function r(e,t,r){if(!Y){var n;t||r||(n=M.getStreamsInfo(e)[0]),T=t||(n?M.getMediaInfoForType(e,n,"audio"):null),h=r||(n?M.getMediaInfoForType(e,n,"video"):null);var s=h?h:T,o=p.getSupportedKeySystemsFromContentProtection(s.contentProtection);o&&o.length>0&&v(o,!0),Y=!0}}function n(e){var t=_CommonEncryption2.default.getPSSHForKeySystem(A,e);if(t){for(var r=g.getAllInitData(),n=0;n<r.length;n++)if(p.initDataEquals(t,r[n]))return void C("DRM: Ignoring initData because we have already seen it!");try{g.createKeySession(t,k)}catch(e){m.trigger(_coreEventsEvents2.default.KEY_SESSION_CREATED,{data:null,error:"Error creating key session! "+e.message})}}else m.trigger(_coreEventsEvents2.default.KEY_SESSION_CREATED,{data:null,error:"Selected key system is "+A.systemString+".  needkey/encrypted event contains no initData corresponding to that key system!"})}function s(e){g.loadKeySession(e)}function o(e){g.removeKeySession(e)}function i(e){g.closeKeySession(e)}function a(e){g.setServerCertificate(e)}function E(e){e?(g.setMediaElement(e),m.on(_coreEventsEvents2.default.NEED_KEY,_,this),m.on(_coreEventsEvents2.default.INTERNAL_KEY_MESSAGE,S,this)):null===e&&(g.setMediaElement(e),m.off(_coreEventsEvents2.default.NEED_KEY,_,this),m.off(_coreEventsEvents2.default.INTERNAL_KEY_MESSAGE,S,this))}function u(e){k=e}function c(e){q=e}function l(e){L=e}function d(){E(null),A=void 0,g&&(g.reset(),g=null)}function f(e){var t=null,r=e.systemString;return L&&(t=r in L?L[r]:null),t}function v(e,t){var r=this,s=[],o=[];h&&o.push(new _voMediaCapability2.default(h.codec,q)),T&&s.push(new _voMediaCapability2.default(T.codec,q));var i,a=new _voKeySystemConfiguration2.default(s,o,"optional","temporary"===k?"optional":"required",[k]),E=[];if(A){for(i=0;i<e.length;i++)if(A===e[i].ks){var u=function(){E.push({ks:e[i].ks,configs:[a]});var s=function s(o){m.off(_coreEventsEvents2.default.KEY_SYSTEM_ACCESS_COMPLETE,s,r),o.error?t||m.trigger(_coreEventsEvents2.default.KEY_SYSTEM_SELECTED,{error:"DRM: KeySystem Access Denied! -- "+o.error}):(C("DRM: KeySystem Access Granted"),m.trigger(_coreEventsEvents2.default.KEY_SYSTEM_SELECTED,{data:o.data}),n(e[i].initData))};return m.on(_coreEventsEvents2.default.KEY_SYSTEM_ACCESS_COMPLETE,s,r),g.requestKeySystemAccess(E),"break"}();if("break"===u)break}}else if(void 0===A){A=null,K.push(e);for(var c=0;c<e.length;c++)E.push({ks:e[c].ks,configs:[a]});var l,d=function e(n){m.off(_coreEventsEvents2.default.KEY_SYSTEM_ACCESS_COMPLETE,e,r),n.error?(A=void 0,m.off(_coreEventsEvents2.default.INTERNAL_KEY_SYSTEM_SELECTED,f,r),t||m.trigger(_coreEventsEvents2.default.KEY_SYSTEM_SELECTED,{data:null,error:"DRM: KeySystem Access Denied! -- "+n.error})):(l=n.data,C("DRM: KeySystem Access Granted ("+l.keySystem.systemString+")!  Selecting key system..."),g.selectKeySystem(l))},f=function e(s){if(m.off(_coreEventsEvents2.default.INTERNAL_KEY_SYSTEM_SELECTED,e,r),m.off(_coreEventsEvents2.default.KEY_SYSTEM_ACCESS_COMPLETE,d,r),s.error)A=void 0,t||m.trigger(_coreEventsEvents2.default.KEY_SYSTEM_SELECTED,{data:null,error:"DRM: Error selecting key system! -- "+s.error});else{A=g.getKeySystem(),m.trigger(_coreEventsEvents2.default.KEY_SYSTEM_SELECTED,{data:l});for(var o=0;o<K.length;o++)for(i=0;i<K[o].length;i++)if(A===K[o][i].ks){n(K[o][i].initData);break}}};m.on(_coreEventsEvents2.default.INTERNAL_KEY_SYSTEM_SELECTED,f,r),m.on(_coreEventsEvents2.default.KEY_SYSTEM_ACCESS_COMPLETE,d,r),g.requestKeySystemAccess(E)}else K.push(e)}function y(e,t){m.trigger(_coreEventsEvents2.default.LICENSE_REQUEST_COMPLETE,{data:e,error:t})}function S(e){if(C("DRM: onKeyMessage"),e.error)return void C(e.error);var t=e.data;m.trigger(_coreEventsEvents2.default.KEY_MESSAGE,{data:t});var r=t.messageType?t.messageType:"license-request",n=t.message,s=t.sessionToken,o=f(A),i=A.systemString,a=p.getLicenseServer(A,o,r),E={sessionToken:s,messageType:r};if(!a)return C("DRM: License server request not required for this message (type = "+e.data.messageType+").  Session ID = "+s.getSessionID()),void y(E);if(p.isClearKey(A)){var u=p.processClearKeyLicenseRequest(o,n);if(u)return C("DRM: ClearKey license request handled by application!"),y(E),void g.updateKeySession(s,u)}var c=new XMLHttpRequest,l=null;if(o&&o.serverURL){var d=o.serverURL;"string"==typeof d&&""!==d?l=d:"object"==typeof d&&d.hasOwnProperty(r)&&(l=d[r])}else o&&o.laURL&&""!==o.laURL?l=o.laURL:(l=A.getLicenseServerURLFromInitData(_CommonEncryption2.default.getPSSHData(s.initData)),l||(l=e.data.laURL));if(l=a.getServerURLFromMessage(l,n,r),!l)return void y(E,"DRM: No license server URL specified!");c.open(a.getHTTPMethod(r),l,!0),c.responseType=a.getResponseType(i,r),c.onload=function(){200==this.status?(y(E),g.updateKeySession(s,a.getLicenseMessage(this.response,i,r))):y(E,"DRM: "+i+' update, XHR status is "'+this.statusText+'" ('+this.status+"), expected to be 200. readyState is "+this.readyState+".  Response is "+(this.response?a.getErrorResponse(this.response,i,r):"NONE"))},c.onabort=function(){y(E,"DRM: "+i+' update, XHR aborted. status is "'+this.statusText+'" ('+this.status+"), readyState is "+this.readyState)},c.onerror=function(){y(E,"DRM: "+i+' update, XHR error. status is "'+this.statusText+'" ('+this.status+"), readyState is "+this.readyState)};var v=function(e){var t;if(e)for(t in e)"authorization"===t.toLowerCase()&&(c.withCredentials=!0),c.setRequestHeader(t,e[t])};o&&v(o.httpRequestHeaders),v(A.getRequestHeadersFromMessage(n)),o&&o.withCredentials&&(c.withCredentials=!0),c.send(A.getLicenseRequestFromMessage(n))}function _(e){if(C("DRM: onNeedKey"),"cenc"!==e.key.initDataType)return void C("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+e.key.initDataType);var t=e.key.initData;ArrayBuffer.isView(t)&&(t=t.buffer),C("DRM: initData:",String.fromCharCode.apply(null,new Uint8Array(t)));var r=p.getSupportedKeySystems(t,L);return 0===r.length?void C("DRM: Received needkey event with initData, but we don't support any of the key systems!"):void v(r,!1)}var p=e.protectionKeyController,g=e.protectionModel,M=e.adapter,m=e.eventBus,C=e.log,D=void 0,R=void 0,K=void 0,T=void 0,h=void 0,L=void 0,Y=void 0,k=void 0,q=void 0,A=void 0;return D={initialize:r,createKeySession:n,loadKeySession:s,removeKeySession:o,closeKeySession:i,setServerCertificate:a,setMediaElement:E,setSessionType:u,setRobustnessLevel:c,setProtectionData:l,reset:d},t(),D}Object.defineProperty(exports,"__esModule",{value:!0});var _CommonEncryption=require("../CommonEncryption"),_CommonEncryption2=_interopRequireDefault(_CommonEncryption),_coreEventsEvents=require("../../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_voMediaCapability=require("../vo/MediaCapability"),_voMediaCapability2=_interopRequireDefault(_voMediaCapability),_voKeySystemConfiguration=require("../vo/KeySystemConfiguration"),_voKeySystemConfiguration2=_interopRequireDefault(_voKeySystemConfiguration),_coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_Protection=require("../Protection"),_Protection2=_interopRequireDefault(_Protection);ProtectionController.__dashjs_factory_name="ProtectionController",exports.default=_coreFactoryMaker2.default.getClassFactory(ProtectionController),module.exports=exports.default;
},{"../../../core/FactoryMaker":15,"../../../core/events/Events":18,"../CommonEncryption":111,"../Protection":112,"../vo/KeySystemConfiguration":131,"../vo/MediaCapability":132}],115:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ProtectionKeyController(){function e(e){e&&e.log&&(m=e.log)}function r(){c=[];var e;e=(0,_drmKeySystemPlayReady2.default)(l).getInstance(),c.push(e),e=(0,_drmKeySystemWidevine2.default)(l).getInstance(),c.push(e),e=(0,_drmKeySystemClearKey2.default)(l).getInstance(),c.push(e),_=e}function t(){return c}function n(e){for(var r=0;r<c.length;r++)if(c[r].systemString===e)return c[r];return null}function i(e){return e===_}function a(e,r){if(e.byteLength===r.byteLength){for(var t=new Uint8Array(e),n=new Uint8Array(r),i=0;i<t.length;i++)if(t[i]!==n[i])return!1;return!0}return!1}function s(e){var r,t,n,i,a=[];if(e)for(n=0;n<c.length;++n)for(t=c[n],i=0;i<e.length;++i)if(r=e[i],r.schemeIdUri.toLowerCase()===t.schemeIdURI){var s=t.getInitData(r);s&&a.push({ks:c[n],initData:s})}return a}function o(e,r){var t,n=[],i=_CommonEncryption2.default.parsePSSHList(e);for(t=0;t<c.length;++t){var a=c[t].systemString,s=!r||a in r;c[t].uuid in i&&s&&n.push({ks:c[t],initData:i[c[t].uuid]})}return n}function y(e,r,t){if("license-release"===t||"individualization-request"===t)return null;var n=null;return r&&r.hasOwnProperty("drmtoday")?n=(0,_serversDRMToday2.default)(l).getInstance():"com.widevine.alpha"===e.systemString?n=(0,_serversWidevine2.default)(l).getInstance():"com.microsoft.playready"===e.systemString?n=(0,_serversPlayReady2.default)(l).getInstance():"org.w3.clearkey"===e.systemString&&(n=(0,_serversClearKey2.default)(l).getInstance()),n}function u(e,r){try{return _.getClearKeysFromProtectionData(e,r)}catch(e){return m("Failed to retrieve clearkeys from ProtectionData"),null}}var l=this.context,d=void 0,m=void 0,c=void 0,_=void 0;return d={initialize:r,isClearKey:i,initDataEquals:a,getKeySystems:t,getKeySystemBySystemString:n,getSupportedKeySystemsFromContentProtection:s,getSupportedKeySystems:o,getLicenseServer:y,processClearKeyLicenseRequest:u,setConfig:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _CommonEncryption=require("./../CommonEncryption"),_CommonEncryption2=_interopRequireDefault(_CommonEncryption),_drmKeySystemClearKey=require("./../drm/KeySystemClearKey"),_drmKeySystemClearKey2=_interopRequireDefault(_drmKeySystemClearKey),_drmKeySystemWidevine=require("./../drm/KeySystemWidevine"),_drmKeySystemWidevine2=_interopRequireDefault(_drmKeySystemWidevine),_drmKeySystemPlayReady=require("./../drm/KeySystemPlayReady"),_drmKeySystemPlayReady2=_interopRequireDefault(_drmKeySystemPlayReady),_serversDRMToday=require("./../servers/DRMToday"),_serversDRMToday2=_interopRequireDefault(_serversDRMToday),_serversPlayReady=require("./../servers/PlayReady"),_serversPlayReady2=_interopRequireDefault(_serversPlayReady),_serversWidevine=require("./../servers/Widevine"),_serversWidevine2=_interopRequireDefault(_serversWidevine),_serversClearKey=require("./../servers/ClearKey"),_serversClearKey2=_interopRequireDefault(_serversClearKey),_coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);ProtectionKeyController.__dashjs_factory_name="ProtectionKeyController",exports.default=_coreFactoryMaker2.default.getSingletonFactory(ProtectionKeyController),module.exports=exports.default;
},{"../../../core/FactoryMaker":15,"./../CommonEncryption":111,"./../drm/KeySystemClearKey":116,"./../drm/KeySystemPlayReady":117,"./../drm/KeySystemWidevine":118,"./../servers/ClearKey":122,"./../servers/DRMToday":123,"./../servers/PlayReady":124,"./../servers/Widevine":125}],116:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function KeySystemClearKey(){function e(e,r){var t=null;if(e){for(var o=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(r))),n=[],a=0;a<o.kids.length;a++){var u=o.kids[a],i=e.clearkeys.hasOwnProperty(u)?e.clearkeys[u]:null;if(!i)throw new Error("DRM: ClearKey keyID ("+u+") is not known!");n.push(new _voKeyPair2.default(u,i))}t=new _voClearKeyKeySet2.default(n)}return t}function r(e){return _CommonEncryption2.default.parseInitDataFromContentProtection(e)}function t(){return null}function o(e){return new Uint8Array(e)}function n(){return null}var a=void 0;return a={uuid:uuid,schemeIdURI:schemeIdURI,systemString:systemString,getInitData:r,getRequestHeadersFromMessage:t,getLicenseRequestFromMessage:o,getLicenseServerURLFromInitData:n,getClearKeysFromProtectionData:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _voKeyPair=require("../vo/KeyPair"),_voKeyPair2=_interopRequireDefault(_voKeyPair),_voClearKeyKeySet=require("../vo/ClearKeyKeySet"),_voClearKeyKeySet2=_interopRequireDefault(_voClearKeyKeySet),_CommonEncryption=require("../CommonEncryption"),_CommonEncryption2=_interopRequireDefault(_CommonEncryption),_coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),uuid="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",systemString="org.w3.clearkey",schemeIdURI="urn:uuid:"+uuid;KeySystemClearKey.__dashjs_factory_name="KeySystemClearKey",exports.default=_coreFactoryMaker2.default.getSingletonFactory(KeySystemClearKey),module.exports=exports.default;
},{"../../../core/FactoryMaker":15,"../CommonEncryption":111,"../vo/ClearKeyKeySet":126,"../vo/KeyPair":129}],117:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function KeySystemPlayReady(){function e(e){var r,t,a={},n=new DOMParser,o="utf16"===i?new Uint16Array(e):new Uint8Array(e);r=String.fromCharCode.apply(null,o),t=n.parseFromString(r,"application/xml");for(var l=t.getElementsByTagName("name"),s=t.getElementsByTagName("value"),u=0;u<l.length;u++)a[l[u].childNodes[0].nodeValue]=s[u].childNodes[0].nodeValue;return a.hasOwnProperty("Content")&&(a["Content-Type"]=a.Content,delete a.Content),a}function r(e){var r,t,a=null,n=new DOMParser,o="utf16"===i?new Uint16Array(e):new Uint8Array(e);if(r=String.fromCharCode.apply(null,o),t=n.parseFromString(r,"application/xml"),t.getElementsByTagName("Challenge")[0]){var l=t.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;l&&(a=_externalsBase642.default.decode(l))}return a}function t(e){if(e)for(var r=new DataView(e),t=r.getUint16(4,!0),a=6,n=new DOMParser,o=0;o<t;o++){var i=r.getUint16(a,!0);a+=2;var l=r.getUint16(a,!0);if(a+=2,1===i){var s=e.slice(a,a+l),u=String.fromCharCode.apply(null,new Uint16Array(s)),y=n.parseFromString(u,"application/xml");if(y.getElementsByTagName("LA_URL")[0]){var d=y.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue;if(d)return d}if(y.getElementsByTagName("LUI_URL")[0]){var m=y.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue;if(m)return m}}else a+=l}return null}function a(e){var r,t,a,n,o,i=new Uint8Array([112,115,115,104,0,0,0,0]),l=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),s=0,u=null;if("pssh"in e)return _CommonEncryption2.default.parseInitDataFromContentProtection(e);if("pro"in e)u=_externalsBase642.default.decodeArray(e.pro.__text);else{if(!("prheader"in e))return null;u=_externalsBase642.default.decodeArray(e.prheader.__text)}return r=u.length,t=4+i.length+l.length+4+r,a=new ArrayBuffer(t),n=new Uint8Array(a),o=new DataView(a),o.setUint32(s,t),s+=4,n.set(i,s),s+=i.length,n.set(l,s),s+=l.length,o.setUint32(s,r),s+=4,n.set(u,s),s+=r,n.buffer}function n(e){if("utf8"!==e&&"utf16"!==e)throw new _voError2.default("Illegal PlayReady message format! -- "+e);i=e}var o=void 0,i="utf16";return o={uuid:uuid,schemeIdURI:schemeIdURI,systemString:systemString,getInitData:a,getRequestHeadersFromMessage:e,getLicenseRequestFromMessage:r,getLicenseServerURLFromInitData:t,setPlayReadyMessageFormat:n}}Object.defineProperty(exports,"__esModule",{value:!0});var _CommonEncryption=require("../CommonEncryption"),_CommonEncryption2=_interopRequireDefault(_CommonEncryption),_voError=require("../../vo/Error"),_voError2=_interopRequireDefault(_voError),_coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_externalsBase64=require("../../../../externals/base64"),_externalsBase642=_interopRequireDefault(_externalsBase64),uuid="9a04f079-9840-4286-ab92-e65be0885f95",systemString="com.microsoft.playready",schemeIdURI="urn:uuid:"+uuid;KeySystemPlayReady.__dashjs_factory_name="KeySystemPlayReady",exports.default=_coreFactoryMaker2.default.getSingletonFactory(KeySystemPlayReady),module.exports=exports.default;
},{"../../../../externals/base64":8,"../../../core/FactoryMaker":15,"../../vo/Error":168,"../CommonEncryption":111}],118:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function KeySystemWidevine(){function e(e){return _CommonEncryption2.default.parseInitDataFromContentProtection(e)}function t(){return null}function r(e){return new Uint8Array(e)}function n(){return null}var o=void 0;return o={uuid:uuid,schemeIdURI:schemeIdURI,systemString:systemString,getInitData:e,getRequestHeadersFromMessage:t,getLicenseRequestFromMessage:r,getLicenseServerURLFromInitData:n}}Object.defineProperty(exports,"__esModule",{value:!0});var _CommonEncryption=require("../CommonEncryption"),_CommonEncryption2=_interopRequireDefault(_CommonEncryption),_coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),uuid="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",systemString="com.widevine.alpha",schemeIdURI="urn:uuid:"+uuid;KeySystemWidevine.__dashjs_factory_name="KeySystemWidevine",exports.default=_coreFactoryMaker2.default.getSingletonFactory(KeySystemWidevine),module.exports=exports.default;
},{"../../../core/FactoryMaker":15,"../CommonEncryption":111}],119:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ProtectionModel_01b(e){function t(){D=null,k=null,R=[],I=[],p=(0,_controllersProtectionKeyController2.default)(g).getInstance(),M=(0,_utilsErrorHandler2.default)(g).getInstance(),C=v()}function r(){D&&_();for(var e=0;e<I.length;e++)c(I[e]);K.trigger(_coreEventsEvents2.default.TEARDOWN_COMPLETE)}function o(){return k}function n(){for(var e=[],t=0;t<R.length;t++)e.push(R[t].initData);for(var t=0;t<I.length;t++)e.push(I[t].initData);return e}function s(e){var t=D;t||(t=document.createElement("video"));for(var r=!1,o=0;o<e.length;o++)for(var n=e[o].ks.systemString,s=e[o].configs,i=null,a=null,u=0;u<s.length;u++){var d=s[u].videoCapabilities;if(d&&0!==d.length){a=[];for(var c=0;c<d.length;c++)""!==t.canPlayType(d[c].contentType,n)&&a.push(d[c])}if(!(!i&&!a||i&&0===i.length||a&&0===a.length)){r=!0;var l=new _voKeySystemConfiguration2.default(i,a),y=p.getKeySystemBySystemString(n);K.trigger(_coreEventsEvents2.default.KEY_SYSTEM_ACCESS_COMPLETE,{data:new _voKeySystemAccess2.default(y,l)});break}}r||K.trigger(_coreEventsEvents2.default.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"})}function i(e){k=e.keySystem,K.trigger(_coreEventsEvents2.default.INTERNAL_KEY_SYSTEM_SELECTED)}function a(e){D!==e&&(D&&_(),D=e,D&&(D.addEventListener(h.keyerror,C),D.addEventListener(h.needkey,C),D.addEventListener(h.keymessage,C),D.addEventListener(h.keyadded,C),K.trigger(_coreEventsEvents2.default.VIDEO_ELEMENT_SELECTED)))}function u(e){if(!k)throw new Error("Can not create sessions until you have selected a key system");if(A||0===I.length){var t={sessionID:null,initData:e,getSessionID:function(){return this.sessionID},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}};return R.push(t),D[h.generateKeyRequest](k.systemString,new Uint8Array(e)),t}throw new Error("Multiple sessions not allowed!")}function d(e,t){var r=e.sessionID;if(p.isClearKey(k))for(var o=0;o<t.keyPairs.length;o++)D[h.addKey](k.systemString,t.keyPairs[o].key,t.keyPairs[o].keyID,r);else D[h.addKey](k.systemString,new Uint8Array(t),e.initData,r)}function c(e){D[h.cancelKeyRequest](k.systemString,e.sessionID)}function l(){}function y(){}function E(){}function v(){return{handleEvent:function(e){var t=null;switch(e.type){case h.needkey:var r=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;K.trigger(_coreEventsEvents2.default.NEED_KEY,{key:new _voNeedKey2.default(r,"cenc")});break;case h.keyerror:if(t=f(I,e.sessionId),t||(t=f(R,e.sessionId)),t){var o="";switch(e.errorCode.code){case 1:o+="MEDIA_KEYERR_UNKNOWN - An unspecified error occurred. This value is used for errors that don't match any of the other codes.";break;case 2:o+="MEDIA_KEYERR_CLIENT - The Key System could not be installed or updated.";break;case 3:o+="MEDIA_KEYERR_SERVICE - The message passed into update indicated an error from the license service.";break;case 4:o+="MEDIA_KEYERR_OUTPUT - There is no available output device with the required characteristics for the content protection system.";break;case 5:o+="MEDIA_KEYERR_HARDWARECHANGE - A hardware configuration change caused a content protection error.";break;case 6:o+="MEDIA_KEYERR_DOMAIN - An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain."}o+="  System Code = "+e.systemCode,K.trigger(_coreEventsEvents2.default.KEY_ERROR,{data:new _voKeyError2.default(t,o)})}else m("No session token found for key error");break;case h.keyadded:t=f(I,e.sessionId),t||(t=f(R,e.sessionId)),t?(m("DRM: Key added."),K.trigger(_coreEventsEvents2.default.KEY_ADDED,{data:t})):m("No session token found for key added");break;case h.keymessage:if(A=null!==e.sessionId&&void 0!==e.sessionId,A?(t=f(I,e.sessionId),!t&&R.length>0&&(t=R.shift(),I.push(t),t.sessionID=e.sessionId)):R.length>0&&(t=R.shift(),I.push(t),0!==R.length&&M.mediaKeyMessageError("Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!")),t){var n=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;t.keyMessage=n,K.trigger(_coreEventsEvents2.default.INTERNAL_KEY_MESSAGE,{data:new _voKeyMessage2.default(t,n,e.defaultURL)})}else m("No session token found for key message")}}}}function f(e,t){if(t&&e){for(var r=e.length,o=0;o<r;o++)if(e[o].sessionID==t)return e[o];return null}return null}function _(){D.removeEventListener(h.keyerror,C),D.removeEventListener(h.needkey,C),D.removeEventListener(h.keymessage,C),D.removeEventListener(h.keyadded,C)}var g=this.context,K=e.eventBus,m=e.log,h=e.api,S=void 0,D=void 0,k=void 0,p=void 0,M=void 0,R=void 0,I=void 0,A=void 0,C=void 0;return S={getAllInitData:n,requestKeySystemAccess:s,getKeySystem:o,selectKeySystem:i,setMediaElement:a,createKeySession:u,updateKeySession:d,closeKeySession:c,setServerCertificate:l,loadKeySession:y,removeKeySession:E,reset:r},t(),S}Object.defineProperty(exports,"__esModule",{value:!0});var _controllersProtectionKeyController=require("../controllers/ProtectionKeyController"),_controllersProtectionKeyController2=_interopRequireDefault(_controllersProtectionKeyController),_voNeedKey=require("../vo/NeedKey"),_voNeedKey2=_interopRequireDefault(_voNeedKey),_voKeyError=require("../vo/KeyError"),_voKeyError2=_interopRequireDefault(_voKeyError),_voKeyMessage=require("../vo/KeyMessage"),_voKeyMessage2=_interopRequireDefault(_voKeyMessage),_voKeySystemConfiguration=require("../vo/KeySystemConfiguration"),_voKeySystemConfiguration2=_interopRequireDefault(_voKeySystemConfiguration),_voKeySystemAccess=require("../vo/KeySystemAccess"),_voKeySystemAccess2=_interopRequireDefault(_voKeySystemAccess),_coreEventsEvents=require("../../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_utilsErrorHandler=require("../../utils/ErrorHandler"),_utilsErrorHandler2=_interopRequireDefault(_utilsErrorHandler),_coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);ProtectionModel_01b.__dashjs_factory_name="ProtectionModel_01b",exports.default=_coreFactoryMaker2.default.getClassFactory(ProtectionModel_01b),module.exports=exports.default;
},{"../../../core/FactoryMaker":15,"../../../core/events/Events":18,"../../utils/ErrorHandler":157,"../controllers/ProtectionKeyController":115,"../vo/KeyError":127,"../vo/KeyMessage":128,"../vo/KeySystemAccess":130,"../vo/KeySystemConfiguration":131,"../vo/NeedKey":133}],120:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ProtectionModel_21Jan2015(e){function t(){D=null,m=null,h=null,M=[],R=(0,_controllersProtectionKeyController2.default)(T).getInstance(),C=g()}function n(){var e,t=M.length;if(0!==t)for(var n=function(e){y(e),0===M.length&&(m?(m.removeEventListener("encrypted",C),m.setMediaKeys(null).then(function(){I.trigger(_coreEventsEvents2.default.TEARDOWN_COMPLETE)})):I.trigger(_coreEventsEvents2.default.TEARDOWN_COMPLETE))},r=0;r<t;r++)e=M[r],function(t){e.session.closed.then(function(){n(t)}),d(e).catch(function(){n(t)})}(e);else I.trigger(_coreEventsEvents2.default.TEARDOWN_COMPLETE)}function r(){return D}function s(){for(var e=[],t=0;t<M.length;t++)e.push(M[t].initData);return e}function o(e){_(e,0)}function i(e){e.mksa.createMediaKeys().then(function(t){D=e.keySystem,h=t,m&&m.setMediaKeys(h),I.trigger(_coreEventsEvents2.default.INTERNAL_KEY_SYSTEM_SELECTED)}).catch(function(){I.trigger(_coreEventsEvents2.default.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+e.keySystem.systemString+")! Could not create MediaKeys -- TODO"})})}function a(e){m!==e&&(m&&(m.removeEventListener("encrypted",C),m.setMediaKeys(null)),m=e,m&&(m.addEventListener("encrypted",C),h&&m.setMediaKeys(h)))}function c(e){if(!D||!h)throw new Error("Can not set server certificate until you have selected a key system");h.setServerCertificate(e).then(function(){p("DRM: License server certificate successfully updated."),I.trigger(_coreEventsEvents2.default.SERVER_CERTIFICATE_UPDATED)}).catch(function(e){I.trigger(_coreEventsEvents2.default.SERVER_CERTIFICATE_UPDATED,{error:"Error updating server certificate -- "+e.name})})}function u(e,t){if(!D||!h)throw new Error("Can not create sessions until you have selected a key system");var n=h.createSession(t),r=S(n,e,t);n.generateRequest("cenc",e).then(function(){p("DRM: Session created.  SessionID = "+r.getSessionID()),I.trigger(_coreEventsEvents2.default.KEY_SESSION_CREATED,{data:r})}).catch(function(e){y(r),I.trigger(_coreEventsEvents2.default.KEY_SESSION_CREATED,{data:null,error:"Error generating key request -- "+e.name})})}function E(e,t){var n=e.session;R.isClearKey(D)&&(t=t.toJWK()),n.update(t).catch(function(t){I.trigger(_coreEventsEvents2.default.KEY_ERROR,{data:new _voKeyError2.default(e,"Error sending update() message! "+t.name)})})}function l(e){if(!D||!h)throw new Error("Can not load sessions until you have selected a key system");var t=h.createSession();t.load(e).then(function(n){if(n){var r=S(t);p("DRM: Session created.  SessionID = "+r.getSessionID()),I.trigger(_coreEventsEvents2.default.KEY_SESSION_CREATED,{data:r})}else I.trigger(_coreEventsEvents2.default.KEY_SESSION_CREATED,{data:null,error:"Could not load session! Invalid Session ID ("+e+")"})}).catch(function(t){I.trigger(_coreEventsEvents2.default.KEY_SESSION_CREATED,{data:null,error:"Could not load session ("+e+")! "+t.name})})}function v(e){var t=e.session;t.remove().then(function(){p("DRM: Session removed.  SessionID = "+e.getSessionID()),I.trigger(_coreEventsEvents2.default.KEY_SESSION_REMOVED,{data:e.getSessionID()})},function(t){I.trigger(_coreEventsEvents2.default.KEY_SESSION_REMOVED,{data:null,error:"Error removing session ("+e.getSessionID()+"). "+t.name})})}function f(e){d(e).catch(function(t){y(e),I.trigger(_coreEventsEvents2.default.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+e.getSessionID()+") "+t.name})})}function _(e,t){!function(t){var n=e[t].ks,r=e[t].configs;navigator.requestMediaKeySystemAccess(n.systemString,r).then(function(e){var t="function"==typeof e.getConfiguration?e.getConfiguration():null,r=new _voKeySystemAccess2.default(n,t);r.mksa=e,I.trigger(_coreEventsEvents2.default.KEY_SYSTEM_ACCESS_COMPLETE,{data:r})}).catch(function(){++t<e.length?_(e,t):I.trigger(_coreEventsEvents2.default.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied!"})})}(t)}function d(e){var t=e.session;return t.removeEventListener("keystatuseschange",e),t.removeEventListener("message",e),t.close()}function g(){return{handleEvent:function(e){switch(e.type){case"encrypted":if(e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;I.trigger(_coreEventsEvents2.default.NEED_KEY,{key:new _voNeedKey2.default(t,e.initDataType)})}}}}}function y(e){for(var t=0;t<M.length;t++)if(M[t]===e){M.splice(t,1);break}}function S(e,t,n){var r={session:e,initData:t,handleEvent:function(e){switch(e.type){case"keystatuseschange":I.trigger(_coreEventsEvents2.default.KEY_STATUSES_CHANGED,{data:this});break;case"message":var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;I.trigger(_coreEventsEvents2.default.INTERNAL_KEY_MESSAGE,{data:new _voKeyMessage2.default(this,t,void 0,e.messageType)})}},getSessionID:function(){return e.sessionId},getExpirationTime:function(){return e.expiration},getKeyStatuses:function(){return e.keyStatuses},getSessionType:function(){return n}};return e.addEventListener("keystatuseschange",r),e.addEventListener("message",r),e.closed.then(function(){y(r),p("DRM: Session closed.  SessionID = "+r.getSessionID()),I.trigger(_coreEventsEvents2.default.KEY_SESSION_CLOSED,{data:r.getSessionID()})}),M.push(r),r}var K,D,m,h,M,C,R,T=this.context,I=e.eventBus,p=e.log;return K={getAllInitData:s,requestKeySystemAccess:o,getKeySystem:r,selectKeySystem:i,setMediaElement:a,setServerCertificate:c,createKeySession:u,updateKeySession:E,loadKeySession:l,removeKeySession:v,closeKeySession:f,reset:n},t(),K}Object.defineProperty(exports,"__esModule",{value:!0});var _controllersProtectionKeyController=require("../controllers/ProtectionKeyController"),_controllersProtectionKeyController2=_interopRequireDefault(_controllersProtectionKeyController),_voNeedKey=require("../vo/NeedKey"),_voNeedKey2=_interopRequireDefault(_voNeedKey),_voKeyError=require("../vo/KeyError"),_voKeyError2=_interopRequireDefault(_voKeyError),_voKeyMessage=require("../vo/KeyMessage"),_voKeyMessage2=_interopRequireDefault(_voKeyMessage),_voKeySystemAccess=require("../vo/KeySystemAccess"),_voKeySystemAccess2=_interopRequireDefault(_voKeySystemAccess),_coreEventsEvents=require("../../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);ProtectionModel_21Jan2015.__dashjs_factory_name="ProtectionModel_21Jan2015",exports.default=_coreFactoryMaker2.default.getClassFactory(ProtectionModel_21Jan2015),module.exports=exports.default;
},{"../../../core/FactoryMaker":15,"../../../core/events/Events":18,"../controllers/ProtectionKeyController":115,"../vo/KeyError":127,"../vo/KeyMessage":128,"../vo/KeySystemAccess":130,"../vo/NeedKey":133}],121:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ProtectionModel_3Feb2014(e){function t(){C=null,D=null,M=null,h=null,k=[],T=(0,_controllersProtectionKeyController2.default)(g).getInstance(),L=E()}function r(){try{for(var e=0;e<k.length;e++)c(k[e]);C&&C.removeEventListener(m.needkey,L),S.trigger(_coreEventsEvents2.default.TEARDOWN_COMPLETE)}catch(e){S.trigger(_coreEventsEvents2.default.TEARDOWN_COMPLETE,{error:"Error tearing down key sessions and MediaKeys! -- "+e.message})}}function n(){return D}function o(){for(var e=[],t=0;t<k.length;t++)e.push(k[t].initData);return e}function s(e){for(var t=!1,r=0;r<e.length;r++)for(var n=e[r].ks.systemString,o=e[r].configs,s=null,i=null,a=0;a<o.length;a++){var u=o[a].audioCapabilities,l=o[a].videoCapabilities;if(u&&0!==u.length){s=[];for(var c=0;c<u.length;c++)window[m.MediaKeys].isTypeSupported(n,u[c].contentType)&&s.push(u[c])}if(l&&0!==l.length){i=[];for(var d=0;d<l.length;d++)window[m.MediaKeys].isTypeSupported(n,l[d].contentType)&&i.push(l[d])}if(!(!s&&!i||s&&0===s.length||i&&0===i.length)){t=!0;var v=new _voKeySystemConfiguration2.default(s,i),y=T.getKeySystemBySystemString(n);S.trigger(_coreEventsEvents2.default.KEY_SYSTEM_ACCESS_COMPLETE,{data:new _voKeySystemAccess2.default(y,v)});break}}t||S.trigger(_coreEventsEvents2.default.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"})}function i(e){try{M=e.mediaKeys=new window[m.MediaKeys](e.keySystem.systemString),D=e.keySystem,h=e,C&&f(),S.trigger(_coreEventsEvents2.default.INTERNAL_KEY_SYSTEM_SELECTED)}catch(e){S.trigger(_coreEventsEvents2.default.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+D.systemString+")! Could not create MediaKeys -- TODO"})}}function a(e){C!==e&&(C&&C.removeEventListener(m.needkey,L),C=e,C&&(C.addEventListener(m.needkey,L),M&&f()))}function u(e){if(!D||!M||!h)throw new Error("Can not create sessions until you have selected a key system");var t=null;if(null!==h.ksConfiguration.videoCapabilities&&h.ksConfiguration.videoCapabilities.length>0&&(t=h.ksConfiguration.videoCapabilities[0]),null===t&&null!==h.ksConfiguration.audioCapabilities&&h.ksConfiguration.audioCapabilities.length>0&&(t=h.ksConfiguration.audioCapabilities[0]),null===t)throw new Error("Can not create sessions for unknown content types.");var r=t.contentType,n=M.createSession(r,new Uint8Array(e)),o=_(n,e);n.addEventListener(m.error,o),n.addEventListener(m.message,o),n.addEventListener(m.ready,o),n.addEventListener(m.close,o),k.push(o),K("DRM: Session created.  SessionID = "+o.getSessionID()),S.trigger(_coreEventsEvents2.default.KEY_SESSION_CREATED,{data:o})}function l(e,t){var r=e.session;T.isClearKey(D)?r.update(new Uint8Array(t.toJWK())):r.update(new Uint8Array(t))}function c(e){var t=e.session;t.removeEventListener(m.error,e),t.removeEventListener(m.message,e),t.removeEventListener(m.ready,e),t.removeEventListener(m.close,e);for(var r=0;r<k.length;r++)if(k[r]===e){k.splice(r,1);break}t[m.release]()}function d(){}function v(){}function y(){}function E(){return{handleEvent:function(e){switch(e.type){case m.needkey:if(e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;S.trigger(_coreEventsEvents2.default.NEED_KEY,{key:new _voNeedKey2.default(t,"cenc")})}}}}}function f(){var e=null,t=function(){C.removeEventListener("loadedmetadata",e),C[m.setMediaKeys](M),S.trigger(_coreEventsEvents2.default.VIDEO_ELEMENT_SELECTED)};C.readyState>=1?t():(e=t.bind(this),C.addEventListener("loadedmetadata",e))}function _(e,t){return{session:e,initData:t,getSessionID:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"},handleEvent:function(e){switch(e.type){case m.error:var t="KeyError";S.trigger(_coreEventsEvents2.default.KEY_ERROR,{data:new _voKeyError2.default(this,t)});break;case m.message:var r=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;S.trigger(_coreEventsEvents2.default.INTERNAL_KEY_MESSAGE,{data:new _voKeyMessage2.default(this,r,e.destinationURL)});break;case m.ready:K("DRM: Key added."),S.trigger(_coreEventsEvents2.default.KEY_ADDED);break;case m.close:K("DRM: Session closed.  SessionID = "+this.getSessionID()),S.trigger(_coreEventsEvents2.default.KEY_SESSION_CLOSED,{data:this.getSessionID()})}}}}var g=this.context,S=e.eventBus,K=e.log,m=e.api,p=void 0,C=void 0,D=void 0,M=void 0,h=void 0,k=void 0,L=void 0,T=void 0;return p={getAllInitData:o,requestKeySystemAccess:s,getKeySystem:n,selectKeySystem:i,setMediaElement:a,createKeySession:u,updateKeySession:l,closeKeySession:c,setServerCertificate:d,loadKeySession:v,removeKeySession:y,reset:r},t(),p}Object.defineProperty(exports,"__esModule",{value:!0});var _controllersProtectionKeyController=require("../controllers/ProtectionKeyController"),_controllersProtectionKeyController2=_interopRequireDefault(_controllersProtectionKeyController),_voNeedKey=require("../vo/NeedKey"),_voNeedKey2=_interopRequireDefault(_voNeedKey),_voKeyError=require("../vo/KeyError"),_voKeyError2=_interopRequireDefault(_voKeyError),_voKeyMessage=require("../vo/KeyMessage"),_voKeyMessage2=_interopRequireDefault(_voKeyMessage),_voKeySystemConfiguration=require("../vo/KeySystemConfiguration"),_voKeySystemConfiguration2=_interopRequireDefault(_voKeySystemConfiguration),_voKeySystemAccess=require("../vo/KeySystemAccess"),_voKeySystemAccess2=_interopRequireDefault(_voKeySystemAccess),_coreEventsEvents=require("../../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);ProtectionModel_3Feb2014.__dashjs_factory_name="ProtectionModel_3Feb2014",exports.default=_coreFactoryMaker2.default.getClassFactory(ProtectionModel_3Feb2014),module.exports=exports.default;
},{"../../../core/FactoryMaker":15,"../../../core/events/Events":18,"../controllers/ProtectionKeyController":115,"../vo/KeyError":127,"../vo/KeyMessage":128,"../vo/KeySystemAccess":130,"../vo/KeySystemConfiguration":131,"../vo/NeedKey":133}],122:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ClearKey(){function e(e,r){var t=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(r)));e+="/?";for(var a=0;a<t.kids.length;a++)e+=t.kids[a]+"&";return e=e.substring(0,e.length-1)}function r(){return"GET"}function t(){return"json"}function a(e){if(!e.hasOwnProperty("keys"))return null;for(var r=[],t=0;t<e.keys.length;t++){var a=e.keys[t],o=a.kid.replace(/=/g,""),n=a.k.replace(/=/g,"");r.push(new _voKeyPair2.default(o,n))}return new _voClearKeyKeySet2.default(r)}function o(e){return String.fromCharCode.apply(null,new Uint8Array(e))}var n=void 0;return n={getServerURLFromMessage:e,getHTTPMethod:r,getResponseType:t,getLicenseMessage:a,getErrorResponse:o}}Object.defineProperty(exports,"__esModule",{value:!0});var _voKeyPair=require("../vo/KeyPair"),_voKeyPair2=_interopRequireDefault(_voKeyPair),_voClearKeyKeySet=require("../vo/ClearKeyKeySet"),_voClearKeyKeySet2=_interopRequireDefault(_voClearKeyKeySet),_coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);ClearKey.__dashjs_factory_name="ClearKey",exports.default=_coreFactoryMaker2.default.getSingletonFactory(ClearKey),module.exports=exports.default;
},{"../../../core/FactoryMaker":15,"../vo/ClearKeyKeySet":126,"../vo/KeyPair":129}],123:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function DRMToday(){function e(e){return e}function r(){return"POST"}function t(e){return a[e].responseType}function n(e,r){return a[r].getLicenseMessage(e)}function o(e,r){return a[r].getErrorResponse(e)}var a={"com.widevine.alpha":{responseType:"json",getLicenseMessage:function(e){return _externalsBase642.default.decodeArray(e.license)},getErrorResponse:function(e){return e}},"com.microsoft.playready":{responseType:"arraybuffer",getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}},s=void 0;return s={getServerURLFromMessage:e,getHTTPMethod:r,getResponseType:t,getLicenseMessage:n,getErrorResponse:o}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_externalsBase64=require("../../../../externals/base64"),_externalsBase642=_interopRequireDefault(_externalsBase64);DRMToday.__dashjs_factory_name="DRMToday",exports.default=_coreFactoryMaker2.default.getSingletonFactory(DRMToday),module.exports=exports.default;
},{"../../../../externals/base64":8,"../../../core/FactoryMaker":15}],124:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function PlayReady(){function e(e){return e}function r(){return"POST"}function t(){return"arraybuffer"}function a(e){return e}function o(e){return String.fromCharCode.apply(null,new Uint8Array(e))}var n=void 0;return n={getServerURLFromMessage:e,getHTTPMethod:r,getResponseType:t,getLicenseMessage:a,getErrorResponse:o}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);PlayReady.__dashjs_factory_name="PlayReady",exports.default=_coreFactoryMaker2.default.getSingletonFactory(PlayReady),module.exports=exports.default;
},{"../../../core/FactoryMaker":15}],125:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function Widevine(){function e(e){return e}function r(){return"POST"}function t(){return"arraybuffer"}function n(e){return e}function o(e){return String.fromCharCode.apply(null,new Uint8Array(e))}var a=void 0;return a={getServerURLFromMessage:e,getHTTPMethod:r,getResponseType:t,getLicenseMessage:n,getErrorResponse:o}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);Widevine.__dashjs_factory_name="Widevine",exports.default=_coreFactoryMaker2.default.getSingletonFactory(Widevine),module.exports=exports.default;
},{"../../../core/FactoryMaker":15}],126:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),ClearKeyKeySet=function(){function e(t,r){if(_classCallCheck(this,e),r&&"persistent"!==r&&"temporary"!==r)throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=t,this.type=r}return _createClass(e,[{key:"toJWK",value:function(){var e,t=this.keyPairs.length,r={keys:[]};for(e=0;e<t;e++){var a={kty:"oct",alg:"A128KW",kid:this.keyPairs[e].keyID,k:this.keyPairs[e].key};r.keys.push(a)}this.type&&(r.type=this.type);var n=JSON.stringify(r),s=n.length,i=new ArrayBuffer(s),o=new Uint8Array(i);for(e=0;e<s;e++)o[e]=n.charCodeAt(e);return i}}]),e}();exports.default=ClearKeyKeySet,module.exports=exports.default;
},{}],127:[function(require,module,exports){
"use strict";function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var KeyError=function e(r,s){_classCallCheck(this,e),this.sessionToken=r,this.error=s};exports.default=KeyError,module.exports=exports.default;
},{}],128:[function(require,module,exports){
"use strict";function _classCallCheck(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var KeyMessage=function e(s,t,a,l){_classCallCheck(this,e),this.sessionToken=s,this.message=t,this.defaultURL=a,this.messageType=l?l:"license-request"};exports.default=KeyMessage,module.exports=exports.default;
},{}],129:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var KeyPair=function e(t,s){_classCallCheck(this,e),this.keyID=t,this.key=s};exports.default=KeyPair,module.exports=exports.default;
},{}],130:[function(require,module,exports){
"use strict";function _classCallCheck(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var KeySystemAccess=function e(s,t){_classCallCheck(this,e),this.keySystem=s,this.ksConfiguration=t};exports.default=KeySystemAccess,module.exports=exports.default;
},{}],131:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var KeySystemConfiguration=function t(e,i,s,a,n){_classCallCheck(this,t),this.initDataTypes=["cenc"],e&&e.length&&(this.audioCapabilities=e),i&&i.length&&(this.videoCapabilities=i),this.distinctiveIdentifier=s,this.persistentState=a,this.sessionTypes=n};exports.default=KeySystemConfiguration,module.exports=exports.default;
},{}],132:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var MediaCapability=function e(t,a){_classCallCheck(this,e),this.contentType=t,this.robustness=a};exports.default=MediaCapability,module.exports=exports.default;
},{}],133:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var NeedKey=function e(t,a){_classCallCheck(this,e),this.initData=t,this.initDataType=a};exports.default=NeedKey,module.exports=exports.default;
},{}],134:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function DroppedFramesHistory(){function e(e,r){var o=r.droppedVideoFrames-a;a=r.droppedVideoFrames;var d=r.totalVideoFrames-s;s=r.totalVideoFrames,t[e]?(t[e].droppedVideoFrames+=o,t[e].totalVideoFrames+=d):t[e]={droppedVideoFrames:o,totalVideoFrames:d}}function r(){return t}function o(e){t=[],a=e.droppedVideoFrames,s=e.totalVideoFrames}var t=[],a=0,s=0;return{push:e,getFrameHistory:r,reset:o}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMakerJs=require("../../core/FactoryMaker.js"),_coreFactoryMakerJs2=_interopRequireDefault(_coreFactoryMakerJs);DroppedFramesHistory.__dashjs_factory_name="DroppedFramesHistory";var factory=_coreFactoryMakerJs2.default.getClassFactory(DroppedFramesHistory);exports.default=factory,module.exports=exports.default;
},{"../../core/FactoryMaker.js":15}],135:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function RulesContext(e){function r(){return m.mediaInfo.streamInfo}function t(){return m.mediaInfo}function n(){return m}function o(){return _}function u(){return m.mediaInfo.streamInfo.manifestInfo}function a(){return y}function s(){return p}function c(){return I}function f(){return g}function i(){return R}function d(){return x}var l=void 0,m=e.streamProcessor.getCurrentRepresentationInfo(),y=e.streamProcessor,_=e.currentValue,p=e.playbackIndex,I=e.switchHistory,g=e.droppedFramesHistory,R=e.currentRequest,x=e.hasRichBuffer;return l={getCurrentValue:o,getManifestInfo:u,getMediaInfo:t,getPlaybackIndex:s,getDroppedFramesHistory:f,getCurrentRequest:i,getSwitchHistory:c,getStreamInfo:r,getStreamProcessor:a,getTrackInfo:n,hasRichBuffer:d}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);RulesContext.__dashjs_factory_name="RulesContext",exports.default=_coreFactoryMaker2.default.getClassFactory(RulesContext),module.exports=exports.default;
},{"../../core/FactoryMaker":15}],136:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function RulesController(){function e(){i={}}function t(e){e&&e.abrRulesCollection&&(i[ABR_RULE]=e.abrRulesCollection)}function u(e,t,u,r,o,a){var i,R,c={},_={},s=e.length,n=s,f=l(t,r),d=function(e){var t,l,o;if(e.value!==_SwitchRequest2.default.NO_CHANGE){var i=a(c[e.priority],e.value);i!==c[e.priority]&&(c[e.priority]=i,_[e.priority]=e.reason)}--s||(c[_SwitchRequest2.default.WEAK]!==_SwitchRequest2.default.NO_CHANGE&&(o=_SwitchRequest2.default.WEAK,t=c[_SwitchRequest2.default.WEAK],l=_[_SwitchRequest2.default.WEAK]),c[_SwitchRequest2.default.DEFAULT]!==_SwitchRequest2.default.NO_CHANGE&&(o=_SwitchRequest2.default.DEFAULT,t=c[_SwitchRequest2.default.DEFAULT],l=_[_SwitchRequest2.default.DEFAULT]),c[_SwitchRequest2.default.STRONG]!==_SwitchRequest2.default.NO_CHANGE&&(o=_SwitchRequest2.default.STRONG,t=c[_SwitchRequest2.default.STRONG],l=_[_SwitchRequest2.default.STRONG]),o!=_SwitchRequest2.default.STRONG&&o!=_SwitchRequest2.default.WEAK&&(o=_SwitchRequest2.default.DEFAULT),u(void 0!==t?{value:t,confidence:o,reason:l}:{value:r,confidence:o,reason:{name:"NO_CHANGE"}}))};for(c[_SwitchRequest2.default.STRONG]=_SwitchRequest2.default.NO_CHANGE,c[_SwitchRequest2.default.WEAK]=_SwitchRequest2.default.NO_CHANGE,c[_SwitchRequest2.default.DEFAULT]=_SwitchRequest2.default.NO_CHANGE,R=0;R<n;R++)i=e[R],i.execute(f,d)}function r(){var e,t,u=i[ABR_RULE],r=(u.getRules(_abrABRRulesCollection2.default.QUALITY_SWITCH_RULES)||[]).concat(u.getRules(_abrABRRulesCollection2.default.ABANDON_FRAGMENT_RULES)||[]),l=r.length;for(t=0;t<l;t++)e=r[t],"function"==typeof e.reset&&e.reset();i={}}function l(e,t){return(0,_RulesContext2.default)(o).create({streamProcessor:e,currentValue:t})}var o=this.context,a=void 0,i=void 0;return a={initialize:e,setConfig:t,applyRules:u,reset:r}}Object.defineProperty(exports,"__esModule",{value:!0});var _RulesContext=require("./RulesContext"),_RulesContext2=_interopRequireDefault(_RulesContext),_SwitchRequest=require("./SwitchRequest"),_SwitchRequest2=_interopRequireDefault(_SwitchRequest),_abrABRRulesCollection=require("./abr/ABRRulesCollection"),_abrABRRulesCollection2=_interopRequireDefault(_abrABRRulesCollection),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),ABR_RULE=0;RulesController.__dashjs_factory_name="RulesController";var factory=_coreFactoryMaker2.default.getSingletonFactory(RulesController);factory.ABR_RULE=ABR_RULE,exports.default=factory,module.exports=exports.default;
},{"../../core/FactoryMaker":15,"./RulesContext":135,"./SwitchRequest":137,"./abr/ABRRulesCollection":139}],137:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function SwitchRequest(e,r){var t=void 0===e?NO_CHANGE:e,a=void 0===r?null:r,o={value:t,reason:a};return o}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),NO_CHANGE=-1;SwitchRequest.__dashjs_factory_name="SwitchRequest";var factory=_coreFactoryMaker2.default.getClassFactory(SwitchRequest);factory.NO_CHANGE=NO_CHANGE,exports.default=factory,module.exports=exports.default;
},{"../../core/FactoryMaker":15}],138:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function SwitchRequestHistory(){function e(e){t[e.oldValue]||(t[e.oldValue]={noDrops:0,drops:0,dropSize:0});var r=e.newValue-e.oldValue,o=r<0?1:0,s=o?-r:0,u=o?0:1;if(t[e.oldValue].drops+=o,t[e.oldValue].dropSize+=s,t[e.oldValue].noDrops+=u,a.push({idx:e.oldValue,noDrop:u,drop:o,dropSize:s}),a.length>SWITCH_REQUEST_HISTORY_DEPTH){var i=a.shift();t[i.idx].drops-=i.drop,t[i.idx].dropSize-=i.dropSize,t[i.idx].noDrops-=i.noDrop}}function r(){return t}function o(){t=[],a=[]}var t=[],a=[];return{push:e,getSwitchRequests:r,reset:o}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMakerJs=require("../../core/FactoryMaker.js"),_coreFactoryMakerJs2=_interopRequireDefault(_coreFactoryMakerJs),SWITCH_REQUEST_HISTORY_DEPTH=8;SwitchRequestHistory.__dashjs_factory_name="SwitchRequestHistory";var factory=_coreFactoryMakerJs2.default.getClassFactory(SwitchRequestHistory);exports.default=factory,module.exports=exports.default;
},{"../../core/FactoryMaker.js":15}],139:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ABRRulesCollection(){function e(){i=[],n=[];var e=(0,_modelsMetricsModel2.default)(s).getInstance(),t=(0,_dashDashMetrics2.default)(s).getInstance(),u=(0,_modelsMediaPlayerModel2.default)(s).getInstance();u.getBufferOccupancyABREnabled()?(i.push((0,_BolaRule2.default)(s).create({metricsModel:e,dashMetrics:(0,_dashDashMetrics2.default)(s).getInstance()})),n.push((0,_BolaAbandonRule2.default)(s).create({metricsModel:e,dashMetrics:(0,_dashDashMetrics2.default)(s).getInstance()}))):(i.push((0,_ThroughputRule2.default)(s).create({metricsModel:e,dashMetrics:t})),i.push((0,_InsufficientBufferRule2.default)(s).create({metricsModel:e})),i.push((0,_SwitchHistoryRuleJs2.default)(s).create()),i.push((0,_DroppedFramesRuleJs2.default)(s).create()),n.push((0,_AbandonRequestsRule2.default)(s).create()))}function t(e){switch(e){case QUALITY_SWITCH_RULES:return i;case ABANDON_FRAGMENT_RULES:return n;default:return null}}function u(e){return e.filter(function(e){return e.value>_SwitchRequestJs2.default.NO_CHANGE})}function r(e){if(0!==e.length)return e.reduce(function(e,t){return e.value<t.value?e:t})}function a(e){var t=i.map(function(t){return t.getMaxIndex(e)}),a=u(t),l=r(a);return l||(0,_SwitchRequestJs2.default)(s).create()}function l(e){var t=n.map(function(t){return t.shouldAbandon(e)}),a=u(t),l=r(a);return l||(0,_SwitchRequestJs2.default)(s).create()}var s=this.context,o=void 0,i=void 0,n=void 0;return o={initialize:e,getRules:t,getMaxQuality:a,shouldAbandonFragment:l}}Object.defineProperty(exports,"__esModule",{value:!0});var _ThroughputRule=require("./ThroughputRule"),_ThroughputRule2=_interopRequireDefault(_ThroughputRule),_InsufficientBufferRule=require("./InsufficientBufferRule"),_InsufficientBufferRule2=_interopRequireDefault(_InsufficientBufferRule),_AbandonRequestsRule=require("./AbandonRequestsRule"),_AbandonRequestsRule2=_interopRequireDefault(_AbandonRequestsRule),_DroppedFramesRuleJs=require("./DroppedFramesRule.js"),_DroppedFramesRuleJs2=_interopRequireDefault(_DroppedFramesRuleJs),_SwitchHistoryRuleJs=require("./SwitchHistoryRule.js"),_SwitchHistoryRuleJs2=_interopRequireDefault(_SwitchHistoryRuleJs),_BolaRule=require("./BolaRule"),_BolaRule2=_interopRequireDefault(_BolaRule),_BolaAbandonRule=require("./BolaAbandonRule"),_BolaAbandonRule2=_interopRequireDefault(_BolaAbandonRule),_modelsMediaPlayerModel=require("../../models/MediaPlayerModel"),_modelsMediaPlayerModel2=_interopRequireDefault(_modelsMediaPlayerModel),_modelsMetricsModel=require("../../models/MetricsModel"),_modelsMetricsModel2=_interopRequireDefault(_modelsMetricsModel),_dashDashMetrics=require("../../../dash/DashMetrics"),_dashDashMetrics2=_interopRequireDefault(_dashDashMetrics),_coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_SwitchRequestJs=require("../SwitchRequest.js"),_SwitchRequestJs2=_interopRequireDefault(_SwitchRequestJs),QUALITY_SWITCH_RULES="qualitySwitchRules",ABANDON_FRAGMENT_RULES="abandonFragmentRules";ABRRulesCollection.__dashjs_factory_name="ABRRulesCollection";var factory=_coreFactoryMaker2.default.getSingletonFactory(ABRRulesCollection);factory.QUALITY_SWITCH_RULES=QUALITY_SWITCH_RULES,factory.ABANDON_FRAGMENT_RULES=ABANDON_FRAGMENT_RULES,exports.default=factory,module.exports=exports.default;
},{"../../../core/FactoryMaker":15,"../../../dash/DashMetrics":22,"../../models/MediaPlayerModel":107,"../../models/MetricsModel":108,"../SwitchRequest.js":137,"./AbandonRequestsRule":140,"./BolaAbandonRule":141,"./BolaRule":142,"./DroppedFramesRule.js":143,"./InsufficientBufferRule":144,"./SwitchHistoryRule.js":145,"./ThroughputRule":146}],140:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function AbandonRequestsRule(){function e(){l={},c={},f=[],_=(0,_modelsMediaPlayerModel2.default)(n).getInstance(),y=(0,_dashDashMetrics2.default)(n).getInstance(),m=(0,_modelsMetricsModel2.default)(n).getInstance()}function t(e,t){l[e]=l[e]||{},l[e][t]=l[e][t]||{}}function a(e,t){f[e]=f[e]||[],f[e].push(t)}function r(e){var r=e.getMediaInfo(),d=r.type,b=e.getCurrentRequest(),h=(0,_SwitchRequest2.default)(n).create(_SwitchRequest2.default.NO_CHANGE,{name:AbandonRequestsRule.__dashjs_factory_name});if(!isNaN(b.index)){t(d,b.index);var M=_.getStableBufferTime(),g=y.getCurrentBufferLevel(m.getReadOnlyMetricsFor(d));if(g>M)return h;var q=l[d][b.index];if(null===q||null===b.firstByteDate||c.hasOwnProperty(q.id))return h;if(void 0===q.firstByteTime&&(f[d]=[],q.firstByteTime=b.firstByteDate.getTime(),q.segmentDuration=b.duration,q.bytesTotal=b.bytesTotal,q.id=b.index),q.bytesLoaded=b.bytesLoaded,q.elapsedTime=(new Date).getTime()-q.firstByteTime,q.bytesLoaded>0&&q.elapsedTime>0&&a(d,Math.round(8*q.bytesLoaded/q.elapsedTime)),f[d].length>=o&&q.elapsedTime>i&&q.bytesLoaded<q.bytesTotal){var R=f[d].reduce(function(e,t){return e+t},0);if(q.measuredBandwidthInKbps=Math.round(R/f[d].length),q.estimatedTimeOfDownload=+(8*q.bytesTotal/q.measuredBandwidthInKbps/1e3).toFixed(2),q.estimatedTimeOfDownload<q.segmentDuration*s||0===e.getTrackInfo().quality)return h;if(!c.hasOwnProperty(q.id)){var p=e.getStreamProcessor().getABRController(),D=q.bytesTotal-q.bytesLoaded,w=p.getBitrateList(r),T=p.getQualityForBitrate(r,q.measuredBandwidthInKbps*_.getBandwidthSafetyFactor()),v=q.bytesTotal*w[T].bitrate/w[p.getQualityFor(d,r.streamInfo)].bitrate;D>v&&(h.value=T,h.reason.throughput=q.measuredBandwidthInKbps,h.reason.fragmentID=q.id,c[q.id]=q,u("AbandonRequestsRule ( ",d,"frag id",q.id,") is asking to abandon and switch to quality to ",T," measured bandwidth was",q.measuredBandwidthInKbps),delete l[d][q.id])}}else q.bytesLoaded===q.bytesTotal&&delete l[d][q.id]}return h}function d(){e()}var s=1.8,i=500,o=5,n=this.context,u=(0,_coreDebug2.default)(n).getInstance().log,l=void 0,c=void 0,f=void 0,_=void 0,y=void 0,m=void 0,b={shouldAbandon:r,reset:d};return e(),b}Object.defineProperty(exports,"__esModule",{value:!0});var _SwitchRequest=require("../SwitchRequest"),_SwitchRequest2=_interopRequireDefault(_SwitchRequest),_modelsMediaPlayerModel=require("../../models/MediaPlayerModel"),_modelsMediaPlayerModel2=_interopRequireDefault(_modelsMediaPlayerModel),_dashDashMetrics=require("../../../dash/DashMetrics"),_dashDashMetrics2=_interopRequireDefault(_dashDashMetrics),_modelsMetricsModel=require("../../models/MetricsModel"),_modelsMetricsModel2=_interopRequireDefault(_modelsMetricsModel),_coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_coreDebug=require("../../../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug);AbandonRequestsRule.__dashjs_factory_name="AbandonRequestsRule",exports.default=_coreFactoryMaker2.default.getClassFactory(AbandonRequestsRule),module.exports=exports.default;
},{"../../../core/Debug":13,"../../../core/FactoryMaker":15,"../../../dash/DashMetrics":22,"../../models/MediaPlayerModel":107,"../../models/MetricsModel":108,"../SwitchRequest":137}],141:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function BolaAbandonRule(e){function t(){_={},b=(0,_modelsMediaPlayerModel2.default)(s).getInstance()}function a(e,t,a){_[e]={index:t,quality:a}}function r(e,t,a){var r=_[e];return!r||(t!==r.index||a<r.quality)}function o(e){var t=e.getMediaInfo(),o=t.type,i=f.getReadOnlyMetricsFor(o),c=e.getCurrentRequest(),b=(0,_SwitchRequest2.default)(s).create(_SwitchRequest2.default.NO_CHANGE,{name:BolaAbandonRule.__dashjs_factory_name});if(0===i.BolaState.length)return n("WARNING: executing BolaAbandonRule before initializing BolaRule"),_[o]=null,b;var y=i.BolaState[0]._s,B=c.index,R=c.quality;if(isNaN(B)||0===R||!r(o,B,R)||!c.firstByteDate)return b;var g=Date.now(),p=g-c.firstByteDate.getTime(),v=c.bytesLoaded,q=c.bytesTotal,M=q-v,h=c.duration,D=d.getCurrentBufferLevel(i)?d.getCurrentBufferLevel(i):0,m=D+y.placeholderBuffer,A=8*v/(.001*p),S=y.bandwidthSafetyFactor*A,T=.001*(c.firstByteDate.getTime()-c.requestStartDate.getTime());T<.001*u&&(T=.001*u);var x=T+8*q/S,F="";_BolaRule2.default.BOLA_DEBUG&&(F="index="+B+" quality="+R+" bytesLoaded/bytesTotal="+v+"/"+q+" bufferLevel="+D+" timeSince1stByte="+(p/1e3).toFixed(3)+" estThroughput="+(S/1e6).toFixed(3)+" latency="+T.toFixed(3));var L=q*y.bitrates[0]/y.bitrates[R],w=M-T*S/8;if(w<1&&(w=1),p<l||M<=L||D>y.bufferTarget||w<=L||x<=h)return b;var N=m-T;N<0&&(N=0);for(var P=0;P+1<R&&q*y.bitrates[P+1]/y.bitrates[R]<w;)++P;var O=R;if(y.state===_BolaRule2.default.BOLA_STATE_STARTUP){O=0;for(var k=0;k<=P&&(L=q*y.bitrates[k]/y.bitrates[R],!(8*L/h>S));++k)O=k}else for(var C=(y.Vp*(y.utilities[R]+y.gp)-N)/w,k=0;k<=P;++k){L=q*y.bitrates[k]/y.bitrates[R];var E=(y.Vp*(y.utilities[k]+y.gp)-N)/L;E>C&&(O=k,C=E)}var G=y.rebufferSafetyFactor*A*(D-T)/8;if(O===R&&w>G&&(O=P),O===R)return b;for(;O>0&&(L=q*y.bitrates[O]/y.bitrates[R],!(L<=G));)--O;var I=NaN;if(O>0){var V=y.utilities[O],j=y.utilities[O-1],E=y.bitrates[O],U=y.bitrates[O-1];I=y.Vp*((E*j-U*V)/(E-U)+y.gp)}else{var V=y.utilities[0],j=y.utilities[1],E=y.bitrates[0],U=y.bitrates[1];I=y.Vp*((E*j-U*V)/(E-U)+y.gp),I-=h}return m>I&&(y.placeholderBuffer=I-D,y.placeholderBuffer<0&&(y.placeholderBuffer=0)),y.lastQuality=O,f.updateBolaState(o,y),_BolaRule2.default.BOLA_DEBUG&&n("BolaDebug "+o+" BolaAbandonRule abandon to "+O+" - "+F),a(o,B,R),b.value=O,b.reason.state=y.state,b.reason.throughput=A,b.reason.bufferLevel=D,b.reason.bytesLoaded=c.bytesLoaded,b.reason.bytesTotal=c.bytesTotal,b.reason.elapsedTimeMs=p,b}function i(){_={}}var l=500,u=200,s=this.context,n=(0,_coreDebug2.default)(s).getInstance().log,d=e.dashMetrics,f=e.metricsModel,c=void 0,_=void 0,b=void 0;return c={shouldAbandon:o,reset:i},t(),c}Object.defineProperty(exports,"__esModule",{value:!0});var _SwitchRequest=require("../SwitchRequest"),_SwitchRequest2=_interopRequireDefault(_SwitchRequest),_modelsMediaPlayerModel=require("../../models/MediaPlayerModel"),_modelsMediaPlayerModel2=_interopRequireDefault(_modelsMediaPlayerModel),_coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_coreDebug=require("../../../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug),_BolaRule=require("./BolaRule"),_BolaRule2=_interopRequireDefault(_BolaRule);BolaAbandonRule.__dashjs_factory_name="BolaAbandonRule",exports.default=_coreFactoryMaker2.default.getClassFactory(BolaAbandonRule),module.exports=exports.default;
},{"../../../core/Debug":13,"../../../core/FactoryMaker":15,"../../models/MediaPlayerModel":107,"../SwitchRequest":137,"./BolaRule":142}],142:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function BolaRule(e){function t(){p={},F={},O={},y=[],L=(0,_modelsMediaPlayerModel2.default)(v).getInstance(),M=(0,_controllersPlaybackController2.default)(v).getInstance(),b=(0,_dashDashAdapter2.default)(v).getInstance(),R.on(_coreEventsEvents2.default.BUFFER_EMPTY,f,D),R.on(_coreEventsEvents2.default.PLAYBACK_SEEKING,_,D),R.on(_coreEventsEvents2.default.PERIOD_SWITCH_STARTED,c,D),R.on(_coreEventsEvents2.default.MEDIA_FRAGMENT_LOADED,E,D)}function r(e){return e.map(function(e){return Math.log(e)})}function a(e,t,a,o){var u=NaN;if(o?(u=0,o.forEach(function(e,t){e>o[u]&&(u=t)})):(o=r(a),u=o.length-1),0===u)return null;var l=1-o[0]+(o[u]-o[0])/(t/e-1),n=e/(o[0]+l-1);return{utilities:o,gp:l,Vp:n}}function o(e){var t={},r=e.getMediaInfo(),o=e.getStreamProcessor(),u=e.getStreamInfo(),l=e.getTrackInfo(),n=o.isDynamic(),i=u.manifestInfo.duration,s=l.fragmentDuration,f=r.bitrateList.map(function(e){return e.bandwidth}),_=a(MINIMUM_BUFFER_S,BUFFER_TARGET_S,f,null);if(null===_)return t.state=BOLA_STATE_ONE_BITRATE,t;if(t.state=BOLA_STATE_STARTUP,t.bitrates=f,t.utilities=_.utilities,t.Vp=_.Vp,t.gp=_.gp,t.isDynamic=n,t.movieDuration=i,t.fragmentDuration=s,t.bandwidthSafetyFactor=L.getBandwidthSafetyFactor(),t.rebufferSafetyFactor=REBUFFER_SAFETY_FACTOR,t.bufferTarget=L.getStableBufferTime(),t.lastQuality=0,t.placeholderBuffer=0,t.throughputCount=n?d:A,BOLA_DEBUG){for(var c="",E=0;E<f.length;++E){var B=_.utilities[E],T=f[E],v=0;if(E>0){var h=_.utilities[E-1],S=f[E-1];v=_.Vp*((h*T-B*S)/(T-S)+_.gp)}var R=_.Vp*(B+_.gp);c+="\n"+E+":"+(1e-6*f[E]).toFixed(3)+"Mbps "+v.toFixed(3)+"/"+R.toFixed(3)}g("BolaDebug "+r.type+" bitrates"+c)}return t}function u(e,t){for(var r=e.bitrates.length,a=NaN,o=NaN,u=0;u<r;++u){var l=(e.Vp*(e.utilities[u]+e.gp)-t)/e.bitrates[u];(isNaN(o)||l>=o)&&(o=l,a=u)}return a}function l(e,t){for(var r=h.getHttpRequests(e),a=[],o=r.length-1;o>=0&&a.length<t;--o){var u=r[o];u.type===_voMetricsHTTPRequest.HTTPRequest.MEDIA_SEGMENT_TYPE&&u._tfinish&&u.tresponse&&u.trace&&a.push(u)}return a}function n(e,t,r){var a=l(e,t);if(0===a.length)return 0;for(var o=0,u="",n=0;n<a.length;++n){var i=.001*(a[n]._tfinish.getTime()-a[n].trequest.getTime()),s=8*a[n].trace.reduce(function(e,t){return e+t.b[0]},0);BOLA_DEBUG&&(u+=" "+(1e-6*s).toFixed(3)+"/"+i.toFixed(3)+"="+(1e-6*s/i).toFixed(3)+"Mbps"),o+=i/s}return BOLA_DEBUG&&g("BolaDebug "+r+" BolaRule recent throughput = "+(a.length/(1e6*o)).toFixed(3)+"Mbps:"+u),a.length/o}function i(e,t){var r=0;return e.bitrates.some(function(e,a){return e>t||(r=a,!1)}),r}function s(e,t){var r=Date.now(),a=p[t],o=O[t],u=NaN;if(p[t]=r,O[t]=!1,!o){var n=l(e,1);n.length>0&&(u=n[0]._tfinish.getTime(),u>r&&(u=r))}var i=0;return i=o||a>u?r-a:r-u,isNaN(i)||i<=0?0:.001*i}function f(){BOLA_DEBUG&&g("BolaDebug BUFFER_EMPTY"),y.forEach(function(e){var t=S.getReadOnlyMetricsFor(e);if(0!==t.BolaState.length){var r=t.BolaState[0]._s;r.state===BOLA_STATE_STEADY&&(r.placeholderBuffer=0,S.updateBolaState(e,r))}})}function _(e){BOLA_DEBUG&&g("BolaDebug PLAYBACK_SEEKING "+e.seekTime.toFixed(3)),y.forEach(function(e){var t=S.getReadOnlyMetricsFor(e);if(0!==t.BolaState.length){var r=t.BolaState[0]._s;r.state!==BOLA_STATE_ONE_BITRATE&&(r.state=BOLA_STATE_STARTUP),S.updateBolaState(e,r)}}),F={},O={}}function c(){}function E(e){if(e&&e.chunk&&e.chunk.mediaInfo){var t=e.chunk.mediaInfo.type,r=e.chunk.start;void 0===t||isNaN(r)||(r<=F[t]?O[t]=!0:(O[t]=!1,F[t]=r))}}function B(e){var t=e.getStreamProcessor();t.getScheduleController().setTimeToLoadDelay(0);var r=(0,_SwitchRequest2.default)(v).create(_SwitchRequest2.default.NO_CHANGE,{name:BolaRule.__dashjs_factory_name}),a=e.getMediaInfo(),l=a.type,f=S.getReadOnlyMetricsFor(l);if(0===f.BolaState.length){BOLA_DEBUG&&g("BolaDebug "+l+"\nBolaDebug "+l+" BolaRule for state=- fragmentStart="+b.getIndexHandlerTime(e.getStreamProcessor()).toFixed(3));var _=o(e);S.updateBolaState(l,_);var c=0;if(_.state!==BOLA_STATE_ONE_BITRATE){y.push(l);var E=n(f,_.throughputCount,l);if(0===E)return BOLA_DEBUG&&g("BolaDebug "+l+" BolaRule quality unchanged for INITIALIZE"),r;c=i(_,E*_.bandwidthSafetyFactor),_.lastQuality=c,r.value=c,r.reason.state=_.state,r.reason.throughput=E}return BOLA_DEBUG&&g("BolaDebug "+l+" BolaRule quality "+c+" for INITIALIZE"),r}var B=f.BolaState[0]._s;if(B.state===BOLA_STATE_ONE_BITRATE)return BOLA_DEBUG&&g("BolaDebug "+l+" BolaRule quality 0 for ONE_BITRATE"),r;var T=B.bitrates,d=B.utilities;BOLA_DEBUG&&g("BolaDebug "+l+"\nBolaDebug "+l+" EXECUTE BolaRule for state="+B.state+" fragmentStart="+b.getIndexHandlerTime(e.getStreamProcessor()).toFixed(3));var A=h.getCurrentBufferLevel(f)?h.getCurrentBufferLevel(f):0,R=n(f,B.throughputCount,l);A<=.1&&(B.placeholderBuffer=0);var D=s(f,l);D>0&&(B.placeholderBuffer+=D),B.placeholderBuffer<0&&(B.placeholderBuffer=0);var p=A+B.placeholderBuffer,F=u(B,p);if(BOLA_DEBUG&&g("BolaDebug "+l+" BolaRule bufferLevel="+A.toFixed(3)+"(+"+B.placeholderBuffer.toFixed(3)+"="+p.toFixed(3)+") recentThroughput="+(1e-6*R).toFixed(3)+" tentativeQuality="+F),B.state===BOLA_STATE_STARTUP){var c=i(B,R*B.bandwidthSafetyFactor);if(A>B.fragmentDuration/REBUFFER_SAFETY_FACTOR){B.state=BOLA_STATE_STEADY;for(var O=0,L=0;L<c;++L){var M=B.Vp*(B.gp+(T[c]*d[L]-T[L]*d[c])/(T[c]-T[L]));M>O&&(O=M)}O>A&&(B.placeholderBuffer=O-A)}return BOLA_DEBUG&&g("BolaDebug "+l+" BolaRule quality "+c+" for STARTUP"),B.lastQuality=c,S.updateBolaState(l,B),r.value=c,r.reason.state=BOLA_STATE_STARTUP,r.reason.throughput=R,r}if(F>B.lastQuality){var c=i(B,R);F>c&&(c<B.lastQuality&&(c=B.lastQuality),F=c)}if(R>0)for(var I=REBUFFER_SAFETY_FACTOR*R*A/B.fragmentDuration;F>0&&T[F]>I;)--F;var m=0,U=B.Vp*(d[F]+B.gp);return m=p-U,m>0&&(m>B.placeholderBuffer?(m-=B.placeholderBuffer,B.placeholderBuffer=0):(B.placeholderBuffer-=m,m=0)),m>0?F===T.length-1?m=0:t.getScheduleController().setTimeToLoadDelay(1e3*m):m=0,B.lastQuality=F,S.updateBolaState(l,B),r.value=F,r.reason.state=B.state,r.reason.throughput=R,r.reason.bufferLevel=A,BOLA_DEBUG&&g("BolaDebug "+l+" BolaRule quality "+F+" delay="+m.toFixed(3)+" for STEADY"),r}function T(){R.off(_coreEventsEvents2.default.BUFFER_EMPTY,f,D),R.off(_coreEventsEvents2.default.PLAYBACK_SEEKING,_,D),R.off(_coreEventsEvents2.default.PERIOD_SWITCH_STARTED,c,D),R.off(_coreEventsEvents2.default.MEDIA_FRAGMENT_LOADED,E,D),t()}var d=2,A=3,v=this.context,g=(0,_coreDebug2.default)(v).getInstance().log,h=e.dashMetrics,S=e.metricsModel,R=(0,_coreEventBus2.default)(v).getInstance(),D=void 0,p=void 0,F=void 0,O=void 0,y=void 0,L=void 0,M=void 0,b=void 0;return D={getMaxIndex:B,reset:T},t(),D}Object.defineProperty(exports,"__esModule",{value:!0});var _SwitchRequest=require("../SwitchRequest"),_SwitchRequest2=_interopRequireDefault(_SwitchRequest),_coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_modelsMediaPlayerModel=require("../../models/MediaPlayerModel"),_modelsMediaPlayerModel2=_interopRequireDefault(_modelsMediaPlayerModel),_controllersPlaybackController=require("../../controllers/PlaybackController"),_controllersPlaybackController2=_interopRequireDefault(_controllersPlaybackController),_voMetricsHTTPRequest=require("../../vo/metrics/HTTPRequest"),_dashDashAdapter=require("../../../dash/DashAdapter"),_dashDashAdapter2=_interopRequireDefault(_dashDashAdapter),_coreEventBus=require("../../../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreEventsEvents=require("../../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_coreDebug=require("../../../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug),BOLA_STATE_ONE_BITRATE=0,BOLA_STATE_STARTUP=1,BOLA_STATE_STEADY=2,BOLA_DEBUG=!1,MINIMUM_BUFFER_S=10,BUFFER_TARGET_S=30,REBUFFER_SAFETY_FACTOR=.5;BolaRule.__dashjs_factory_name="BolaRule";var factory=_coreFactoryMaker2.default.getClassFactory(BolaRule);factory.BOLA_STATE_ONE_BITRATE=BOLA_STATE_ONE_BITRATE,factory.BOLA_STATE_STARTUP=BOLA_STATE_STARTUP,factory.BOLA_STATE_STEADY=BOLA_STATE_STEADY,factory.BOLA_DEBUG=BOLA_DEBUG,exports.default=factory,module.exports=exports.default;
},{"../../../core/Debug":13,"../../../core/EventBus":14,"../../../core/FactoryMaker":15,"../../../core/events/Events":18,"../../../dash/DashAdapter":20,"../../controllers/PlaybackController":74,"../../models/MediaPlayerModel":107,"../../vo/metrics/HTTPRequest":185,"../SwitchRequest":137}],143:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function DroppedFramesRule(){function e(e){var u=e.getDroppedFramesHistory();if(u){for(var s=u.getFrameHistory(),c=0,i=0,d=_SwitchRequestJs2.default.NO_CHANGE,p=1;p<s.length;p++)if(s[p]&&(c=s[p].droppedVideoFrames,i=s[p].totalVideoFrames,i>o&&c/i>a)){d=p-1,t("DroppedFramesRule, index: "+d+" Dropped Frames: "+c+" Total Frames: "+i);break}return(0,_SwitchRequestJs2.default)(r).create(d,{droppedFrames:c})}return(0,_SwitchRequestJs2.default)(r).create()}var r=this.context,t=(0,_coreDebug2.default)(r).getInstance().log,a=.15,o=375;return{getMaxIndex:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMakerJs=require("../../../core/FactoryMaker.js"),_coreFactoryMakerJs2=_interopRequireDefault(_coreFactoryMakerJs),_SwitchRequestJs=require("../SwitchRequest.js"),_SwitchRequestJs2=_interopRequireDefault(_SwitchRequestJs),_coreDebug=require("../../../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug);DroppedFramesRule.__dashjs_factory_name="DroppedFramesRule";var factory=_coreFactoryMakerJs2.default.getClassFactory(DroppedFramesRule);exports.default=factory,module.exports=exports.default;
},{"../../../core/Debug":13,"../../../core/FactoryMaker.js":15,"../SwitchRequest.js":137}],144:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function InsufficientBufferRule(e){function t(){a={},_=0,d=1e3,l.on(_coreEventsEvents2.default.PLAYBACK_SEEKING,o,c)}function r(e){var t=(new Date).getTime(),r=e.getMediaInfo().type,o=i.getReadOnlyMetricsFor(r),n=o.BufferState.length>0?o.BufferState[o.BufferState.length-1]:null,l=(0,_SwitchRequestJs2.default)(f).create();return t-_<d||null===n?l:(u(r,n.state),n.state===_controllersBufferController2.default.BUFFER_EMPTY&&void 0!==a[r].firstBufferLoadedEvent&&(s("Switch to index 0; buffer is empty."),l.value=0,l.reason="InsufficientBufferRule: Buffer is empty"),_=t,l)}function u(e,t){a[e]=a[e]||{},a[e].state=t,t!==_controllersBufferController2.default.BUFFER_LOADED||a[e].firstBufferLoadedEvent||(a[e].firstBufferLoadedEvent=!0)}function o(){a={}}function n(){l.off(_coreEventsEvents2.default.PLAYBACK_SEEKING,o,c),a={},_=0}var f=this.context,s=(0,_coreDebug2.default)(f).getInstance().log,l=(0,_coreEventBus2.default)(f).getInstance(),i=e.metricsModel,c=void 0,a=void 0,_=void 0,d=void 0;return c={getMaxIndex:r,reset:n},t(),c}Object.defineProperty(exports,"__esModule",{value:!0});var _controllersBufferController=require("../../controllers/BufferController"),_controllersBufferController2=_interopRequireDefault(_controllersBufferController),_coreEventBus=require("../../../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreEventsEvents=require("../../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_coreDebug=require("../../../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug),_SwitchRequestJs=require("../SwitchRequest.js"),_SwitchRequestJs2=_interopRequireDefault(_SwitchRequestJs);InsufficientBufferRule.__dashjs_factory_name="InsufficientBufferRule",exports.default=_coreFactoryMaker2.default.getClassFactory(InsufficientBufferRule),module.exports=exports.default;
},{"../../../core/Debug":13,"../../../core/EventBus":14,"../../../core/FactoryMaker":15,"../../../core/events/Events":18,"../../controllers/BufferController":69,"../SwitchRequest.js":137}],145:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function SwitchHistoryRule(){function e(e){for(var s=e.getSwitchHistory(),a=s.getSwitchRequests(),i=0,c=0,l=0,n=(0,_SwitchRequestJs2.default)(r).create(),_=0;_<a.length;_++)if(void 0!==a[_]&&(i+=a[_].drops,c+=a[_].noDrops,l+=a[_].dropSize,i+c>=u&&i/c>o)){n.value=_>0?_-1:0,n.reason={index:n.value,drops:i,noDrops:c,dropSize:l},t("Switch history rule index: "+n.value+" samples: "+(i+c)+" drops: "+i);break}return n}var r=this.context,t=(0,_coreDebug2.default)(r).getInstance().log,o=.075,u=6;return{getMaxIndex:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMakerJs=require("../../../core/FactoryMaker.js"),_coreFactoryMakerJs2=_interopRequireDefault(_coreFactoryMakerJs),_coreDebug=require("../../../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug),_SwitchRequestJs=require("../SwitchRequest.js"),_SwitchRequestJs2=_interopRequireDefault(_SwitchRequestJs);SwitchHistoryRule.__dashjs_factory_name="SwitchRequest";var factory=_coreFactoryMakerJs2.default.getClassFactory(SwitchHistoryRule);exports.default=factory,module.exports=exports.default;
},{"../../../core/Debug":13,"../../../core/FactoryMaker.js":15,"../SwitchRequest.js":137}],146:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ThroughputRule(e){function t(){m=[],D=[],b=(0,_modelsMediaPlayerModel2.default)(q).getInstance()}function r(e,t){m[e]=m[e]||[],m[e].push(t)}function o(e,t){if(D[e]||(D[e]=[]),D[e].push(t),D[e].length>h)return D[e].shift()}function u(e){var t=void 0;return D[e]&&D[e].length>0&&(t=D[e].reduce(function(e,t){return e+t})/D[e].length),t}function n(e,t){var r=Math.min(m[e].length,t?f:d),o=m[e].slice(r*-1,m[e].length);return o.length>1&&o.reduce(function(e,t){return(e*v<=t||e>=t*p)&&r++,t}),r=Math.min(m[e].length,r),m[e].slice(r*-1,m[e].length)}function l(e,t){var r=n(e,t),o=0;if(r.length>0){var u=r.reduce(function(e,t){return e+t},0);o=u/r.length}return m[e].length>=c&&m[e].shift(),o/1e3*b.getBandwidthSafetyFactor()}function i(e,t,r){var o=!1;if(e<M&&(o=!0),!o)switch(r){case"video":o=t<g;break;case"audio":o=t<_}return o}function a(e){var t=e.getMediaInfo(),n=t.type,a=T.getReadOnlyMetricsFor(n),s=e.getStreamProcessor(),c=s.getABRController(),f=s.isDynamic(),d=y.getCurrentHttpRequest(a),h=a.BufferState.length>0?a.BufferState[a.BufferState.length-1]:null,g=e.hasRichBuffer(),_=(0,_SwitchRequestJs2.default)(q).create();if(!a||!d||d.type!==_voMetricsHTTPRequest.HTTPRequest.MEDIA_SEGMENT_TYPE||!h||g)return _;var M=void 0,p=void 0;if(d.trace&&d.trace.length){p=d.tresponse.getTime()-d.trequest.getTime()||1,M=d._tfinish.getTime()-d.tresponse.getTime()||1;var v=d.trace.reduce(function(e,t){return e+t.b[0]},0),b=Math.round(8*v/(M/1e3)),A=void 0,B=void 0;i(p,M,n)?m[n]&&D[n]?(A=l(n,f),B=u(n)):(A=b/1e3,B=p):(r(n,b),A=l(n,f),o(n,p),B=u(n,f)),c.setAverageThroughput(n,A),c.getAbandonmentStateFor(n)!==_controllersAbrController2.default.ABANDON_LOAD&&(h.state===_controllersBufferController2.default.BUFFER_LOADED||f)&&(_.value=c.getQualityForBitrate(t,A,B),s.getScheduleController().setTimeToLoadDelay(0),R("ThroughputRule requesting switch to index: ",_.value,"type: ",n,"Average throughput",Math.round(A),"kbps"),_.reason={throughput:A,latency:B})}return _}function s(){t()}var c=20,f=3,d=4,h=d,g=50,_=5,M=50,p=1.3,v=1.3,q=this.context,R=(0,_coreDebug2.default)(q).getInstance().log,y=e.dashMetrics,T=e.metricsModel,m=void 0,D=void 0,b=void 0,A={getMaxIndex:a,reset:s};return t(),A}Object.defineProperty(exports,"__esModule",{value:!0});var _controllersBufferController=require("../../controllers/BufferController"),_controllersBufferController2=_interopRequireDefault(_controllersBufferController),_controllersAbrController=require("../../controllers/AbrController"),_controllersAbrController2=_interopRequireDefault(_controllersAbrController),_modelsMediaPlayerModel=require("../../models/MediaPlayerModel"),_modelsMediaPlayerModel2=_interopRequireDefault(_modelsMediaPlayerModel),_voMetricsHTTPRequest=require("../../vo/metrics/HTTPRequest"),_coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_coreDebug=require("../../../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug),_SwitchRequestJs=require("../SwitchRequest.js"),_SwitchRequestJs2=_interopRequireDefault(_SwitchRequestJs);ThroughputRule.__dashjs_factory_name="ThroughputRule",exports.default=_coreFactoryMaker2.default.getClassFactory(ThroughputRule),module.exports=exports.default;
},{"../../../core/Debug":13,"../../../core/FactoryMaker":15,"../../controllers/AbrController":66,"../../controllers/BufferController":69,"../../models/MediaPlayerModel":107,"../../vo/metrics/HTTPRequest":185,"../SwitchRequest.js":137}],147:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function BasicSelector(e){function r(e){var r,t=0;return e&&e.some(function(e,r){return t=r,!o.contains(e.serviceLocation)})&&(r=e[t]),r}var t=void 0,o=e.blacklistController;return t={select:r}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);BasicSelector.__dashjs_factory_name="BasicSelector",exports.default=_coreFactoryMaker2.default.getClassFactory(BasicSelector),module.exports=exports.default;
},{"../../../core/FactoryMaker":15}],148:[function(require,module,exports){
"use strict";function _interopRequireDefault(r){return r&&r.__esModule?r:{default:r}}function DVBSelector(r){function e(r){var e=[],t=function(r){return!e.length||!r.dvb_priority||e.indexOf(r.dvb_priority)===-1},o=function(r){return!n.contains(r.serviceLocation)||(r.dvb_priority&&e.push(r.dvb_priority),!1)};return r.filter(o).filter(t)}function t(r){var e,t,o=function(r,e){var t=r.dvb_priority-e.dvb_priority;return isNaN(t)?0:t},i=function(r,e,t){return!e||t[0].dvb_priority&&r.dvb_priority&&t[0].dvb_priority===r.dvb_priority},n=0,u=[],a=0;if(t=r.sort(o).filter(i),t.length)return t.length>1&&(t.forEach(function(r){n+=r.dvb_weight,u.push(n)}),e=Math.floor(Math.random()*(n-1)),u.every(function(r,t){return a=t,!(e<r)})),t[a]}function o(r){return r&&t(e(r))}var i=void 0,n=r.blacklistController;return i={select:o}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);DVBSelector.__dashjs_factory_name="DVBSelector",exports.default=_coreFactoryMaker2.default.getClassFactory(DVBSelector),module.exports=exports.default;
},{"../../../core/FactoryMaker":15}],149:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function BufferLevelRule(e){function r(){f=(0,_modelsMediaPlayerModel2.default)(l).getInstance(),i=(0,_controllersPlaybackController2.default)(l).getInstance()}function t(e,r,t){var l=a.getCurrentBufferLevel(n.getReadOnlyMetricsFor(r));return l<o(e,r,t)}function o(e,r,t){var o=NaN,l=e.getCurrentRepresentationInfo();if("fragmentedText"===r)o=u.getAllTracksAreDisabled()?0:l.fragmentDuration;else if("audio"===r&&t){var i=a.getCurrentBufferLevel(n.getReadOnlyMetricsFor("video"));o=Math.floor(Math.max(i,l.fragmentDuration))}else{var s=l.mediaInfo.streamInfo,c=e.getABRController();if(c.isPlayingAtTopQuality(s)){var d=s.manifestInfo.duration>=f.getLongFormContentDurationThreshold();o=d?f.getBufferTimeAtTopQualityLongForm():f.getBufferTimeAtTopQuality()}else o=f.getStableBufferTime()}return o}var l=this.context,a=e.dashMetrics,n=e.metricsModel,u=e.textSourceBuffer,f=void 0,i=void 0,s={execute:t,getBufferTarget:o};return r(),s}Object.defineProperty(exports,"__esModule",{value:!0});var _modelsMediaPlayerModel=require("../../models/MediaPlayerModel"),_modelsMediaPlayerModel2=_interopRequireDefault(_modelsMediaPlayerModel),_controllersPlaybackController=require("../../controllers/PlaybackController"),_controllersPlaybackController2=_interopRequireDefault(_controllersPlaybackController),_coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);BufferLevelRule.__dashjs_factory_name="BufferLevelRule",exports.default=_coreFactoryMaker2.default.getClassFactory(BufferLevelRule),module.exports=exports.default;
},{"../../../core/FactoryMaker":15,"../../controllers/PlaybackController":74,"../../models/MediaPlayerModel":107}],150:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function NextFragmentRequestRule(e){function t(e,t){var r=e.getCurrentRepresentationInfo(),i=r.mediaInfo,g=i.type,s=e.getScheduleController(),l=s.getSeekTarget(),d=!isNaN(l),c=e.getBuffer(),f=d?l:n.getIndexHandlerTime(e);if(isNaN(f)||"fragmentedText"===g&&u.getAllTracksAreDisabled())return null;if(d&&s.setSeekTarget(NaN),c){var m=o.getBufferRange(e.getBuffer(),f);null!==m&&(a("Prior to making a request for time, NextFragmentRequestRule is aligning index handler's currentTime with bufferedRange.end.",f," was changed to ",m.end),f=m.end)}var F=void 0;return t?(f=t.startTime+t.duration/2,F=n.getFragmentRequestForTime(e,r,f,{timeThreshold:0,ignoreIsFinished:!0})):(F=n.getFragmentRequestForTime(e,r,f,{keepIdx:!d}),F&&e.getFragmentModel().isFragmentLoaded(F)&&(F=n.getNextFragmentRequest(e,r)),F&&(n.setIndexHandlerTime(e,F.startTime+F.duration),F.delayLoadingTime=(new Date).getTime()+s.getTimeToLoadDelay(),s.setTimeToLoadDelay(0))),F}var r=this.context,a=(0,_coreDebug2.default)(r).getInstance().log,n=e.adapter,o=e.sourceBufferController,u=e.textSourceBuffer,i={execute:t};return i}Object.defineProperty(exports,"__esModule",{value:!0});var _coreDebug=require("../../../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug),_coreFactoryMaker=require("../../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);NextFragmentRequestRule.__dashjs_factory_name="NextFragmentRequestRule",exports.default=_coreFactoryMaker2.default.getClassFactory(NextFragmentRequestRule),module.exports=exports.default;
},{"../../../core/Debug":13,"../../../core/FactoryMaker":15}],151:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function BaseURLSelector(){function e(){c=(0,_controllersBlacklistController2.default)(s).create({updateEventName:_coreEventsEvents2.default.SERVICE_LOCATION_BLACKLIST_CHANGED,loadFailedEventName:_coreEventsEvents2.default.FRAGMENT_LOADING_COMPLETED}),E=(0,_rulesBaseUrlResolutionBasicSelector2.default)(s).create({blacklistController:c}),u=(0,_rulesBaseUrlResolutionDVBSelector2.default)(s).create({blacklistController:c}),i=E}function r(e){e.selector&&(i=e.selector)}function t(e){i=_.getIsDVB(e)?u:E}function o(e){var r=e.baseUrls,t=e.selectedIdx;if(!isNaN(t))return r[t];var o=i.select(r);return o?(e.selectedIdx=r.indexOf(o),o):void a.trigger(_coreEventsEvents2.default.URL_RESOLUTION_FAILED,{error:new Error(URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE,URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE)})}function l(){c.reset()}var s=this.context,a=(0,_coreEventBus2.default)(s).getInstance(),_=(0,_dashModelsDashManifestModel2.default)(s).getInstance(),n=void 0,c=void 0,E=void 0,u=void 0,i=void 0;return n={chooseSelectorFromManifest:t,select:o,reset:l,setConfig:r},e(),n}Object.defineProperty(exports,"__esModule",{value:!0});var _coreEventBus=require("../../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreEventsEvents=require("../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_dashModelsDashManifestModel=require("../../dash/models/DashManifestModel"),_dashModelsDashManifestModel2=_interopRequireDefault(_dashModelsDashManifestModel),_controllersBlacklistController=require("../controllers/BlacklistController"),_controllersBlacklistController2=_interopRequireDefault(_controllersBlacklistController),_rulesBaseUrlResolutionDVBSelector=require("../rules/baseUrlResolution/DVBSelector"),_rulesBaseUrlResolutionDVBSelector2=_interopRequireDefault(_rulesBaseUrlResolutionDVBSelector),_rulesBaseUrlResolutionBasicSelector=require("../rules/baseUrlResolution/BasicSelector"),_rulesBaseUrlResolutionBasicSelector2=_interopRequireDefault(_rulesBaseUrlResolutionBasicSelector),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=1,URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE="Failed to resolve a valid URL";BaseURLSelector.__dashjs_factory_name="BaseURLSelector";var factory=_coreFactoryMaker2.default.getClassFactory(BaseURLSelector);factory.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE,factory.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE=URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE,exports.default=factory,module.exports=exports.default;
},{"../../core/EventBus":14,"../../core/FactoryMaker":15,"../../core/events/Events":18,"../../dash/models/DashManifestModel":27,"../controllers/BlacklistController":68,"../rules/baseUrlResolution/BasicSelector":147,"../rules/baseUrlResolution/DVBSelector":148}],152:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function BoxParser(){function e(e){if(!e)return null;void 0===e.fileStart&&(e.fileStart=0);var r=_codemIsoboxer2.default.parseBuffer(e),t=(0,_IsoFile2.default)(o).create();return t.setData(r),t}var r=void 0,o=this.context;return r={parse:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _IsoFile=require("./IsoFile"),_IsoFile2=_interopRequireDefault(_IsoFile),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_codemIsoboxer=require("codem-isoboxer"),_codemIsoboxer2=_interopRequireDefault(_codemIsoboxer);BoxParser.__dashjs_factory_name="BoxParser",exports.default=_coreFactoryMaker2.default.getSingletonFactory(BoxParser),module.exports=exports.default;
},{"../../core/FactoryMaker":15,"./IsoFile":159,"codem-isoboxer":7}],153:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function Capabilities(){function e(){u=!1}function r(){var e="WebKitMediaSource"in window,r="MediaSource"in window;return e||r}function t(){return u}function o(e){u=e}function a(e,r){var t=e.canPlayType(r);return"probably"===t||"maybe"===t}var i=void 0,u=void 0;return i={supportsMediaSource:r,supportsEncryptedMedia:t,supportsCodec:a,setEncryptedMediaSupported:o},e(),i}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);Capabilities.__dashjs_factory_name="Capabilities",exports.default=_coreFactoryMaker2.default.getSingletonFactory(Capabilities),module.exports=exports.default;
},{"../../core/FactoryMaker":15}],154:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function CustomTimeRanges(){function e(e,t){var r=0;for(r=0;r<this.customTimeRangeArray.length&&e>this.customTimeRangeArray[r].start;r++);for(this.customTimeRangeArray.splice(r,0,{start:e,end:t}),r=0;r<this.customTimeRangeArray.length-1;r++)this.mergeRanges(r,r+1)&&r--;this.length=this.customTimeRangeArray.length}function t(){this.customTimeRangeArray=[],this.length=0}function r(e,t){for(var r=0;r<this.customTimeRangeArray.length;r++)if(e<=this.customTimeRangeArray[r].start&&t>=this.customTimeRangeArray[r].end)this.customTimeRangeArray.splice(r,1),r--;else{if(e>this.customTimeRangeArray[r].start&&t<this.customTimeRangeArray[r].end){this.customTimeRangeArray.splice(r+1,0,{start:t,end:this.customTimeRangeArray[r].end}),this.customTimeRangeArray[r].end=e;break}e>this.customTimeRangeArray[r].start&&e<this.customTimeRangeArray[r].end?this.customTimeRangeArray[r].end=e:t>this.customTimeRangeArray[r].start&&t<this.customTimeRangeArray[r].end&&(this.customTimeRangeArray[r].start=t)}this.length=this.customTimeRangeArray.length}function a(e,t){var r=this.customTimeRangeArray[e],a=this.customTimeRangeArray[t];return r.start<=a.start&&a.start<=r.end&&r.end<=a.end?(r.end=a.end,this.customTimeRangeArray.splice(t,1),!0):a.start<=r.start&&r.start<=a.end&&a.end<=r.end?(r.start=a.start,this.customTimeRangeArray.splice(t,1),!0):a.start<=r.start&&r.start<=a.end&&r.end<=a.end?(this.customTimeRangeArray.splice(e,1),!0):r.start<=a.start&&a.start<=r.end&&a.end<=r.end&&(this.customTimeRangeArray.splice(t,1),!0)}function s(e){return this.customTimeRangeArray[e].start}function n(e){return this.customTimeRangeArray[e].end}var i=[],m=0;return{customTimeRangeArray:i,length:m,add:e,clear:t,remove:r,mergeRanges:a,start:s,end:n}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);CustomTimeRanges.__dashjs_factory_name="CustomTimeRanges",exports.default=_coreFactoryMaker2.default.getClassFactory(CustomTimeRanges),module.exports=exports.default;
},{"../../core/FactoryMaker":15}],155:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function DOMStorage(){function e(e){if(void 0!==g)return g;g=!1;var t,a="1",r="1";try{"undefined"!=typeof window&&(t=window[e])}catch(e){return l("Warning: DOMStorage access denied: "+e.message),g}if(!t||e!==STORAGE_TYPE_LOCAL&&e!==STORAGE_TYPE_SESSION)return g;try{t.setItem(a,r),t.removeItem(a),g=!0}catch(e){l("Warning: DOMStorage is supported, but cannot be used: "+e.message)}return g}function t(){e(STORAGE_TYPE_LOCAL)&&legacyKeysAndReplacements.forEach(function(e){var t=localStorage.getItem(e.oldKey);if(t){localStorage.removeItem(e.oldKey);try{localStorage.setItem(e.newKey,t)}catch(e){l(e.message)}}})}function a(){S=(0,_modelsMediaPlayerModel2.default)(d).getInstance(),t()}function r(){var e=6e5;return Math.round((new Date).getTime()/e)*e}function o(t,a){return e(t)&&S["get"+a+"CachingInfo"]().enabled}function s(e){if(!o(STORAGE_TYPE_LOCAL,"LastMediaSettings"))return null;var t=LOCAL_STORAGE_SETTINGS_KEY_TEMPLATE.replace(/\?/,e),a=JSON.parse(localStorage.getItem(t))||{},r=(new Date).getTime()-parseInt(a.timestamp,10)>=S.getLastMediaSettingsCachingInfo().ttl||!1,s=a.settings;return r&&(localStorage.removeItem(t),s=null),s}function i(e){var t=NaN;if(o(STORAGE_TYPE_LOCAL,"LastBitrate")){var a=LOCAL_STORAGE_BITRATE_KEY_TEMPLATE.replace(/\?/,e),r=JSON.parse(localStorage.getItem(a))||{},s=(new Date).getTime()-parseInt(r.timestamp,10)>=S.getLastBitrateCachingInfo().ttl||!1,i=parseInt(r.bitrate,10);isNaN(i)||s?s&&localStorage.removeItem(a):(t=i,l("Last saved bitrate for "+e+" was "+i))}return t}function n(e,t){if(o(STORAGE_TYPE_LOCAL,"LastMediaSettings")){var a=LOCAL_STORAGE_SETTINGS_KEY_TEMPLATE.replace(/\?/,e);try{localStorage.setItem(a,JSON.stringify({settings:t,timestamp:r()}))}catch(e){l(e.message)}}}function _(e,t){if(o(STORAGE_TYPE_LOCAL,"LastBitrate")&&t){var a=LOCAL_STORAGE_BITRATE_KEY_TEMPLATE.replace(/\?/,e);try{localStorage.setItem(a,JSON.stringify({bitrate:t/1e3,timestamp:r()}))}catch(e){l(e.message)}}}var d=this.context,l=(0,_coreDebug2.default)(d).getInstance().log,c=void 0,g=void 0,S=void 0;return c={getSavedBitrateSettings:i,setSavedBitrateSettings:_,getSavedMediaSettings:s,setSavedMediaSettings:n,isSupported:e},a(),c}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_modelsMediaPlayerModel=require("../models/MediaPlayerModel"),_modelsMediaPlayerModel2=_interopRequireDefault(_modelsMediaPlayerModel),_coreDebug=require("../../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug),legacyKeysAndReplacements=[{oldKey:"dashjs_vbitrate",newKey:"dashjs_video_bitrate"},{oldKey:"dashjs_abitrate",newKey:"dashjs_audio_bitrate"},{oldKey:"dashjs_vsettings",newKey:"dashjs_video_settings"},{oldKey:"dashjs_asettings",newKey:"dashjs_audio_settings"}],LOCAL_STORAGE_BITRATE_KEY_TEMPLATE="dashjs_?_bitrate",LOCAL_STORAGE_SETTINGS_KEY_TEMPLATE="dashjs_?_settings",STORAGE_TYPE_LOCAL="localStorage",STORAGE_TYPE_SESSION="sessionStorage";DOMStorage.__dashjs_factory_name="DOMStorage";var factory=_coreFactoryMaker2.default.getSingletonFactory(DOMStorage);exports.default=factory,module.exports=exports.default;
},{"../../core/Debug":13,"../../core/FactoryMaker":15,"../models/MediaPlayerModel":107}],156:[function(require,module,exports){
"use strict";function _interopRequireDefault(r){return r&&r.__esModule?r:{default:r}}function EBMLParser(r){function e(){return v}function t(r){v=r}function o(r,e){var t=!0,o=0,a=void 0,n=void 0;if(void 0===e&&(e=!1),r.tag>16777215?(g.getUint32(v)!==r.tag&&(t=!1),o=4):r.tag>65535?(a=g.getUint16(v),n=g.getUint8(v+2),256*a+n!==r.tag&&(t=!1),o=3):r.tag>255?(g.getUint16(v)!==r.tag&&(t=!1),o=2):(g.getUint8(v)!==r.tag&&(t=!1),o=1),!t&&r.required&&!e)throw new _voError2.default("required tag not found");return t&&(v+=o),t}function a(r,e){var t=o(r,e);return t&&u(),t}function n(r){var e=void 0;return o(r),e=u(),d[r.parse](e)}function i(r,e){var t=o(r,e),a=void 0;return t&&(a=u(),v+=a),t}function u(r){var e=1,t=128,o=8,a=-1,n=0,i=g.getUint8(v),u=void 0;for(u=0;u<o;u+=1){if((i&t)===t){n=void 0===r?i&~t:i,a=u;break}t>>=1}for(u=0;u<a;u+=1,e+=1)n=n<<8|255&g.getUint8(v+e);return v+=e,n}function c(r){var e=void 0;switch(r){case 4:e=g.getFloat32(v),v+=4;break;case 8:e=g.getFloat64(v),v+=8}return e}function s(r){var e=0,t=void 0;for(t=0;t<r;t+=1)e<<=8,e|=255&g.getUint8(v+t);return v+=r,e}function f(){return v<g.byteLength}var d=void 0,g=new DataView(r.data),v=0;return d={getPos:e,setPos:t,consumeTag:o,consumeTagAndSize:a,parseTag:n,skipOverElement:i,getMatroskaCodedNum:u,getMatroskaFloat:c,getMatroskaUint:s,moreData:f}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_voError=require("../vo/Error"),_voError2=_interopRequireDefault(_voError);EBMLParser.__dashjs_factory_name="EBMLParser",exports.default=_coreFactoryMaker2.default.getClassFactory(EBMLParser),module.exports=exports.default;
},{"../../core/FactoryMaker":15,"../vo/Error":168}],157:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ErrorHandler(){function e(e){I.trigger(_coreEventsEvents2.default.ERROR,{error:"capability",event:e})}function r(e,r,R){I.trigger(_coreEventsEvents2.default.ERROR,{error:"download",event:{id:e,url:r,request:R}})}function R(e,r,R,_){I.trigger(_coreEventsEvents2.default.ERROR,{error:"manifestError",event:{message:e,id:r,manifest:R,event:_}})}function _(e,r,R){I.trigger(_coreEventsEvents2.default.ERROR,{error:"cc",event:{message:e,id:r,cc:R}})}function E(e){I.trigger(_coreEventsEvents2.default.ERROR,{error:"mediasource",event:e})}function t(e){I.trigger(_coreEventsEvents2.default.ERROR,{error:"key_session",event:e})}function o(e){I.trigger(_coreEventsEvents2.default.ERROR,{error:"key_message",event:e})}var O=void 0,n=this.context,I=(0,_coreEventBus2.default)(n).getInstance();return O={capabilityError:e,downloadError:r,manifestError:R,timedTextError:_,mediaSourceError:E,mediaKeySessionError:t,mediaKeyMessageError:o}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreEventBus=require("../../core/EventBus"),_coreEventBus2=_interopRequireDefault(_coreEventBus),_coreEventsEvents=require("../../core/events/Events"),_coreEventsEvents2=_interopRequireDefault(_coreEventsEvents),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),CAPABILITY_ERROR_MEDIASOURCE="mediasource",CAPABILITY_ERROR_MEDIAKEYS="mediakeys",DOWNLOAD_ERROR_ID_MANIFEST="manifest",DOWNLOAD_ERROR_ID_SIDX="SIDX",DOWNLOAD_ERROR_ID_CONTENT="content",DOWNLOAD_ERROR_ID_INITIALIZATION="initialization",DOWNLOAD_ERROR_ID_XLINK="xlink",MANIFEST_ERROR_ID_CODEC="codec",MANIFEST_ERROR_ID_PARSE="parse",MANIFEST_ERROR_ID_NOSTREAMS="nostreams",TIMED_TEXT_ERROR_ID_PARSE="parse";ErrorHandler.__dashjs_factory_name="ErrorHandler";var factory=_coreFactoryMaker2.default.getSingletonFactory(ErrorHandler);factory.CAPABILITY_ERROR_MEDIASOURCE=CAPABILITY_ERROR_MEDIASOURCE,factory.CAPABILITY_ERROR_MEDIAKEYS=CAPABILITY_ERROR_MEDIAKEYS,factory.DOWNLOAD_ERROR_ID_MANIFEST=DOWNLOAD_ERROR_ID_MANIFEST,factory.DOWNLOAD_ERROR_ID_SIDX=DOWNLOAD_ERROR_ID_SIDX,factory.DOWNLOAD_ERROR_ID_CONTENT=DOWNLOAD_ERROR_ID_CONTENT,factory.DOWNLOAD_ERROR_ID_INITIALIZATION=DOWNLOAD_ERROR_ID_INITIALIZATION,factory.DOWNLOAD_ERROR_ID_XLINK=DOWNLOAD_ERROR_ID_XLINK,factory.MANIFEST_ERROR_ID_CODEC=MANIFEST_ERROR_ID_CODEC,factory.MANIFEST_ERROR_ID_PARSE=MANIFEST_ERROR_ID_PARSE,factory.MANIFEST_ERROR_ID_NOSTREAMS=MANIFEST_ERROR_ID_NOSTREAMS,factory.TIMED_TEXT_ERROR_ID_PARSE=TIMED_TEXT_ERROR_ID_PARSE,exports.default=factory,module.exports=exports.default;
},{"../../core/EventBus":14,"../../core/FactoryMaker":15,"../../core/events/Events":18}],158:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function InitCache(){function e(e){var t=e.streamId,r=e.mediaInfo.type,o=e.quality;a[t]=a[t]||{},a[t][r]=a[t][r]||{},a[t][r][o]=e}function t(e,t,r){return a[e][t][r]}function r(){a={}}var a={},o={save:e,extract:t,reset:r};return o}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);InitCache.__dashjs_factory_name="InitCache",exports.default=_coreFactoryMaker2.default.getSingletonFactory(InitCache),module.exports=exports.default;
},{"../../core/FactoryMaker":15}],159:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function IsoFile(){function e(e){return e&&_&&_.boxes&&0!==_.boxes.length?n(_.fetch(e)):null}function s(e){for(var s,t=_.fetchAll(e),a=[],o=0,r=t.length;o<r;o++)s=n(t[o]),s&&a.push(s);return a}function t(e){_=e}function a(){if(!_||!_.boxes||!_.boxes.length)return null;var e=_.boxes[_.boxes.length-1].type,t=s(e);return t[t.length-1]}function o(){return _._cursor.offset}function r(){f={offset:"_offset",size:"size",type:"type"},u={references:"references",timescale:"timescale",earliest_presentation_time:"earliest_presentation_time",first_offset:"first_offset"},c={reference_type:"reference_type",referenced_size:"referenced_size",subsegment_duration:"subsegment_duration"},d={id:"id",value:"value",timescale:"timescale",scheme_id_uri:"scheme_id_uri",presentation_time_delta:"presentation_time_delta",event_duration:"event_duration",message_data:"message_data"},m={timescale:"timescale"},p={sequence_number:"sequence_number"},v={samples_with_subsamples:"samples_with_subsamples"},g={base_data_offset:"base_data_offset",sample_description_index:"sample_description_index",default_sample_duration:"default_sample_duration",default_sample_size:"default_sample_size",default_sample_flags:"default_sample_flags",flags:"flags"},b={version:"version",baseMediaDecodeTime:"baseMediaDecodeTime",flags:"flags"},x={sample_count:"sample_count",first_sample_flags:"first_sample_flags",data_offset:"data_offset",flags:"flags",samples:"samples"},h={sample_size:"sample_size",sample_duration:"sample_duration",sample_composition_time_offset:"sample_composition_time_offset"}}function i(e,s,t){for(var a in t)s[a]=e[t[a]]}function n(e){if(!e)return null;var s,t,a=new _voIsoBox2.default;switch(i(e,a,f),e.hasOwnProperty("_incomplete")&&(a.isComplete=!e._incomplete),a.type){case"sidx":if(i(e,a,u),a.references)for(s=0,t=a.references.length;s<t;s++)i(e.references[s],a.references[s],c);break;case"emsg":i(e,a,d);break;case"mdhd":i(e,a,m);break;case"mfhd":i(e,a,p);break;case"subs":i(e,a,v);break;case"tfhd":i(e,a,g);break;case"tfdt":i(e,a,b);break;case"trun":if(i(e,a,x),a.samples)for(s=0,t=a.samples.length;s<t;s++)i(e.samples[s],a.samples[s],h)}return a}var l=void 0,_=void 0,f=void 0,u=void 0,c=void 0,d=void 0,m=void 0,p=void 0,v=void 0,g=void 0,b=void 0,x=void 0,h=void 0;return l={getBox:e,getBoxes:s,setData:t,getLastBox:a,getOffset:o},r(),l}Object.defineProperty(exports,"__esModule",{value:!0});var _voIsoBox=require("../vo/IsoBox"),_voIsoBox2=_interopRequireDefault(_voIsoBox),_coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);IsoFile.__dashjs_factory_name="IsoFile",exports.default=_coreFactoryMaker2.default.getClassFactory(IsoFile),module.exports=exports.default;
},{"../../core/FactoryMaker":15,"../vo/IsoBox":171}],160:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function LiveEdgeFinder(){function e(e,r){o=e,n=r}function r(){var e=n.getCurrentRepresentationInfo(),r=e.DVRWindow.end;return e.useCalculatedLiveEdgeTime&&(r=o.getExpectedLiveEdge(),o.setClientTimeOffset(r-e.DVRWindow.end)),r}function t(){o=null,n=null}var i=void 0,o=void 0,n=void 0;return i={initialize:e,getLiveEdge:r,reset:t}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);LiveEdgeFinder.__dashjs_factory_name="LiveEdgeFinder";var factory=_coreFactoryMaker2.default.getSingletonFactory(LiveEdgeFinder);exports.default=factory,module.exports=exports.default;
},{"../../core/FactoryMaker":15}],161:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ObjectUtils(){function e(e,t){return JSON.stringify(e)===JSON.stringify(t)}var t=void 0;return t={areSimpleEquivalent:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);ObjectUtils.__dashjs_factory_name="ObjectUtils",exports.default=_coreFactoryMaker2.default.getSingletonFactory(ObjectUtils),module.exports=exports.default;
},{"../../core/FactoryMaker":15}],162:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function RequestModifier(){function e(e){return e}function r(e){return e}var t=void 0;return t={modifyRequestURL:e,modifyRequestHeader:r}}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);RequestModifier.__dashjs_factory_name="RequestModifier",exports.default=_coreFactoryMaker2.default.getSingletonFactory(RequestModifier),module.exports=exports.default;
},{"../../core/FactoryMaker":15}],163:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function TTMLParser(){function e(e){e&&e.videoModel&&(Y=e.videoModel)}function t(e){if(e.hasOwnProperty("begin")&&e.hasOwnProperty("end")){var t=c(e.begin),n=c(e.end);return[t,n]}return null}function n(){var e="cue_TTML_"+te;return te++,e}function r(e,t,n){function r(e,t){if(e.hasOwnProperty(t)){var n=e[t];a.indexOf(n)<0&&a.push(n)}}for(var i=[],a=[],o=[],l=0;l<e.length;l++){var s=e[l];r(s,"begin"),r(s,"end")}if(0===a.length)return o;if("undefined"!=typeof t&&"undefined"!=typeof n){for(var l=0;l<a.length;l++){var d=c(a[l]);t<d&&d<n&&i.push(d)}i.push(t),i.push(n)}else for(var l=0;l<a.length;l++)i.push(c(a[l]));i.sort(function(e,t){return e-t});for(var l=0;l<i.length-1;l++)o.push([i[l],i[l+1]]);return o}function i(e,t){return"undefined"!=typeof startInterval&&e<t&&(e=t),e}function a(e,t){return"undefined"!=typeof t&&e>t&&(e=t),e}function o(e,t,n){var r=c(e.begin),o=c(e.end);return r=i(r,t),o=a(o,n),"undefined"!=typeof t&&"undefined"!=typeof n&&(o<t||r>n)?(L("TTML: Cue "+r+"-"+o+" outside interval "+t+"-"+n),null):[r,o]}function l(e,n){var r=!0;if(e.hasOwnProperty("span")){var i=t(e.span);null!==i&&(r=i[0]<n[1]&&i[1]>n[0])}return r}function s(e,i,a,s){var d=void 0,c=void 0,u=void 0,g=void 0,h=void 0,y=void 0,b="";if(A=ee.xml_str2json(e),!A)throw new Error("TTML document could not be parsed");if(Y.getTTMLRenderingDiv()&&(h="html"),d=A.tt,!d)throw new Error("TTML document lacks tt element");var w=f(d,"http://www.w3.org/ns/ttml");if(w&&p(d,w),g=d["tts:extent"],c=d.head,!c)throw new Error("TTML document lacks head element");c.layout&&(H=c.layout.region_asArray),c.styling&&(R=c.styling.style_asArray);var O={};if(s)for(y=0;y<s.length;y++){var _="urn:mpeg:14496-30:subs:"+(y+1).toString(),P="data:image/png;base64,"+btoa(s[y]);O[_]=P}if(c.metadata){var z=c.metadata.image_asArray;if(z)for(y=0;y<z.length;y++){var _="#"+z[y]["xml:id"],D=z[y].imagetype.toLowerCase(),P="data:image/"+D+";base64,"+z[y].__text;O[_]=P}}if(u=d.body,!u)throw new Error("TTML document lacks body element");var C=M(),I=Y.getElement().clientWidth,W=Y.getElement().clientHeight,$=[I/C[0],W/C[1]];X["font-size"]=$[1]+"px;";var U=[];if(H)for(y=0;y<H.length;y++)U.push(k(JSON.parse(JSON.stringify(H[y])),$));var Z=f(A.tt,"http://www.w3.org/ns/ttml#parameter");d.hasOwnProperty(Z+":frameRate")&&(d.frameRate=parseInt(d[Z+":frameRate"],10));for(var G=[],K=d.body_asArray[0].__children,Q=0;Q<K.length;Q++){var V=K[Q].div,te=null;if(null===(te=t(V))){var ne=V.p_asArray;if(null===te&&(!ne||0===ne.length))return b="TTML has div that contains no timing and no paragraphs.",L(b),G;for(var re=0;re<ne.length;re++){var ie=ne[re],ae=ie.span_asArray,oe=[];if(ie.hasOwnProperty("begin")&&ie.hasOwnProperty("end")){var le=o(ie,i,a);null!==le&&oe.push(le)}else oe=r(ae,i,a);if(0!==oe.length)for(var se=ie.__children,de=0;de<oe.length;de++){for(var ce=oe[de],fe=[],pe=0;pe<se.length;pe++){var ue=se[pe];l(ue,ce)&&fe.push(ue)}if(0!==fe.length)if("html"===h){B={},J={},q={};var ge=F(ie,V,$),he=j(ie,$),ve=he[1];he=he[0];var me=document.createElement("div");me.className=ve;var xe=S(fe,$);xe.className="cueDirUniWrapper",v("unicode-bidi",he)&&(xe.style.cssText+=m("unicode-bidi",he),x("unicode-bidi",he)),v("direction",he)&&(xe.style.cssText+=m("direction",he),x("direction",he)),v("padding-left",he)&&v("padding-right",he)&&(xe.innerHTML=E(xe,he)),v("padding-left",he)&&v("padding-right",he)&&(x("padding-left",he),x("padding-right",he));var ye="";if(v("regionID",ge)){var be=m("regionID",ge);ye=be.slice(be.indexOf(":")+1,be.length-1)}he&&(me.style.cssText=he.join(" ")+"display:flex;"),ge&&(ge=ge.join(" ")),me.appendChild(xe);var we=document.createElement("div");we.appendChild(me),we.id=n(),we.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+ge,0===Object.keys(q).length&&(q.defaultFontSize="100"),G.push({start:ce[0],end:ce[1],type:"html",cueHTMLElement:we,regions:U,regionID:ye,cueID:we.id,videoHeight:W,videoWidth:I,cellResolution:C,fontSize:q||{defaultFontSize:"100"},lineHeight:B,linePadding:J})}else{var Oe="",_e=fe;_e.length&&_e.forEach(function(e){if(e.hasOwnProperty("span")){var t=e.span.__children;t.forEach(function(e){t.hasOwnProperty("metadata")||(e.hasOwnProperty("#text")?Oe+=e["#text"].replace(/[\r\n]+/gm," ").trim():"br"in e&&(Oe+="\n"))})}else Oe+=e.hasOwnProperty("br")?"\n":e["#text"].replace(/[\r\n]+/gm," ").trim()}),G.push({start:ce[0],end:ce[1],data:Oe,type:"text"})}}else b="TTML: Empty paragraph"}}else{var Te=void 0;if(V.region){var ke=N(H,V.region);Te=T(ke,g)}Te||(Te=T(V,g));var Ne=V["smpte:backgroundImage"];void 0!==Ne&&void 0!==O[Ne]&&G.push({start:te[0],end:te[1],id:n(),data:O[Ne],type:"image",layout:Te})}}if(""!==b&&L(b),G.length>0)return G;throw new Error(b)}function d(){I=/^([0-9][0-9]+):([0-5][0-9]):([0-5][0-9])|(60)(\.([0-9])+)?$/,q={},B={},J={},W={top:"auto;",left:"auto;",width:"90%;",height:"10%;","align-items":"flex-start;",overflow:"visible;","-ms-writing-mode":"lr-tb, horizontal-tb;","-webkit-writing-mode":"horizontal-tb;","-moz-writing-mode":"horizontal-tb;","writing-mode":"horizontal-tb;"},X={color:"rgb(255,255,255);",direction:"ltr;","font-family":"monospace, sans-serif;","font-style":"normal;","line-height":"normal;","font-weight":"normal;","text-align":"start;","justify-content":"flex-start;","text-decoration":"none;","unicode-bidi":"normal;","white-space":"normal;",width:"100%;"},$={monospace:"font-family: monospace;",sansSerif:"font-family: sans-serif;",serif:"font-family: serif;",monospaceSansSerif:"font-family: monospace, sans-serif;",monospaceSerif:"font-family: monospace, serif;",proportionalSansSerif:"font-family: Arial;",proportionalSerif:"font-family: Times New Roman;",default:"font-family: monospace, sans-serif;"},U={right:["justify-content: flex-end;","text-align: right;"],start:["justify-content: flex-start;","text-align: start;"],center:["justify-content: center;","text-align: center;"],end:["justify-content: flex-end;","text-align: end;"],left:["justify-content: flex-start;","text-align: left;"]},Z={start:"text-align: start;",center:"text-align: center;",end:"text-align: end;",auto:""},G={wrap:"white-space: normal;",noWrap:"white-space: nowrap;"},K={normal:"unicode-bidi: normal;",embed:"unicode-bidi: embed;",bidiOverride:"unicode-bidi: bidi-override;"},Q={before:"align-items: flex-start;",center:"align-items: center;",after:"align-items: flex-end;"},V={lrtb:"-webkit-writing-mode: horizontal-tb;writing-mode: horizontal-tb;",rltb:"-webkit-writing-mode: horizontal-tb;writing-mode: horizontal-tb;direction: rtl;unicode-bidi: bidi-override;",tbrl:"-webkit-writing-mode: vertical-rl;writing-mode: vertical-rl;-webkit-text-orientation: upright;text-orientation: upright;",tblr:"-webkit-writing-mode: vertical-lr;writing-mode: vertical-lr;-webkit-text-orientation: upright;text-orientation: upright;",lr:"-webkit-writing-mode: horizontal-tb;writing-mode: horizontal-tb;",rl:"-webkit-writing-mode: horizontal-tb;writing-mode: horizontal-tb;direction: rtl;",tb:"-webkit-writing-mode: vertical-rl;writing-mode: vertical-rl;-webkit-text-orientation: upright;text-orientation: upright;"},ee=new _externalsXml2json2.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,matchers:[]})}function c(e){var t,n,r,i=I.test(e);if(!i)return NaN;if(t=e.split(":"),n=parseFloat(t[0])*SECONDS_IN_HOUR+parseFloat(t[1])*SECONDS_IN_MIN+parseFloat(t[2]),t[3]){if(r=A.tt.frameRate,!r||isNaN(r))return NaN;n+=parseFloat(t[3])/r}return n}function f(e,t){var n=Object.keys(e).filter(function(n){return("xmlns"===n.split(":")[0]||"xmlns"===n.split(":")[1])&&e[n]===t}).map(function(e){return e.split(":")[2]||e.split(":")[1]});return 1!=n.length?null:n[0]}function p(e,t){for(var n in e)if(e.hasOwnProperty(n)){if(("object"==typeof e[n]||e[n]instanceof Object)&&!Array.isArray(e[n]))p(e[n],t);else if(Array.isArray(e[n]))for(var r=0;r<e[n].length;r++)p(e[n][r],t);var i=t+":",a=n.indexOf(i);if(a>=0){var o=n.slice(a+i.length);e[o]=e[n],delete e[n]}}}function u(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function g(e){var t=e.slice(1),n=t.match(/.{2}/g),r=parseFloat(parseInt(parseInt(n[3],16)/255*1e3,10)/1e3),i=n.slice(0,3).map(function(e){return parseInt(e,16)});return"rgba("+i.join(",")+","+r+");"}function h(e){var t=void 0,n=void 0,r=void 0;return t=e.replace(/^(rgb|rgba)\(/,"").replace(/\)$/,"").replace(/\s/g,"").split(","),n=parseInt(t[t.length-1],10)/255,r="rgba("+t[0]+","+t[1]+","+t[2]+","+n+");"}function v(e,t){for(var n=0;n<t.length;n++)if(t[n].indexOf(e)>-1)return!0;return!1}function m(e,t){for(var n=0;n<t.length;n++)if(t[n].indexOf(e)>-1)return t[n];return null}function x(e,t){t.splice(t.indexOf(m(e,t)),1)}function y(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<t.length;r++)e[n]&&e[n].split(":")[0].indexOf(t[r].split(":")[0])>-1&&e.splice(n,1);return e.concat(t)}function b(e){var t=new Array(2),n=e.indexOf(":")===-1?0:e.indexOf(":"),r=void 0;return e.indexOf("%")===-1?e.indexOf("c")===-1?e.indexOf("p")===-1?t[0]=t[1]=null:(t[0]="p",r=e.indexOf("p")):(t[0]="c",r=e.indexOf("c")):(t[0]="%",r=e.indexOf("%")),t[1]=e.slice(n,r),t}function w(e,t,n){var r,i,a=[];for(var o in e)if(e.hasOwnProperty(o)){var l=o.replace("ebutts:","");l=l.replace("xml:",""),l=l.replace("tts:",""),l=u(l),e[l]=e[o],delete e[o]}if("line-padding"in e){var s=parseFloat(e["line-padding"].slice(e["line-padding"].indexOf(":")+1,e["line-padding"].indexOf("c")));"id"in e&&(J[e.id]=s);var d=s*t[0]+"px;";a.push("padding-left:"+d),a.push("padding-right:"+d)}if("font-size"in e){var c=b(e["font-size"]),f=parseFloat(c[1]);"id"in e&&(q[e.id]=c),"%"===c[0]?r=f/100*t[1]+"px;":"c"===c[0]&&(r=f*t[1]+"px;"),a.push("font-size:"+r)}if("line-height"in e)if("normal"===e["line-height"])a.push("line-height: normal;");else{var p=b(e["line-height"]),m=parseFloat(p[1]);"id"in e&&(B[e.id]=p),"%"===p[0]?i=m/100*t[1]+"px;":"c"===p[0]&&(i=m*t[1]+"px;"),a.push("line-height:"+i)}"font-family"in e&&(e["font-family"]in $?a.push($[e["font-family"]]):a.push("font-family:"+e["font-family"]+";")),"text-align"in e&&e["text-align"]in U&&(a.push(U[e["text-align"]][0]),a.push(U[e["text-align"]][1])),"multi-row-align"in e&&(v("text-align",a)&&"auto"!=e["multi-row-align"]&&x("text-align",a),e["multi-row-align"]in Z&&a.push(Z[e["multi-row-align"]]));var y;return"background-color"in e&&(y=e["background-color"].indexOf("#")>-1&&e["background-color"].length-1===8?g(e["background-color"]):e["background-color"].indexOf("rgba")>-1?h(e["background-color"]):e["background-color"]+";",a.push("background-color: "+y)),"color"in e&&(y=e.color.indexOf("#")>-1&&e.color.length-1===8?g(e.color):e.color.indexOf("rgba")>-1?h(e.color):e.color+";",a.push("color: "+y)),"wrap-option"in e&&(e["wrap-option"]in G?a.push(G[e["wrap-option"]]):a.push("white-space:"+e["wrap-option"])),"unicode-bidi"in e&&(e["unicode-bidi"]in K?a.push(K[e["unicode-bidi"]]):a.push("unicode-bidi:"+e["unicode-bidi"])),"font-style"in e&&a.push("font-style:"+e["font-style"]+";"),"font-weight"in e&&a.push("font-weight:"+e["font-weight"]+";"),"direction"in e&&a.push("direction:"+e.direction+";"),"text-decoration"in e&&a.push("text-decoration:"+e["text-decoration"]+";"),n&&(a=a.concat(k(e,t))),A.tt.hasOwnProperty("xml:space")&&"preserve"===A.tt["xml:space"]&&a.push("white-space: pre;"),a}function O(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r["xml:id"]===t||r.id===t)return r}return null}function _(e,t,n){var r=[],i=e.match(/\S+/g);return i.forEach(function(e){var i=O(R,e);if(i){var a=w(JSON.parse(JSON.stringify(i)),t,n);r=r.concat(a)}}),r}function T(e,t){var n=/([\d\.]+)(%|px)\s+([\d\.]+)(%|px)/;if("tts:extent"in e&&"tts:origin"in e){var r=n.exec(e["tts:extent"]),i=n.exec(e["tts:origin"]);if(null===r||null===i)return L("Bad extent or origin: "+e["tts:extent"]+" "+e["tts:origin"]),null;var a=parseFloat(r[1]),o=parseFloat(r[3]),l=parseFloat(i[1]),s=parseFloat(i[3]);if(t){var d=n.exec(t);if(null===d||"px"!==d[2]||"px"!==d[4])return L("Bad tt.extent: "+t),null;var c=parseFloat(d[1]),f=parseFloat(d[3]);"px"===r[2]&&(a=a/c*100),"px"===r[4]&&(o=o/f*100),"px"===i[2]&&(l=l/c*100),"px"===i[4]&&(s=s/f*100)}return{left:l,top:s,width:a,height:o}}return null}function k(e,t){var n=[];for(var r in e){var i=r.replace("tts:","");i=i.replace("xml:",""),i=u(i),e[i]=e[r],i!==r&&delete e[r]}if("extent"in e){var a=e.extent.split(/\s/);n.push("width: "+a[0]+";"),n.push("height: "+a[1]+";")}if("origin"in e){var o=e.origin.split(/\s/);n.push("left: "+o[0]+";"),n.push("top: "+o[1]+";")}if("display-align"in e&&n.push(Q[e["display-align"]]),"writing-mode"in e&&n.push(V[e["writing-mode"]]),"style"in e){var l=_(e.style,t,!0);n=n.concat(l)}return"padding"in e&&n.push("padding:"+e.padding+";"),"overflow"in e&&n.push("overflow:"+e.overflow+";"),"show-background"in e&&n.push("show-background:"+e["show-background"]+";"),"id"in e&&n.push("regionID:"+e.id+";"),n}function N(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r["xml:id"]===t||r.id===t)return r}return null}function P(e,t){var n=[],r=e.match(/\S+/g);return r.forEach(function(e){var r=N(H,e);if(r){var i=k(JSON.parse(JSON.stringify(r)),t);n=n.concat(i)}}),n}function M(){var e=[32,15];return A.tt.hasOwnProperty("ttp:cellResolution")?A.tt["ttp:cellResolution"].split(" ").map(parseFloat):e}function E(e,t){for(var n=m("padding-left",t),r=m("padding-right",t),i=n.concat(" "+r+" "),a="",o="",l="",s=Array.prototype.slice.call(e.children),d=e.getElementsByClassName("lineBreak")[0],c=s.indexOf(d),f=[];c!=-1;)f.push(c),c=s.indexOf(d,c+1);var p="</span>",u="<br>",g='<span class="spanPadding" style="-webkit-box-decoration-break: clone; box-decoration-break: clone; ';if(f.length)f.forEach(function(e,t){if(0===t){for(var n="",r=0;r<e;r++)a+=s[r].outerHTML,0===r&&(n=i.concat(s[r].style.cssText));a=g+n+'">'+a}for(var d="",c=e+1;c<s.length;c++)o+=s[c].outerHTML,c===s.length-1&&(d+=i.concat(s[c].style.cssText));o=g+d+'">'+o,a&&o&&t===f.length-1?l+=a+p+u+o+p:a&&o&&t!==f.length-1?l+=a+p+u+o+p+u:a&&!o?l+=a+p:!a&&o&&t===f.length-1?l+=o+p:!a&&o&&t!==f.length-1&&(l+=o+p+u)});else{for(var h="",v=0;v<s.length;v++)h+=s[v].style.cssText;l=g+i+h+'">'+e.innerHTML+p}return l}function S(e,t){var n=document.createElement("div");return e.forEach(function(e){if(!e.hasOwnProperty("metadata"))if(e.hasOwnProperty("span")){var r=e.span.__children,i=document.createElement("span");if(e.span.hasOwnProperty("style")){var a=_(e.span.style,t);i.className="spanPadding "+e.span.style,i.style.cssText=a.join(" ")}r.forEach(function(e){if(!r.hasOwnProperty("metadata"))if(e.hasOwnProperty("#text")){var t=document.createTextNode(e["#text"]);i.appendChild(t)}else if("br"in e){i.hasChildNodes()&&n.appendChild(i);var a=document.createElement("br");a.className="lineBreak",n.appendChild(a);var o=document.createElement("span");o.className=i.className,o.style.cssText=i.style.cssText,i=o}}),n.appendChild(i)}else if(e.hasOwnProperty("br")){var o=document.createElement("br");o.className="lineBreak",n.appendChild(o)}else if(e.hasOwnProperty("#text")){var l=document.createElement("span");l.textContent=e["#text"],n.appendChild(l)}}),n}function F(e,t,n){var r,i,a=[],o=e.region,l=t.region;return l&&(r=P(l,n)),o?(i=a.concat(P(o,n)),a=r?y(r,i):i):r&&(a=r),z(a,W),a}function j(e,t){var n,r,i,a=[],o=e.style,l=A.tt.body.style,s=A.tt.body.div.style,d="";return l&&(n=_(l,t),d="paragraph "+l),s&&(r=_(s,t),n?(r=y(n,r),d+=" "+s):d="paragraph "+s),o?(i=_(o,t),n&&r?(a=y(r,i),d+=" "+o):n?(a=y(n,i),d+=" "+o):r?(a=y(r,i),d+=" "+o):(a=i,d="paragraph "+o)):n&&!r?a=n:!n&&r&&(a=r),z(a,X),[a,d]}function z(e,t){for(var n in t)t.hasOwnProperty(n)&&(v(n,e)||e.push(n+":"+t[n]))}var D=this.context,L=(0,_coreDebug2.default)(D).getInstance().log,C=void 0,I=void 0,A=void 0,R=void 0,H=void 0,q=void 0,B=void 0,J=void 0,W=void 0,X=void 0,$=void 0,U=void 0,Z=void 0,G=void 0,K=void 0,Q=void 0,V=void 0,Y=void 0,ee=void 0,te=0;return C={parse:s,setConfig:e},d(),C}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_externalsXml2json=require("../../../externals/xml2json"),_externalsXml2json2=_interopRequireDefault(_externalsXml2json),_coreDebug=require("../../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug),SECONDS_IN_HOUR=3600,SECONDS_IN_MIN=60;TTMLParser.__dashjs_factory_name="TTMLParser",exports.default=_coreFactoryMaker2.default.getSingletonFactory(TTMLParser),module.exports=exports.default;
},{"../../../externals/xml2json":11,"../../core/Debug":13,"../../core/FactoryMaker":15}],164:[function(require,module,exports){
"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function URLUtils(){function t(){try{new window.URL("x","http://y");u=l}catch(t){}finally{u=u||d}}function r(t){var r=t.indexOf("/"),e=t.lastIndexOf("/");return r!==-1?e===r+1?t:(t.indexOf("?")!==-1&&(t=t.substring(0,t.indexOf("?"))),t.substring(0,e+1)):""}function e(t){var r=t.match(f);return r?r[1]:""}function n(t){return!c.test(t)}function a(t){return n(t)&&"/"===t.charAt(0)}function i(t){return s.test(t)}function o(t,r){return u(t,r)}var u=void 0,c=/^[a-z][a-z0-9+\-.]*:/i,s=/^https?:\/\//i,f=/^([a-z][a-z0-9+\-.]*:\/\/[^\/]+)\/?/i,l=function(t,r){try{return new window.URL(t,r).toString()}catch(r){return t}},d=function(t,i){var o=r;if(!i)return t;if(!n(t))return t;a(t)&&(o=e);var u=o(i),c="/"!==u.charAt(u.length-1)&&"/"!==t.charAt(0)?"/":"";return[u,t].join(c)};t();var _={parseBaseUrl:r,parseOrigin:e,isRelative:n,isPathAbsolute:a,isHTTPURL:i,resolve:o};return _}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker);URLUtils.__dashjs_factory_name="URLUtils",exports.default=_coreFactoryMaker2.default.getSingletonFactory(URLUtils),module.exports=exports.default;
},{"../../core/FactoryMaker":15}],165:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function VTTParser(){function e(){u=/(?:\r\n|\r|\n)/gm,l=/-->/,f=/(^[\s]+|[\s]+$)/g,p=/\s\b/g}function t(e){var t,o,n=[];e=e.split(u),t=e.length,o=-1;for(var s=0;s<t;s++){var p=e[s];if(p.length>0&&"WEBVTT"!==p&&p.match(l)){var h=a(p),d=h.cuePoints,g=h.styles,_=i(e,s+1),m=r(d[0].replace(f,"")),v=r(d[1].replace(f,""));!isNaN(m)&&!isNaN(v)&&m>=o&&v>m?""!==_?(o=m,n.push({start:m,end:v,data:_,styles:g})):c("Skipping cue due to empty/malformed cue text"):c("Skipping cue due to incorrect cue timing")}}return n}function r(e){var t=e.split(":"),r=t.length-1;return e=60*parseInt(t[r-1],10)+parseFloat(t[r]),2===r&&(e+=3600*parseInt(t[0],10)),e}function a(e){var t=e.split(l),r=t[1].split(p);return r.shift(),t[1]=r[0],r.shift(),{cuePoints:t,styles:o(r)}}function o(e){var t={};return e.forEach(function(e){if(e.split(/:/).length>1){var r=e.split(/:/)[1];r&&r.search(/%/)!=-1&&(r=parseInt(r.replace(/%/,""),10)),(e.match(/align/)||e.match(/A/))&&(t.align=r),(e.match(/line/)||e.match(/L/))&&(t.line=r),(e.match(/position/)||e.match(/P/))&&(t.position=r),(e.match(/size/)||e.match(/S/))&&(t.size=r)}}),t}function i(e,t){for(var r,a=t,o="",i="";""!==e[a]&&a<e.length;)a++;if(r=a-t,r>1)for(var n=0;n<r;n++){if(i=e[t+n],i.match(l)){o="";break}o+=i,n!==r-1&&(o+="\n")}else i=e[t],i.match(l)||(o=i);return decodeURI(o)}var n=this.context,c=(0,_coreDebug2.default)(n).getInstance().log,s=void 0,u=void 0,l=void 0,f=void 0,p=void 0;return s={parse:t},e(),s}Object.defineProperty(exports,"__esModule",{value:!0});var _coreFactoryMaker=require("../../core/FactoryMaker"),_coreFactoryMaker2=_interopRequireDefault(_coreFactoryMaker),_coreDebug=require("../../core/Debug"),_coreDebug2=_interopRequireDefault(_coreDebug);VTTParser.__dashjs_factory_name="VTTParser",exports.default=_coreFactoryMaker2.default.getSingletonFactory(VTTParser),module.exports=exports.default;
},{"../../core/Debug":13,"../../core/FactoryMaker":15}],166:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var BitrateInfo=function t(){_classCallCheck(this,t),this.mediaType=null,this.bitrate=null,this.width=null,this.height=null,this.qualityIndex=NaN};exports.default=BitrateInfo,module.exports=exports.default;
},{}],167:[function(require,module,exports){
"use strict";function _classCallCheck(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var DataChunk=function t(){_classCallCheck(this,t),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN};exports.default=DataChunk,module.exports=exports.default;
},{}],168:[function(require,module,exports){
"use strict";function _classCallCheck(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var Error=function e(s,t,l){_classCallCheck(this,e),this.code=s||null,this.message=t||null,this.data=l||null};exports.default=Error,module.exports=exports.default;
},{}],169:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var FragmentRequest=function t(){_classCallCheck(this,t),this.action=t.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer"};FragmentRequest.ACTION_DOWNLOAD="download",FragmentRequest.ACTION_COMPLETE="complete",exports.default=FragmentRequest,module.exports=exports.default;
},{}],170:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _get=function(e,t,r){for(var o=!0;o;){var n=e,u=t,i=r;o=!1,null===n&&(n=Function.prototype);var a=Object.getOwnPropertyDescriptor(n,u);if(void 0!==a){if("value"in a)return a.value;var l=a.get;if(void 0===l)return;return l.call(i)}var s=Object.getPrototypeOf(n);if(null===s)return;e=s,t=u,r=i,o=!0,a=s=void 0}},_FragmentRequest2=require("./FragmentRequest"),_FragmentRequest3=_interopRequireDefault(_FragmentRequest2),HeadRequest=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.url=e||null,this.checkForExistenceOnly=!0}return _inherits(t,e),t}(_FragmentRequest3.default);exports.default=HeadRequest,module.exports=exports.default;
},{"./FragmentRequest":169}],171:[function(require,module,exports){
"use strict";function _classCallCheck(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var IsoBox=function e(){_classCallCheck(this,e),this.offset=NaN,this.type=null,this.size=NaN,this.isComplete=!0};exports.default=IsoBox,module.exports=exports.default;
},{}],172:[function(require,module,exports){
"use strict";function _classCallCheck(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var ManifestInfo=function a(){_classCallCheck(this,a),this.DVRWindowSize=NaN,this.loadedTime=null,this.availableFrom=null,this.minBufferTime=NaN,this.duration=NaN,this.isDynamic=!1,this.maxFragmentDuration=null};exports.default=ManifestInfo,module.exports=exports.default;
},{}],173:[function(require,module,exports){
"use strict";function _classCallCheck(t,l){if(!(t instanceof l))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var MediaInfo=function t(){_classCallCheck(this,t),this.id=null,this.index=null,this.type=null,this.streamInfo=null,this.representationCount=0,this.lang=null,this.viewpoint=null,this.accessibility=null,this.audioChannelConfiguration=null,this.roles=null,this.codec=null,this.mimeType=null,this.contentProtection=null,this.isText=!1,this.KID=null,this.bitrateList=null};exports.default=MediaInfo,module.exports=exports.default;
},{}],174:[function(require,module,exports){
"use strict";function _classCallCheck(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var MetricsList=function t(){_classCallCheck(this,t),this.TcpList=[],this.HttpList=[],this.RepSwitchList=[],this.BufferLevel=[],this.BufferState=[],this.PlayList=[],this.DroppedFrames=[],this.SchedulingInfo=[],this.DVRInfo=[],this.ManifestUpdate=[],this.RequestsQueue=null,this.DVBErrors=[],this.BolaState=[]};exports.default=MetricsList,module.exports=exports.default;
},{}],175:[function(require,module,exports){
"use strict";function _classCallCheck(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var StreamInfo=function t(){_classCallCheck(this,t),this.id=null,this.index=null,this.start=NaN,this.duration=NaN,this.manifestInfo=null,this.isLast=!0,this.isFirst=!0};exports.default=StreamInfo,module.exports=exports.default;
},{}],176:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _get=function(e,t,r){for(var o=!0;o;){var n=e,u=t,i=r;o=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,u);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(i)}var a=Object.getPrototypeOf(n);if(null===a)return;e=a,t=u,r=i,o=!0,s=a=void 0}},_FragmentRequest2=require("./FragmentRequest"),_FragmentRequest3=_interopRequireDefault(_FragmentRequest2),TextRequest=function(e){function t(e,r){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.url=e||null,this.type=r||null,this.mediaType="stream",this.responseType="text"}return _inherits(t,e),t}(_FragmentRequest3.default);exports.default=TextRequest,module.exports=exports.default;
},{"./FragmentRequest":169}],177:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var TextTrackInfo=function t(){_classCallCheck(this,t),this.video=null,this.captionData=null,this.label=null,this.lang=null,this.defaultTrack=!1,this.kind=null,this.isFragmented=!1,this.isEmbedded=!1};exports.default=TextTrackInfo,module.exports=exports.default;
},{}],178:[function(require,module,exports){
"use strict";function _classCallCheck(l,t){if(!(l instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var TrackInfo=function l(){_classCallCheck(this,l),this.id=null,this.quality=null,this.DVRWindow=null,this.fragmentDuration=null,this.mediaInfo=null,this.MSETimeOffset=null};exports.default=TrackInfo,module.exports=exports.default;
},{}],179:[function(require,module,exports){
"use strict";function _classCallCheck(t,l){if(!(t instanceof l))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var URIFragmentData=function t(){_classCallCheck(this,t),this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null};exports.default=URIFragmentData,module.exports=exports.default;
},{}],180:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var BolaState=function e(){_classCallCheck(this,e),this._s=void 0};exports.default=BolaState,module.exports=exports.default;
},{}],181:[function(require,module,exports){
"use strict";function _classCallCheck(e,l){if(!(e instanceof l))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var BufferLevel=function e(){_classCallCheck(this,e),this.t=null,this.level=null};exports.default=BufferLevel,module.exports=exports.default;
},{}],182:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _controllersBufferController=require("../../controllers/BufferController"),_controllersBufferController2=_interopRequireDefault(_controllersBufferController),BufferState=function e(){_classCallCheck(this,e),this.target=null,this.state=_controllersBufferController2.default.BUFFER_EMPTY};exports.default=BufferState,module.exports=exports.default;
},{"../../controllers/BufferController":69}],183:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var DVRInfo=function e(){_classCallCheck(this,e),this.time=null,this.range=null,this.manifestInfo=null};exports.default=DVRInfo,module.exports=exports.default;
},{}],184:[function(require,module,exports){
"use strict";function _classCallCheck(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var DroppedFrames=function e(){_classCallCheck(this,e),this.time=null,this.droppedFrames=null};exports.default=DroppedFrames,module.exports=exports.default;
},{}],185:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var HTTPRequest=function e(){_classCallCheck(this,e),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this._stream=null,this._tfinish=null,this._mediaduration=null,this._responseHeaders=null,this._serviceLocation=null},HTTPRequestTrace=function e(){_classCallCheck(this,e),this.s=null,this.d=null,this.b=[]};HTTPRequest.MPD_TYPE="MPD",HTTPRequest.XLINK_EXPANSION_TYPE="XLinkExpansion",HTTPRequest.INIT_SEGMENT_TYPE="InitializationSegment",HTTPRequest.INDEX_SEGMENT_TYPE="IndexSegment",HTTPRequest.MEDIA_SEGMENT_TYPE="MediaSegment",HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE="BitstreamSwitchingSegment",HTTPRequest.OTHER_TYPE="other",exports.HTTPRequest=HTTPRequest,exports.HTTPRequestTrace=HTTPRequestTrace;
},{}],186:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var ManifestUpdate=function t(){_classCallCheck(this,t),this.mediaType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.streamInfo=[],this.trackInfo=[]},ManifestUpdateStreamInfo=function t(){_classCallCheck(this,t),this.id=null,this.index=null,this.start=null,this.duration=null},ManifestUpdateTrackInfo=function t(){_classCallCheck(this,t),this.id=null,this.index=null,this.mediaType=null,this.streamIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.fragmentInfoType=null};exports.ManifestUpdate=ManifestUpdate,exports.ManifestUpdateStreamInfo=ManifestUpdateStreamInfo,exports.ManifestUpdateTrackInfo=ManifestUpdateTrackInfo;
},{}],187:[function(require,module,exports){
"use strict";function _classCallCheck(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var PlayList=function t(){_classCallCheck(this,t),this.start=null,this.mstart=null,this.starttype=null,this.trace=[]};PlayList.INITIAL_PLAYOUT_START_REASON="initial_playout",PlayList.SEEK_START_REASON="seek",PlayList.RESUME_FROM_PAUSE_START_REASON="resume",PlayList.METRICS_COLLECTION_START_REASON="metrics_collection_start";var PlayListTrace=function t(){_classCallCheck(this,t),this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null};PlayListTrace.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",PlayListTrace.REBUFFERING_REASON="rebuffering",PlayListTrace.USER_REQUEST_STOP_REASON="user_request",PlayListTrace.END_OF_PERIOD_STOP_REASON="end_of_period",PlayListTrace.END_OF_CONTENT_STOP_REASON="end_of_content",PlayListTrace.METRICS_COLLECTION_STOP_REASON="metrics_collection_end",PlayListTrace.FAILURE_STOP_REASON="failure",exports.PlayList=PlayList,exports.PlayListTrace=PlayListTrace;
},{}],188:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var RepresentationSwitch=function t(){_classCallCheck(this,t),this.t=null,this.mt=null,this.to=null,this.lto=null};exports.default=RepresentationSwitch,module.exports=exports.default;
},{}],189:[function(require,module,exports){
"use strict";function _classCallCheck(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var RequestsQueue=function e(){_classCallCheck(this,e),this.loadingRequests=[],this.executedRequests=[]};exports.default=RequestsQueue,module.exports=exports.default;
},{}],190:[function(require,module,exports){
"use strict";function _classCallCheck(l,t){if(!(l instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var SchedulingInfo=function l(){_classCallCheck(this,l),this.mediaType=null,this.t=null,this.type=null,this.startTime=null,this.availabilityStartTime=null,this.duration=null,this.quality=null,this.range=null,this.state=null};exports.default=SchedulingInfo,module.exports=exports.default;
},{}],191:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var TCPConnection=function t(){_classCallCheck(this,t),this.tcpid=null,this.dest=null,this.topen=null,this.tclose=null,this.tconnect=null};exports.default=TCPConnection,module.exports=exports.default;
},{}],192:[function(require,module,exports){
function forEach(r,t,o){if(!isFunction(t))throw new TypeError("iterator must be a function");arguments.length<3&&(o=this),"[object Array]"===toString.call(r)?forEachArray(r,t,o):"string"==typeof r?forEachString(r,t,o):forEachObject(r,t,o)}function forEachArray(r,t,o){for(var n=0,a=r.length;n<a;n++)hasOwnProperty.call(r,n)&&t.call(o,r[n],n,r)}function forEachString(r,t,o){for(var n=0,a=r.length;n<a;n++)t.call(o,r.charAt(n),n,r)}function forEachObject(r,t,o){for(var n in r)hasOwnProperty.call(r,n)&&t.call(o,r[n],n,r)}var isFunction=require("is-function");module.exports=forEach;var toString=Object.prototype.toString,hasOwnProperty=Object.prototype.hasOwnProperty;
},{"is-function":195}],193:[function(require,module,exports){
(function (global){
var topLevel="undefined"!=typeof global?global:"undefined"!=typeof window?window:{},minDoc=require("min-document");if("undefined"!=typeof document)module.exports=document;else{var doccy=topLevel["__GLOBAL_DOCUMENT_CACHE@4"];doccy||(doccy=topLevel["__GLOBAL_DOCUMENT_CACHE@4"]=minDoc),module.exports=doccy}
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"min-document":6}],194:[function(require,module,exports){
(function (global){
"undefined"!=typeof window?module.exports=window:"undefined"!=typeof global?module.exports=global:"undefined"!=typeof self?module.exports=self:module.exports={};
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],195:[function(require,module,exports){
function isFunction(o){var t=toString.call(o);return"[object Function]"===t||"function"==typeof o&&"[object RegExp]"!==t||"undefined"!=typeof window&&(o===window.setTimeout||o===window.alert||o===window.confirm||o===window.prompt)}module.exports=isFunction;var toString=Object.prototype.toString;
},{}],196:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _lineStream=require("./line-stream"),_lineStream2=_interopRequireDefault(_lineStream),_parseStream=require("./parse-stream"),_parseStream2=_interopRequireDefault(_parseStream),_parser=require("./parser"),_parser2=_interopRequireDefault(_parser);module.exports={LineStream:_lineStream2.default,ParseStream:_parseStream2.default,Parser:_parser2.default};
},{"./line-stream":197,"./parse-stream":198,"./parser":199}],197:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_stream=require("./stream"),_stream2=_interopRequireDefault(_stream),LineStream=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.buffer="",e}return _inherits(t,e),_createClass(t,[{key:"push",value:function(e){var t=void 0;for(this.buffer+=e,t=this.buffer.indexOf("\n");t>-1;t=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)}}]),t}(_stream2.default);exports.default=LineStream;
},{"./stream":200}],198:[function(require,module,exports){
"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(exports,"__esModule",{value:!0});var _slicedToArray=function(){function t(t,e){var r=[],a=!0,i=!1,n=void 0;try{for(var s,u=t[Symbol.iterator]();!(a=(s=u.next()).done)&&(r.push(s.value),!e||r.length!==e);a=!0);}catch(t){i=!0,n=t}finally{try{!a&&u.return&&u.return()}finally{if(i)throw n}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}}(),_stream=require("./stream"),_stream2=_interopRequireDefault(_stream),attributeSeparator=function(){var t="[^=]*",e='"[^"]*"|[^,]*',r="(?:"+t+")=(?:"+e+")";return new RegExp("(?:^|,)("+r+")")},parseAttributes=function(t){for(var e=t.split(attributeSeparator()),r={},a=e.length,i=void 0;a--;)""!==e[a]&&(i=/([^=]*)=(.*)/.exec(e[a]).slice(1),i[0]=i[0].replace(/^\s+|\s+$/g,""),i[1]=i[1].replace(/^\s+|\s+$/g,""),i[1]=i[1].replace(/^['"](.*)['"]$/g,"$1"),r[i[0]]=i[1]);return r},ParseStream=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this))}return _inherits(e,t),_createClass(e,[{key:"push",value:function(t){var e=void 0,r=void 0;if(t=t.replace(/^[\u0000\s]+|[\u0000\s]+$/g,""),0!==t.length){if("#"!==t[0])return void this.trigger("data",{type:"uri",uri:t});if(0!==t.indexOf("#EXT"))return void this.trigger("data",{type:"comment",text:t.slice(1)});if(t=t.replace("\r",""),e=/^#EXTM3U/.exec(t))return void this.trigger("data",{type:"tag",tagType:"m3u"});if(e=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(t))return r={type:"tag",tagType:"inf"},e[1]&&(r.duration=parseFloat(e[1])),e[2]&&(r.title=e[2]),void this.trigger("data",r);if(e=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(t))return r={type:"tag",tagType:"targetduration"},e[1]&&(r.duration=parseInt(e[1],10)),void this.trigger("data",r);if(e=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(t))return r={type:"tag",tagType:"totalduration"},e[1]&&(r.duration=parseInt(e[1],10)),void this.trigger("data",r);if(e=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(t))return r={type:"tag",tagType:"version"},e[1]&&(r.version=parseInt(e[1],10)),void this.trigger("data",r);if(e=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(t))return r={type:"tag",tagType:"media-sequence"},e[1]&&(r.number=parseInt(e[1],10)),void this.trigger("data",r);if(e=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(t))return r={type:"tag",tagType:"discontinuity-sequence"},e[1]&&(r.number=parseInt(e[1],10)),void this.trigger("data",r);if(e=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(t))return r={type:"tag",tagType:"playlist-type"},e[1]&&(r.playlistType=e[1]),void this.trigger("data",r);if(e=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(t))return r={type:"tag",tagType:"byterange"},e[1]&&(r.length=parseInt(e[1],10)),e[2]&&(r.offset=parseInt(e[2],10)),void this.trigger("data",r);if(e=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(t))return r={type:"tag",tagType:"allow-cache"},e[1]&&(r.allowed=!/NO/.test(e[1])),void this.trigger("data",r);if(e=/^#EXT-X-MAP:?(.*)$/.exec(t)){if(r={type:"tag",tagType:"map"},e[1]){var a=parseAttributes(e[1]);if(a.URI&&(r.uri=a.URI),a.BYTERANGE){var i=a.BYTERANGE.split("@"),n=_slicedToArray(i,2),s=n[0],u=n[1];r.byterange={},s&&(r.byterange.length=parseInt(s,10)),u&&(r.byterange.offset=parseInt(u,10))}}return void this.trigger("data",r)}if(e=/^#EXT-X-STREAM-INF:?(.*)$/.exec(t)){if(r={type:"tag",tagType:"stream-inf"},e[1]){if(r.attributes=parseAttributes(e[1]),r.attributes.RESOLUTION){var o=r.attributes.RESOLUTION.split("x"),p={};o[0]&&(p.width=parseInt(o[0],10)),o[1]&&(p.height=parseInt(o[1],10)),r.attributes.RESOLUTION=p}r.attributes.BANDWIDTH&&(r.attributes.BANDWIDTH=parseInt(r.attributes.BANDWIDTH,10)),r.attributes["PROGRAM-ID"]&&(r.attributes["PROGRAM-ID"]=parseInt(r.attributes["PROGRAM-ID"],10))}return void this.trigger("data",r)}return(e=/^#EXT-X-MEDIA:?(.*)$/.exec(t))?(r={type:"tag",tagType:"media"},e[1]&&(r.attributes=parseAttributes(e[1])),void this.trigger("data",r)):(e=/^#EXT-X-ENDLIST/.exec(t))?void this.trigger("data",{type:"tag",tagType:"endlist"}):(e=/^#EXT-X-DISCONTINUITY/.exec(t))?void this.trigger("data",{type:"tag",tagType:"discontinuity"}):(e=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(t))?(r={type:"tag",tagType:"program-date-time"},e[1]&&(r.dateTimeString=e[1],r.dateTimeObject=new Date(e[1])),void this.trigger("data",r)):(e=/^#EXT-X-KEY:?(.*)$/.exec(t))?(r={type:"tag",tagType:"key"},e[1]&&(r.attributes=parseAttributes(e[1]),r.attributes.IV&&("0x"===r.attributes.IV.substring(0,2).toLowerCase()&&(r.attributes.IV=r.attributes.IV.substring(2)),r.attributes.IV=r.attributes.IV.match(/.{8}/g),r.attributes.IV[0]=parseInt(r.attributes.IV[0],16),r.attributes.IV[1]=parseInt(r.attributes.IV[1],16),r.attributes.IV[2]=parseInt(r.attributes.IV[2],16),r.attributes.IV[3]=parseInt(r.attributes.IV[3],16),r.attributes.IV=new Uint32Array(r.attributes.IV))),void this.trigger("data",r)):(e=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(t))?(r={type:"tag",tagType:"cue-out-cont"},e[1]?r.data=e[1]:r.data="",void this.trigger("data",r)):(e=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(t))?(r={type:"tag",tagType:"cue-out"},e[1]?r.data=e[1]:r.data="",void this.trigger("data",r)):(e=/^#EXT-X-CUE-IN:?(.*)?$/.exec(t))?(r={type:"tag",tagType:"cue-in"},e[1]?r.data=e[1]:r.data="",void this.trigger("data",r)):void this.trigger("data",{type:"tag",data:t.slice(4)})}}}]),e}(_stream2.default);exports.default=ParseStream;
},{"./stream":200}],199:[function(require,module,exports){
"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},_createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),_stream=require("./stream"),_stream2=_interopRequireDefault(_stream),_lineStream=require("./line-stream"),_lineStream2=_interopRequireDefault(_lineStream),_parseStream=require("./parse-stream"),_parseStream2=_interopRequireDefault(_parseStream),Parser=function(t){function e(){_classCallCheck(this,e);var t=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));t.lineStream=new _lineStream2.default,t.parseStream=new _parseStream2.default,t.lineStream.pipe(t.parseStream);var i=t,n=[],r={},a=void 0,s=void 0,u=function(){},o={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},f=0;return t.manifest={allowCache:!0,discontinuityStarts:[],segments:[]},t.parseStream.on("data",function(t){var e=void 0,l=void 0;({tag:function(){(({"allow-cache":function(){this.manifest.allowCache=t.allowed,"allowed"in t||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function e(){var e={};"length"in t&&(r.byterange=e,e.length=t.length,"offset"in t||(this.trigger("info",{message:"defaulting offset to zero"}),t.offset=0)),"offset"in t&&(r.byterange=e,e.offset=t.offset)},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),t.duration>0&&(r.duration=t.duration),0===t.duration&&(r.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=n},key:function(){return t.attributes?"NONE"===t.attributes.METHOD?void(s=null):t.attributes.URI?(t.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),s={method:t.attributes.METHOD||"AES-128",uri:t.attributes.URI},void("undefined"!=typeof t.attributes.IV&&(s.iv=t.attributes.IV))):void this.trigger("warn",{message:"ignoring key declaration without URI"}):void this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){return isFinite(t.number)?void(this.manifest.mediaSequence=t.number):void this.trigger("warn",{message:"ignoring invalid media sequence: "+t.number})},"discontinuity-sequence":function(){return isFinite(t.number)?(this.manifest.discontinuitySequence=t.number,void(f=t.number)):void this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+t.number})},"playlist-type":function(){return/VOD|EVENT/.test(t.playlistType)?void(this.manifest.playlistType=t.playlistType):void this.trigger("warn",{message:"ignoring unknown playlist type: "+t.playlist})},map:function(){a={},t.uri&&(a.uri=t.uri),t.byterange&&(a.byterange=t.byterange)},"stream-inf":function(){return this.manifest.playlists=n,this.manifest.mediaGroups=this.manifest.mediaGroups||o,t.attributes?(r.attributes||(r.attributes={}),void _extends(r.attributes,t.attributes)):void this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||o,!(t.attributes&&t.attributes.TYPE&&t.attributes["GROUP-ID"]&&t.attributes.NAME))return void this.trigger("warn",{message:"ignoring incomplete or missing media group"});var i=this.manifest.mediaGroups[t.attributes.TYPE];i[t.attributes["GROUP-ID"]]=i[t.attributes["GROUP-ID"]]||{},e=i[t.attributes["GROUP-ID"]],l={default:/yes/i.test(t.attributes.DEFAULT)},l.default?l.autoselect=!0:l.autoselect=/yes/i.test(t.attributes.AUTOSELECT),t.attributes.LANGUAGE&&(l.language=t.attributes.LANGUAGE),t.attributes.URI&&(l.uri=t.attributes.URI),t.attributes["INSTREAM-ID"]&&(l.instreamId=t.attributes["INSTREAM-ID"]),t.attributes.CHARACTERISTICS&&(l.characteristics=t.attributes.CHARACTERISTICS),t.attributes.FORCED&&(l.forced=/yes/i.test(t.attributes.FORCED)),e[t.attributes.NAME]=l},discontinuity:function(){f+=1,r.discontinuity=!0,this.manifest.discontinuityStarts.push(n.length)},"program-date-time":function(){this.manifest.dateTimeString=t.dateTimeString,this.manifest.dateTimeObject=t.dateTimeObject},targetduration:function(){return!isFinite(t.duration)||t.duration<0?void this.trigger("warn",{message:"ignoring invalid target duration: "+t.duration}):void(this.manifest.targetDuration=t.duration)},totalduration:function(){return!isFinite(t.duration)||t.duration<0?void this.trigger("warn",{message:"ignoring invalid total duration: "+t.duration}):void(this.manifest.totalDuration=t.duration)},"cue-out":function(){r.cueOut=t.data},"cue-out-cont":function(){r.cueOutCont=t.data},"cue-in":function(){r.cueIn=t.data}})[t.tagType]||u).call(i)},uri:function(){r.uri=t.uri,n.push(r),!this.manifest.targetDuration||"duration"in r||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),r.duration=this.manifest.targetDuration),s&&(r.key=s),r.timeline=f,a&&(r.map=a),r={}},comment:function(){}})[t.type].call(i)}),t}return _inherits(e,t),_createClass(e,[{key:"push",value:function(t){this.lineStream.push(t)}},{key:"end",value:function(){this.lineStream.push("\n")}}]),e}(_stream2.default);exports.default=Parser;
},{"./line-stream":197,"./parse-stream":198,"./stream":200}],200:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),Stream=function(){function e(){_classCallCheck(this,e),this.listeners={}}return _createClass(e,[{key:"on",value:function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}},{key:"off",value:function(e,t){if(!this.listeners[e])return!1;var n=this.listeners[e].indexOf(t);return this.listeners[e].splice(n,1),n>-1}},{key:"trigger",value:function(e){var t=this.listeners[e],n=void 0,i=void 0,s=void 0;if(t)if(2===arguments.length)for(i=t.length,n=0;n<i;++n)t[n].call(this,arguments[1]);else for(s=Array.prototype.slice.call(arguments,1),i=t.length,n=0;n<i;++n)t[n].apply(this,s)}},{key:"dispose",value:function(){this.listeners={}}},{key:"pipe",value:function(e){this.on("data",function(t){e.push(t)})}}]),e}();exports.default=Stream;
},{}],201:[function(require,module,exports){
"use strict";var ADTS_SAMPLING_FREQUENCIES=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],parseSyncSafeInteger=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},percentEncode=function(e,r,a){var t,n="";for(t=r;t<a;t++)n+="%"+("00"+e[t].toString(16)).slice(-2);return n},parseIso88591=function(e,r,a){return unescape(percentEncode(e,r,a))},parseId3TagSize=function(e,r){var a=e[r+6]<<21|e[r+7]<<14|e[r+8]<<7|e[r+9],t=e[r+5],n=(16&t)>>4;return n?a+20:a+10},parseAdtsSize=function(e,r){var a=(224&e[r+5])>>5,t=e[r+4]<<3,n=6144&e[r+3];return n|t|a},parseType=function(e,r){return e[r]==="I".charCodeAt(0)&&e[r+1]==="D".charCodeAt(0)&&e[r+2]==="3".charCodeAt(0)?"timed-metadata":e[r]&!0&&240===(240&e[r+1])?"audio":null},parseSampleRate=function(e){for(var r=0;r+5<e.length;){if(255===e[r]&&240===(246&e[r+1]))return ADTS_SAMPLING_FREQUENCIES[(60&e[r+2])>>>2];r++}return null},parseAacTimestamp=function(e){var r,a,t,n;r=10,64&e[5]&&(r+=4,r+=parseSyncSafeInteger(e.subarray(10,14)));do{if(a=parseSyncSafeInteger(e.subarray(r+4,r+8)),a<1)return null;if(n=String.fromCharCode(e[r],e[r+1],e[r+2],e[r+3]),"PRIV"===n){t=e.subarray(r+10,r+a+10);for(var s=0;s<t.byteLength;s++)if(0===t[s]){var p=parseIso88591(t,0,s);if("com.apple.streaming.transportStreamTimestamp"===p){var i=t.subarray(s+1),u=(1&i[3])<<30|i[4]<<22|i[5]<<14|i[6]<<6|i[7]>>>2;return u*=4,u+=3&i[7]}break}}r+=10,r+=a}while(r<e.byteLength);return null};module.exports={parseId3TagSize:parseId3TagSize,parseAdtsSize:parseAdtsSize,parseType:parseType,parseSampleRate:parseSampleRate,parseAacTimestamp:parseAacTimestamp};
},{}],202:[function(require,module,exports){
"use strict";var StreamTypes=require("./stream-types.js"),parsePid=function(e){var r=31&e[1];return r<<=8,r|=e[2]},parsePayloadUnitStartIndicator=function(e){return!!(64&e[1])},parseAdaptionField=function(e){var r=0;return(48&e[3])>>>4>1&&(r+=e[4]+1),r},parseType=function(e,r){var a=parsePid(e);return 0===a?"pat":a===r?"pmt":r?"pes":null},parsePat=function(e){var r=parsePayloadUnitStartIndicator(e),a=4+parseAdaptionField(e);return r&&(a+=e[a]+1),(31&e[a+10])<<8|e[a+11]},parsePmt=function(e){var r={},a=parsePayloadUnitStartIndicator(e),t=4+parseAdaptionField(e);if(a&&(t+=e[t]+1),1&e[t+5]){var s,i,n;s=(15&e[t+1])<<8|e[t+2],i=3+s-4,n=(15&e[t+10])<<8|e[t+11];for(var p=12+n;p<i;){var o=t+p;r[(31&e[o+1])<<8|e[o+2]]=e[o],p+=((15&e[o+3])<<8|e[o+4])+5}return r}},parsePesType=function(e,r){var a=parsePid(e),t=r[a];switch(t){case StreamTypes.H264_STREAM_TYPE:return"video";case StreamTypes.ADTS_STREAM_TYPE:return"audio";case StreamTypes.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},parsePesTime=function(e){var r=parsePayloadUnitStartIndicator(e);if(!r)return null;var a,t=4+parseAdaptionField(e),s={};return a=e[t+7],192&a&&(s.pts=(14&e[t+9])<<27|(255&e[t+10])<<20|(254&e[t+11])<<12|(255&e[t+12])<<5|(254&e[t+13])>>>3,s.pts*=4,s.pts+=(6&e[t+13])>>>1,s.dts=s.pts,64&a&&(s.dts=(14&e[t+14])<<27|(255&e[t+15])<<20|(254&e[t+16])<<12|(255&e[t+17])<<5|(254&e[t+18])>>>3,s.dts*=4,s.dts+=(6&e[t+18])>>>1)),s},parseNalUnitType=function(e){switch(e){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},videoPacketContainsKeyFrame=function(e){for(var r,a=4+parseAdaptionField(e),t=e.subarray(a),s=0,i=0,n=!1;i<t.byteLength-3;i++)if(1===t[i+2]){s=i+5;break}for(;s<t.byteLength;)switch(t[s]){case 0:if(0!==t[s-1]){s+=2;break}if(0!==t[s-2]){s++;break}i+3!==s-2&&(r=parseNalUnitType(31&t[i+3]),"slice_layer_without_partitioning_rbsp_idr"===r&&(n=!0));do s++;while(1!==t[s]&&s<t.length);i=s-2,s+=3;break;case 1:if(0!==t[s-1]||0!==t[s-2]){s+=3;break}r=parseNalUnitType(31&t[i+3]),"slice_layer_without_partitioning_rbsp_idr"===r&&(n=!0),i=s-2,s+=3;break;default:s+=3}return t=t.subarray(i),s-=i,i=0,t&&t.byteLength>3&&(r=parseNalUnitType(31&t[i+3]),"slice_layer_without_partitioning_rbsp_idr"===r&&(n=!0)),n};module.exports={parseType:parseType,parsePat:parsePat,parsePmt:parsePmt,parsePayloadUnitStartIndicator:parsePayloadUnitStartIndicator,parsePesType:parsePesType,parsePesTime:parsePesTime,videoPacketContainsKeyFrame:videoPacketContainsKeyFrame};
},{"./stream-types.js":203}],203:[function(require,module,exports){
"use strict";module.exports={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21};
},{}],204:[function(require,module,exports){
"use strict";var Stream=require("../utils/stream"),MAX_TS=8589934592,RO_THRESH=4294967296,handleRollover=function(t,e){var r=1;for(t>e&&(r=-1);Math.abs(e-t)>RO_THRESH;)t+=r*MAX_TS;return t},TimestampRolloverStream=function(t){var e,r;TimestampRolloverStream.prototype.init.call(this),this.type_=t,this.push=function(t){t.type===this.type_&&(void 0===r&&(r=t.dts),t.dts=handleRollover(t.dts,r),t.pts=handleRollover(t.pts,r),e=t.dts,this.trigger("data",t))},this.flush=function(){r=e,this.trigger("done")}};TimestampRolloverStream.prototype=new Stream,module.exports={TimestampRolloverStream:TimestampRolloverStream,handleRollover:handleRollover};
},{"../utils/stream":207}],205:[function(require,module,exports){
"use strict";var findBox,parseType,timescale,startTime;findBox=function(r,t){var n,e,a,i,o,u=[];if(!t.length)return null;for(n=0;n<r.byteLength;)e=r[n]<<24,e|=r[n+1]<<16,e|=r[n+2]<<8,e|=r[n+3],a=parseType(r.subarray(n+4,n+8)),i=e>1?n+e:r.byteLength,a===t[0]&&(1===t.length?u.push(r.subarray(n+8,i)):(o=findBox(r.subarray(n+8,i),t.slice(1)),o.length&&(u=u.concat(o)))),n=i;return u},parseType=function(r){var t="";return t+=String.fromCharCode(r[0]),t+=String.fromCharCode(r[1]),t+=String.fromCharCode(r[2]),t+=String.fromCharCode(r[3])},timescale=function(r){var t={},n=findBox(r,["moov","trak"]);return n.reduce(function(r,t){var n,e,a,i,o;return(n=findBox(t,["tkhd"])[0])?(e=n[0],a=0===e?12:20,i=n[a]<<24|n[a+1]<<16|n[a+2]<<8|n[a+3],(o=findBox(t,["mdia","mdhd"])[0])?(e=o[0],a=0===e?12:20,r[i]=o[a]<<24|o[a+1]<<16|o[a+2]<<8|o[a+3],r):null):null},t)},startTime=function(r,t){var n,e,a;return n=findBox(t,["moof","traf"]),e=[].concat.apply([],n.map(function(t){return findBox(t,["tfhd"]).map(function(n){var e,a,i;return e=n[4]<<24|n[5]<<16|n[6]<<8|n[7],a=r[e]||9e4,i=findBox(t,["tfdt"]).map(function(r){var t,n;return t=r[0],n=r[4]<<24|r[5]<<16|r[6]<<8|r[7],1===t&&(n*=Math.pow(2,32),n+=r[8]<<24|r[9]<<16|r[10]<<8|r[11]),n})[0],i=i||1/0,i/a})})),a=Math.min.apply(null,e),isFinite(a)?a:0},module.exports={parseType:parseType,timescale:timescale,startTime:startTime};
},{}],206:[function(require,module,exports){
"use strict";var StreamTypes=require("../m2ts/stream-types.js"),handleRollover=require("../m2ts/timestamp-rollover-stream.js").handleRollover,probe={};probe.ts=require("../m2ts/probe.js"),probe.aac=require("../aac/probe.js");var PES_TIMESCALE=9e4,MP2T_PACKET_LENGTH=188,SYNC_BYTE=71,isLikelyAacData=function(e){return e[0]==="I".charCodeAt(0)&&e[1]==="D".charCodeAt(0)&&e[2]==="3".charCodeAt(0)},parsePsi_=function(e,a){for(var t,s,r=0,i=MP2T_PACKET_LENGTH;i<e.byteLength;)if(e[r]!==SYNC_BYTE||e[i]!==SYNC_BYTE)r++,i++;else{switch(t=e.subarray(r,i),s=probe.ts.parseType(t,a.pid)){case"pat":a.pid||(a.pid=probe.ts.parsePat(t));break;case"pmt":a.table||(a.table=probe.ts.parsePmt(t))}if(a.pid&&a.table)return;r+=MP2T_PACKET_LENGTH,i+=MP2T_PACKET_LENGTH}},parseAudioPes_=function(e,a,t){for(var s,r,i,p,o,T=0,d=MP2T_PACKET_LENGTH,n=!1;d<e.byteLength;)if(e[T]!==SYNC_BYTE||e[d]!==SYNC_BYTE)T++,d++;else{switch(s=e.subarray(T,d),r=probe.ts.parseType(s,a.pid)){case"pes":i=probe.ts.parsePesType(s,a.table),p=probe.ts.parsePayloadUnitStartIndicator(s),"audio"===i&&p&&(o=probe.ts.parsePesTime(s),o.type="audio",t.audio.push(o),n=!0)}if(n)break;T+=MP2T_PACKET_LENGTH,d+=MP2T_PACKET_LENGTH}for(d=e.byteLength,T=d-MP2T_PACKET_LENGTH,n=!1;T>=0;)if(e[T]!==SYNC_BYTE||e[d]!==SYNC_BYTE)T--,d--;else{switch(s=e.subarray(T,d),r=probe.ts.parseType(s,a.pid)){case"pes":i=probe.ts.parsePesType(s,a.table),p=probe.ts.parsePayloadUnitStartIndicator(s),"audio"===i&&p&&(o=probe.ts.parsePesTime(s),o.type="audio",t.audio.push(o),n=!0)}if(n)break;T-=MP2T_PACKET_LENGTH,d-=MP2T_PACKET_LENGTH}},parseVideoPes_=function(e,a,t){for(var s,r,i,p,o,T,d,n,l=0,E=MP2T_PACKET_LENGTH,u=!1,b={data:[],size:0};E<e.byteLength;)if(e[l]!==SYNC_BYTE||e[E]!==SYNC_BYTE)l++,E++;else{switch(s=e.subarray(l,E),r=probe.ts.parseType(s,a.pid)){case"pes":if(i=probe.ts.parsePesType(s,a.table),p=probe.ts.parsePayloadUnitStartIndicator(s),"video"===i&&(p&&!u&&(o=probe.ts.parsePesTime(s),o.type="video",t.video.push(o),u=!0),!t.firstKeyFrame)){if(p&&0!==b.size){for(T=new Uint8Array(b.size),d=0;b.data.length;)n=b.data.shift(),T.set(n,d),d+=n.byteLength;probe.ts.videoPacketContainsKeyFrame(T)&&(t.firstKeyFrame=probe.ts.parsePesTime(T),t.firstKeyFrame.type="video"),b.size=0}b.data.push(s),b.size+=s.byteLength}}if(u&&t.firstKeyFrame)break;l+=MP2T_PACKET_LENGTH,E+=MP2T_PACKET_LENGTH}for(E=e.byteLength,l=E-MP2T_PACKET_LENGTH,u=!1;l>=0;)if(e[l]!==SYNC_BYTE||e[E]!==SYNC_BYTE)l--,E--;else{switch(s=e.subarray(l,E),r=probe.ts.parseType(s,a.pid)){case"pes":i=probe.ts.parsePesType(s,a.table),p=probe.ts.parsePayloadUnitStartIndicator(s),"video"===i&&p&&(o=probe.ts.parsePesTime(s),o.type="video",t.video.push(o),u=!0)}if(u)break;l-=MP2T_PACKET_LENGTH,E-=MP2T_PACKET_LENGTH}},adjustTimestamp_=function(e,a){if(e.audio&&e.audio.length){var t=a;"undefined"==typeof t&&(t=e.audio[0].dts),e.audio.forEach(function(e){e.dts=handleRollover(e.dts,t),e.pts=handleRollover(e.pts,t),e.dtsTime=e.dts/PES_TIMESCALE,e.ptsTime=e.pts/PES_TIMESCALE})}if(e.video&&e.video.length){var s=a;if("undefined"==typeof s&&(s=e.video[0].dts),e.video.forEach(function(e){e.dts=handleRollover(e.dts,s),e.pts=handleRollover(e.pts,s),e.dtsTime=e.dts/PES_TIMESCALE,e.ptsTime=e.pts/PES_TIMESCALE}),e.firstKeyFrame){var r=e.firstKeyFrame;r.dts=handleRollover(r.dts,s),r.pts=handleRollover(r.pts,s),r.dtsTime=r.dts/PES_TIMESCALE,r.ptsTime=r.dts/PES_TIMESCALE}}},inspectAac_=function(e){for(var a,t=!1,s=0,r=null,i=null,p=0,o=0;e.length-o>=3;){var T=probe.aac.parseType(e,o);switch(T){case"timed-metadata":if(e.length-o<10){t=!0;break}if(p=probe.aac.parseId3TagSize(e,o),p>e.length){t=!0;break}null===i&&(a=e.subarray(o,o+p),i=probe.aac.parseAacTimestamp(a)),o+=p;break;case"audio":if(e.length-o<7){t=!0;break}if(p=probe.aac.parseAdtsSize(e,o),p>e.length){t=!0;break}null===r&&(a=e.subarray(o,o+p),r=probe.aac.parseSampleRate(a)),s++,o+=p;break;default:o++}if(t)return null}if(null===r||null===i)return null;var d=PES_TIMESCALE/r,n={audio:[{type:"audio",dts:i,pts:i},{type:"audio",dts:i+1024*s*d,pts:i+1024*s*d}]};return n},inspectTs_=function(e){var a={pid:null,table:null},t={};parsePsi_(e,a);for(var s in a.table)if(a.table.hasOwnProperty(s)){var r=a.table[s];switch(r){case StreamTypes.H264_STREAM_TYPE:t.video=[],parseVideoPes_(e,a,t),0===t.video.length&&delete t.video;break;case StreamTypes.ADTS_STREAM_TYPE:t.audio=[],parseAudioPes_(e,a,t),0===t.audio.length&&delete t.audio}}return t},inspect=function(e,a){var t,s=isLikelyAacData(e);return t=s?inspectAac_(e):inspectTs_(e),t&&(t.audio||t.video)?(adjustTimestamp_(t,a),t):null};module.exports={inspect:inspect};
},{"../aac/probe.js":201,"../m2ts/probe.js":202,"../m2ts/stream-types.js":203,"../m2ts/timestamp-rollover-stream.js":204}],207:[function(require,module,exports){
"use strict";var Stream=function(){this.init=function(){var t={};this.on=function(n,i){t[n]||(t[n]=[]),t[n]=t[n].concat(i)},this.off=function(n,i){var e;return!!t[n]&&(e=t[n].indexOf(i),t[n]=t[n].slice(),t[n].splice(e,1),e>-1)},this.trigger=function(n){var i,e,o,r;if(i=t[n])if(2===arguments.length)for(o=i.length,e=0;e<o;++e)i[e].call(this,arguments[1]);else{for(r=[],e=arguments.length,e=1;e<arguments.length;++e)r.push(arguments[e]);for(o=i.length,e=0;e<o;++e)i[e].apply(this,r)}},this.dispose=function(){t={}}}};Stream.prototype.pipe=function(t){return this.on("data",function(n){t.push(n)}),this.on("done",function(n){t.flush(n)}),t},Stream.prototype.push=function(t){this.trigger("data",t)},Stream.prototype.flush=function(t){this.trigger("done",t)},module.exports=Stream;
},{}],208:[function(require,module,exports){
var trim=require("trim"),forEach=require("for-each"),isArray=function(r){return"[object Array]"===Object.prototype.toString.call(r)};module.exports=function(r){if(!r)return{};var e={};return forEach(trim(r).split("\n"),function(r){var t=r.indexOf(":"),i=trim(r.slice(0,t)).toLowerCase(),o=trim(r.slice(t+1));"undefined"==typeof e[i]?e[i]=o:isArray(e[i])?e[i].push(o):e[i]=[e[i],o]}),e};
},{"for-each":192,"trim":217}],209:[function(require,module,exports){
"use strict";var PADDING;module.exports=function(t){var e=PADDING[t.byteLength%16||0],n=new Uint8Array(t.byteLength+e.length);return n.set(t),n.set(e,t.byteLength),n},PADDING=[[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],[15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],[14,14,14,14,14,14,14,14,14,14,14,14,14,14],[13,13,13,13,13,13,13,13,13,13,13,13,13],[12,12,12,12,12,12,12,12,12,12,12,12],[11,11,11,11,11,11,11,11,11,11,11],[10,10,10,10,10,10,10,10,10,10],[9,9,9,9,9,9,9,9,9],[8,8,8,8,8,8,8,8],[7,7,7,7,7,7,7],[6,6,6,6,6,6],[5,5,5,5,5],[4,4,4,4],[3,3,3],[2,2],[1]];
},{}],210:[function(require,module,exports){
"use strict";exports.pad=require("./pad.js"),exports.unpad=require("./unpad.js");
},{"./pad.js":209,"./unpad.js":211}],211:[function(require,module,exports){
"use strict";module.exports=function(t){return t.subarray(0,t.byteLength-t[t.byteLength-1])};
},{}],212:[function(require,module,exports){
var decimalAdjust=exports.decimalAdjust=function(o,t,e){return"undefined"==typeof e||0===+e?Math[o](t):(t=+t,e=+e,isNaN(t)||"number"!=typeof e||e%1!==0?NaN:(t=t.toString().split("e"),t=Math[o](+(t[0]+"e"+(t[1]?+t[1]-e:-e))),t=t.toString().split("e"),+(t[0]+"e"+(t[1]?+t[1]+e:e))))};module.exports={round10:function(o,t){return decimalAdjust("round",o,t)},floor10:function(o,t){return decimalAdjust("floor",o,t)},ceil10:function(o,t){return decimalAdjust("ceil",o,t)}},module.exports.polyfill=function(){Math.round10||(Math.round10=module.exports.round10),Math.floor10||(Math.floor10=module.exports.floor10),Math.ceil10||(Math.ceil10=module.exports.ceil10)};
},{}],213:[function(require,module,exports){
function SafeParseTuple(e,r){var a,u=null;try{a=JSON.parse(e,r)}catch(e){u=e}return[u,a]}module.exports=SafeParseTuple;
},{}],214:[function(require,module,exports){
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.THREE=t.THREE||{})}(this,function(t){"use strict";function e(){}function i(t,e){this.x=t||0,this.y=e||0}function n(t,e,r,a,o,s,c,h,l,u){Object.defineProperty(this,"id",{value:Ko++}),this.uuid=Qo.generateUUID(),this.name="",this.image=void 0!==t?t:n.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:n.DEFAULT_MAPPING,this.wrapS=void 0!==r?r:ka,this.wrapT=void 0!==a?a:ka,this.magFilter=void 0!==o?o:Za,this.minFilter=void 0!==s?s:Qa,this.anisotropy=void 0!==l?l:1,this.format=void 0!==c?c:fo,this.type=void 0!==h?h:$a,this.offset=new i(0,0),this.repeat=new i(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==u?u:Ho,this.version=0,this.onUpdate=null}function r(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.w=void 0!==n?n:1}function a(t,e,i){this.uuid=Qo.generateUUID(),this.width=t,this.height=e,this.scissor=new r(0,0,t,e),this.scissorTest=!1,this.viewport=new r(0,0,t,e),i=i||{},void 0===i.minFilter&&(i.minFilter=Za),this.texture=new n(void 0,void 0,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0===i.stencilBuffer||i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null}function o(t,e,i){a.call(this,t,e,i),this.activeCubeFace=0,this.activeMipMapLevel=0}function s(t,e,i,n){this._x=t||0,this._y=e||0,this._z=i||0,this._w=void 0!==n?n:1}function c(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0}function h(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function l(t,e,i,r,a,o,s,c,h,l){t=void 0!==t?t:[],e=void 0!==e?e:Na,n.call(this,t,e,i,r,a,o,s,c,h,l),this.flipY=!1}function u(){this.seq=[],this.map={}}function p(t,e,i){var n=t[0];if(n<=0||n>0)return t;var r=e*i,a=es[r];if(void 0===a&&(a=new Float32Array(r),es[r]=a),0!==e){n.toArray(a,0);for(var o=1,s=0;o!==e;++o)s+=i,t[o].toArray(a,s)}return a}function d(t,e){var i=is[e];void 0===i&&(i=new Int32Array(e),is[e]=i);for(var n=0;n!==e;++n)i[n]=t.allocTextureUnit();return i}function f(t,e){t.uniform1f(this.addr,e)}function m(t,e){t.uniform1i(this.addr,e)}function g(t,e){void 0===e.x?t.uniform2fv(this.addr,e):t.uniform2f(this.addr,e.x,e.y)}function v(t,e){void 0!==e.x?t.uniform3f(this.addr,e.x,e.y,e.z):void 0!==e.r?t.uniform3f(this.addr,e.r,e.g,e.b):t.uniform3fv(this.addr,e)}function y(t,e){void 0===e.x?t.uniform4fv(this.addr,e):t.uniform4f(this.addr,e.x,e.y,e.z,e.w)}function x(t,e){t.uniformMatrix2fv(this.addr,!1,e.elements||e)}function _(t,e){t.uniformMatrix3fv(this.addr,!1,e.elements||e)}function b(t,e){t.uniformMatrix4fv(this.addr,!1,e.elements||e)}function w(t,e,i){var n=i.allocTextureUnit();t.uniform1i(this.addr,n),i.setTexture2D(e||$o,n)}function M(t,e,i){var n=i.allocTextureUnit();t.uniform1i(this.addr,n),i.setTextureCube(e||ts,n)}function E(t,e){t.uniform2iv(this.addr,e)}function T(t,e){t.uniform3iv(this.addr,e)}function S(t,e){t.uniform4iv(this.addr,e)}function A(t){switch(t){case 5126:return f;case 35664:return g;case 35665:return v;case 35666:return y;case 35674:return x;case 35675:return _;case 35676:return b;case 35678:return w;case 35680:return M;case 5124:case 35670:return m;case 35667:case 35671:return E;case 35668:case 35672:return T;case 35669:case 35673:return S}}function L(t,e){t.uniform1fv(this.addr,e)}function R(t,e){t.uniform1iv(this.addr,e)}function P(t,e){t.uniform2fv(this.addr,p(e,this.size,2))}function C(t,e){t.uniform3fv(this.addr,p(e,this.size,3))}function I(t,e){t.uniform4fv(this.addr,p(e,this.size,4))}function U(t,e){t.uniformMatrix2fv(this.addr,!1,p(e,this.size,4))}function N(t,e){t.uniformMatrix3fv(this.addr,!1,p(e,this.size,9))}function D(t,e){t.uniformMatrix4fv(this.addr,!1,p(e,this.size,16))}function O(t,e,i){var n=e.length,r=d(i,n);t.uniform1iv(this.addr,r);for(var a=0;a!==n;++a)i.setTexture2D(e[a]||$o,r[a])}function F(t,e,i){var n=e.length,r=d(i,n);t.uniform1iv(this.addr,r);for(var a=0;a!==n;++a)i.setTextureCube(e[a]||ts,r[a])}function z(t){switch(t){case 5126:return L;case 35664:return P;case 35665:return C;case 35666:return I;case 35674:return U;case 35675:return N;case 35676:return D;case 35678:return O;case 35680:return F;case 5124:case 35670:return R;case 35667:case 35671:return E;case 35668:case 35672:return T;case 35669:case 35673:return S}}function B(t,e,i){this.id=t,this.addr=i,this.setValue=A(e.type)}function G(t,e,i){this.id=t,this.addr=i,this.size=e.size,this.setValue=z(e.type)}function H(t){this.id=t,u.call(this)}function V(t,e){t.seq.push(e),t.map[e.id]=e}function k(t,e,i){var n=t.name,r=n.length;for(ns.lastIndex=0;;){var a=ns.exec(n),o=ns.lastIndex,s=a[1],c="]"===a[2],h=a[3];if(c&&(s|=0),void 0===h||"["===h&&o+2===r){V(i,void 0===h?new B(s,t,e):new G(s,t,e));break}var l=i.map,u=l[s];void 0===u&&(u=new H(s),V(i,u)),i=u}}function j(t,e,i){u.call(this),this.renderer=i;for(var n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),r=0;r!==n;++r){var a=t.getActiveUniform(e,r),o=a.name,s=t.getUniformLocation(e,o);k(a,s,this)}}function W(t,e,i){return void 0===e&&void 0===i?this.set(t):this.setRGB(t,e,i)}function X(t,e,i,r,a,o,s,c,h,l,u,p){n.call(this,null,o,s,c,h,l,r,a,u,p),this.image={data:t,width:e,height:i},this.magFilter=void 0!==h?h:Xa,this.minFilter=void 0!==l?l:Xa,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function Y(t,e){this.min=void 0!==t?t:new i(+(1/0),+(1/0)),this.max=void 0!==e?e:new i(-(1/0),-(1/0))}function q(t,e){function n(){var t=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),e=new Uint16Array([0,1,2,0,2,3]);a=f.createBuffer(),o=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,a),f.bufferData(f.ARRAY_BUFFER,t,f.STATIC_DRAW),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,o),f.bufferData(f.ELEMENT_ARRAY_BUFFER,e,f.STATIC_DRAW),p=f.createTexture(),d=f.createTexture(),m.bindTexture(f.TEXTURE_2D,p),f.texImage2D(f.TEXTURE_2D,0,f.RGB,16,16,0,f.RGB,f.UNSIGNED_BYTE,null),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),m.bindTexture(f.TEXTURE_2D,d),f.texImage2D(f.TEXTURE_2D,0,f.RGBA,16,16,0,f.RGBA,f.UNSIGNED_BYTE,null),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),s={vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if ( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if ( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if ( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},h=r(s),l={vertex:f.getAttribLocation(h,"position"),uv:f.getAttribLocation(h,"uv")},u={renderType:f.getUniformLocation(h,"renderType"),map:f.getUniformLocation(h,"map"),occlusionMap:f.getUniformLocation(h,"occlusionMap"),opacity:f.getUniformLocation(h,"opacity"),color:f.getUniformLocation(h,"color"),scale:f.getUniformLocation(h,"scale"),rotation:f.getUniformLocation(h,"rotation"),screenPosition:f.getUniformLocation(h,"screenPosition")}}function r(e){var i=f.createProgram(),n=f.createShader(f.FRAGMENT_SHADER),r=f.createShader(f.VERTEX_SHADER),a="precision "+t.getPrecision()+" float;\n";return f.shaderSource(n,a+e.fragmentShader),f.shaderSource(r,a+e.vertexShader),f.compileShader(n),f.compileShader(r),f.attachShader(i,n),f.attachShader(i,r),f.linkProgram(i),i}var a,o,s,h,l,u,p,d,f=t.context,m=t.state;this.render=function(r,s,g){if(0!==e.length){var v=new c,y=g.w/g.z,x=.5*g.z,_=.5*g.w,b=16/g.w,w=new i(b*y,b),M=new c(1,1,0),E=new i(1,1),T=new Y;T.min.set(g.x,g.y),T.max.set(g.x+(g.z-16),g.y+(g.w-16)),void 0===h&&n(),f.useProgram(h),m.initAttributes(),m.enableAttribute(l.vertex),m.enableAttribute(l.uv),m.disableUnusedAttributes(),f.uniform1i(u.occlusionMap,0),f.uniform1i(u.map,1),f.bindBuffer(f.ARRAY_BUFFER,a),f.vertexAttribPointer(l.vertex,2,f.FLOAT,!1,16,0),f.vertexAttribPointer(l.uv,2,f.FLOAT,!1,16,8),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,o),m.disable(f.CULL_FACE),m.setDepthWrite(!1);for(var S=0,A=e.length;S<A;S++){b=16/g.w,w.set(b*y,b);var L=e[S];if(v.set(L.matrixWorld.elements[12],L.matrixWorld.elements[13],L.matrixWorld.elements[14]),v.applyMatrix4(s.matrixWorldInverse),v.applyProjection(s.projectionMatrix),M.copy(v),E.x=g.x+M.x*x+x-8,E.y=g.y+M.y*_+_-8,T.containsPoint(E)===!0){m.activeTexture(f.TEXTURE0),m.bindTexture(f.TEXTURE_2D,null),m.activeTexture(f.TEXTURE1),m.bindTexture(f.TEXTURE_2D,p),f.copyTexImage2D(f.TEXTURE_2D,0,f.RGB,E.x,E.y,16,16,0),f.uniform1i(u.renderType,0),f.uniform2f(u.scale,w.x,w.y),f.uniform3f(u.screenPosition,M.x,M.y,M.z),m.disable(f.BLEND),m.enable(f.DEPTH_TEST),f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0),m.activeTexture(f.TEXTURE0),m.bindTexture(f.TEXTURE_2D,d),f.copyTexImage2D(f.TEXTURE_2D,0,f.RGBA,E.x,E.y,16,16,0),f.uniform1i(u.renderType,1),m.disable(f.DEPTH_TEST),m.activeTexture(f.TEXTURE1),m.bindTexture(f.TEXTURE_2D,p),f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0),L.positionScreen.copy(M),L.customUpdateCallback?L.customUpdateCallback(L):L.updateLensFlares(),f.uniform1i(u.renderType,2),m.enable(f.BLEND);for(var R=0,P=L.lensFlares.length;R<P;R++){var C=L.lensFlares[R];C.opacity>.001&&C.scale>.001&&(M.x=C.x,M.y=C.y,M.z=C.z,b=C.size*C.scale/g.w,w.x=b*y,w.y=b,f.uniform3f(u.screenPosition,M.x,M.y,M.z),f.uniform2f(u.scale,w.x,w.y),f.uniform1f(u.rotation,C.rotation),f.uniform1f(u.opacity,C.opacity),f.uniform3f(u.color,C.color.r,C.color.g,C.color.b),m.setBlending(C.blending,C.blendEquation,C.blendSrc,C.blendDst),t.setTexture2D(C.texture,1),f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0))}}}m.enable(f.CULL_FACE),m.enable(f.DEPTH_TEST),m.setDepthWrite(!0),t.resetGLState()}}}function Z(t,e){function i(){var t=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),e=new Uint16Array([0,1,2,0,2,3]);o=f.createBuffer(),h=f.createBuffer(),f.bindBuffer(f.ARRAY_BUFFER,o),f.bufferData(f.ARRAY_BUFFER,t,f.STATIC_DRAW),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,h),f.bufferData(f.ELEMENT_ARRAY_BUFFER,e,f.STATIC_DRAW),l=r(),u={position:f.getAttribLocation(l,"position"),uv:f.getAttribLocation(l,"uv")},p={uvOffset:f.getUniformLocation(l,"uvOffset"),uvScale:f.getUniformLocation(l,"uvScale"),rotation:f.getUniformLocation(l,"rotation"),scale:f.getUniformLocation(l,"scale"),color:f.getUniformLocation(l,"color"),map:f.getUniformLocation(l,"map"),opacity:f.getUniformLocation(l,"opacity"),modelViewMatrix:f.getUniformLocation(l,"modelViewMatrix"),projectionMatrix:f.getUniformLocation(l,"projectionMatrix"),fogType:f.getUniformLocation(l,"fogType"),fogDensity:f.getUniformLocation(l,"fogDensity"),fogNear:f.getUniformLocation(l,"fogNear"),fogFar:f.getUniformLocation(l,"fogFar"),fogColor:f.getUniformLocation(l,"fogColor"),alphaTest:f.getUniformLocation(l,"alphaTest")};var i=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");i.width=8,i.height=8;var a=i.getContext("2d");a.fillStyle="white",a.fillRect(0,0,8,8),d=new n(i),d.needsUpdate=!0}function r(){var e=f.createProgram(),i=f.createShader(f.VERTEX_SHADER),n=f.createShader(f.FRAGMENT_SHADER);return f.shaderSource(i,["precision "+t.getPrecision()+" float;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n")),f.shaderSource(n,["precision "+t.getPrecision()+" float;","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")),f.compileShader(i),f.compileShader(n),f.attachShader(e,i),f.attachShader(e,n),f.linkProgram(e),e}function a(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:e.id-t.id}var o,h,l,u,p,d,f=t.context,m=t.state,g=new c,v=new s,y=new c;this.render=function(n,r){if(0!==e.length){void 0===l&&i(),f.useProgram(l),m.initAttributes(),m.enableAttribute(u.position),m.enableAttribute(u.uv),m.disableUnusedAttributes(),m.disable(f.CULL_FACE),m.enable(f.BLEND),f.bindBuffer(f.ARRAY_BUFFER,o),f.vertexAttribPointer(u.position,2,f.FLOAT,!1,16,0),f.vertexAttribPointer(u.uv,2,f.FLOAT,!1,16,8),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,h),f.uniformMatrix4fv(p.projectionMatrix,!1,r.projectionMatrix.elements),m.activeTexture(f.TEXTURE0),f.uniform1i(p.map,0);var s=0,c=0,x=n.fog;x?(f.uniform3f(p.fogColor,x.color.r,x.color.g,x.color.b),x.isFog?(f.uniform1f(p.fogNear,x.near),f.uniform1f(p.fogFar,x.far),f.uniform1i(p.fogType,1),s=1,c=1):x.isFogExp2&&(f.uniform1f(p.fogDensity,x.density),f.uniform1i(p.fogType,2),s=2,c=2)):(f.uniform1i(p.fogType,0),s=0,c=0);for(var _=0,b=e.length;_<b;_++){var w=e[_];w.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,w.matrixWorld),w.z=-w.modelViewMatrix.elements[14]}e.sort(a);for(var M=[],_=0,b=e.length;_<b;_++){var w=e[_],E=w.material;if(E.visible!==!1){f.uniform1f(p.alphaTest,E.alphaTest),f.uniformMatrix4fv(p.modelViewMatrix,!1,w.modelViewMatrix.elements),w.matrixWorld.decompose(g,v,y),M[0]=y.x,M[1]=y.y;var T=0;n.fog&&E.fog&&(T=c),s!==T&&(f.uniform1i(p.fogType,T),s=T),null!==E.map?(f.uniform2f(p.uvOffset,E.map.offset.x,E.map.offset.y),f.uniform2f(p.uvScale,E.map.repeat.x,E.map.repeat.y)):(f.uniform2f(p.uvOffset,0,0),f.uniform2f(p.uvScale,1,1)),f.uniform1f(p.opacity,E.opacity),f.uniform3f(p.color,E.color.r,E.color.g,E.color.b),f.uniform1f(p.rotation,E.rotation),f.uniform2fv(p.scale,M),m.setBlending(E.blending,E.blendEquation,E.blendSrc,E.blendDst),m.setDepthTest(E.depthTest),m.setDepthWrite(E.depthWrite),E.map?t.setTexture2D(E.map,0):t.setTexture2D(d,0),f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0)}}m.enable(f.CULL_FACE),t.resetGLState()}}}function J(){Object.defineProperty(this,"id",{value:sh++}),this.uuid=Qo.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=Zr,this.side=Gr,this.shading=jr,this.vertexColors=Wr,this.opacity=1,this.transparent=!1,this.blendSrc=la,this.blendDst=ua,this.blendEquation=ea,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=_a,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this._needsUpdate=!0}function Q(t){J.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function K(t){J.call(this),this.type="MeshDepthMaterial",this.depthPacking=Zo,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(t)}function $(t,e){this.min=void 0!==t?t:new c(+(1/0),+(1/0),+(1/0)),this.max=void 0!==e?e:new c(-(1/0),-(1/0),-(1/0))}function tt(t,e){this.center=void 0!==t?t:new c,this.radius=void 0!==e?e:0}function et(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function it(t,e){this.normal=void 0!==t?t:new c(1,0,0),this.constant=void 0!==e?e:0}function nt(t,e,i,n,r,a){this.planes=[void 0!==t?t:new it,void 0!==e?e:new it,void 0!==i?i:new it,void 0!==n?n:new it,void 0!==r?r:new it,void 0!==a?a:new it]}function rt(t,e,n,o){function s(e,i,n,r){var a=e.geometry,o=null,s=E,c=e.customDepthMaterial;if(n&&(s=T,c=e.customDistanceMaterial),c)o=c;else{var h=!1;i.morphTargets&&(a&&a.isBufferGeometry?h=a.morphAttributes&&a.morphAttributes.position&&a.morphAttributes.position.length>0:a&&a.isGeometry&&(h=a.morphTargets&&a.morphTargets.length>0));var l=e.isSkinnedMesh&&i.skinning,u=0;h&&(u|=b),l&&(u|=w),o=s[u]}if(t.localClippingEnabled&&i.clipShadows===!0&&0!==i.clippingPlanes.length){var p=o.uuid,d=i.uuid,f=S[p];void 0===f&&(f={},S[p]=f);var m=f[d];void 0===m&&(m=o.clone(),f[d]=m),o=m}o.visible=i.visible,o.wireframe=i.wireframe;var g=i.side;return z.renderSingleSided&&g==Vr&&(g=Gr),z.renderReverseSided&&(g===Gr?g=Hr:g===Hr&&(g=Gr)),o.side=g,o.clipShadows=i.clipShadows,o.clippingPlanes=i.clippingPlanes,o.wireframeLinewidth=i.wireframeLinewidth,o.linewidth=i.linewidth,n&&void 0!==o.uniforms.lightPos&&o.uniforms.lightPos.value.copy(r),o}function l(t,e,i){if(t.visible!==!1){var n=0!==(t.layers.mask&e.layers.mask);if(n&&(t.isMesh||t.isLine||t.isPoints)&&t.castShadow&&(t.frustumCulled===!1||d.intersectsObject(t)===!0)){var r=t.material;r.visible===!0&&(t.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,t.matrixWorld),_.push(t))}for(var a=t.children,o=0,s=a.length;o<s;o++)l(a[o],e,i)}}var u=t.context,p=t.state,d=new nt,f=new h,m=e.shadows,g=new i,v=new i(o.maxTextureSize,o.maxTextureSize),y=new c,x=new c,_=[],b=1,w=2,M=(b|w)+1,E=new Array(M),T=new Array(M),S={},A=[new c(1,0,0),new c(-1,0,0),new c(0,0,1),new c(0,0,-1),new c(0,1,0),new c(0,-1,0)],L=[new c(0,1,0),new c(0,1,0),new c(0,1,0),new c(0,1,0),new c(0,0,1),new c(0,0,-1)],R=[new r,new r,new r,new r,new r,new r],P=new K;P.depthPacking=Jo,P.clipping=!0;for(var C=oh.distanceRGBA,I=rs.clone(C.uniforms),U=0;U!==M;++U){var N=0!==(U&b),D=0!==(U&w),O=P.clone();O.morphTargets=N,O.skinning=D,E[U]=O;var F=new Q({defines:{USE_SHADOWMAP:""},uniforms:I,vertexShader:C.vertexShader,fragmentShader:C.fragmentShader,morphTargets:N,skinning:D,clipping:!0});T[U]=F}var z=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=zr,this.renderReverseSided=!0,this.renderSingleSided=!0,this.render=function(e,i){if(z.enabled!==!1&&(z.autoUpdate!==!1||z.needsUpdate!==!1)&&0!==m.length){p.buffers.color.setClear(1,1,1,1),p.disable(u.BLEND),p.setDepthTest(!0),p.setScissorTest(!1);for(var r,o,c=0,h=m.length;c<h;c++){var b=m[c],w=b.shadow;if(void 0!==w){var M=w.camera;if(g.copy(w.mapSize),g.min(v),b&&b.isPointLight){r=6,o=!0;var E=g.x,T=g.y;R[0].set(2*E,T,E,T),R[1].set(0,T,E,T),R[2].set(3*E,T,E,T),R[3].set(E,T,E,T),R[4].set(3*E,0,E,T),R[5].set(E,0,E,T),g.x*=4,g.y*=2}else r=1,o=!1;if(null===w.map){var S={minFilter:Xa,magFilter:Xa,format:fo};w.map=new a(g.x,g.y,S),M.updateProjectionMatrix()}w.isSpotLightShadow&&w.update(b),w&&w.isRectAreaLightShadow&&w.update(b);var P=w.map,C=w.matrix;x.setFromMatrixPosition(b.matrixWorld),M.position.copy(x),t.setRenderTarget(P),t.clear();for(var I=0;I<r;I++){if(o){y.copy(M.position),y.add(A[I]),M.up.copy(L[I]),M.lookAt(y);var U=R[I];p.viewport(U)}else y.setFromMatrixPosition(b.target.matrixWorld),M.lookAt(y);M.updateMatrixWorld(),M.matrixWorldInverse.getInverse(M.matrixWorld),C.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),C.multiply(M.projectionMatrix),C.multiply(M.matrixWorldInverse),f.multiplyMatrices(M.projectionMatrix,M.matrixWorldInverse),d.setFromMatrix(f),_.length=0,l(e,i,M);for(var N=0,D=_.length;N<D;N++){var O=_[N],F=n.update(O),B=O.material;if(B&&B.isMultiMaterial)for(var G=F.groups,H=B.materials,V=0,k=G.length;V<k;V++){var j=G[V],W=H[j.materialIndex];if(W.visible===!0){var X=s(O,W,o,x);t.renderBufferDirect(M,null,F,X,O,j)}}else{var X=s(O,B,o,x);t.renderBufferDirect(M,null,F,X,O,null)}}}}else console.warn("THREE.WebGLShadowMap:",b,"has no shadow.")}var Y=t.getClearColor(),q=t.getClearAlpha();t.setClearColor(Y,q),z.needsUpdate=!1}}}function at(t,e){this.origin=void 0!==t?t:new c,this.direction=void 0!==e?e:new c}function ot(t,e,i,n){this._x=t||0,this._y=e||0,this._z=i||0,this._order=n||ot.DefaultOrder}function st(){this.mask=1}function ct(){function t(){r.setFromEuler(n,!1)}function e(){n.setFromQuaternion(r,void 0,!1)}Object.defineProperty(this,"id",{value:ch++}),this.uuid=Qo.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ct.DefaultUp.clone();var i=new c,n=new ot,r=new s,a=new c(1,1,1);n.onChange(t),r.onChange(e),Object.defineProperties(this,{position:{enumerable:!0,value:i},rotation:{enumerable:!0,value:n},quaternion:{enumerable:!0,value:r},scale:{enumerable:!0,value:a},modelViewMatrix:{value:new h},normalMatrix:{value:new et}}),this.matrix=new h,this.matrixWorld=new h,this.matrixAutoUpdate=ct.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new st,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={},this.onBeforeRender=function(){},this.onAfterRender=function(){}}function ht(t,e){this.start=void 0!==t?t:new c,this.end=void 0!==e?e:new c}function lt(t,e,i){this.a=void 0!==t?t:new c,this.b=void 0!==e?e:new c,this.c=void 0!==i?i:new c}function ut(t,e,i,n,r,a){this.a=t,this.b=e,this.c=i,this.normal=n&&n.isVector3?n:new c,this.vertexNormals=Array.isArray(n)?n:[],this.color=r&&r.isColor?r:new W,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==a?a:0}function pt(t){J.call(this),this.type="MeshBasicMaterial",this.color=new W(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ta,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(t)}function dt(t,e,i){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=Qo.generateUUID(),this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=i===!0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function ft(t,e){dt.call(this,new Int8Array(t),e)}function mt(t,e){dt.call(this,new Uint8Array(t),e)}function gt(t,e){dt.call(this,new Uint8ClampedArray(t),e)}function vt(t,e){dt.call(this,new Int16Array(t),e)}function yt(t,e){dt.call(this,new Uint16Array(t),e)}function xt(t,e){dt.call(this,new Int32Array(t),e)}function _t(t,e){dt.call(this,new Uint32Array(t),e)}function bt(t,e){dt.call(this,new Float32Array(t),e)}function wt(t,e){dt.call(this,new Float64Array(t),e)}function Mt(){this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Et(){Object.defineProperty(this,"id",{value:Tt()}),this.uuid=Qo.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function Tt(){return hh++}function St(){Object.defineProperty(this,"id",{value:Tt()}),this.uuid=Qo.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}}function At(t,e){ct.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new St,this.material=void 0!==e?e:new pt({color:16777215*Math.random()}),this.drawMode=zo,this.updateMorphTargets()}function Lt(t,e,i,n,r,a){function o(t,e,i){var n=0;return n+=(t+1)*(e+1)*2,n+=(t+1)*(i+1)*2,n+=(i+1)*(e+1)*2}function s(t,e,i){var n=0;return n+=t*e*2,n+=t*i*2,n+=i*e*2,6*n}function h(t,e,i,n,r,a,o,s,h,u,p){for(var w=a/h,M=o/u,E=a/2,T=o/2,S=s/2,A=h+1,L=u+1,R=0,P=0,C=new c,I=0;I<L;I++)for(var U=I*M-T,N=0;N<A;N++){var D=N*w-E;C[t]=D*n,C[e]=U*r,C[i]=S,f[v]=C.x,f[v+1]=C.y,f[v+2]=C.z,C[t]=0,C[e]=0,C[i]=s>0?1:-1,m[v]=C.x,m[v+1]=C.y,m[v+2]=C.z,g[y]=N/h,g[y+1]=1-I/u,v+=3,y+=2,R+=1}for(I=0;I<u;I++)for(N=0;N<h;N++){var O=_+N+A*I,F=_+N+A*(I+1),z=_+(N+1)+A*(I+1),B=_+(N+1)+A*I;d[x]=O,d[x+1]=F,d[x+2]=B,d[x+3]=F,d[x+4]=z,d[x+5]=B,x+=6,P+=6}l.addGroup(b,P,p),b+=P,_+=R}St.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:n,heightSegments:r,depthSegments:a};var l=this;n=Math.floor(n)||1,r=Math.floor(r)||1,a=Math.floor(a)||1;var u=o(n,r,a),p=s(n,r,a),d=new(p>65535?Uint32Array:Uint16Array)(p),f=new Float32Array(3*u),m=new Float32Array(3*u),g=new Float32Array(2*u),v=0,y=0,x=0,_=0,b=0;h("z","y","x",-1,-1,i,e,t,a,r,0),h("z","y","x",1,-1,i,e,-t,a,r,1),h("x","z","y",1,1,t,i,e,n,a,2),h("x","z","y",1,-1,t,i,-e,n,a,3),h("x","y","z",1,-1,t,e,i,n,r,4),h("x","y","z",-1,-1,t,e,-i,n,r,5),this.setIndex(new dt(d,1)),this.addAttribute("position",new dt(f,3)),this.addAttribute("normal",new dt(m,3)),this.addAttribute("uv",new dt(g,2))}function Rt(t,e,i,n){St.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:n};for(var r=t/2,a=e/2,o=Math.floor(i)||1,s=Math.floor(n)||1,c=o+1,h=s+1,l=t/o,u=e/s,p=new Float32Array(c*h*3),d=new Float32Array(c*h*3),f=new Float32Array(c*h*2),m=0,g=0,v=0;v<h;v++)for(var y=v*u-a,x=0;x<c;x++){var _=x*l-r;p[m]=_,p[m+1]=-y,d[m+2]=1,f[g]=x/o,f[g+1]=1-v/s,m+=3,g+=2}m=0;for(var b=new(p.length/3>65535?Uint32Array:Uint16Array)(o*s*6),v=0;v<s;v++)for(var x=0;x<o;x++){var w=x+c*v,M=x+c*(v+1),E=x+1+c*(v+1),T=x+1+c*v;b[m]=w,b[m+1]=M,b[m+2]=T,b[m+3]=M,b[m+4]=E,b[m+5]=T,m+=6}this.setIndex(new dt(b,1)),this.addAttribute("position",new dt(p,3)),this.addAttribute("normal",new dt(d,3)),this.addAttribute("uv",new dt(f,2))}function Pt(){ct.call(this),this.type="Camera",this.matrixWorldInverse=new h,this.projectionMatrix=new h}function Ct(t,e,i,n){Pt.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==i?i:.1,this.far=void 0!==n?n:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function It(t,e,i,n,r,a){Pt.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=i,this.bottom=n,this.near=void 0!==r?r:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()}function Ut(t,e,i){function n(t){s=t}function r(i){i.array instanceof Uint32Array&&e.get("OES_element_index_uint")?(c=t.UNSIGNED_INT,h=4):i.array instanceof Uint16Array?(c=t.UNSIGNED_SHORT,h=2):(c=t.UNSIGNED_BYTE,h=1)}function a(e,n){t.drawElements(s,n,c,e*h),i.calls++,i.vertices+=n,s===t.TRIANGLES&&(i.faces+=n/3)}function o(n,r,a){var o=e.get("ANGLE_instanced_arrays");return null===o?void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):(o.drawElementsInstancedANGLE(s,a,c,r*h,n.maxInstancedCount),i.calls++,i.vertices+=a*n.maxInstancedCount,void(s===t.TRIANGLES&&(i.faces+=n.maxInstancedCount*a/3)))}var s,c,h;return{setMode:n,setIndex:r,render:a,renderInstances:o}}function Nt(t,e,i){function n(t){o=t}function r(e,n){t.drawArrays(o,e,n),i.calls++,i.vertices+=n,o===t.TRIANGLES&&(i.faces+=n/3)}function a(n){var r=e.get("ANGLE_instanced_arrays");if(null===r)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");var a=n.attributes.position,s=0;a.isInterleavedBufferAttribute?(s=a.data.count,r.drawArraysInstancedANGLE(o,0,s,n.maxInstancedCount)):(s=a.count,r.drawArraysInstancedANGLE(o,0,s,n.maxInstancedCount)),i.calls++,i.vertices+=s*n.maxInstancedCount,o===t.TRIANGLES&&(i.faces+=n.maxInstancedCount*s/3)}var o;return{setMode:n,render:r,renderInstances:a}}function Dt(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":n={direction:new c,color:new W,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new i};break;case"SpotLight":n={position:new c,direction:new c,color:new W,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new i};break;case"PointLight":n={position:new c,color:new W,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new i};break;
case"HemisphereLight":n={direction:new c,skyColor:new W,groundColor:new W};break;case"RectAreaLight":n={color:new W,position:new c,halfWidth:new c,halfHeight:new c}}return t[e.id]=n,n}}}function Ot(t){for(var e=t.split("\n"),i=0;i<e.length;i++)e[i]=i+1+": "+e[i];return e.join("\n")}function Ft(t,e,i){var n=t.createShader(e);return t.shaderSource(n,i),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)===!1&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(n)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e===t.VERTEX_SHADER?"vertex":"fragment",t.getShaderInfoLog(n),Ot(i)),n}function zt(t){switch(t){case Ho:return["Linear","( value )"];case Vo:return["sRGB","( value )"];case jo:return["RGBE","( value )"];case Xo:return["RGBM","( value, 7.0 )"];case Yo:return["RGBM","( value, 16.0 )"];case qo:return["RGBD","( value, 256.0 )"];case ko:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+t)}}function Bt(t,e){var i=zt(e);return"vec4 "+t+"( vec4 value ) { return "+i[0]+"ToLinear"+i[1]+"; }"}function Gt(t,e){var i=zt(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function Ht(t,e){var i;switch(e){case Ra:i="Linear";break;case Pa:i="Reinhard";break;case Ca:i="Uncharted2";break;case Ia:i="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function Vt(t,e,i){t=t||{};var n=[t.derivatives||e.envMapCubeUV||e.bumpMap||e.normalMap||e.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(t.fragDepth||e.logarithmicDepthBuffer)&&i.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",t.drawBuffers&&i.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(t.shaderTextureLOD||e.envMap)&&i.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""];return n.filter(Wt).join("\n")}function kt(t){var e=[];for(var i in t){var n=t[i];n!==!1&&e.push("#define "+i+" "+n)}return e.join("\n")}function jt(t,e,i){for(var n={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),a=0;a<r;a++){var o=t.getActiveAttrib(e,a),s=o.name;n[s]=t.getAttribLocation(e,s)}return n}function Wt(t){return""!==t}function Xt(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function Yt(t){function e(t,e){var i=nh[e];if(void 0===i)throw new Error("Can not resolve #include <"+e+">");return Yt(i)}var i=/#include +<([\w\d.]+)>/g;return t.replace(i,e)}function qt(t){function e(t,e,i,n){for(var r="",a=parseInt(e);a<parseInt(i);a++)r+=n.replace(/\[ i \]/g,"[ "+a+" ]");return r}var i=/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;return t.replace(i,e)}function Zt(t,e,i,n){var r=t.context,a=i.extensions,o=i.defines,s=i.__webglShader.vertexShader,c=i.__webglShader.fragmentShader,h="SHADOWMAP_TYPE_BASIC";n.shadowMapType===zr?h="SHADOWMAP_TYPE_PCF":n.shadowMapType===Br&&(h="SHADOWMAP_TYPE_PCF_SOFT");var l="ENVMAP_TYPE_CUBE",u="ENVMAP_MODE_REFLECTION",p="ENVMAP_BLENDING_MULTIPLY";if(n.envMap){switch(i.envMap.mapping){case Na:case Da:l="ENVMAP_TYPE_CUBE";break;case Ba:case Ga:l="ENVMAP_TYPE_CUBE_UV";break;case Oa:case Fa:l="ENVMAP_TYPE_EQUIREC";break;case za:l="ENVMAP_TYPE_SPHERE"}switch(i.envMap.mapping){case Da:case Fa:u="ENVMAP_MODE_REFRACTION"}switch(i.combine){case Ta:p="ENVMAP_BLENDING_MULTIPLY";break;case Sa:p="ENVMAP_BLENDING_MIX";break;case Aa:p="ENVMAP_BLENDING_ADD"}}var d,f,m=t.gammaFactor>0?t.gammaFactor:1,g=Vt(a,n,t.extensions),v=kt(o),y=r.createProgram();i.isRawShaderMaterial?(d=[v,"\n"].filter(Wt).join("\n"),f=[g,v,"\n"].filter(Wt).join("\n")):(d=["precision "+n.precision+" float;","precision "+n.precision+" int;","#define SHADER_NAME "+i.__webglShader.name,v,n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+m,"#define MAX_BONES "+n.maxBones,n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.vertexColors?"#define USE_COLOR":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+n.numClippingPlanes,n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+h:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&t.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Wt).join("\n"),f=[g,"precision "+n.precision+" float;","precision "+n.precision+" int;","#define SHADER_NAME "+i.__webglShader.name,v,n.alphaTest?"#define ALPHATEST "+n.alphaTest:"","#define GAMMA_FACTOR "+m,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+l:"",n.envMap?"#define "+u:"",n.envMap?"#define "+p:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.vertexColors?"#define USE_COLOR":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+n.numClippingPlanes,"#define UNION_CLIPPING_PLANES "+(n.numClippingPlanes-n.numClipIntersection),n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+h:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&t.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",n.envMap&&t.extensions.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",n.toneMapping!==La?"#define TONE_MAPPING":"",n.toneMapping!==La?nh.tonemapping_pars_fragment:"",n.toneMapping!==La?Ht("toneMapping",n.toneMapping):"",n.outputEncoding||n.mapEncoding||n.envMapEncoding||n.emissiveMapEncoding?nh.encodings_pars_fragment:"",n.mapEncoding?Bt("mapTexelToLinear",n.mapEncoding):"",n.envMapEncoding?Bt("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMapEncoding?Bt("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.outputEncoding?Gt("linearToOutputTexel",n.outputEncoding):"",n.depthPacking?"#define DEPTH_PACKING "+i.depthPacking:"","\n"].filter(Wt).join("\n")),s=Yt(s,n),s=Xt(s,n),c=Yt(c,n),c=Xt(c,n),i.isShaderMaterial||(s=qt(s),c=qt(c));var x=d+s,_=f+c,b=Ft(r,r.VERTEX_SHADER,x),w=Ft(r,r.FRAGMENT_SHADER,_);r.attachShader(y,b),r.attachShader(y,w),void 0!==i.index0AttributeName?r.bindAttribLocation(y,0,i.index0AttributeName):n.morphTargets===!0&&r.bindAttribLocation(y,0,"position"),r.linkProgram(y);var M=r.getProgramInfoLog(y),E=r.getShaderInfoLog(b),T=r.getShaderInfoLog(w),S=!0,A=!0;r.getProgramParameter(y,r.LINK_STATUS)===!1?(S=!1,console.error("THREE.WebGLProgram: shader error: ",r.getError(),"gl.VALIDATE_STATUS",r.getProgramParameter(y,r.VALIDATE_STATUS),"gl.getProgramInfoLog",M,E,T)):""!==M?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",M):""!==E&&""!==T||(A=!1),A&&(this.diagnostics={runnable:S,material:i,programLog:M,vertexShader:{log:E,prefix:d},fragmentShader:{log:T,prefix:f}}),r.deleteShader(b),r.deleteShader(w);var L;this.getUniforms=function(){return void 0===L&&(L=new j(r,y,t)),L};var R;return this.getAttributes=function(){return void 0===R&&(R=jt(r,y)),R},this.destroy=function(){r.deleteProgram(y),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=lh++,this.code=e,this.usedTimes=1,this.program=y,this.vertexShader=b,this.fragmentShader=w,this}function Jt(t,e){function i(t){if(e.floatVertexTextures&&t&&t.skeleton&&t.skeleton.useVertexTexture)return 1024;var i=e.maxVertexUniforms,n=Math.floor((i-20)/4),r=n;return void 0!==t&&t&&t.isSkinnedMesh&&(r=Math.min(t.skeleton.bones.length,r),r<t.skeleton.bones.length&&console.warn("WebGLRenderer: too many bones - "+t.skeleton.bones.length+", this GPU supports just "+r+" (try OpenGL instead of ANGLE)")),r}function n(t,e){var i;return t?t.isTexture?i=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),i=t.texture.encoding):i=Ho,i===Ho&&e&&(i=ko),i}var r=[],a={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},o=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking"];this.getParameters=function(r,o,s,c,h,l){var u=a[r.type],p=i(l),d=t.getPrecision();null!==r.precision&&(d=e.getMaxPrecision(r.precision),d!==r.precision&&console.warn("THREE.WebGLProgram.getParameters:",r.precision,"not supported, using",d,"instead."));var f=t.getCurrentRenderTarget(),m={shaderID:u,precision:d,supportsVertexTextures:e.vertexTextures,outputEncoding:n(f?f.texture:null,t.gammaOutput),map:!!r.map,mapEncoding:n(r.map,t.gammaInput),envMap:!!r.envMap,envMapMode:r.envMap&&r.envMap.mapping,envMapEncoding:n(r.envMap,t.gammaInput),envMapCubeUV:!!r.envMap&&(r.envMap.mapping===Ba||r.envMap.mapping===Ga),lightMap:!!r.lightMap,aoMap:!!r.aoMap,emissiveMap:!!r.emissiveMap,emissiveMapEncoding:n(r.emissiveMap,t.gammaInput),bumpMap:!!r.bumpMap,normalMap:!!r.normalMap,displacementMap:!!r.displacementMap,roughnessMap:!!r.roughnessMap,metalnessMap:!!r.metalnessMap,specularMap:!!r.specularMap,alphaMap:!!r.alphaMap,gradientMap:!!r.gradientMap,combine:r.combine,vertexColors:r.vertexColors,fog:!!s,useFog:r.fog,fogExp:s&&s.isFogExp2,flatShading:r.shading===kr,sizeAttenuation:r.sizeAttenuation,logarithmicDepthBuffer:e.logarithmicDepthBuffer,skinning:r.skinning,maxBones:p,useVertexTexture:e.floatVertexTextures&&l&&l.skeleton&&l.skeleton.useVertexTexture,morphTargets:r.morphTargets,morphNormals:r.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numClippingPlanes:c,numClipIntersection:h,shadowMapEnabled:t.shadowMap.enabled&&l.receiveShadow&&o.shadows.length>0,shadowMapType:t.shadowMap.type,toneMapping:t.toneMapping,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:r.premultipliedAlpha,alphaTest:r.alphaTest,doubleSided:r.side===Vr,flipSided:r.side===Hr,depthPacking:void 0!==r.depthPacking&&r.depthPacking};return m},this.getProgramCode=function(t,e){var i=[];if(e.shaderID?i.push(e.shaderID):(i.push(t.fragmentShader),i.push(t.vertexShader)),void 0!==t.defines)for(var n in t.defines)i.push(n),i.push(t.defines[n]);for(var r=0;r<o.length;r++)i.push(e[o[r]]);return i.join()},this.acquireProgram=function(e,i,n){for(var a,o=0,s=r.length;o<s;o++){var c=r[o];if(c.code===n){a=c,++a.usedTimes;break}}return void 0===a&&(a=new Zt(t,n,e,i),r.push(a)),a},this.releaseProgram=function(t){if(0===--t.usedTimes){var e=r.indexOf(t);r[e]=r[r.length-1],r.pop(),t.destroy()}},this.programs=r}function Qt(t,e,i){function n(t){var r=t.target,s=c[r.id];null!==s.index&&a(s.index),o(s.attributes),r.removeEventListener("dispose",n),delete c[r.id];var h=e.get(r);h.wireframe&&a(h.wireframe),e.delete(r);var l=e.get(s);l.wireframe&&a(l.wireframe),e.delete(s),i.memory.geometries--}function r(t){return t.isInterleavedBufferAttribute?e.get(t.data).__webglBuffer:e.get(t).__webglBuffer}function a(e){var i=r(e);void 0!==i&&(t.deleteBuffer(i),s(e))}function o(t){for(var e in t)a(t[e])}function s(t){t.isInterleavedBufferAttribute?e.delete(t.data):e.delete(t)}var c={};return{get:function(t){var e=t.geometry;if(void 0!==c[e.id])return c[e.id];e.addEventListener("dispose",n);var r;return e.isBufferGeometry?r=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new St).setFromObject(t)),r=e._bufferGeometry),c[e.id]=r,i.memory.geometries++,r}}}function Kt(t,e,i){function n(e){var i=l.get(e);e.geometry.isGeometry&&i.updateFromObject(e);var n=i.index,a=i.attributes;null!==n&&r(n,t.ELEMENT_ARRAY_BUFFER);for(var o in a)r(a[o],t.ARRAY_BUFFER);var s=i.morphAttributes;for(var o in s)for(var c=s[o],h=0,u=c.length;h<u;h++)r(c[h],t.ARRAY_BUFFER);return i}function r(t,i){var n=t.isInterleavedBufferAttribute?t.data:t,r=e.get(n);void 0===r.__webglBuffer?a(r,n,i):r.version!==n.version&&o(r,n,i)}function a(e,i,n){e.__webglBuffer=t.createBuffer(),t.bindBuffer(n,e.__webglBuffer);var r=i.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW;t.bufferData(n,i.array,r);var a=t.FLOAT,o=i.array;o instanceof Float32Array?a=t.FLOAT:o instanceof Float64Array?console.warn("Unsupported data buffer format: Float64Array"):o instanceof Uint16Array?a=t.UNSIGNED_SHORT:o instanceof Int16Array?a=t.SHORT:o instanceof Uint32Array?a=t.UNSIGNED_INT:o instanceof Int32Array?a=t.INT:o instanceof Int8Array?a=t.BYTE:o instanceof Uint8Array&&(a=t.UNSIGNED_BYTE),e.bytesPerElement=o.BYTES_PER_ELEMENT,e.type=a,e.version=i.version,i.onUploadCallback()}function o(e,i,n){t.bindBuffer(n,e.__webglBuffer),i.dynamic===!1?t.bufferData(n,i.array,t.STATIC_DRAW):i.updateRange.count===-1?t.bufferSubData(n,0,i.array):0===i.updateRange.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(n,i.updateRange.offset*i.array.BYTES_PER_ELEMENT,i.array.subarray(i.updateRange.offset,i.updateRange.offset+i.updateRange.count)),i.updateRange.count=0),e.version=i.version}function s(t){return t.isInterleavedBufferAttribute?e.get(t.data).__webglBuffer:e.get(t).__webglBuffer}function c(t){return t.isInterleavedBufferAttribute?e.get(t.data):e.get(t)}function h(i){var n=e.get(i);if(void 0!==n.wireframe)return n.wireframe;var a=[],o=i.index,s=i.attributes,c=s.position;if(null!==o)for(var h=o.array,l=0,u=h.length;l<u;l+=3){var p=h[l+0],d=h[l+1],f=h[l+2];a.push(p,d,d,f,f,p)}else for(var h=s.position.array,l=0,u=h.length/3-1;l<u;l+=3){var p=l+0,d=l+1,f=l+2;a.push(p,d,d,f,f,p)}var m=c.count>65535?Uint32Array:Uint16Array,g=new dt(new m(a),1);return r(g,t.ELEMENT_ARRAY_BUFFER),n.wireframe=g,g}var l=new Qt(t,e,i);return{getAttributeBuffer:s,getAttributeProperties:c,getWireframeAttribute:h,update:n}}function $t(t,e,i,n,r,a,o){function s(t,e){if(t.width>e||t.height>e){var i=e/Math.max(t.width,t.height),n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");n.width=Math.floor(t.width*i),n.height=Math.floor(t.height*i);var r=n.getContext("2d");return r.drawImage(t,0,0,t.width,t.height,0,0,n.width,n.height),console.warn("THREE.WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+n.width+"x"+n.height,t),n}return t}function c(t){return Qo.isPowerOfTwo(t.width)&&Qo.isPowerOfTwo(t.height)}function h(t){if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement){var e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");e.width=Qo.nearestPowerOfTwo(t.width),e.height=Qo.nearestPowerOfTwo(t.height);var i=e.getContext("2d");return i.drawImage(t,0,0,e.width,e.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+t.width+"x"+t.height+"). Resized to "+e.width+"x"+e.height,t),e}return t}function l(t){return t.wrapS!==ka||t.wrapT!==ka||t.minFilter!==Xa&&t.minFilter!==Za}function u(e){return e===Xa||e===Ya||e===qa?t.NEAREST:t.LINEAR}function p(t){var e=t.target;e.removeEventListener("dispose",p),f(e),A.textures--}function d(t){var e=t.target;e.removeEventListener("dispose",d),m(e),A.textures--}function f(e){var i=n.get(e);if(e.image&&i.__image__webglTextureCube)t.deleteTexture(i.__image__webglTextureCube);else{if(void 0===i.__webglInit)return;t.deleteTexture(i.__webglTexture)}n.delete(e)}function m(e){var i=n.get(e),r=n.get(e.texture);if(e){if(void 0!==r.__webglTexture&&t.deleteTexture(r.__webglTexture),e.depthTexture&&e.depthTexture.dispose(),e.isWebGLRenderTargetCube)for(var a=0;a<6;a++)t.deleteFramebuffer(i.__webglFramebuffer[a]),i.__webglDepthbuffer&&t.deleteRenderbuffer(i.__webglDepthbuffer[a]);else t.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&t.deleteRenderbuffer(i.__webglDepthbuffer);n.delete(e.texture),n.delete(e)}}function g(e,r){var a=n.get(e);if(e.version>0&&a.__version!==e.version){var o=e.image;if(void 0===o)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",e);else{if(o.complete!==!1)return void _(a,e,r);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",e)}}i.activeTexture(t.TEXTURE0+r),i.bindTexture(t.TEXTURE_2D,a.__webglTexture)}function v(e,o){var h=n.get(e);if(6===e.image.length)if(e.version>0&&h.__version!==e.version){h.__image__webglTextureCube||(e.addEventListener("dispose",p),h.__image__webglTextureCube=t.createTexture(),A.textures++),i.activeTexture(t.TEXTURE0+o),i.bindTexture(t.TEXTURE_CUBE_MAP,h.__image__webglTextureCube),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var l=e&&e.isCompressedTexture,u=e.image[0]&&e.image[0].isDataTexture,d=[],f=0;f<6;f++)l||u?d[f]=u?e.image[f].image:e.image[f]:d[f]=s(e.image[f],r.maxCubemapSize);var m=d[0],g=c(m),v=a(e.format),y=a(e.type);x(t.TEXTURE_CUBE_MAP,e,g);for(var f=0;f<6;f++)if(l)for(var _,b=d[f].mipmaps,w=0,M=b.length;w<M;w++)_=b[w],e.format!==fo&&e.format!==po?i.getCompressedTextureFormats().indexOf(v)>-1?i.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+f,w,v,_.width,_.height,0,_.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+f,w,v,_.width,_.height,0,v,y,_.data);else u?i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+f,0,v,d[f].width,d[f].height,0,v,y,d[f].data):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+f,0,v,v,y,d[f]);e.generateMipmaps&&g&&t.generateMipmap(t.TEXTURE_CUBE_MAP),h.__version=e.version,e.onUpdate&&e.onUpdate(e)}else i.activeTexture(t.TEXTURE0+o),i.bindTexture(t.TEXTURE_CUBE_MAP,h.__image__webglTextureCube)}function y(e,r){i.activeTexture(t.TEXTURE0+r),i.bindTexture(t.TEXTURE_CUBE_MAP,n.get(e).__webglTexture)}function x(i,o,s){var c;if(s?(t.texParameteri(i,t.TEXTURE_WRAP_S,a(o.wrapS)),t.texParameteri(i,t.TEXTURE_WRAP_T,a(o.wrapT)),t.texParameteri(i,t.TEXTURE_MAG_FILTER,a(o.magFilter)),t.texParameteri(i,t.TEXTURE_MIN_FILTER,a(o.minFilter))):(t.texParameteri(i,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(i,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),o.wrapS===ka&&o.wrapT===ka||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",o),t.texParameteri(i,t.TEXTURE_MAG_FILTER,u(o.magFilter)),t.texParameteri(i,t.TEXTURE_MIN_FILTER,u(o.minFilter)),o.minFilter!==Xa&&o.minFilter!==Za&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",o)),c=e.get("EXT_texture_filter_anisotropic")){if(o.type===ao&&null===e.get("OES_texture_float_linear"))return;if(o.type===oo&&null===e.get("OES_texture_half_float_linear"))return;(o.anisotropy>1||n.get(o).__currentAnisotropy)&&(t.texParameterf(i,c.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,r.getMaxAnisotropy())),n.get(o).__currentAnisotropy=o.anisotropy)}}function _(e,n,o){void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",p),e.__webglTexture=t.createTexture(),A.textures++),i.activeTexture(t.TEXTURE0+o),i.bindTexture(t.TEXTURE_2D,e.__webglTexture),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,n.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,n.unpackAlignment);var u=s(n.image,r.maxTextureSize);l(n)&&c(u)===!1&&(u=h(u));var d=c(u),f=a(n.format),m=a(n.type);x(t.TEXTURE_2D,n,d);var g,v=n.mipmaps;if(n.isDepthTexture){var y=t.DEPTH_COMPONENT;if(n.type===ao){if(!L)throw new Error("Float Depth Texture only supported in WebGL2.0");y=t.DEPTH_COMPONENT32F}else L&&(y=t.DEPTH_COMPONENT16);n.format===yo&&y===t.DEPTH_COMPONENT&&n.type!==io&&n.type!==ro&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),n.type=io,m=a(n.type)),n.format===xo&&(y=t.DEPTH_STENCIL,n.type!==lo&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),n.type=lo,m=a(n.type))),i.texImage2D(t.TEXTURE_2D,0,y,u.width,u.height,0,f,m,null)}else if(n.isDataTexture)if(v.length>0&&d){for(var _=0,b=v.length;_<b;_++)g=v[_],i.texImage2D(t.TEXTURE_2D,_,f,g.width,g.height,0,f,m,g.data);n.generateMipmaps=!1}else i.texImage2D(t.TEXTURE_2D,0,f,u.width,u.height,0,f,m,u.data);else if(n.isCompressedTexture)for(var _=0,b=v.length;_<b;_++)g=v[_],n.format!==fo&&n.format!==po?i.getCompressedTextureFormats().indexOf(f)>-1?i.compressedTexImage2D(t.TEXTURE_2D,_,f,g.width,g.height,0,g.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texImage2D(t.TEXTURE_2D,_,f,g.width,g.height,0,f,m,g.data);else if(v.length>0&&d){for(var _=0,b=v.length;_<b;_++)g=v[_],i.texImage2D(t.TEXTURE_2D,_,f,f,m,g);n.generateMipmaps=!1}else i.texImage2D(t.TEXTURE_2D,0,f,f,m,u);n.generateMipmaps&&d&&t.generateMipmap(t.TEXTURE_2D),e.__version=n.version,n.onUpdate&&n.onUpdate(n)}function b(e,r,o,s){var c=a(r.texture.format),h=a(r.texture.type);i.texImage2D(s,0,c,r.width,r.height,0,c,h,null),t.bindFramebuffer(t.FRAMEBUFFER,e),t.framebufferTexture2D(t.FRAMEBUFFER,o,s,n.get(r.texture).__webglTexture,0),t.bindFramebuffer(t.FRAMEBUFFER,null)}function w(e,i){t.bindRenderbuffer(t.RENDERBUFFER,e),i.depthBuffer&&!i.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,i.width,i.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e)):i.depthBuffer&&i.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,i.width,i.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e)):t.renderbufferStorage(t.RENDERBUFFER,t.RGBA4,i.width,i.height),t.bindRenderbuffer(t.RENDERBUFFER,null)}function M(e,i){var r=i&&i.isWebGLRenderTargetCube;if(r)throw new Error("Depth Texture with cube render targets is not supported!");if(t.bindFramebuffer(t.FRAMEBUFFER,e),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),g(i.depthTexture,0);var a=n.get(i.depthTexture).__webglTexture;if(i.depthTexture.format===yo)t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,a,0);else{if(i.depthTexture.format!==xo)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,a,0)}}function E(e){var i=n.get(e),r=e.isWebGLRenderTargetCube===!0;if(e.depthTexture){if(r)throw new Error("target.depthTexture not supported in Cube render targets");M(i.__webglFramebuffer,e)}else if(r){i.__webglDepthbuffer=[];for(var a=0;a<6;a++)t.bindFramebuffer(t.FRAMEBUFFER,i.__webglFramebuffer[a]),i.__webglDepthbuffer[a]=t.createRenderbuffer(),w(i.__webglDepthbuffer[a],e)}else t.bindFramebuffer(t.FRAMEBUFFER,i.__webglFramebuffer),i.__webglDepthbuffer=t.createRenderbuffer(),w(i.__webglDepthbuffer,e);t.bindFramebuffer(t.FRAMEBUFFER,null)}function T(e){var r=n.get(e),a=n.get(e.texture);e.addEventListener("dispose",d),a.__webglTexture=t.createTexture(),A.textures++;var o=e.isWebGLRenderTargetCube===!0,s=c(e);if(o){r.__webglFramebuffer=[];for(var h=0;h<6;h++)r.__webglFramebuffer[h]=t.createFramebuffer()}else r.__webglFramebuffer=t.createFramebuffer();if(o){i.bindTexture(t.TEXTURE_CUBE_MAP,a.__webglTexture),x(t.TEXTURE_CUBE_MAP,e.texture,s);for(var h=0;h<6;h++)b(r.__webglFramebuffer[h],e,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+h);e.texture.generateMipmaps&&s&&t.generateMipmap(t.TEXTURE_CUBE_MAP),i.bindTexture(t.TEXTURE_CUBE_MAP,null)}else i.bindTexture(t.TEXTURE_2D,a.__webglTexture),x(t.TEXTURE_2D,e.texture,s),b(r.__webglFramebuffer,e,t.COLOR_ATTACHMENT0,t.TEXTURE_2D),e.texture.generateMipmaps&&s&&t.generateMipmap(t.TEXTURE_2D),i.bindTexture(t.TEXTURE_2D,null);e.depthBuffer&&E(e)}function S(e){var r=e.texture;if(r.generateMipmaps&&c(e)&&r.minFilter!==Xa&&r.minFilter!==Za){var a=e&&e.isWebGLRenderTargetCube?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,o=n.get(r).__webglTexture;i.bindTexture(a,o),t.generateMipmap(a),i.bindTexture(a,null)}}var A=o.memory,L="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext;this.setTexture2D=g,this.setTextureCube=v,this.setTextureCubeDynamic=y,this.setupRenderTarget=T,this.updateRenderTargetMipmap=S}function te(){var t={};return{get:function(e){var i=e.uuid,n=t[i];return void 0===n&&(n={},t[i]=n),n},delete:function(e){delete t[e.uuid]},clear:function(){t={}}}}function ee(t,e,i){function n(){var e=!1,i=new r,n=null,a=new r;return{setMask:function(i){n===i||e||(t.colorMask(i,i,i,i),n=i)},setLocked:function(t){e=t},setClear:function(e,n,r,o,s){s===!0&&(e*=o,n*=o,r*=o),i.set(e,n,r,o),a.equals(i)===!1&&(t.clearColor(e,n,r,o),a.copy(i))},reset:function(){e=!1,n=null,a.set(0,0,0,1)}}}function a(){var e=!1,i=null,n=null,r=null;return{setTest:function(e){e?d(t.DEPTH_TEST):f(t.DEPTH_TEST)},setMask:function(n){i===n||e||(t.depthMask(n),i=n)},setFunc:function(e){if(n!==e){if(e)switch(e){case va:t.depthFunc(t.NEVER);break;case ya:t.depthFunc(t.ALWAYS);break;case xa:t.depthFunc(t.LESS);break;case _a:t.depthFunc(t.LEQUAL);break;case ba:t.depthFunc(t.EQUAL);break;case wa:t.depthFunc(t.GEQUAL);break;case Ma:t.depthFunc(t.GREATER);break;case Ea:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}else t.depthFunc(t.LEQUAL);n=e}},setLocked:function(t){e=t},setClear:function(e){r!==e&&(t.clearDepth(e),r=e)},reset:function(){e=!1,i=null,n=null,r=null}}}function o(){var e=!1,i=null,n=null,r=null,a=null,o=null,s=null,c=null,h=null;return{setTest:function(e){e?d(t.STENCIL_TEST):f(t.STENCIL_TEST)},setMask:function(n){i===n||e||(t.stencilMask(n),i=n)},setFunc:function(e,i,o){n===e&&r===i&&a===o||(t.stencilFunc(e,i,o),n=e,r=i,a=o)},setOp:function(e,i,n){o===e&&s===i&&c===n||(t.stencilOp(e,i,n),o=e,s=i,c=n)},setLocked:function(t){e=t},setClear:function(e){h!==e&&(t.clearStencil(e),h=e)},reset:function(){e=!1,i=null,n=null,r=null,a=null,o=null,s=null,c=null,h=null}}}function s(e,i,n){var r=new Uint8Array(4),a=t.createTexture();t.bindTexture(e,a),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST);for(var o=0;o<n;o++)t.texImage2D(i+o,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,r);return a}function c(){z.setClear(0,0,0,1),B.setClear(1),G.setClear(0),d(t.DEPTH_TEST),_(_a),T(!1),S(Ir),d(t.CULL_FACE),d(t.BLEND),g(Zr)}function h(){for(var t=0,e=V.length;t<e;t++)V[t]=0}function l(i){if(V[i]=1,0===k[i]&&(t.enableVertexAttribArray(i),k[i]=1),0!==j[i]){var n=e.get("ANGLE_instanced_arrays");n.vertexAttribDivisorANGLE(i,0),j[i]=0}}function u(e,i,n){V[e]=1,0===k[e]&&(t.enableVertexAttribArray(e),k[e]=1),j[e]!==i&&(n.vertexAttribDivisorANGLE(e,i),j[e]=i)}function p(){for(var e=0,i=k.length;e!==i;++e)k[e]!==V[e]&&(t.disableVertexAttribArray(e),k[e]=0)}function d(e){W[e]!==!0&&(t.enable(e),W[e]=!0)}function f(e){W[e]!==!1&&(t.disable(e),W[e]=!1)}function m(){if(null===X&&(X=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")))for(var i=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),n=0;n<i.length;n++)X.push(i[n]);return X}function g(e,n,r,a,o,s,c,h){e!==qr?d(t.BLEND):f(t.BLEND),e===Y&&h===tt||(e===Jr?h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE,t.ONE,t.ONE)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE)):e===Qr?h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR)):e===Kr?h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR)):h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)),Y=e,tt=h),e===$r?(o=o||n,s=s||r,c=c||a,n===q&&o===Q||(t.blendEquationSeparate(i(n),i(o)),q=n,Q=o),r===Z&&a===J&&s===K&&c===$||(t.blendFuncSeparate(i(r),i(a),i(s),i(c)),Z=r,J=a,K=s,$=c)):(q=null,Z=null,J=null,Q=null,K=null,$=null)}function v(t){z.setMask(t)}function y(t){B.setTest(t)}function x(t){B.setMask(t)}function _(t){B.setFunc(t)}function b(t){G.setTest(t)}function w(t){G.setMask(t)}function M(t,e,i){G.setFunc(t,e,i)}function E(t,e,i){G.setOp(t,e,i);
}function T(e){et!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),et=e)}function S(e){e!==Cr?(d(t.CULL_FACE),e!==it&&(e===Ir?t.cullFace(t.BACK):e===Ur?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):f(t.CULL_FACE),it=e}function A(e){e!==nt&&(ht&&t.lineWidth(e),nt=e)}function L(e,i,n){e?(d(t.POLYGON_OFFSET_FILL),rt===i&&at===n||(t.polygonOffset(i,n),rt=i,at=n)):f(t.POLYGON_OFFSET_FILL)}function R(){return ot}function P(e){ot=e,e?d(t.SCISSOR_TEST):f(t.SCISSOR_TEST)}function C(e){void 0===e&&(e=t.TEXTURE0+st-1),lt!==e&&(t.activeTexture(e),lt=e)}function I(e,i){null===lt&&C();var n=ut[lt];void 0===n&&(n={type:void 0,texture:void 0},ut[lt]=n),n.type===e&&n.texture===i||(t.bindTexture(e,i||ft[e]),n.type=e,n.texture=i)}function U(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error(t)}}function N(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error(t)}}function D(e){pt.equals(e)===!1&&(t.scissor(e.x,e.y,e.z,e.w),pt.copy(e))}function O(e){dt.equals(e)===!1&&(t.viewport(e.x,e.y,e.z,e.w),dt.copy(e))}function F(){for(var e=0;e<k.length;e++)1===k[e]&&(t.disableVertexAttribArray(e),k[e]=0);W={},X=null,lt=null,ut={},Y=null,et=null,it=null,z.reset(),B.reset(),G.reset()}var z=new n,B=new a,G=new o,H=t.getParameter(t.MAX_VERTEX_ATTRIBS),V=new Uint8Array(H),k=new Uint8Array(H),j=new Uint8Array(H),W={},X=null,Y=null,q=null,Z=null,J=null,Q=null,K=null,$=null,tt=!1,et=null,it=null,nt=null,rt=null,at=null,ot=null,st=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),ct=parseFloat(/^WebGL\ ([0-9])/.exec(t.getParameter(t.VERSION))[1]),ht=parseFloat(ct)>=1,lt=null,ut={},pt=new r,dt=new r,ft={};return ft[t.TEXTURE_2D]=s(t.TEXTURE_2D,t.TEXTURE_2D,1),ft[t.TEXTURE_CUBE_MAP]=s(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),{buffers:{color:z,depth:B,stencil:G},init:c,initAttributes:h,enableAttribute:l,enableAttributeAndDivisor:u,disableUnusedAttributes:p,enable:d,disable:f,getCompressedTextureFormats:m,setBlending:g,setColorWrite:v,setDepthTest:y,setDepthWrite:x,setDepthFunc:_,setStencilTest:b,setStencilWrite:w,setStencilFunc:M,setStencilOp:E,setFlipSided:T,setCullFace:S,setLineWidth:A,setPolygonOffset:L,getScissorTest:R,setScissorTest:P,activeTexture:C,bindTexture:I,compressedTexImage2D:U,texImage2D:N,scissor:D,viewport:O,reset:F}}function ie(t,e,i){function n(){if(void 0!==a)return a;var i=e.get("EXT_texture_filter_anisotropic");return a=null!==i?t.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function r(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var a,o=void 0!==i.precision?i.precision:"highp",s=r(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);var c=i.logarithmicDepthBuffer===!0&&!!e.get("EXT_frag_depth"),h=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),l=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),u=t.getParameter(t.MAX_TEXTURE_SIZE),p=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),d=t.getParameter(t.MAX_VERTEX_ATTRIBS),f=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),m=t.getParameter(t.MAX_VARYING_VECTORS),g=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),v=l>0,y=!!e.get("OES_texture_float"),x=v&&y;return{getMaxAnisotropy:n,getMaxPrecision:r,precision:o,logarithmicDepthBuffer:c,maxTextures:h,maxVertexTextures:l,maxTextureSize:u,maxCubemapSize:p,maxAttributes:d,maxVertexUniforms:f,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:v,floatFragmentTextures:y,floatVertexTextures:x}}function ne(t){var e={};return{get:function(i){if(void 0!==e[i])return e[i];var n;switch(i){case"WEBGL_depth_texture":n=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":n=t.getExtension("WEBGL_compressed_texture_etc1");break;default:n=t.getExtension(i)}return null===n&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),e[i]=n,n}}}function re(){function t(){h.value!==n&&(h.value=n,h.needsUpdate=r>0),i.numPlanes=r,i.numIntersection=0}function e(t,e,n,r){var a=null!==t?t.length:0,o=null;if(0!==a){if(o=h.value,r!==!0||null===o){var l=n+4*a,u=e.matrixWorldInverse;c.getNormalMatrix(u),(null===o||o.length<l)&&(o=new Float32Array(l));for(var p=0,d=n;p!==a;++p,d+=4)s.copy(t[p]).applyMatrix4(u,c),s.normal.toArray(o,d),o[d+3]=s.constant}h.value=o,h.needsUpdate=!0}return i.numPlanes=a,o}var i=this,n=null,r=0,a=!1,o=!1,s=new it,c=new et,h={value:null,needsUpdate:!1};this.uniform=h,this.numPlanes=0,this.numIntersection=0,this.init=function(t,i,o){var s=0!==t.length||i||0!==r||a;return a=i,n=e(t,o,0),r=t.length,s},this.beginShadows=function(){o=!0,e(null)},this.endShadows=function(){o=!1,t()},this.setState=function(i,s,c,l,u,p){if(!a||null===i||0===i.length||o&&!c)o?e(null):t();else{var d=o?0:r,f=4*d,m=u.clippingState||null;h.value=m,m=e(i,l,f,p);for(var g=0;g!==f;++g)m[g]=n[g];u.clippingState=m,this.numIntersection=s?this.numPlanes:0,this.numPlanes+=d}}}function ae(t){function e(){return null===dt?Pt:1}function i(){ce.init(),ce.scissor(yt.copy(Ot).multiplyScalar(Pt)),ce.viewport(_t.copy(zt).multiplyScalar(Pt)),ce.buffers.color.setClear(wt.r,wt.g,wt.b,Mt,J)}function n(){ut=null,vt=null,gt="",mt=-1,ce.reset()}function a(t){t.preventDefault(),n(),i(),he.clear()}function o(t){var e=t.target;e.removeEventListener("dispose",o),s(e)}function s(t){l(t),he.delete(t)}function l(t){var e=he.get(t).program;t.program=void 0,void 0!==e&&pe.releaseProgram(e)}function u(t,e,i,n){var r;if(i&&i.isInstancedBufferGeometry&&(r=oe.get("ANGLE_instanced_arrays"),null===r))return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");void 0===n&&(n=0),ce.initAttributes();var a=i.attributes,o=e.getAttributes(),s=t.defaultAttributeValues;for(var c in o){var h=o[c];if(h>=0){var l=a[c];if(void 0!==l){var u=l.normalized,p=l.itemSize,d=ue.getAttributeProperties(l),f=d.__webglBuffer,m=d.type,g=d.bytesPerElement;if(l.isInterleavedBufferAttribute){var v=l.data,y=v.stride,x=l.offset;v&&v.isInstancedInterleavedBuffer?(ce.enableAttributeAndDivisor(h,v.meshPerAttribute,r),void 0===i.maxInstancedCount&&(i.maxInstancedCount=v.meshPerAttribute*v.count)):ce.enableAttribute(h),Qt.bindBuffer(Qt.ARRAY_BUFFER,f),Qt.vertexAttribPointer(h,p,m,u,y*g,(n*y+x)*g)}else l.isInstancedBufferAttribute?(ce.enableAttributeAndDivisor(h,l.meshPerAttribute,r),void 0===i.maxInstancedCount&&(i.maxInstancedCount=l.meshPerAttribute*l.count)):ce.enableAttribute(h),Qt.bindBuffer(Qt.ARRAY_BUFFER,f),Qt.vertexAttribPointer(h,p,m,u,0,n*p*g)}else if(void 0!==s){var _=s[c];if(void 0!==_)switch(_.length){case 2:Qt.vertexAttrib2fv(h,_);break;case 3:Qt.vertexAttrib3fv(h,_);break;case 4:Qt.vertexAttrib4fv(h,_);break;default:Qt.vertexAttrib1fv(h,_)}}}}ce.disableUnusedAttributes()}function p(t,e){return Math.abs(e[0])-Math.abs(t[0])}function d(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.material.program&&e.material.program&&t.material.program!==e.material.program?t.material.program.id-e.material.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function f(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function m(t,e,i,n,r){var a,o;i.transparent?(a=at,o=++ot):(a=et,o=++it);var s=a[o];void 0!==s?(s.id=t.id,s.object=t,s.geometry=e,s.material=i,s.z=Wt.z,s.group=r):(s={id:t.id,object:t,geometry:e,material:i,z:Wt.z,group:r},a.push(s))}function g(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),kt.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),y(kt)}function v(t){return kt.center.set(0,0,0),kt.radius=.7071067811865476,kt.applyMatrix4(t.matrixWorld),y(kt)}function y(t){if(!Bt.intersectsSphere(t))return!1;var e=Gt.numPlanes;if(0===e)return!0;var i=lt.clippingPlanes,n=t.center,r=-t.radius,a=0;do if(i[a].distanceToPoint(n)<r)return!1;while(++a!==e);return!0}function x(t,e){if(t.visible!==!1){var i=0!==(t.layers.mask&e.layers.mask);if(i)if(t.isLight)$.push(t);else if(t.isSprite)t.frustumCulled!==!1&&v(t)!==!0||ct.push(t);else if(t.isLensFlare)ht.push(t);else if(t.isImmediateRenderObject)lt.sortObjects===!0&&(Wt.setFromMatrixPosition(t.matrixWorld),Wt.applyProjection(jt)),m(t,null,t.material,Wt.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),t.frustumCulled===!1||g(t)===!0)){var n=t.material;if(n.visible===!0){lt.sortObjects===!0&&(Wt.setFromMatrixPosition(t.matrixWorld),Wt.applyProjection(jt));var r=ue.update(t);if(n.isMultiMaterial)for(var a=r.groups,o=n.materials,s=0,c=a.length;s<c;s++){var h=a[s],l=o[h.materialIndex];l.visible===!0&&m(t,r,l,Wt.z,h)}else m(t,r,n,Wt.z,null)}}for(var u=t.children,s=0,c=u.length;s<c;s++)x(u[s],e)}}function _(t,e,i,n){for(var r=0,a=t.length;r<a;r++){var o=t[r],s=o.object,c=o.geometry,h=void 0===n?o.material:n,l=o.group;if(s.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,s.matrixWorld),s.normalMatrix.getNormalMatrix(s.modelViewMatrix),s.onBeforeRender(lt,e,i,c,h,l),s.isImmediateRenderObject){w(h);var u=M(i,e.fog,h,s);gt="",s.render(function(t){lt.renderBufferImmediate(t,u,h)})}else lt.renderBufferDirect(i,e.fog,c,h,s,l);s.onAfterRender(lt,e,i,c,h,l)}}function b(t,e,i){var n=he.get(t),r=pe.getParameters(t,qt,e,Gt.numPlanes,Gt.numIntersection,i),a=pe.getProgramCode(t,r),s=n.program,c=!0;if(void 0===s)t.addEventListener("dispose",o);else if(s.code!==a)l(t);else{if(void 0!==r.shaderID)return;c=!1}if(c){if(r.shaderID){var h=oh[r.shaderID];n.__webglShader={name:t.type,uniforms:rs.clone(h.uniforms),vertexShader:h.vertexShader,fragmentShader:h.fragmentShader}}else n.__webglShader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};t.__webglShader=n.__webglShader,s=pe.acquireProgram(t,r,a),n.program=s,t.program=s}var u=s.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(var p=0;p<lt.maxMorphTargets;p++)u["morphTarget"+p]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;for(var p=0;p<lt.maxMorphNormals;p++)u["morphNormal"+p]>=0&&t.numSupportedMorphNormals++}var d=n.__webglShader.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&t.clipping!==!0||(n.numClippingPlanes=Gt.numPlanes,n.numIntersection=Gt.numIntersection,d.clippingPlanes=Gt.uniform),n.fog=e,n.lightsHash=qt.hash,t.lights&&(d.ambientLightColor.value=qt.ambient,d.directionalLights.value=qt.directional,d.spotLights.value=qt.spot,d.rectAreaLights.value=qt.rectArea,d.pointLights.value=qt.point,d.hemisphereLights.value=qt.hemi,d.directionalShadowMap.value=qt.directionalShadowMap,d.directionalShadowMatrix.value=qt.directionalShadowMatrix,d.spotShadowMap.value=qt.spotShadowMap,d.spotShadowMatrix.value=qt.spotShadowMatrix,d.pointShadowMap.value=qt.pointShadowMap,d.pointShadowMatrix.value=qt.pointShadowMatrix);var f=n.program.getUniforms(),m=j.seqWithValue(f.seq,d);n.uniformsList=m}function w(t){t.side===Vr?ce.disable(Qt.CULL_FACE):ce.enable(Qt.CULL_FACE),ce.setFlipSided(t.side===Hr),t.transparent===!0?ce.setBlending(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha):ce.setBlending(qr),ce.setDepthFunc(t.depthFunc),ce.setDepthTest(t.depthTest),ce.setDepthWrite(t.depthWrite),ce.setColorWrite(t.colorWrite),ce.setPolygonOffset(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)}function M(t,e,i,n){bt=0;var r=he.get(i);if(Ht&&(Vt||t!==vt)){var a=t===vt&&i.id===mt;Gt.setState(i.clippingPlanes,i.clipIntersection,i.clipShadows,t,r,a)}i.needsUpdate===!1&&(void 0===r.program?i.needsUpdate=!0:i.fog&&r.fog!==e?i.needsUpdate=!0:i.lights&&r.lightsHash!==qt.hash?i.needsUpdate=!0:void 0===r.numClippingPlanes||r.numClippingPlanes===Gt.numPlanes&&r.numIntersection===Gt.numIntersection||(i.needsUpdate=!0)),i.needsUpdate&&(b(i,e,n),i.needsUpdate=!1);var o=!1,s=!1,c=!1,h=r.program,l=h.getUniforms(),u=r.__webglShader.uniforms;if(h.id!==ut&&(Qt.useProgram(h.program),ut=h.id,o=!0,s=!0,c=!0),i.id!==mt&&(mt=i.id,s=!0),o||t!==vt){if(l.set(Qt,t,"projectionMatrix"),se.logarithmicDepthBuffer&&l.setValue(Qt,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),t!==vt&&(vt=t,s=!0,c=!0),i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshStandardMaterial||i.envMap){var p=l.map.cameraPosition;void 0!==p&&p.setValue(Qt,Wt.setFromMatrixPosition(t.matrixWorld))}(i.isMeshPhongMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.skinning)&&l.setValue(Qt,"viewMatrix",t.matrixWorldInverse),l.set(Qt,lt,"toneMappingExposure"),l.set(Qt,lt,"toneMappingWhitePoint")}if(i.skinning){l.setOptional(Qt,n,"bindMatrix"),l.setOptional(Qt,n,"bindMatrixInverse");var d=n.skeleton;d&&(se.floatVertexTextures&&d.useVertexTexture?(l.set(Qt,d,"boneTexture"),l.set(Qt,d,"boneTextureWidth"),l.set(Qt,d,"boneTextureHeight")):l.setOptional(Qt,d,"boneMatrices"))}return s&&(i.lights&&D(u,c),e&&i.fog&&L(u,e),(i.isMeshBasicMaterial||i.isMeshLambertMaterial||i.isMeshPhongMaterial||i.isMeshStandardMaterial||i.isMeshNormalMaterial||i.isMeshDepthMaterial)&&E(u,i),i.isLineBasicMaterial?T(u,i):i.isLineDashedMaterial?(T(u,i),S(u,i)):i.isPointsMaterial?A(u,i):i.isMeshLambertMaterial?R(u,i):i.isMeshToonMaterial?C(u,i):i.isMeshPhongMaterial?P(u,i):i.isMeshPhysicalMaterial?U(u,i):i.isMeshStandardMaterial?I(u,i):i.isMeshDepthMaterial?i.displacementMap&&(u.displacementMap.value=i.displacementMap,u.displacementScale.value=i.displacementScale,u.displacementBias.value=i.displacementBias):i.isMeshNormalMaterial&&N(u,i),void 0!==u.ltcMat&&(u.ltcMat.value=THREE.UniformsLib.LTC_MAT_TEXTURE),void 0!==u.ltcMag&&(u.ltcMag.value=THREE.UniformsLib.LTC_MAG_TEXTURE),j.upload(Qt,r.uniformsList,u,lt)),l.set(Qt,n,"modelViewMatrix"),l.set(Qt,n,"normalMatrix"),l.setValue(Qt,"modelMatrix",n.matrixWorld),h}function E(t,e){t.opacity.value=e.opacity,t.diffuse.value=e.color,e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),t.map.value=e.map,t.specularMap.value=e.specularMap,t.alphaMap.value=e.alphaMap,e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity);var i;if(e.map?i=e.map:e.specularMap?i=e.specularMap:e.displacementMap?i=e.displacementMap:e.normalMap?i=e.normalMap:e.bumpMap?i=e.bumpMap:e.roughnessMap?i=e.roughnessMap:e.metalnessMap?i=e.metalnessMap:e.alphaMap?i=e.alphaMap:e.emissiveMap&&(i=e.emissiveMap),void 0!==i){i.isWebGLRenderTarget&&(i=i.texture);var n=i.offset,r=i.repeat;t.offsetRepeat.value.set(n.x,n.y,r.x,r.y)}t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap&&e.envMap.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio}function T(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity}function S(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}function A(t,e){if(t.diffuse.value=e.color,t.opacity.value=e.opacity,t.size.value=e.size*Pt,t.scale.value=.5*Tt,t.map.value=e.map,null!==e.map){var i=e.map.offset,n=e.map.repeat;t.offsetRepeat.value.set(i.x,i.y,n.x,n.y)}}function L(t,e){t.fogColor.value=e.color,e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)}function R(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}function P(t,e){t.specular.value=e.specular,t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function C(t,e){P(t,e),e.gradientMap&&(t.gradientMap.value=e.gradientMap)}function I(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}function U(t,e){t.clearCoat.value=e.clearCoat,t.clearCoatRoughness.value=e.clearCoatRoughness,I(t,e)}function N(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function D(t,e){t.ambientLightColor.needsUpdate=e,t.directionalLights.needsUpdate=e,t.pointLights.needsUpdate=e,t.spotLights.needsUpdate=e,t.rectAreaLights.needsUpdate=e,t.hemisphereLights.needsUpdate=e}function O(t){for(var e=0,i=0,n=t.length;i<n;i++){var r=t[i];r.castShadow&&(qt.shadows[e++]=r)}qt.shadows.length=e}function F(t,e){var i,n,r,a,o,s,c,l=0,u=0,p=0,d=e.matrixWorldInverse,f=0,m=0,g=0,v=0,y=0;for(i=0,n=t.length;i<n;i++)if(r=t[i],a=r.color,o=r.intensity,s=r.distance,c=r.shadow&&r.shadow.map?r.shadow.map.texture:null,r.isAmbientLight)l+=a.r*o,u+=a.g*o,p+=a.b*o;else if(r.isDirectionalLight){var x=de.get(r);x.color.copy(r.color).multiplyScalar(r.intensity),x.direction.setFromMatrixPosition(r.matrixWorld),Wt.setFromMatrixPosition(r.target.matrixWorld),x.direction.sub(Wt),x.direction.transformDirection(d),x.shadow=r.castShadow,r.castShadow&&(x.shadowBias=r.shadow.bias,x.shadowRadius=r.shadow.radius,x.shadowMapSize=r.shadow.mapSize),qt.directionalShadowMap[f]=c,qt.directionalShadowMatrix[f]=r.shadow.matrix,qt.directional[f++]=x}else if(r.isSpotLight){var x=de.get(r);x.position.setFromMatrixPosition(r.matrixWorld),x.position.applyMatrix4(d),x.color.copy(a).multiplyScalar(o),x.distance=s,x.direction.setFromMatrixPosition(r.matrixWorld),Wt.setFromMatrixPosition(r.target.matrixWorld),x.direction.sub(Wt),x.direction.transformDirection(d),x.coneCos=Math.cos(r.angle),x.penumbraCos=Math.cos(r.angle*(1-r.penumbra)),x.decay=0===r.distance?0:r.decay,x.shadow=r.castShadow,r.castShadow&&(x.shadowBias=r.shadow.bias,x.shadowRadius=r.shadow.radius,x.shadowMapSize=r.shadow.mapSize),qt.spotShadowMap[g]=c,qt.spotShadowMatrix[g]=r.shadow.matrix,qt.spot[g++]=x}else if(r.isRectAreaLight){var x=de.get(r);x.color.copy(a).multiplyScalar(o/(r.width*r.height)),x.position.setFromMatrixPosition(r.matrixWorld),x.position.applyMatrix4(d),Yt.identity(),Xt.copy(r.matrixWorld),Xt.premultiply(d),Yt.extractRotation(Xt),x.halfWidth.set(.5*r.width,0,0),x.halfHeight.set(0,.5*r.height,0),x.halfWidth.applyMatrix4(Yt),x.halfHeight.applyMatrix4(Yt),qt.rectArea[v++]=x}else if(r.isPointLight){var x=de.get(r);x.position.setFromMatrixPosition(r.matrixWorld),x.position.applyMatrix4(d),x.color.copy(r.color).multiplyScalar(r.intensity),x.distance=r.distance,x.decay=0===r.distance?0:r.decay,x.shadow=r.castShadow,r.castShadow&&(x.shadowBias=r.shadow.bias,x.shadowRadius=r.shadow.radius,x.shadowMapSize=r.shadow.mapSize),qt.pointShadowMap[m]=c,void 0===qt.pointShadowMatrix[m]&&(qt.pointShadowMatrix[m]=new h),Wt.setFromMatrixPosition(r.matrixWorld).negate(),qt.pointShadowMatrix[m].identity().setPosition(Wt),qt.point[m++]=x}else if(r.isHemisphereLight){var x=de.get(r);x.direction.setFromMatrixPosition(r.matrixWorld),x.direction.transformDirection(d),x.direction.normalize(),x.skyColor.copy(r.color).multiplyScalar(o),x.groundColor.copy(r.groundColor).multiplyScalar(o),qt.hemi[y++]=x}qt.ambient[0]=l,qt.ambient[1]=u,qt.ambient[2]=p,qt.directional.length=f,qt.spot.length=g,qt.rectArea.length=v,qt.point.length=m,qt.hemi.length=y,qt.hash=f+","+m+","+g+","+v+","+y+","+qt.shadows.length}function z(){var t=bt;return t>=se.maxTextures&&console.warn("WebGLRenderer: trying to use "+t+" texture units while this GPU supports only "+se.maxTextures),bt+=1,t}function B(t){var e;if(t===Va)return Qt.REPEAT;if(t===ka)return Qt.CLAMP_TO_EDGE;if(t===ja)return Qt.MIRRORED_REPEAT;if(t===Xa)return Qt.NEAREST;if(t===Ya)return Qt.NEAREST_MIPMAP_NEAREST;if(t===qa)return Qt.NEAREST_MIPMAP_LINEAR;if(t===Za)return Qt.LINEAR;if(t===Ja)return Qt.LINEAR_MIPMAP_NEAREST;if(t===Qa)return Qt.LINEAR_MIPMAP_LINEAR;if(t===$a)return Qt.UNSIGNED_BYTE;if(t===so)return Qt.UNSIGNED_SHORT_4_4_4_4;if(t===co)return Qt.UNSIGNED_SHORT_5_5_5_1;if(t===ho)return Qt.UNSIGNED_SHORT_5_6_5;if(t===to)return Qt.BYTE;if(t===eo)return Qt.SHORT;if(t===io)return Qt.UNSIGNED_SHORT;if(t===no)return Qt.INT;if(t===ro)return Qt.UNSIGNED_INT;if(t===ao)return Qt.FLOAT;if(t===oo&&(e=oe.get("OES_texture_half_float"),null!==e))return e.HALF_FLOAT_OES;if(t===uo)return Qt.ALPHA;if(t===po)return Qt.RGB;if(t===fo)return Qt.RGBA;if(t===mo)return Qt.LUMINANCE;if(t===go)return Qt.LUMINANCE_ALPHA;if(t===yo)return Qt.DEPTH_COMPONENT;if(t===xo)return Qt.DEPTH_STENCIL;if(t===ea)return Qt.FUNC_ADD;if(t===ia)return Qt.FUNC_SUBTRACT;if(t===na)return Qt.FUNC_REVERSE_SUBTRACT;if(t===oa)return Qt.ZERO;if(t===sa)return Qt.ONE;if(t===ca)return Qt.SRC_COLOR;if(t===ha)return Qt.ONE_MINUS_SRC_COLOR;if(t===la)return Qt.SRC_ALPHA;if(t===ua)return Qt.ONE_MINUS_SRC_ALPHA;if(t===pa)return Qt.DST_ALPHA;if(t===da)return Qt.ONE_MINUS_DST_ALPHA;if(t===fa)return Qt.DST_COLOR;if(t===ma)return Qt.ONE_MINUS_DST_COLOR;if(t===ga)return Qt.SRC_ALPHA_SATURATE;if((t===_o||t===bo||t===wo||t===Mo)&&(e=oe.get("WEBGL_compressed_texture_s3tc"),null!==e)){if(t===_o)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===bo)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===wo)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===Mo)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((t===Eo||t===To||t===So||t===Ao)&&(e=oe.get("WEBGL_compressed_texture_pvrtc"),null!==e)){if(t===Eo)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===To)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===So)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===Ao)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(t===Lo&&(e=oe.get("WEBGL_compressed_texture_etc1"),null!==e))return e.COMPRESSED_RGB_ETC1_WEBGL;if((t===ra||t===aa)&&(e=oe.get("EXT_blend_minmax"),null!==e)){if(t===ra)return e.MIN_EXT;if(t===aa)return e.MAX_EXT}return t===lo&&(e=oe.get("WEBGL_depth_texture"),null!==e)?e.UNSIGNED_INT_24_8_WEBGL:0}console.log("THREE.WebGLRenderer",Rr),t=t||{};var G=void 0!==t.canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),H=void 0!==t.context?t.context:null,V=void 0!==t.alpha&&t.alpha,k=void 0===t.depth||t.depth,X=void 0===t.stencil||t.stencil,Y=void 0!==t.antialias&&t.antialias,J=void 0===t.premultipliedAlpha||t.premultipliedAlpha,K=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,$=[],et=[],it=-1,at=[],ot=-1,st=new Float32Array(8),ct=[],ht=[];this.domElement=G,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=Ra,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var lt=this,ut=null,dt=null,ft=null,mt=-1,gt="",vt=null,yt=new r,xt=null,_t=new r,bt=0,wt=new W(0),Mt=0,Et=G.width,Tt=G.height,Pt=1,Ot=new r(0,0,Et,Tt),Ft=!1,zt=new r(0,0,Et,Tt),Bt=new nt,Gt=new re,Ht=!1,Vt=!1,kt=new tt,jt=new h,Wt=new c,Xt=new h,Yt=new h,qt={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],shadows:[]},Zt={calls:0,vertices:0,faces:0,points:0};this.info={render:Zt,memory:{geometries:0,textures:0},programs:null};var Qt;try{var ae={alpha:V,depth:k,stencil:X,antialias:Y,premultipliedAlpha:J,preserveDrawingBuffer:K};if(Qt=H||G.getContext("webgl",ae)||G.getContext("experimental-webgl",ae),null===Qt)throw null!==G.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";void 0===Qt.getShaderPrecisionFormat&&(Qt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),G.addEventListener("webglcontextlost",a,!1)}catch(t){console.error("THREE.WebGLRenderer: "+t)}var oe=new ne(Qt);oe.get("WEBGL_depth_texture"),oe.get("OES_texture_float"),oe.get("OES_texture_float_linear"),oe.get("OES_texture_half_float"),oe.get("OES_texture_half_float_linear"),oe.get("OES_standard_derivatives"),oe.get("ANGLE_instanced_arrays"),oe.get("OES_element_index_uint")&&(St.MaxIndex=4294967296);var se=new ie(Qt,oe,t),ce=new ee(Qt,oe,B),he=new te,le=new $t(Qt,oe,ce,he,se,B,this.info),ue=new Kt(Qt,he,this.info),pe=new Jt(this,se),de=new Dt;this.info.programs=pe.programs;var fe=new Nt(Qt,oe,Zt),me=new Ut(Qt,oe,Zt),ge=new It(-1,1,1,-1,0,1),ve=new Ct,ye=new At(new Rt(2,2),new pt({depthTest:!1,depthWrite:!1,fog:!1})),xe=oh.cube,_e=new At(new Lt(5,5,5),new Q({uniforms:xe.uniforms,vertexShader:xe.vertexShader,fragmentShader:xe.fragmentShader,side:Hr,depthTest:!1,depthWrite:!1,fog:!1}));i(),this.context=Qt,this.capabilities=se,this.extensions=oe,this.properties=he,this.state=ce;var be=new rt(this,qt,ue,se);this.shadowMap=be;var we=new Z(this,ct),Me=new q(this,ht);this.getContext=function(){return Qt},this.getContextAttributes=function(){return Qt.getContextAttributes()},this.forceContextLoss=function(){oe.get("WEBGL_lose_context").loseContext()},this.getMaxAnisotropy=function(){return se.getMaxAnisotropy()},this.getPrecision=function(){return se.precision},this.getPixelRatio=function(){return Pt},this.setPixelRatio=function(t){void 0!==t&&(Pt=t,this.setSize(zt.z,zt.w,!1))},this.getSize=function(){return{width:Et,height:Tt}},this.setSize=function(t,e,i){Et=t,Tt=e,G.width=t*Pt,G.height=e*Pt,i!==!1&&(G.style.width=t+"px",G.style.height=e+"px"),this.setViewport(0,0,t,e)},this.setViewport=function(t,e,i,n){ce.viewport(zt.set(t,e,i,n))},this.setScissor=function(t,e,i,n){ce.scissor(Ot.set(t,e,i,n))},this.setScissorTest=function(t){ce.setScissorTest(Ft=t)},this.getClearColor=function(){return wt},this.setClearColor=function(t,e){wt.set(t),Mt=void 0!==e?e:1,ce.buffers.color.setClear(wt.r,wt.g,wt.b,Mt,J)},this.getClearAlpha=function(){return Mt},this.setClearAlpha=function(t){Mt=t,ce.buffers.color.setClear(wt.r,wt.g,wt.b,Mt,J)},this.clear=function(t,e,i){var n=0;(void 0===t||t)&&(n|=Qt.COLOR_BUFFER_BIT),(void 0===e||e)&&(n|=Qt.DEPTH_BUFFER_BIT),(void 0===i||i)&&(n|=Qt.STENCIL_BUFFER_BIT),Qt.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(t,e,i,n){this.setRenderTarget(t),this.clear(e,i,n)},this.resetGLState=n,this.dispose=function(){at=[],ot=-1,et=[],it=-1,G.removeEventListener("webglcontextlost",a,!1)},this.renderBufferImmediate=function(t,e,i){ce.initAttributes();var n=he.get(t);t.hasPositions&&!n.position&&(n.position=Qt.createBuffer()),t.hasNormals&&!n.normal&&(n.normal=Qt.createBuffer()),t.hasUvs&&!n.uv&&(n.uv=Qt.createBuffer()),t.hasColors&&!n.color&&(n.color=Qt.createBuffer());var r=e.getAttributes();if(t.hasPositions&&(Qt.bindBuffer(Qt.ARRAY_BUFFER,n.position),Qt.bufferData(Qt.ARRAY_BUFFER,t.positionArray,Qt.DYNAMIC_DRAW),ce.enableAttribute(r.position),Qt.vertexAttribPointer(r.position,3,Qt.FLOAT,!1,0,0)),t.hasNormals){if(Qt.bindBuffer(Qt.ARRAY_BUFFER,n.normal),!i.isMeshPhongMaterial&&!i.isMeshStandardMaterial&&!i.isMeshNormalMaterial&&i.shading===kr)for(var a=0,o=3*t.count;a<o;a+=9){var s=t.normalArray,c=(s[a+0]+s[a+3]+s[a+6])/3,h=(s[a+1]+s[a+4]+s[a+7])/3,l=(s[a+2]+s[a+5]+s[a+8])/3;s[a+0]=c,s[a+1]=h,s[a+2]=l,s[a+3]=c,s[a+4]=h,s[a+5]=l,s[a+6]=c,s[a+7]=h,s[a+8]=l}Qt.bufferData(Qt.ARRAY_BUFFER,t.normalArray,Qt.DYNAMIC_DRAW),ce.enableAttribute(r.normal),Qt.vertexAttribPointer(r.normal,3,Qt.FLOAT,!1,0,0)}t.hasUvs&&i.map&&(Qt.bindBuffer(Qt.ARRAY_BUFFER,n.uv),Qt.bufferData(Qt.ARRAY_BUFFER,t.uvArray,Qt.DYNAMIC_DRAW),ce.enableAttribute(r.uv),Qt.vertexAttribPointer(r.uv,2,Qt.FLOAT,!1,0,0)),t.hasColors&&i.vertexColors!==Wr&&(Qt.bindBuffer(Qt.ARRAY_BUFFER,n.color),Qt.bufferData(Qt.ARRAY_BUFFER,t.colorArray,Qt.DYNAMIC_DRAW),ce.enableAttribute(r.color),Qt.vertexAttribPointer(r.color,3,Qt.FLOAT,!1,0,0)),ce.disableUnusedAttributes(),Qt.drawArrays(Qt.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,i,n,r,a,o){w(r);var s=M(t,i,r,a),c=!1,h=n.id+"_"+s.id+"_"+r.wireframe;h!==gt&&(gt=h,c=!0);var l=a.morphTargetInfluences;if(void 0!==l){for(var d=[],f=0,m=l.length;f<m;f++){var g=l[f];d.push([g,f])}d.sort(p),d.length>8&&(d.length=8);for(var v=n.morphAttributes,f=0,m=d.length;f<m;f++){var g=d[f];if(st[f]=g[0],0!==g[0]){var y=g[1];r.morphTargets===!0&&v.position&&n.addAttribute("morphTarget"+f,v.position[y]),r.morphNormals===!0&&v.normal&&n.addAttribute("morphNormal"+f,v.normal[y])}else r.morphTargets===!0&&n.removeAttribute("morphTarget"+f),r.morphNormals===!0&&n.removeAttribute("morphNormal"+f)}for(var f=d.length,x=st.length;f<x;f++)st[f]=0;s.getUniforms().setValue(Qt,"morphTargetInfluences",st),c=!0}var y=n.index,_=n.attributes.position,b=1;r.wireframe===!0&&(y=ue.getWireframeAttribute(n),b=2);var E;null!==y?(E=me,E.setIndex(y)):E=fe,c&&(u(r,s,n),null!==y&&Qt.bindBuffer(Qt.ELEMENT_ARRAY_BUFFER,ue.getAttributeBuffer(y)));var T=0;null!==y?T=y.count:void 0!==_&&(T=_.count);var S=n.drawRange.start*b,A=n.drawRange.count*b,L=null!==o?o.start*b:0,R=null!==o?o.count*b:1/0,P=Math.max(S,L),C=Math.min(T,S+A,L+R)-1,I=Math.max(0,C-P+1);if(0!==I){if(a.isMesh)if(r.wireframe===!0)ce.setLineWidth(r.wireframeLinewidth*e()),E.setMode(Qt.LINES);else switch(a.drawMode){case zo:E.setMode(Qt.TRIANGLES);break;case Bo:E.setMode(Qt.TRIANGLE_STRIP);break;case Go:E.setMode(Qt.TRIANGLE_FAN)}else if(a.isLine){var U=r.linewidth;void 0===U&&(U=1),ce.setLineWidth(U*e()),a.isLineSegments?E.setMode(Qt.LINES):E.setMode(Qt.LINE_STRIP)}else a.isPoints&&E.setMode(Qt.POINTS);n&&n.isInstancedBufferGeometry?n.maxInstancedCount>0&&E.renderInstances(n,P,I):E.render(P,I)}},this.render=function(t,e,i,n){if(void 0!==e&&e.isCamera!==!0)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");gt="",mt=-1,vt=null,t.autoUpdate===!0&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),e.matrixWorldInverse.getInverse(e.matrixWorld),jt.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),Bt.setFromMatrix(jt),$.length=0,it=-1,ot=-1,ct.length=0,ht.length=0,Vt=this.localClippingEnabled,Ht=Gt.init(this.clippingPlanes,Vt,e),x(t,e),et.length=it+1,at.length=ot+1,lt.sortObjects===!0&&(et.sort(d),at.sort(f)),Ht&&Gt.beginShadows(),O($),be.render(t,e),F($,e),Ht&&Gt.endShadows(),Zt.calls=0,Zt.vertices=0,Zt.faces=0,Zt.points=0,void 0===i&&(i=null),this.setRenderTarget(i);var r=t.background;if(null===r?ce.buffers.color.setClear(wt.r,wt.g,wt.b,Mt,J):r&&r.isColor&&(ce.buffers.color.setClear(r.r,r.g,r.b,1,J),
n=!0),(this.autoClear||n)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),r&&r.isCubeTexture?(ve.projectionMatrix.copy(e.projectionMatrix),ve.matrixWorld.extractRotation(e.matrixWorld),ve.matrixWorldInverse.getInverse(ve.matrixWorld),_e.material.uniforms.tCube.value=r,_e.modelViewMatrix.multiplyMatrices(ve.matrixWorldInverse,_e.matrixWorld),ue.update(_e),lt.renderBufferDirect(ve,null,_e.geometry,_e.material,_e,null)):r&&r.isTexture&&(ye.material.map=r,ue.update(ye),lt.renderBufferDirect(ge,null,ye.geometry,ye.material,ye,null)),t.overrideMaterial){var a=t.overrideMaterial;_(et,t,e,a),_(at,t,e,a)}else ce.setBlending(qr),_(et,t,e),_(at,t,e);we.render(t,e),Me.render(t,e,_t),i&&le.updateRenderTargetMipmap(i),ce.setDepthTest(!0),ce.setDepthWrite(!0),ce.setColorWrite(!0)},this.setFaceCulling=function(t,e){ce.setCullFace(t),ce.setFlipSided(e===Dr)},this.allocTextureUnit=z,this.setTexture2D=function(){var t=!1;return function(e,i){e&&e.isWebGLRenderTarget&&(t||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),le.setTexture2D(e,i)}}(),this.setTexture=function(){var t=!1;return function(e,i){t||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),t=!0),le.setTexture2D(e,i)}}(),this.setTextureCube=function(){var t=!1;return function(e,i){e&&e.isWebGLRenderTargetCube&&(t||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?le.setTextureCube(e,i):le.setTextureCubeDynamic(e,i)}}(),this.getCurrentRenderTarget=function(){return dt},this.setRenderTarget=function(t){dt=t,t&&void 0===he.get(t).__webglFramebuffer&&le.setupRenderTarget(t);var e,i=t&&t.isWebGLRenderTargetCube;if(t){var n=he.get(t);e=i?n.__webglFramebuffer[t.activeCubeFace]:n.__webglFramebuffer,yt.copy(t.scissor),xt=t.scissorTest,_t.copy(t.viewport)}else e=null,yt.copy(Ot).multiplyScalar(Pt),xt=Ft,_t.copy(zt).multiplyScalar(Pt);if(ft!==e&&(Qt.bindFramebuffer(Qt.FRAMEBUFFER,e),ft=e),ce.scissor(yt),ce.setScissorTest(xt),ce.viewport(_t),i){var r=he.get(t.texture);Qt.framebufferTexture2D(Qt.FRAMEBUFFER,Qt.COLOR_ATTACHMENT0,Qt.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,r.__webglTexture,t.activeMipMapLevel)}},this.readRenderTargetPixels=function(t,e,i,n,r,a){if((t&&t.isWebGLRenderTarget)===!1)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");var o=he.get(t).__webglFramebuffer;if(o){var s=!1;o!==ft&&(Qt.bindFramebuffer(Qt.FRAMEBUFFER,o),s=!0);try{var c=t.texture,h=c.format,l=c.type;if(h!==fo&&B(h)!==Qt.getParameter(Qt.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(l===$a||B(l)===Qt.getParameter(Qt.IMPLEMENTATION_COLOR_READ_TYPE)||l===ao&&(oe.get("OES_texture_float")||oe.get("WEBGL_color_buffer_float"))||l===oo&&oe.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");Qt.checkFramebufferStatus(Qt.FRAMEBUFFER)===Qt.FRAMEBUFFER_COMPLETE?e>=0&&e<=t.width-n&&i>=0&&i<=t.height-r&&Qt.readPixels(e,i,n,r,B(h),B(l),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&Qt.bindFramebuffer(Qt.FRAMEBUFFER,ft)}}}}function oe(t,e){this.name="",this.color=new W(t),this.density=void 0!==e?e:25e-5}function se(t,e,i){this.name="",this.color=new W(t),this.near=void 0!==e?e:1,this.far=void 0!==i?i:1e3}function ce(){ct.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function he(t,e,i,n,r){ct.call(this),this.lensFlares=[],this.positionScreen=new c,this.customUpdateCallback=void 0,void 0!==t&&this.add(t,e,i,n,r)}function le(t){J.call(this),this.type="SpriteMaterial",this.color=new W(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(t)}function ue(t){ct.call(this),this.type="Sprite",this.material=void 0!==t?t:new le}function pe(){ct.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function de(t,e,i){if(this.useVertexTexture=void 0===i||i,this.identityMatrix=new h,t=t||[],this.bones=t.slice(0),this.useVertexTexture){var n=Math.sqrt(4*this.bones.length);n=Qo.nextPowerOfTwo(Math.ceil(n)),n=Math.max(n,4),this.boneTextureWidth=n,this.boneTextureHeight=n,this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new X(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,fo,ao)}else this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[];for(var r=0,a=this.bones.length;r<a;r++)this.boneInverses.push(new h)}}function fe(){ct.call(this),this.type="Bone"}function me(t,e,i){At.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new h,this.bindMatrixInverse=new h;var n=[];if(this.geometry&&void 0!==this.geometry.bones){for(var r,a,o=0,s=this.geometry.bones.length;o<s;++o)a=this.geometry.bones[o],r=new fe,n.push(r),r.name=a.name,r.position.fromArray(a.pos),r.quaternion.fromArray(a.rotq),void 0!==a.scl&&r.scale.fromArray(a.scl);for(var o=0,s=this.geometry.bones.length;o<s;++o)a=this.geometry.bones[o],a.parent!==-1&&null!==a.parent&&void 0!==n[a.parent]?n[a.parent].add(n[o]):this.add(n[o])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new de(n,void 0,i),this.matrixWorld)}function ge(t){J.call(this),this.type="LineBasicMaterial",this.color=new W(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(t)}function ve(t,e,i){return 1===i?(console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new ye(t,e)):(ct.call(this),this.type="Line",this.geometry=void 0!==t?t:new St,void(this.material=void 0!==e?e:new ge({color:16777215*Math.random()})))}function ye(t,e){ve.call(this,t,e),this.type="LineSegments"}function xe(t){J.call(this),this.type="PointsMaterial",this.color=new W(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(t)}function _e(t,e){ct.call(this),this.type="Points",this.geometry=void 0!==t?t:new St,this.material=void 0!==e?e:new xe({color:16777215*Math.random()})}function be(){ct.call(this),this.type="Group"}function we(t,e,i,r,a,o,s,c,h){function l(){requestAnimationFrame(l),t.readyState>=t.HAVE_CURRENT_DATA&&(u.needsUpdate=!0)}n.call(this,t,e,i,r,a,o,s,c,h),this.generateMipmaps=!1;var u=this;l()}function Me(t,e,i,r,a,o,s,c,h,l,u,p){n.call(this,null,o,s,c,h,l,r,a,u,p),this.image={width:e,height:i},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function Ee(t,e,i,r,a,o,s,c,h){n.call(this,t,e,i,r,a,o,s,c,h),this.needsUpdate=!0}function Te(t,e,i,r,a,o,s,c,h,l){if(l=void 0!==l?l:yo,l!==yo&&l!==xo)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&l===yo&&(i=io),void 0===i&&l===xo&&(i=lo),n.call(this,null,r,a,o,s,c,l,i,h),this.image={width:t,height:e},this.magFilter=void 0!==s?s:Xa,this.minFilter=void 0!==c?c:Xa,this.flipY=!1,this.generateMipmaps=!1}function Se(t){function e(t,e){return t-e}St.call(this);var i=[0,0],n={},r=["a","b","c"];if(t&&t.isGeometry){for(var a=t.vertices,o=t.faces,s=0,c=new Uint32Array(6*o.length),h=0,l=o.length;h<l;h++)for(var u=o[h],p=0;p<3;p++){i[0]=u[r[p]],i[1]=u[r[(p+1)%3]],i.sort(e);var d=i.toString();void 0===n[d]&&(c[2*s]=i[0],c[2*s+1]=i[1],n[d]=!0,s++)}for(var f=new Float32Array(2*s*3),h=0,l=s;h<l;h++)for(var p=0;p<2;p++){var m=a[c[2*h+p]],g=6*h+3*p;f[g+0]=m.x,f[g+1]=m.y,f[g+2]=m.z}this.addAttribute("position",new dt(f,3))}else if(t&&t.isBufferGeometry)if(null!==t.index){var v=t.index.array,a=t.attributes.position,y=t.groups,s=0;0===y.length&&t.addGroup(0,v.length);for(var c=new Uint32Array(2*v.length),x=0,_=y.length;x<_;++x)for(var b=y[x],w=b.start,M=b.count,h=w,E=w+M;h<E;h+=3)for(var p=0;p<3;p++){i[0]=v[h+p],i[1]=v[h+(p+1)%3],i.sort(e);var d=i.toString();void 0===n[d]&&(c[2*s]=i[0],c[2*s+1]=i[1],n[d]=!0,s++)}for(var f=new Float32Array(2*s*3),h=0,l=s;h<l;h++)for(var p=0;p<2;p++){var g=6*h+3*p,T=c[2*h+p];f[g+0]=a.getX(T),f[g+1]=a.getY(T),f[g+2]=a.getZ(T)}this.addAttribute("position",new dt(f,3))}else{for(var a=t.attributes.position.array,s=a.length/3,S=s/3,f=new Float32Array(2*s*3),h=0,l=S;h<l;h++)for(var p=0;p<3;p++){var g=18*h+6*p,A=9*h+3*p;f[g+0]=a[A],f[g+1]=a[A+1],f[g+2]=a[A+2];var T=9*h+3*((p+1)%3);f[g+3]=a[T],f[g+4]=a[T+1],f[g+5]=a[T+2]}this.addAttribute("position",new dt(f,3))}}function Ae(t,e,i){St.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:i};var n,r,a,o,s,c=[],h=[],l=e+1;for(n=0;n<=i;n++)for(s=n/i,r=0;r<=e;r++)o=r/e,a=t(o,s),c.push(a.x,a.y,a.z),h.push(o,s);var u,p,d,f,m=[];for(n=0;n<i;n++)for(r=0;r<e;r++)u=n*l+r,p=n*l+r+1,d=(n+1)*l+r+1,f=(n+1)*l+r,m.push(u,p,f),m.push(p,d,f);this.setIndex(new(m.length>65535?_t:yt)(m,1)),this.addAttribute("position",new bt(c,3)),this.addAttribute("uv",new bt(h,2)),this.computeVertexNormals()}function Le(t,e,i){Et.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:i},this.fromBufferGeometry(new Ae(t,e,i)),this.mergeVertices()}function Re(t,e,n,r){function a(t){for(var i=new c,n=new c,r=new c,a=0;a<e.length;a+=3)p(e[a+0],i),p(e[a+1],n),p(e[a+2],r),o(i,n,r,t)}function o(t,e,i,n){var r,a,o=Math.pow(2,n),s=[];for(r=0;r<=o;r++){s[r]=[];var c=t.clone().lerp(i,r/o),h=e.clone().lerp(i,r/o),l=o-r;for(a=0;a<=l;a++)0===a&&r===o?s[r][a]=c:s[r][a]=c.clone().lerp(h,a/l)}for(r=0;r<o;r++)for(a=0;a<2*(o-r)-1;a++){var p=Math.floor(a/2);a%2===0?(u(s[r][p+1]),u(s[r+1][p]),u(s[r][p])):(u(s[r][p+1]),u(s[r+1][p+1]),u(s[r+1][p]))}}function s(t){for(var e=new c,i=0;i<v.length;i+=3)e.x=v[i+0],e.y=v[i+1],e.z=v[i+2],e.normalize().multiplyScalar(t),v[i+0]=e.x,v[i+1]=e.y,v[i+2]=e.z}function h(){for(var t=new c,e=0;e<v.length;e+=3){t.x=v[e+0],t.y=v[e+1],t.z=v[e+2];var i=m(t)/2/Math.PI+.5,n=g(t)/Math.PI+.5;y.push(i,1-n)}d(),l()}function l(){for(var t=0;t<y.length;t+=6){var e=y[t+0],i=y[t+2],n=y[t+4],r=Math.max(e,i,n),a=Math.min(e,i,n);r>.9&&a<.1&&(e<.2&&(y[t+0]+=1),i<.2&&(y[t+2]+=1),n<.2&&(y[t+4]+=1))}}function u(t){v.push(t.x,t.y,t.z)}function p(e,i){var n=3*e;i.x=t[n+0],i.y=t[n+1],i.z=t[n+2]}function d(){for(var t=new c,e=new c,n=new c,r=new c,a=new i,o=new i,s=new i,h=0,l=0;h<v.length;h+=9,l+=6){t.set(v[h+0],v[h+1],v[h+2]),e.set(v[h+3],v[h+4],v[h+5]),n.set(v[h+6],v[h+7],v[h+8]),a.set(y[l+0],y[l+1]),o.set(y[l+2],y[l+3]),s.set(y[l+4],y[l+5]),r.copy(t).add(e).add(n).divideScalar(3);var u=m(r);f(a,l+0,t,u),f(o,l+2,e,u),f(s,l+4,n,u)}}function f(t,e,i,n){n<0&&1===t.x&&(y[e]=t.x-1),0===i.x&&0===i.z&&(y[e]=n/2/Math.PI+.5)}function m(t){return Math.atan2(t.z,-t.x)}function g(t){return Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))}St.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},n=n||1,r=r||0;var v=[],y=[];a(r),s(n),h(),this.addAttribute("position",new bt(v,3)),this.addAttribute("normal",new bt(v.slice(),3)),this.addAttribute("uv",new bt(y,2)),this.normalizeNormals(),this.boundingSphere=new tt(new c,n)}function Pe(t,e){var i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],n=[2,1,0,0,3,2,1,3,0,2,3,1];Re.call(this,i,n,t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Ce(t,e){Et.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Pe(t,e)),this.mergeVertices()}function Ie(t,e){var i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],n=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];Re.call(this,i,n,t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Ue(t,e){Et.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Ie(t,e)),this.mergeVertices()}function Ne(t,e){var i=(1+Math.sqrt(5))/2,n=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];Re.call(this,n,r,t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function De(t,e){Et.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Ne(t,e)),this.mergeVertices()}function Oe(t,e){var i=(1+Math.sqrt(5))/2,n=1/i,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];Re.call(this,r,a,t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Fe(t,e){Et.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Oe(t,e)),this.mergeVertices()}function ze(t,e,i,n){Et.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:i,detail:n},this.fromBufferGeometry(new Re(t,e,i,n)),this.mergeVertices()}function Be(t,e,n,r,a){function o(){for(p=0;p<e;p++)s(p);s(a===!1?e:0),l(),h()}function s(i){var a=t.getPointAt(i/e),o=u.normals[i],s=u.binormals[i];for(d=0;d<=r;d++){var c=d/r*Math.PI*2,h=Math.sin(c),l=-Math.cos(c);m.x=l*o.x+h*s.x,m.y=l*o.y+h*s.y,m.z=l*o.z+h*s.z,m.normalize(),y.push(m.x,m.y,m.z),f.x=a.x+n*m.x,f.y=a.y+n*m.y,f.z=a.z+n*m.z,v.push(f.x,f.y,f.z)}}function h(){for(d=1;d<=e;d++)for(p=1;p<=r;p++){var t=(r+1)*(d-1)+(p-1),i=(r+1)*d+(p-1),n=(r+1)*d+p,a=(r+1)*(d-1)+p;_.push(t,i,a),_.push(i,n,a)}}function l(){for(p=0;p<=e;p++)for(d=0;d<=r;d++)g.x=p/e,g.y=d/r,x.push(g.x,g.y)}St.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:a},e=e||64,n=n||1,r=r||8,a=a||!1;var u=t.computeFrenetFrames(e,a);this.tangents=u.tangents,this.normals=u.normals,this.binormals=u.binormals;var p,d,f=new c,m=new c,g=new i,v=[],y=[],x=[],_=[];o(),this.setIndex(new(_.length>65535?_t:yt)(_,1)),this.addAttribute("position",new bt(v,3)),this.addAttribute("normal",new bt(y,3)),this.addAttribute("uv",new bt(x,2))}function Ge(t,e,i,n,r,a){Et.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:i,radialSegments:n,closed:r},void 0!==a&&console.warn("THREE.TubeGeometry: taper has been removed.");var o=new Be(t,e,i,n,r);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals,this.fromBufferGeometry(o),this.mergeVertices()}function He(t,e,n,r,a,o){function s(t,e,i,n,r){var a=Math.cos(t),o=Math.sin(t),s=i/e*t,c=Math.cos(s);r.x=n*(2+c)*.5*a,r.y=n*(2+c)*o*.5,r.z=n*Math.sin(s)*.5}St.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:a,q:o},t=t||100,e=e||40,n=Math.floor(n)||64,r=Math.floor(r)||8,a=a||2,o=o||3;var h,l,u=(r+1)*(n+1),p=r*n*2*3,d=new dt(new(p>65535?Uint32Array:Uint16Array)(p),1),f=new dt(new Float32Array(3*u),3),m=new dt(new Float32Array(3*u),3),g=new dt(new Float32Array(2*u),2),v=0,y=0,x=new c,_=new c,b=new i,w=new c,M=new c,E=new c,T=new c,S=new c;for(h=0;h<=n;++h){var A=h/n*a*Math.PI*2;for(s(A,a,o,t,w),s(A+.01,a,o,t,M),T.subVectors(M,w),S.addVectors(M,w),E.crossVectors(T,S),S.crossVectors(E,T),E.normalize(),S.normalize(),l=0;l<=r;++l){var L=l/r*Math.PI*2,R=-e*Math.cos(L),P=e*Math.sin(L);x.x=w.x+(R*S.x+P*E.x),x.y=w.y+(R*S.y+P*E.y),x.z=w.z+(R*S.z+P*E.z),f.setXYZ(v,x.x,x.y,x.z),_.subVectors(x,w).normalize(),m.setXYZ(v,_.x,_.y,_.z),b.x=h/n,b.y=l/r,g.setXY(v,b.x,b.y),v++}}for(l=1;l<=n;l++)for(h=1;h<=r;h++){var C=(r+1)*(l-1)+(h-1),I=(r+1)*l+(h-1),U=(r+1)*l+h,N=(r+1)*(l-1)+h;d.setX(y,C),y++,d.setX(y,I),y++,d.setX(y,N),y++,d.setX(y,I),y++,d.setX(y,U),y++,d.setX(y,N),y++}this.setIndex(d),this.addAttribute("position",f),this.addAttribute("normal",m),this.addAttribute("uv",g)}function Ve(t,e,i,n,r,a,o){Et.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:i,radialSegments:n,p:r,q:a},void 0!==o&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new He(t,e,i,n,r,a)),this.mergeVertices()}function ke(t,e,i,n,r){St.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:n,arc:r},t=t||100,e=e||40,i=Math.floor(i)||8,n=Math.floor(n)||6,r=r||2*Math.PI;var a,o,s=(i+1)*(n+1),h=i*n*2*3,l=new(h>65535?Uint32Array:Uint16Array)(h),u=new Float32Array(3*s),p=new Float32Array(3*s),d=new Float32Array(2*s),f=0,m=0,g=0,v=new c,y=new c,x=new c;for(a=0;a<=i;a++)for(o=0;o<=n;o++){var _=o/n*r,b=a/i*Math.PI*2;y.x=(t+e*Math.cos(b))*Math.cos(_),y.y=(t+e*Math.cos(b))*Math.sin(_),y.z=e*Math.sin(b),u[f]=y.x,u[f+1]=y.y,u[f+2]=y.z,v.x=t*Math.cos(_),v.y=t*Math.sin(_),x.subVectors(y,v).normalize(),p[f]=x.x,p[f+1]=x.y,p[f+2]=x.z,d[m]=o/n,d[m+1]=a/i,f+=3,m+=2}for(a=1;a<=i;a++)for(o=1;o<=n;o++){var w=(n+1)*a+o-1,M=(n+1)*(a-1)+o-1,E=(n+1)*(a-1)+o,T=(n+1)*a+o;l[g]=w,l[g+1]=M,l[g+2]=T,l[g+3]=M,l[g+4]=E,l[g+5]=T,g+=6}this.setIndex(new dt(l,1)),this.addAttribute("position",new dt(u,3)),this.addAttribute("normal",new dt(p,3)),this.addAttribute("uv",new dt(d,2))}function je(t,e,i,n,r){Et.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:n,arc:r},this.fromBufferGeometry(new ke(t,e,i,n,r))}function We(t,e){return"undefined"==typeof t?void(t=[]):(Et.call(this),this.type="ExtrudeGeometry",t=Array.isArray(t)?t:[t],this.addShapeList(t,e),void this.computeFaceNormals())}function Xe(t,e){e=e||{};var i=e.font;if((i&&i.isFont)===!1)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Et;var n=i.generateShapes(t,e.size,e.curveSegments);e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),We.call(this,n,e),this.type="TextGeometry"}function Ye(t,e,i,n,r,a,o){St.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:n,phiLength:r,thetaStart:a,thetaLength:o},t=t||50,e=Math.max(3,Math.floor(e)||8),i=Math.max(2,Math.floor(i)||6),n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI,a=void 0!==a?a:0,o=void 0!==o?o:Math.PI;for(var s=a+o,h=(e+1)*(i+1),l=new dt(new Float32Array(3*h),3),u=new dt(new Float32Array(3*h),3),p=new dt(new Float32Array(2*h),2),d=0,f=[],m=new c,g=0;g<=i;g++){for(var v=[],y=g/i,x=0;x<=e;x++){var _=x/e,b=-t*Math.cos(n+_*r)*Math.sin(a+y*o),w=t*Math.cos(a+y*o),M=t*Math.sin(n+_*r)*Math.sin(a+y*o);m.set(b,w,M).normalize(),l.setXYZ(d,b,w,M),u.setXYZ(d,m.x,m.y,m.z),p.setXY(d,_,1-y),v.push(d),d++}f.push(v)}for(var E=[],g=0;g<i;g++)for(var x=0;x<e;x++){var T=f[g][x+1],S=f[g][x],A=f[g+1][x],L=f[g+1][x+1];(0!==g||a>0)&&E.push(T,S,L),(g!==i-1||s<Math.PI)&&E.push(S,A,L)}this.setIndex(new(l.count>65535?_t:yt)(E,1)),this.addAttribute("position",l),this.addAttribute("normal",u),this.addAttribute("uv",p),this.boundingSphere=new tt(new c,t)}function qe(t,e,i,n,r,a,o){Et.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:n,phiLength:r,thetaStart:a,thetaLength:o},this.fromBufferGeometry(new Ye(t,e,i,n,r,a,o))}function Ze(t,e,n,r,a,o){St.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:a,thetaLength:o},t=t||20,e=e||50,a=void 0!==a?a:0,o=void 0!==o?o:2*Math.PI,n=void 0!==n?Math.max(3,n):8,r=void 0!==r?Math.max(1,r):1;var s,h,l,u=(n+1)*(r+1),p=n*r*2*3,d=new dt(new(p>65535?Uint32Array:Uint16Array)(p),1),f=new dt(new Float32Array(3*u),3),m=new dt(new Float32Array(3*u),3),g=new dt(new Float32Array(2*u),2),v=0,y=0,x=t,_=(e-t)/r,b=new c,w=new i;for(h=0;h<=r;h++){for(l=0;l<=n;l++)s=a+l/n*o,b.x=x*Math.cos(s),b.y=x*Math.sin(s),f.setXYZ(v,b.x,b.y,b.z),m.setXYZ(v,0,0,1),w.x=(b.x/e+1)/2,w.y=(b.y/e+1)/2,g.setXY(v,w.x,w.y),v++;x+=_}for(h=0;h<r;h++){var M=h*(n+1);for(l=0;l<n;l++){s=l+M;var E=s,T=s+n+1,S=s+n+2,A=s+1;d.setX(y,E),y++,d.setX(y,T),y++,d.setX(y,S),y++,d.setX(y,E),y++,d.setX(y,S),y++,d.setX(y,A),y++}}this.setIndex(d),this.addAttribute("position",f),this.addAttribute("normal",m),this.addAttribute("uv",g)}function Je(t,e,i,n,r,a){Et.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:i,phiSegments:n,thetaStart:r,thetaLength:a},this.fromBufferGeometry(new Ze(t,e,i,n,r,a))}function Qe(t,e,i,n){Et.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:n},this.fromBufferGeometry(new Rt(t,e,i,n))}function Ke(t,e,n,r){St.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},e=Math.floor(e)||12,n=n||0,r=r||2*Math.PI,r=Qo.clamp(r,0,2*Math.PI);var a,o,s,h=(e+1)*t.length,l=e*t.length*2*3,u=new dt(new(l>65535?Uint32Array:Uint16Array)(l),1),p=new dt(new Float32Array(3*h),3),d=new dt(new Float32Array(2*h),2),f=0,m=0,g=1/e,v=new c,y=new i;for(o=0;o<=e;o++){var x=n+o*g*r,_=Math.sin(x),b=Math.cos(x);for(s=0;s<=t.length-1;s++)v.x=t[s].x*_,v.y=t[s].y,v.z=t[s].x*b,p.setXYZ(f,v.x,v.y,v.z),y.x=o/e,y.y=s/(t.length-1),d.setXY(f,y.x,y.y),f++}for(o=0;o<e;o++)for(s=0;s<t.length-1;s++){a=s+o*t.length;var w=a,M=a+t.length,E=a+t.length+1,T=a+1;u.setX(m,w),m++,u.setX(m,M),m++,u.setX(m,T),m++,u.setX(m,M),m++,u.setX(m,E),m++,u.setX(m,T),m++}if(this.setIndex(u),this.addAttribute("position",p),this.addAttribute("uv",d),this.computeVertexNormals(),r===2*Math.PI){var S=this.attributes.normal.array,A=new c,L=new c,R=new c;for(a=e*t.length*3,o=0,s=0;o<t.length;o++,s+=3)A.x=S[s+0],A.y=S[s+1],A.z=S[s+2],L.x=S[a+s+0],L.y=S[a+s+1],L.z=S[a+s+2],R.addVectors(A,L).normalize(),S[s+0]=S[a+s+0]=R.x,S[s+1]=S[a+s+1]=R.y,S[s+2]=S[a+s+2]=R.z}}function $e(t,e,i,n){Et.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:i,phiLength:n},this.fromBufferGeometry(new Ke(t,e,i,n)),this.mergeVertices()}function ti(t,e){function i(t){var i,s,h,l=n.length/3,u=t.extractPoints(e),p=u.shape,d=u.holes;if(uh.isClockWise(p)===!1)for(p=p.reverse(),i=0,s=d.length;i<s;i++)h=d[i],uh.isClockWise(h)===!0&&(d[i]=h.reverse());var f=uh.triangulateShape(p,d);for(i=0,s=d.length;i<s;i++)h=d[i],p=p.concat(h);for(i=0,s=p.length;i<s;i++){var m=p[i];n.push(m.x,m.y,0),r.push(0,0,1),a.push(m.x,m.y)}for(i=0,s=f.length;i<s;i++){var g=f[i],v=g[0]+l,y=g[1]+l,x=g[2]+l;o.push(v,y,x),c+=3}}St.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;var n=[],r=[],a=[],o=[],s=0,c=0;if(Array.isArray(t)===!1)i(t);else for(var h=0;h<t.length;h++)i(t[h]),this.addGroup(s,c,h),s+=c,c=0;this.setIndex(new(o.length>65535?_t:yt)(o,1)),this.addAttribute("position",new bt(n,3)),this.addAttribute("normal",new bt(r,3)),this.addAttribute("uv",new bt(a,2))}function ei(t,e){Et.call(this),this.type="ShapeGeometry","object"==typeof e&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new ti(t,e)),this.mergeVertices()}function ii(t,e){function i(t,e){return t-e}St.call(this),e=void 0!==e?e:1;var n,r=Math.cos(Qo.DEG2RAD*e),a=[0,0],o={},s=["a","b","c"];t.isBufferGeometry?(n=new Et,n.fromBufferGeometry(t)):n=t.clone(),n.mergeVertices(),n.computeFaceNormals();for(var c=n.vertices,h=n.faces,l=0,u=h.length;l<u;l++)for(var p=h[l],d=0;d<3;d++){a[0]=p[s[d]],a[1]=p[s[(d+1)%3]],a.sort(i);var f=a.toString();void 0===o[f]?o[f]={vert1:a[0],vert2:a[1],face1:l,face2:void 0}:o[f].face2=l}var m=[];for(var f in o){var g=o[f];if(void 0===g.face2||h[g.face1].normal.dot(h[g.face2].normal)<=r){var v=c[g.vert1];m.push(v.x),m.push(v.y),m.push(v.z),v=c[g.vert2],m.push(v.x),m.push(v.y),m.push(v.z)}}this.addAttribute("position",new bt(m,3))}function ni(t,e,n,r,a,o,s,h){function l(){var t=(r+1)*(a+1);return o===!1&&(t+=(r+1)*m+r*m),t}function u(){var t=r*a*2*3;return o===!1&&(t+=r*m*3),t}function p(){var i,o,l=new c,u=new c,p=0,d=(e-t)/n;for(o=0;o<=a;o++){var m=[],g=o/a,v=g*(e-t)+t;for(i=0;i<=r;i++){var A=i/r,L=A*h+s,R=Math.sin(L),P=Math.cos(L);u.x=v*R,u.y=-g*n+T,u.z=v*P,x.setXYZ(w,u.x,u.y,u.z),l.set(R,d,P).normalize(),_.setXYZ(w,l.x,l.y,l.z),b.setXY(w,A,1-g),m.push(w),w++}E.push(m)}for(i=0;i<r;i++)for(o=0;o<a;o++){var C=E[o][i],I=E[o+1][i],U=E[o+1][i+1],N=E[o][i+1];y.setX(M,C),M++,y.setX(M,I),M++,y.setX(M,N),M++,y.setX(M,I),M++,y.setX(M,U),M++,y.setX(M,N),M++,p+=6}f.addGroup(S,p,0),S+=p}function d(n){var a,o,l,u=new i,p=new c,d=0,m=n===!0?t:e,g=n===!0?1:-1;for(o=w,a=1;a<=r;a++)x.setXYZ(w,0,T*g,0),_.setXYZ(w,0,g,0),u.x=.5,u.y=.5,b.setXY(w,u.x,u.y),w++;for(l=w,a=0;a<=r;a++){var v=a/r,E=v*h+s,A=Math.cos(E),L=Math.sin(E);p.x=m*L,p.y=T*g,p.z=m*A,x.setXYZ(w,p.x,p.y,p.z),_.setXYZ(w,0,g,0),u.x=.5*A+.5,u.y=.5*L*g+.5,b.setXY(w,u.x,u.y),w++}for(a=0;a<r;a++){var R=o+a,P=l+a;n===!0?(y.setX(M,P),M++,y.setX(M,P+1),M++,y.setX(M,R),M++):(y.setX(M,P+1),M++,y.setX(M,P),M++,y.setX(M,R),M++),d+=3}f.addGroup(S,d,n===!0?1:2),S+=d}St.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:a,openEnded:o,thetaStart:s,thetaLength:h};var f=this;t=void 0!==t?t:20,e=void 0!==e?e:20,n=void 0!==n?n:100,r=Math.floor(r)||8,a=Math.floor(a)||1,o=void 0!==o&&o,s=void 0!==s?s:0,h=void 0!==h?h:2*Math.PI;var m=0;o===!1&&(t>0&&m++,e>0&&m++);var g=l(),v=u(),y=new dt(new(v>65535?Uint32Array:Uint16Array)(v),1),x=new dt(new Float32Array(3*g),3),_=new dt(new Float32Array(3*g),3),b=new dt(new Float32Array(2*g),2),w=0,M=0,E=[],T=n/2,S=0;p(),o===!1&&(t>0&&d(!0),e>0&&d(!1)),this.setIndex(y),this.addAttribute("position",x),this.addAttribute("normal",_),this.addAttribute("uv",b)}function ri(t,e,i,n,r,a,o,s){Et.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:i,radialSegments:n,heightSegments:r,openEnded:a,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new ni(t,e,i,n,r,a,o,s)),this.mergeVertices()}function ai(t,e,i,n,r,a,o){ri.call(this,0,t,e,i,n,r,a,o),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:a,thetaLength:o}}function oi(t,e,i,n,r,a,o){ni.call(this,0,t,e,i,n,r,a,o),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:a,thetaLength:o}}function si(t,e,i,n){St.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:n},t=t||50,e=void 0!==e?Math.max(3,e):8,i=void 0!==i?i:0,n=void 0!==n?n:2*Math.PI;var r=e+2,a=new Float32Array(3*r),o=new Float32Array(3*r),s=new Float32Array(2*r);o[2]=1,s[0]=.5,s[1]=.5;for(var h=0,l=3,u=2;h<=e;h++,l+=3,u+=2){var p=i+h/e*n;a[l]=t*Math.cos(p),a[l+1]=t*Math.sin(p),o[l+2]=1,s[u]=(a[l]/t+1)/2,s[u+1]=(a[l+1]/t+1)/2}for(var d=[],l=1;l<=e;l++)d.push(l,l+1,0);this.setIndex(new dt(new Uint16Array(d),1)),this.addAttribute("position",new dt(a,3)),this.addAttribute("normal",new dt(o,3)),this.addAttribute("uv",new dt(s,2)),this.boundingSphere=new tt(new c,t)}function ci(t,e,i,n){Et.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:n},this.fromBufferGeometry(new si(t,e,i,n))}function hi(t,e,i,n,r,a){Et.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:n,heightSegments:r,depthSegments:a},this.fromBufferGeometry(new Lt(t,e,i,n,r,a)),this.mergeVertices()}function li(){Q.call(this,{uniforms:rs.merge([ah.lights,{opacity:{value:1}}]),vertexShader:nh.shadow_vert,fragmentShader:nh.shadow_frag}),this.lights=!0,this.transparent=!0,Object.defineProperties(this,{opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms.opacity.value=t}}})}function ui(t){Q.call(this,t),this.type="RawShaderMaterial"}function pi(t){this.uuid=Qo.generateUUID(),this.type="MultiMaterial",this.materials=Array.isArray(t)?t:[],this.visible=!0}function di(t){J.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new W(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new W(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new i(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function fi(t){di.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(t)}function mi(t){J.call(this),this.type="MeshPhongMaterial",this.color=new W(16777215),this.specular=new W(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new W(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new i(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ta,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function gi(t){mi.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(t)}function vi(t){J.call(this,t),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new i(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function yi(t){J.call(this),this.type="MeshLambertMaterial",this.color=new W(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new W(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ta,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function xi(t){J.call(this),this.type="LineDashedMaterial",this.color=new W(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.lights=!1,this.setValues(t)}function _i(t,e,i){var n=this,r=!1,a=0,o=0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=i,this.itemStart=function(t){o++,r===!1&&void 0!==n.onStart&&n.onStart(t,a,o),r=!0},this.itemEnd=function(t){a++,void 0!==n.onProgress&&n.onProgress(t,a,o),a===o&&(r=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(t){void 0!==n.onError&&n.onError(t)}}function bi(t){this.manager=void 0!==t?t:mh;
}function wi(t){this.manager=void 0!==t?t:mh,this._parser=null}function Mi(t){this.manager=void 0!==t?t:mh,this._parser=null}function Ei(t){this.manager=void 0!==t?t:mh}function Ti(t){this.manager=void 0!==t?t:mh}function Si(t){this.manager=void 0!==t?t:mh}function Ai(t,e){ct.call(this),this.type="Light",this.color=new W(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function Li(t,e,i){Ai.call(this,t,i),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(ct.DefaultUp),this.updateMatrix(),this.groundColor=new W(e)}function Ri(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new i(512,512),this.map=null,this.matrix=new h}function Pi(){Ri.call(this,new Ct(50,1,.5,500))}function Ci(t,e,i,n,r,a){Ai.call(this,t,e),this.type="SpotLight",this.position.copy(ct.DefaultUp),this.updateMatrix(),this.target=new ct,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==i?i:0,this.angle=void 0!==n?n:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==a?a:1,this.shadow=new Pi}function Ii(t,e,i,n){Ai.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==i?i:0,this.decay=void 0!==n?n:1,this.shadow=new Ri(new Ct(90,1,.5,500))}function Ui(t){Ri.call(this,new It(-5,5,5,-5,.5,500))}function Ni(t,e){Ai.call(this,t,e),this.type="DirectionalLight",this.position.copy(ct.DefaultUp),this.updateMatrix(),this.target=new ct,this.shadow=new Ui}function Di(t,e){Ai.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function Oi(t,e,i,n){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new e.constructor(i),this.sampleValues=e,this.valueSize=i}function Fi(t,e,i,n){Oi.call(this,t,e,i,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function zi(t,e,i,n){Oi.call(this,t,e,i,n)}function Bi(t,e,i,n){Oi.call(this,t,e,i,n)}function Gi(t,e,i,n){if(void 0===t)throw new Error("track name is undefined");if(void 0===e||0===e.length)throw new Error("no keyframes in track named "+t);this.name=t,this.times=vh.convertArray(e,this.TimeBufferType),this.values=vh.convertArray(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation),this.validate(),this.optimize()}function Hi(t,e,i,n){Gi.call(this,t,e,i,n)}function Vi(t,e,i,n){Oi.call(this,t,e,i,n)}function ki(t,e,i,n){Gi.call(this,t,e,i,n)}function ji(t,e,i,n){Gi.call(this,t,e,i,n)}function Wi(t,e,i,n){Gi.call(this,t,e,i,n)}function Xi(t,e,i){Gi.call(this,t,e,i)}function Yi(t,e,i,n){Gi.call(this,t,e,i,n)}function qi(t,e,i,n){Gi.apply(this,arguments)}function Zi(t,e,i){this.name=t,this.tracks=i,this.duration=void 0!==e?e:-1,this.uuid=Qo.generateUUID(),this.duration<0&&this.resetDuration(),this.optimize()}function Ji(t){this.manager=void 0!==t?t:mh,this.textures={}}function Qi(t){this.manager=void 0!==t?t:mh}function Ki(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}}function $i(t){"boolean"==typeof t&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),t=void 0),this.manager=void 0!==t?t:mh,this.withCredentials=!1}function tn(t){this.manager=void 0!==t?t:mh,this.texturePath=""}function en(){}function nn(t,e){this.v1=t,this.v2=e}function rn(){this.curves=[],this.autoClose=!1}function an(t,e,i,n,r,a,o,s){this.aX=t,this.aY=e,this.xRadius=i,this.yRadius=n,this.aStartAngle=r,this.aEndAngle=a,this.aClockwise=o,this.aRotation=s||0}function on(t){this.points=void 0===t?[]:t}function sn(t,e,i,n){this.v0=t,this.v1=e,this.v2=i,this.v3=n}function cn(t,e,i){this.v0=t,this.v1=e,this.v2=i}function hn(){ln.apply(this,arguments),this.holes=[]}function ln(t){rn.call(this),this.currentPoint=new i,t&&this.fromPoints(t)}function un(){this.subPaths=[],this.currentPath=null}function pn(t){this.data=t}function dn(t){this.manager=void 0!==t?t:mh}function fn(t){this.manager=void 0!==t?t:mh}function mn(t,e,i,n){Ai.call(this,t,e),this.type="RectAreaLight",this.position.set(0,1,0),this.updateMatrix(),this.width=void 0!==i?i:10,this.height=void 0!==n?n:10}function gn(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ct,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ct,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function vn(t,e,i){ct.call(this),this.type="CubeCamera";var n=90,r=1,a=new Ct(n,r,t,e);a.up.set(0,-1,0),a.lookAt(new c(1,0,0)),this.add(a);var s=new Ct(n,r,t,e);s.up.set(0,-1,0),s.lookAt(new c(-1,0,0)),this.add(s);var h=new Ct(n,r,t,e);h.up.set(0,0,1),h.lookAt(new c(0,1,0)),this.add(h);var l=new Ct(n,r,t,e);l.up.set(0,0,-1),l.lookAt(new c(0,-1,0)),this.add(l);var u=new Ct(n,r,t,e);u.up.set(0,-1,0),u.lookAt(new c(0,0,1)),this.add(u);var p=new Ct(n,r,t,e);p.up.set(0,-1,0),p.lookAt(new c(0,0,-1)),this.add(p);var d={format:po,magFilter:Za,minFilter:Za};this.renderTarget=new o(i,i,d),this.updateCubeMap=function(t,e){null===this.parent&&this.updateMatrixWorld();var i=this.renderTarget,n=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,i.activeCubeFace=0,t.render(e,a,i),i.activeCubeFace=1,t.render(e,s,i),i.activeCubeFace=2,t.render(e,h,i),i.activeCubeFace=3,t.render(e,l,i),i.activeCubeFace=4,t.render(e,u,i),i.texture.generateMipmaps=n,i.activeCubeFace=5,t.render(e,p,i),t.setRenderTarget(null)}}function yn(){ct.call(this),this.type="AudioListener",this.context=wh.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function xn(t){ct.call(this),this.type="Audio",this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function _n(t){xn.call(this,t),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function bn(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function wn(t,e,i){this.binding=t,this.valueSize=i;var n,r=Float64Array;switch(e){case"quaternion":n=this._slerp;break;case"string":case"bool":r=Array,n=this._select;break;default:n=this._lerp}this.buffer=new r(4*i),this._mixBufferRegion=n,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function Mn(t,e,i){this.path=e,this.parsedPath=i||Mn.parseTrackName(e),this.node=Mn.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function En(t){this.uuid=Qo.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var i=0,n=arguments.length;i!==n;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}function Tn(t,e,i){this._mixer=t,this._clip=e,this._localRoot=i||null;for(var n=e.tracks,r=n.length,a=new Array(r),o={endingStart:Do,endingEnd:Do},s=0;s!==r;++s){var c=n[s].createInterpolant(null);a[s]=c,c.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(r),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Po,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Sn(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function An(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}function Ln(){St.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function Rn(t,e,i,n){this.uuid=Qo.generateUUID(),this.data=t,this.itemSize=e,this.offset=i,this.normalized=n===!0}function Pn(t,e){this.uuid=Qo.generateUUID(),this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function Cn(t,e,i){Pn.call(this,t,e),this.meshPerAttribute=i||1}function In(t,e,i){dt.call(this,t,e),this.meshPerAttribute=i||1}function Un(t,e,i,n){this.ray=new at(t,e),this.near=i||0,this.far=n||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Nn(t,e){return t.distance-e.distance}function Dn(t,e,i,n){if(t.visible!==!1&&(t.raycast(e,i),n===!0))for(var r=t.children,a=0,o=r.length;a<o;a++)Dn(r[a],e,i,!0)}function On(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function Fn(t){function e(t,e,i,n,r,a,o){var s=.5*(i-t),c=.5*(n-e);return(2*(e-i)+s+c)*o+(-3*(e-i)-2*s-c)*a+s*r+e}this.points=t;var i,n,r,a,o,s,h,l,u,p=[],d={x:0,y:0,z:0};this.initFromArray=function(t){this.points=[];for(var e=0;e<t.length;e++)this.points[e]={x:t[e][0],y:t[e][1],z:t[e][2]}},this.getPoint=function(t){return i=(this.points.length-1)*t,n=Math.floor(i),r=i-n,p[0]=0===n?n:n-1,p[1]=n,p[2]=n>this.points.length-2?this.points.length-1:n+1,p[3]=n>this.points.length-3?this.points.length-1:n+2,s=this.points[p[0]],h=this.points[p[1]],l=this.points[p[2]],u=this.points[p[3]],a=r*r,o=r*a,d.x=e(s.x,h.x,l.x,u.x,r,a,o),d.y=e(s.y,h.y,l.y,u.y,r,a,o),d.z=e(s.z,h.z,l.z,u.z,r,a,o),d},this.getControlPointsArray=function(){var t,e,i=this.points.length,n=[];for(t=0;t<i;t++)e=this.points[t],n[t]=[e.x,e.y,e.z];return n},this.getLength=function(t){var e,i,n,r,a=0,o=0,s=0,h=new c,l=new c,u=[],p=0;for(u[0]=0,t||(t=100),n=this.points.length*t,h.copy(this.points[0]),e=1;e<n;e++)i=e/n,r=this.getPoint(i),l.copy(r),p+=l.distanceTo(h),h.copy(r),a=(this.points.length-1)*i,o=Math.floor(a),o!==s&&(u[o]=p,s=o);return u[u.length]=p,{chunks:u,total:p}},this.reparametrizeByArcLength=function(t){var e,i,n,r,a,o,s,h,l=[],u=new c,p=this.getLength();for(l.push(u.copy(this.points[0]).clone()),e=1;e<this.points.length;e++){for(o=p.chunks[e]-p.chunks[e-1],s=Math.ceil(t*o/p.total),r=(e-1)/(this.points.length-1),a=e/(this.points.length-1),i=1;i<s-1;i++)n=r+i*(1/s)*(a-r),h=this.getPoint(n),l.push(u.copy(h).clone());l.push(u.copy(this.points[e]).clone())}this.points=l}}function zn(t,e,i){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==i?i:0,this}function Bn(t,e,i){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==i?i:0,this}function Gn(t,e){At.call(this,t,e),this.animationsMap={},this.animationsList=[];var i=this.geometry.morphTargets.length,n="__default",r=0,a=i-1,o=i/1;this.createAnimation(n,r,a,o),this.setAnimationWeight(n,1)}function Hn(t){ct.call(this),this.material=t,this.render=function(t){}}function Vn(t,e,i,n){this.object=t,this.size=void 0!==e?e:1;var r=void 0!==i?i:16711680,a=void 0!==n?n:1,o=0,s=this.object.geometry;s&&s.isGeometry?o=3*s.faces.length:s&&s.isBufferGeometry&&(o=s.attributes.normal.count);var c=new St,h=new bt(2*o*3,3);c.addAttribute("position",h),ye.call(this,c,new ge({color:r,linewidth:a})),this.matrixAutoUpdate=!1,this.update()}function kn(t){ct.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1;for(var e=new St,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],n=0,r=1,a=32;n<a;n++,r++){var o=n/a*Math.PI*2,s=r/a*Math.PI*2;i.push(Math.cos(o),Math.sin(o),1,Math.cos(s),Math.sin(s),1)}e.addAttribute("position",new bt(i,3));var c=new ge({fog:!1});this.cone=new ye(e,c),this.add(this.cone),this.update()}function jn(t){this.bones=this.getBoneList(t);for(var e=new St,i=[],n=[],r=new W(0,0,1),a=new W(0,1,0),o=0;o<this.bones.length;o++){var s=this.bones[o];s.parent&&s.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),n.push(r.r,r.g,r.b),n.push(a.r,a.g,a.b))}e.addAttribute("position",new bt(i,3)),e.addAttribute("color",new bt(n,3));var c=new ge({vertexColors:Yr,depthTest:!1,depthWrite:!1,transparent:!0});ye.call(this,e,c),this.root=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Wn(t,e){this.light=t,this.light.updateMatrixWorld();var i=new Ye(e,4,2),n=new pt({wireframe:!0,fog:!1});n.color.copy(this.light.color).multiplyScalar(this.light.intensity),At.call(this,i,n),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1}function Xn(t){ct.call(this),this.light=t,this.light.updateMatrixWorld();var e=new pt({color:t.color,fog:!1}),i=new pt({color:t.color,fog:!1,wireframe:!0}),n=new St;n.addAttribute("position",new dt(new Float32Array(18),3)),this.add(new At(n,e)),this.add(new At(n,i)),this.update()}function Yn(t,e){ct.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1;var i=new Ie(e);i.rotateY(.5*Math.PI);var n=new pt({vertexColors:Yr,wireframe:!0}),r=i.getAttribute("position"),a=new Float32Array(3*r.count);i.addAttribute("color",new dt(a,3)),this.add(new At(i,n)),this.update()}function qn(t,e,i,n){t=t||10,e=e||10,i=new W(void 0!==i?i:4473924),n=new W(void 0!==n?n:8947848);for(var r=e/2,a=2*t/e,o=[],s=[],c=0,h=0,l=-t;c<=e;c++,l+=a){o.push(-t,0,l,t,0,l),o.push(l,0,-t,l,0,t);var u=c===r?i:n;u.toArray(s,h),h+=3,u.toArray(s,h),h+=3,u.toArray(s,h),h+=3,u.toArray(s,h),h+=3}var p=new St;p.addAttribute("position",new bt(o,3)),p.addAttribute("color",new bt(s,3));var d=new ge({vertexColors:Yr});ye.call(this,p,d)}function Zn(t,e,i,n,r,a){t=t||10,e=e||16,i=i||8,n=n||64,r=new W(void 0!==r?r:4473924),a=new W(void 0!==a?a:8947848);var o,s,c,h,l,u,p,d=[],f=[];for(h=0;h<=e;h++)c=h/e*(2*Math.PI),o=Math.sin(c)*t,s=Math.cos(c)*t,d.push(0,0,0),d.push(o,0,s),p=1&h?r:a,f.push(p.r,p.g,p.b),f.push(p.r,p.g,p.b);for(h=0;h<=i;h++)for(p=1&h?r:a,u=t-t/i*h,l=0;l<n;l++)c=l/n*(2*Math.PI),o=Math.sin(c)*u,s=Math.cos(c)*u,d.push(o,0,s),f.push(p.r,p.g,p.b),c=(l+1)/n*(2*Math.PI),o=Math.sin(c)*u,s=Math.cos(c)*u,d.push(o,0,s),f.push(p.r,p.g,p.b);var m=new St;m.addAttribute("position",new bt(d,3)),m.addAttribute("color",new bt(f,3));var g=new ge({vertexColors:Yr});ye.call(this,m,g)}function Jn(t,e,i,n){this.object=t,this.size=void 0!==e?e:1;var r=void 0!==i?i:16776960,a=void 0!==n?n:1,o=0,s=this.object.geometry;s&&s.isGeometry?o=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var c=new St,h=new bt(2*o*3,3);c.addAttribute("position",h),ye.call(this,c,new ge({color:r,linewidth:a})),this.matrixAutoUpdate=!1,this.update()}function Qn(t,e){ct.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,void 0===e&&(e=1);var i=new St;i.addAttribute("position",new bt([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var n=new ge({fog:!1});this.add(new ve(i,n)),i=new St,i.addAttribute("position",new bt([0,0,0,0,0,1],3)),this.add(new ve(i,n)),this.update()}function Kn(t){function e(t,e,n){i(t,n),i(e,n)}function i(t,e){a.push(0,0,0),o.push(e.r,e.g,e.b),void 0===s[t]&&(s[t]=[]),s[t].push(a.length/3-1)}var n=new St,r=new ge({color:16777215,vertexColors:Xr}),a=[],o=[],s={},c=new W(16755200),h=new W(16711680),l=new W(43775),u=new W(16777215),p=new W(3355443);e("n1","n2",c),e("n2","n4",c),e("n4","n3",c),e("n3","n1",c),e("f1","f2",c),e("f2","f4",c),e("f4","f3",c),e("f3","f1",c),e("n1","f1",c),e("n2","f2",c),e("n3","f3",c),e("n4","f4",c),e("p","n1",h),e("p","n2",h),e("p","n3",h),e("p","n4",h),e("u1","u2",l),e("u2","u3",l),e("u3","u1",l),e("c","t",u),e("p","c",p),e("cn1","cn2",p),e("cn3","cn4",p),e("cf1","cf2",p),e("cf3","cf4",p),n.addAttribute("position",new bt(a,3)),n.addAttribute("color",new bt(o,3)),ye.call(this,n,r),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}function $n(t,e){void 0===e&&(e=16776960);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),r=new St;r.setIndex(new dt(i,1)),r.addAttribute("position",new dt(n,3)),ye.call(this,r,new ge({color:e})),void 0!==t&&this.update(t)}function tr(t,e,i,n,r,a){ct.call(this),void 0===n&&(n=16776960),void 0===i&&(i=1),void 0===r&&(r=.2*i),void 0===a&&(a=.2*r),this.position.copy(e),this.line=new ve(Mh,new ge({color:n})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new At(Eh,new pt({color:n})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(i,r,a)}function er(t){t=t||1;var e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],n=new St;n.addAttribute("position",new bt(e,3)),n.addAttribute("color",new bt(i,3));var r=new ge({vertexColors:Yr});ye.call(this,n,r)}function ir(t,e,i,n,r,a){an.call(this,t,e,i,i,n,r,a)}function nr(t,e,i,n,r,a,o){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new ut(t,e,i,r,a,o)}function rr(t){return console.warn("THREE.MeshFaceMaterial has been renamed to THREE.MultiMaterial."),new pi(t)}function ar(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new _e(t,e)}function or(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new ue(t)}function sr(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new _e(t,e)}function cr(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new xe(t)}function hr(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new xe(t)}function lr(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new xe(t)}function ur(t,e,i){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new c(t,e,i)}function pr(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new dt(t,e).setDynamic(!0)}function dr(t,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new ft(t,e)}function fr(t,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new mt(t,e)}function mr(t,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new gt(t,e)}function gr(t,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new vt(t,e)}function vr(t,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new yt(t,e)}function yr(t,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new xt(t,e)}function xr(t,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new _t(t,e)}function _r(t,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new bt(t,e)}function br(t,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new wt(t,e)}function wr(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Th.call(this,t),this.type="catmullrom",this.closed=!0}function Mr(t,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new $n(t,e)}function Er(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new ye(new ii(t.geometry),new ge({color:void 0!==e?e:16777215}))}function Tr(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new ye(new Se(t.geometry),new ge({color:void 0!==e?e:16777215}))}function Sr(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new bi(t)}function Ar(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(t,e){console.warn("THREE.Projector: .projectVector() is now vector.project()."),t.project(e)},this.unprojectVector=function(t,e){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}}function Lr(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),void 0===Function.prototype.name&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&!function(){Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(void 0!==n&&null!==n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}}(),Object.assign(e.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[t]&&(i[t]=[]),i[t].indexOf(e)===-1&&i[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[t]&&i[t].indexOf(e)!==-1},removeEventListener:function(t,e){if(void 0!==this._listeners){var i=this._listeners,n=i[t];if(void 0!==n){var r=n.indexOf(e);r!==-1&&n.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners,i=e[t.type];if(void 0!==i){t.target=this;var n=[],r=0,a=i.length;for(r=0;r<a;r++)n[r]=i[r];for(r=0;r<a;r++)n[r].call(this,t)}}}});var Rr="83",Pr={LEFT:0,MIDDLE:1,RIGHT:2},Cr=0,Ir=1,Ur=2,Nr=3,Dr=0,Or=1,Fr=0,zr=1,Br=2,Gr=0,Hr=1,Vr=2,kr=1,jr=2,Wr=0,Xr=1,Yr=2,qr=0,Zr=1,Jr=2,Qr=3,Kr=4,$r=5,ta={NoBlending:qr,NormalBlending:Zr,AdditiveBlending:Jr,SubtractiveBlending:Qr,MultiplyBlending:Kr,CustomBlending:$r},ea=100,ia=101,na=102,ra=103,aa=104,oa=200,sa=201,ca=202,ha=203,la=204,ua=205,pa=206,da=207,fa=208,ma=209,ga=210,va=0,ya=1,xa=2,_a=3,ba=4,wa=5,Ma=6,Ea=7,Ta=0,Sa=1,Aa=2,La=0,Ra=1,Pa=2,Ca=3,Ia=4,Ua=300,Na=301,Da=302,Oa=303,Fa=304,za=305,Ba=306,Ga=307,Ha={UVMapping:Ua,CubeReflectionMapping:Na,CubeRefractionMapping:Da,EquirectangularReflectionMapping:Oa,EquirectangularRefractionMapping:Fa,SphericalReflectionMapping:za,CubeUVReflectionMapping:Ba,CubeUVRefractionMapping:Ga},Va=1e3,ka=1001,ja=1002,Wa={RepeatWrapping:Va,ClampToEdgeWrapping:ka,MirroredRepeatWrapping:ja},Xa=1003,Ya=1004,qa=1005,Za=1006,Ja=1007,Qa=1008,Ka={NearestFilter:Xa,NearestMipMapNearestFilter:Ya,NearestMipMapLinearFilter:qa,LinearFilter:Za,LinearMipMapNearestFilter:Ja,LinearMipMapLinearFilter:Qa},$a=1009,to=1010,eo=1011,io=1012,no=1013,ro=1014,ao=1015,oo=1016,so=1017,co=1018,ho=1019,lo=1020,uo=1021,po=1022,fo=1023,mo=1024,go=1025,vo=fo,yo=1026,xo=1027,_o=2001,bo=2002,wo=2003,Mo=2004,Eo=2100,To=2101,So=2102,Ao=2103,Lo=2151,Ro=2200,Po=2201,Co=2202,Io=2300,Uo=2301,No=2302,Do=2400,Oo=2401,Fo=2402,zo=0,Bo=1,Go=2,Ho=3e3,Vo=3001,ko=3007,jo=3002,Wo=3003,Xo=3004,Yo=3005,qo=3006,Zo=3200,Jo=3201,Qo={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),i=new Array(36),n=0;return function(){for(var r=0;r<36;r++)8===r||13===r||18===r||23===r?i[r]="-":14===r?i[r]="4":(n<=2&&(n=33554432+16777216*Math.random()|0),t=15&n,n>>=4,i[r]=e[19===r?3&t|8:t]);return i.join("")}}(),clamp:function(t,e,i){return Math.max(e,Math.min(i,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,i,n,r){return n+(t-e)*(r-n)/(i-e)},lerp:function(t,e,i){return(1-i)*t+i*e},smoothstep:function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e),t*t*(3-2*t))},smootherstep:function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e),t*t*t*(t*(6*t-15)+10))},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*Qo.DEG2RAD},radToDeg:function(t){return t*Qo.RAD2DEG},isPowerOfTwo:function(t){return 0===(t&t-1)&&0!==t},nearestPowerOfTwo:function(t){return Math.pow(2,Math.round(Math.log(t)/Math.LN2))},nextPowerOfTwo:function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t++,t}};i.prototype={constructor:i,isVector2:!0,get width(){return this.x},set width(t){this.x=t},get height(){return this.y},set height(t){this.y=t},set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t):(this.x=0,this.y=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(){var t,e;return function(n,r){return void 0===t&&(t=new i,e=new i),t.set(n,n),e.set(r,r),this.clamp(t,e)}}(),clampLength:function(t,e){var i=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,i))/i)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i},distanceToManhattan:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromAttribute:function(t,e,i){return void 0!==i&&console.warn("THREE.Vector2: offset has been removed from .fromAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var i=Math.cos(e),n=Math.sin(e),r=this.x-t.x,a=this.y-t.y;return this.x=r*i-a*n+t.x,this.y=r*n+a*i+t.y,this}};var Ko=0;n.DEFAULT_IMAGE=void 0,n.DEFAULT_MAPPING=Ua,n.prototype={constructor:n,isTexture:!0,set needsUpdate(t){t===!0&&this.version++},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){function e(t){var e;return void 0!==t.toDataURL?e=t:(e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0,t.width,t.height)),e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}if(void 0!==t.textures[this.uuid])return t.textures[this.uuid];var i={metadata:{version:4.4,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var n=this.image;void 0===n.uuid&&(n.uuid=Qo.generateUUID()),void 0===t.images[n.uuid]&&(t.images[n.uuid]={uuid:n.uuid,url:e(n)}),i.image=n.uuid}return t.textures[this.uuid]=i,i},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping===Ua){if(t.multiply(this.repeat),t.add(this.offset),t.x<0||t.x>1)switch(this.wrapS){case Va:t.x=t.x-Math.floor(t.x);break;case ka:t.x=t.x<0?0:1;break;case ja:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Va:t.y=t.y-Math.floor(t.y);break;case ka:t.y=t.y<0?0:1;break;case ja:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}}},Object.assign(n.prototype,e.prototype),r.prototype={constructor:r,isVector4:!0,set:function(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t);
}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t,this.w*=t):(this.x=0,this.y=0,this.z=0,this.w=0),this},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z,r=this.w,a=t.elements;return this.x=a[0]*e+a[4]*i+a[8]*n+a[12]*r,this.y=a[1]*e+a[5]*i+a[9]*n+a[13]*r,this.z=a[2]*e+a[6]*i+a[10]*n+a[14]*r,this.w=a[3]*e+a[7]*i+a[11]*n+a[15]*r,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,i,n,r,a=.01,o=.1,s=t.elements,c=s[0],h=s[4],l=s[8],u=s[1],p=s[5],d=s[9],f=s[2],m=s[6],g=s[10];if(Math.abs(h-u)<a&&Math.abs(l-f)<a&&Math.abs(d-m)<a){if(Math.abs(h+u)<o&&Math.abs(l+f)<o&&Math.abs(d+m)<o&&Math.abs(c+p+g-3)<o)return this.set(1,0,0,0),this;e=Math.PI;var v=(c+1)/2,y=(p+1)/2,x=(g+1)/2,_=(h+u)/4,b=(l+f)/4,w=(d+m)/4;return v>y&&v>x?v<a?(i=0,n=.707106781,r=.707106781):(i=Math.sqrt(v),n=_/i,r=b/i):y>x?y<a?(i=.707106781,n=0,r=.707106781):(n=Math.sqrt(y),i=_/n,r=w/n):x<a?(i=.707106781,n=.707106781,r=0):(r=Math.sqrt(x),i=b/r,n=w/r),this.set(i,n,r,e),this}var M=Math.sqrt((m-d)*(m-d)+(l-f)*(l-f)+(u-h)*(u-h));return Math.abs(M)<.001&&(M=1),this.x=(m-d)/M,this.y=(l-f)/M,this.z=(u-h)/M,this.w=Math.acos((c+p+g-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(){var t,e;return function(i,n){return void 0===t&&(t=new r,e=new r),t.set(i,i,i,i),e.set(n,n,n,n),this.clamp(t,e)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromAttribute:function(t,e,i){return void 0!==i&&console.warn("THREE.Vector4: offset has been removed from .fromAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}},Object.assign(a.prototype,e.prototype,{isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),o.prototype=Object.create(a.prototype),o.prototype.constructor=o,o.prototype.isWebGLRenderTargetCube=!0,s.prototype={constructor:s,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get w(){return this._w},set w(t){this._w=t,this.onChangeCallback()},set:function(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._w=n,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if((t&&t.isEuler)===!1)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var i=Math.cos(t._x/2),n=Math.cos(t._y/2),r=Math.cos(t._z/2),a=Math.sin(t._x/2),o=Math.sin(t._y/2),s=Math.sin(t._z/2),c=t.order;return"XYZ"===c?(this._x=a*n*r+i*o*s,this._y=i*o*r-a*n*s,this._z=i*n*s+a*o*r,this._w=i*n*r-a*o*s):"YXZ"===c?(this._x=a*n*r+i*o*s,this._y=i*o*r-a*n*s,this._z=i*n*s-a*o*r,this._w=i*n*r+a*o*s):"ZXY"===c?(this._x=a*n*r-i*o*s,this._y=i*o*r+a*n*s,this._z=i*n*s+a*o*r,this._w=i*n*r-a*o*s):"ZYX"===c?(this._x=a*n*r-i*o*s,this._y=i*o*r+a*n*s,this._z=i*n*s-a*o*r,this._w=i*n*r+a*o*s):"YZX"===c?(this._x=a*n*r+i*o*s,this._y=i*o*r+a*n*s,this._z=i*n*s-a*o*r,this._w=i*n*r-a*o*s):"XZY"===c&&(this._x=a*n*r-i*o*s,this._y=i*o*r-a*n*s,this._z=i*n*s+a*o*r,this._w=i*n*r+a*o*s),e!==!1&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var i=e/2,n=Math.sin(i);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(i),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e,i=t.elements,n=i[0],r=i[4],a=i[8],o=i[1],s=i[5],c=i[9],h=i[2],l=i[6],u=i[10],p=n+s+u;return p>0?(e=.5/Math.sqrt(p+1),this._w=.25/e,this._x=(l-c)*e,this._y=(a-h)*e,this._z=(o-r)*e):n>s&&n>u?(e=2*Math.sqrt(1+n-s-u),this._w=(l-c)/e,this._x=.25*e,this._y=(r+o)/e,this._z=(a+h)/e):s>u?(e=2*Math.sqrt(1+s-n-u),this._w=(a-h)/e,this._x=(r+o)/e,this._y=.25*e,this._z=(c+l)/e):(e=2*Math.sqrt(1+u-n-s),this._w=(o-r)/e,this._x=(a+h)/e,this._y=(c+l)/e,this._z=.25*e),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,e,i=1e-6;return function(n,r){return void 0===t&&(t=new c),e=n.dot(r)+1,e<i?(e=0,Math.abs(n.x)>Math.abs(n.z)?t.set(-n.y,n.x,0):t.set(0,-n.z,n.y)):t.crossVectors(n,r),this._x=t.x,this._y=t.y,this._z=t.z,this._w=e,this.normalize()}}(),inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var i=t._x,n=t._y,r=t._z,a=t._w,o=e._x,s=e._y,c=e._z,h=e._w;return this._x=i*h+a*o+n*c-r*s,this._y=n*h+a*s+r*o-i*c,this._z=r*h+a*c+i*s-n*o,this._w=a*h-i*o-n*s-r*c,this.onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var i=this._x,n=this._y,r=this._z,a=this._w,o=a*t._w+i*t._x+n*t._y+r*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=a,this._x=i,this._y=n,this._z=r,this;var s=Math.sqrt(1-o*o);if(Math.abs(s)<.001)return this._w=.5*(a+this._w),this._x=.5*(i+this._x),this._y=.5*(n+this._y),this._z=.5*(r+this._z),this;var c=Math.atan2(s,o),h=Math.sin((1-e)*c)/s,l=Math.sin(e*c)/s;return this._w=a*h+this._w*l,this._x=i*h+this._x*l,this._y=n*h+this._y*l,this._z=r*h+this._z*l,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},Object.assign(s,{slerp:function(t,e,i,n){return i.copy(t).slerp(e,n)},slerpFlat:function(t,e,i,n,r,a,o){var s=i[n+0],c=i[n+1],h=i[n+2],l=i[n+3],u=r[a+0],p=r[a+1],d=r[a+2],f=r[a+3];if(l!==f||s!==u||c!==p||h!==d){var m=1-o,g=s*u+c*p+h*d+l*f,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){var x=Math.sqrt(y),_=Math.atan2(x,g*v);m=Math.sin(m*_)/x,o=Math.sin(o*_)/x}var b=o*v;if(s=s*m+u*b,c=c*m+p*b,h=h*m+d*b,l=l*m+f*b,m===1-o){var w=1/Math.sqrt(s*s+c*c+h*h+l*l);s*=w,c*=w,h*=w,l*=w}}t[e]=s,t[e+1]=c,t[e+2]=h,t[e+3]=l}}),c.prototype={constructor:c,isVector3:!0,set:function(t,e,i){return this.x=t,this.y=e,this.z=i,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(){var t;return function(e){return(e&&e.isEuler)===!1&&console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),void 0===t&&(t=new s),this.applyQuaternion(t.setFromEuler(e))}}(),applyAxisAngle:function(){var t;return function(e,i){return void 0===t&&(t=new s),this.applyQuaternion(t.setFromAxisAngle(e,i))}}(),applyMatrix3:function(t){var e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[3]*i+r[6]*n,this.y=r[1]*e+r[4]*i+r[7]*n,this.z=r[2]*e+r[5]*i+r[8]*n,this},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[4]*i+r[8]*n+r[12],this.y=r[1]*e+r[5]*i+r[9]*n+r[13],this.z=r[2]*e+r[6]*i+r[10]*n+r[14],this},applyProjection:function(t){var e=this.x,i=this.y,n=this.z,r=t.elements,a=1/(r[3]*e+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*e+r[4]*i+r[8]*n+r[12])*a,this.y=(r[1]*e+r[5]*i+r[9]*n+r[13])*a,this.z=(r[2]*e+r[6]*i+r[10]*n+r[14])*a,this},applyQuaternion:function(t){var e=this.x,i=this.y,n=this.z,r=t.x,a=t.y,o=t.z,s=t.w,c=s*e+a*n-o*i,h=s*i+o*e-r*n,l=s*n+r*i-a*e,u=-r*e-a*i-o*n;return this.x=c*s+u*-r+h*-o-l*-a,this.y=h*s+u*-a+l*-r-c*-o,this.z=l*s+u*-o+c*-a-h*-r,this},project:function(){var t;return function(e){return void 0===t&&(t=new h),t.multiplyMatrices(e.projectionMatrix,t.getInverse(e.matrixWorld)),this.applyProjection(t)}}(),unproject:function(){var t;return function(e){return void 0===t&&(t=new h),t.multiplyMatrices(e.matrixWorld,t.getInverse(e.projectionMatrix)),this.applyProjection(t)}}(),transformDirection:function(t){var e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[4]*i+r[8]*n,this.y=r[1]*e+r[5]*i+r[9]*n,this.z=r[2]*e+r[6]*i+r[10]*n,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(){var t,e;return function(i,n){return void 0===t&&(t=new c,e=new c),t.set(i,i,i),e.set(n,n,n),this.clamp(t,e)}}(),clampLength:function(t,e){var i=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,i))/i)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},cross:function(t,e){if(void 0!==e)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e);var i=this.x,n=this.y,r=this.z;return this.x=n*t.z-r*t.y,this.y=r*t.x-i*t.z,this.z=i*t.y-n*t.x,this},crossVectors:function(t,e){var i=t.x,n=t.y,r=t.z,a=e.x,o=e.y,s=e.z;return this.x=n*s-r*o,this.y=r*a-i*s,this.z=i*o-n*a,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:function(){var t;return function(e){return void 0===t&&(t=new c),t.copy(this).projectOnVector(e),this.sub(t)}}(),reflect:function(){var t;return function(e){return void 0===t&&(t=new c),this.sub(t.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(t){var e=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(Qo.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return e*e+i*i+n*n},distanceToManhattan:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){var e=Math.sin(t.phi)*t.radius;return this.x=e*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=e*Math.cos(t.theta),this},setFromCylindrical:function(t){return this.x=t.radius*Math.sin(t.theta),this.y=t.y,this.z=t.radius*Math.cos(t.theta),this},setFromMatrixPosition:function(t){return this.setFromMatrixColumn(t,3)},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=i,this.z=n,this},setFromMatrixColumn:function(t,e){if("number"==typeof t){console.warn("THREE.Vector3: setFromMatrixColumn now expects ( matrix, index ).");var i=t;t=e,e=i}return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromAttribute:function(t,e,i){return void 0!==i&&console.warn("THREE.Vector3: offset has been removed from .fromAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}},h.prototype={constructor:h,isMatrix4:!0,set:function(t,e,i,n,r,a,o,s,c,h,l,u,p,d,f,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=i,g[12]=n,g[1]=r,g[5]=a,g[9]=o,g[13]=s,g[2]=c,g[6]=h,g[10]=l,g[14]=u,g[3]=p,g[7]=d,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new h).fromArray(this.elements)},copy:function(t){return this.elements.set(t.elements),this},copyPosition:function(t){var e=this.elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this},extractBasis:function(t,e,i){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this},extractRotation:function(){var t;return function(e){void 0===t&&(t=new c);var i=this.elements,n=e.elements,r=1/t.setFromMatrixColumn(e,0).length(),a=1/t.setFromMatrixColumn(e,1).length(),o=1/t.setFromMatrixColumn(e,2).length();return i[0]=n[0]*r,i[1]=n[1]*r,i[2]=n[2]*r,i[4]=n[4]*a,i[5]=n[5]*a,i[6]=n[6]*a,i[8]=n[8]*o,i[9]=n[9]*o,i[10]=n[10]*o,this}}(),makeRotationFromEuler:function(t){(t&&t.isEuler)===!1&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,i=t.x,n=t.y,r=t.z,a=Math.cos(i),o=Math.sin(i),s=Math.cos(n),c=Math.sin(n),h=Math.cos(r),l=Math.sin(r);if("XYZ"===t.order){var u=a*h,p=a*l,d=o*h,f=o*l;e[0]=s*h,e[4]=-s*l,e[8]=c,e[1]=p+d*c,e[5]=u-f*c,e[9]=-o*s,e[2]=f-u*c,e[6]=d+p*c,e[10]=a*s}else if("YXZ"===t.order){var m=s*h,g=s*l,v=c*h,y=c*l;e[0]=m+y*o,e[4]=v*o-g,e[8]=a*c,e[1]=a*l,e[5]=a*h,e[9]=-o,e[2]=g*o-v,e[6]=y+m*o,e[10]=a*s}else if("ZXY"===t.order){var m=s*h,g=s*l,v=c*h,y=c*l;e[0]=m-y*o,e[4]=-a*l,e[8]=v+g*o,e[1]=g+v*o,e[5]=a*h,e[9]=y-m*o,e[2]=-a*c,e[6]=o,e[10]=a*s}else if("ZYX"===t.order){var u=a*h,p=a*l,d=o*h,f=o*l;e[0]=s*h,e[4]=d*c-p,e[8]=u*c+f,e[1]=s*l,e[5]=f*c+u,e[9]=p*c-d,e[2]=-c,e[6]=o*s,e[10]=a*s}else if("YZX"===t.order){var x=a*s,_=a*c,b=o*s,w=o*c;e[0]=s*h,e[4]=w-x*l,e[8]=b*l+_,e[1]=l,e[5]=a*h,e[9]=-o*h,e[2]=-c*h,e[6]=_*l+b,e[10]=x-w*l}else if("XZY"===t.order){var x=a*s,_=a*c,b=o*s,w=o*c;e[0]=s*h,e[4]=-l,e[8]=c*h,e[1]=x*l+w,e[5]=a*h,e[9]=_*l-b,e[2]=b*l-_,e[6]=o*h,e[10]=w*l+x}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){var e=this.elements,i=t.x,n=t.y,r=t.z,a=t.w,o=i+i,s=n+n,c=r+r,h=i*o,l=i*s,u=i*c,p=n*s,d=n*c,f=r*c,m=a*o,g=a*s,v=a*c;return e[0]=1-(p+f),e[4]=l-v,e[8]=u+g,e[1]=l+v,e[5]=1-(h+f),e[9]=d-m,e[2]=u-g,e[6]=d+m,e[10]=1-(h+p),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(){var t,e,i;return function(n,r,a){void 0===t&&(t=new c,e=new c,i=new c);var o=this.elements;return i.subVectors(n,r).normalize(),0===i.lengthSq()&&(i.z=1),t.crossVectors(a,i).normalize(),0===t.lengthSq()&&(i.z+=1e-4,t.crossVectors(a,i).normalize()),e.crossVectors(i,t),o[0]=t.x,o[4]=e.x,o[8]=i.x,o[1]=t.y,o[5]=e.y,o[9]=i.y,o[2]=t.z,o[6]=e.z,o[10]=i.z,this}}(),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var i=t.elements,n=e.elements,r=this.elements,a=i[0],o=i[4],s=i[8],c=i[12],h=i[1],l=i[5],u=i[9],p=i[13],d=i[2],f=i[6],m=i[10],g=i[14],v=i[3],y=i[7],x=i[11],_=i[15],b=n[0],w=n[4],M=n[8],E=n[12],T=n[1],S=n[5],A=n[9],L=n[13],R=n[2],P=n[6],C=n[10],I=n[14],U=n[3],N=n[7],D=n[11],O=n[15];return r[0]=a*b+o*T+s*R+c*U,r[4]=a*w+o*S+s*P+c*N,r[8]=a*M+o*A+s*C+c*D,r[12]=a*E+o*L+s*I+c*O,r[1]=h*b+l*T+u*R+p*U,r[5]=h*w+l*S+u*P+p*N,r[9]=h*M+l*A+u*C+p*D,r[13]=h*E+l*L+u*I+p*O,r[2]=d*b+f*T+m*R+g*U,r[6]=d*w+f*S+m*P+g*N,r[10]=d*M+f*A+m*C+g*D,r[14]=d*E+f*L+m*I+g*O,r[3]=v*b+y*T+x*R+_*U,r[7]=v*w+y*S+x*P+_*N,r[11]=v*M+y*A+x*C+_*D,r[15]=v*E+y*L+x*I+_*O,this},multiplyToArray:function(t,e,i){var n=this.elements;return this.multiplyMatrices(t,e),i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToVector3Array:function(){var t;return function(e,i,n){void 0===t&&(t=new c),void 0===i&&(i=0),void 0===n&&(n=e.length);for(var r=0,a=i;r<n;r+=3,a+=3)t.fromArray(e,a),t.applyMatrix4(this),t.toArray(e,a);return e}}(),applyToBufferAttribute:function(){var t;return function(e){void 0===t&&(t=new c);for(var i=0,n=e.count;i<n;i++)t.x=e.getX(i),t.y=e.getY(i),t.z=e.getZ(i),t.applyMatrix4(this),e.setXYZ(i,t.x,t.y,t.z);return e}}(),determinant:function(){var t=this.elements,e=t[0],i=t[4],n=t[8],r=t[12],a=t[1],o=t[5],s=t[9],c=t[13],h=t[2],l=t[6],u=t[10],p=t[14],d=t[3],f=t[7],m=t[11],g=t[15];return d*(+r*s*l-n*c*l-r*o*u+i*c*u+n*o*p-i*s*p)+f*(+e*s*p-e*c*u+r*a*u-n*a*p+n*c*h-r*s*h)+m*(+e*c*l-e*o*p-r*a*l+i*a*p+r*o*h-i*c*h)+g*(-n*o*h-e*s*l+e*o*u+n*a*l-i*a*u+i*s*h)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var i=this.elements,n=t.elements,r=n[0],a=n[1],o=n[2],s=n[3],c=n[4],h=n[5],l=n[6],u=n[7],p=n[8],d=n[9],f=n[10],m=n[11],g=n[12],v=n[13],y=n[14],x=n[15],_=d*y*u-v*f*u+v*l*m-h*y*m-d*l*x+h*f*x,b=g*f*u-p*y*u-g*l*m+c*y*m+p*l*x-c*f*x,w=p*v*u-g*d*u+g*h*m-c*v*m-p*h*x+c*d*x,M=g*d*l-p*v*l-g*h*f+c*v*f+p*h*y-c*d*y,E=r*_+a*b+o*w+s*M;if(0===E){var T="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(e===!0)throw new Error(T);return console.warn(T),this.identity()}var S=1/E;return i[0]=_*S,i[1]=(v*f*s-d*y*s-v*o*m+a*y*m+d*o*x-a*f*x)*S,i[2]=(h*y*s-v*l*s+v*o*u-a*y*u-h*o*x+a*l*x)*S,i[3]=(d*l*s-h*f*s-d*o*u+a*f*u+h*o*m-a*l*m)*S,i[4]=b*S,i[5]=(p*y*s-g*f*s+g*o*m-r*y*m-p*o*x+r*f*x)*S,i[6]=(g*l*s-c*y*s-g*o*u+r*y*u+c*o*x-r*l*x)*S,i[7]=(c*f*s-p*l*s+p*o*u-r*f*u-c*o*m+r*l*m)*S,i[8]=w*S,i[9]=(g*d*s-p*v*s-g*a*m+r*v*m+p*a*x-r*d*x)*S,i[10]=(c*v*s-g*h*s+g*a*u-r*v*u-c*a*x+r*h*x)*S,i[11]=(p*h*s-c*d*s-p*a*u+r*d*u+c*a*m-r*h*m)*S,i[12]=M*S,i[13]=(p*v*o-g*d*o+g*a*f-r*v*f-p*a*y+r*d*y)*S,i[14]=(g*h*o-c*v*o-g*a*l+r*v*l+c*a*y-r*h*y)*S,i[15]=(c*d*o-p*h*o+p*a*l-r*d*l-c*a*f+r*h*f)*S,this},scale:function(t){var e=this.elements,i=t.x,n=t.y,r=t.z;return e[0]*=i,e[4]*=n,e[8]*=r,e[1]*=i,e[5]*=n,e[9]*=r,e[2]*=i,e[6]*=n,e[10]*=r,e[3]*=i,e[7]*=n,e[11]*=r,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,i,n))},makeTranslation:function(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var i=Math.cos(e),n=Math.sin(e),r=1-i,a=t.x,o=t.y,s=t.z,c=r*a,h=r*o;return this.set(c*a+i,c*o-n*s,c*s+n*o,0,c*o+n*s,h*o+i,h*s-n*a,0,c*s-n*o,h*s+n*a,r*s*s+i,0,0,0,0,1),this},makeScale:function(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this},makeShear:function(t,e,i){return this.set(1,e,i,0,t,1,i,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,i){return this.makeRotationFromQuaternion(e),this.scale(i),this.setPosition(t),this},decompose:function(){var t,e;return function(i,n,r){void 0===t&&(t=new c,e=new h);var a=this.elements,o=t.set(a[0],a[1],a[2]).length(),s=t.set(a[4],a[5],a[6]).length(),l=t.set(a[8],a[9],a[10]).length(),u=this.determinant();u<0&&(o=-o),i.x=a[12],i.y=a[13],i.z=a[14],e.elements.set(this.elements);var p=1/o,d=1/s,f=1/l;return e.elements[0]*=p,e.elements[1]*=p,e.elements[2]*=p,e.elements[4]*=d,e.elements[5]*=d,e.elements[6]*=d,e.elements[8]*=f,e.elements[9]*=f,e.elements[10]*=f,n.setFromRotationMatrix(e),r.x=o,r.y=s,r.z=l,this}}(),makeFrustum:function(t,e,i,n,r,a){var o=this.elements,s=2*r/(e-t),c=2*r/(n-i),h=(e+t)/(e-t),l=(n+i)/(n-i),u=-(a+r)/(a-r),p=-2*a*r/(a-r);return o[0]=s,o[4]=0,o[8]=h,o[12]=0,o[1]=0,o[5]=c,o[9]=l,o[13]=0,o[2]=0,o[6]=0,o[10]=u,o[14]=p,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makePerspective:function(t,e,i,n){var r=i*Math.tan(Qo.DEG2RAD*t*.5),a=-r,o=a*e,s=r*e;return this.makeFrustum(o,s,a,r,i,n)},makeOrthographic:function(t,e,i,n,r,a){var o=this.elements,s=1/(e-t),c=1/(i-n),h=1/(a-r),l=(e+t)*s,u=(i+n)*c,p=(a+r)*h;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-l,o[1]=0,o[5]=2*c,o[9]=0,o[13]=-u,o[2]=0,o[6]=0,o[10]=-2*h,o[14]=-p,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(t){for(var e=this.elements,i=t.elements,n=0;n<16;n++)if(e[n]!==i[n])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var i=0;i<16;i++)this.elements[i]=t[i+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t}},l.prototype=Object.create(n.prototype),l.prototype.constructor=l,l.prototype.isCubeTexture=!0,Object.defineProperty(l.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}});var $o=new n,ts=new l,es=[],is=[];H.prototype.setValue=function(t,e){for(var i=this.seq,n=0,r=i.length;n!==r;++n){var a=i[n];a.setValue(t,e[a.id])}};var ns=/([\w\d_]+)(\])?(\[|\.)?/g;j.prototype.setValue=function(t,e,i){var n=this.map[e];void 0!==n&&n.setValue(t,i,this.renderer)},j.prototype.set=function(t,e,i){var n=this.map[i];void 0!==n&&n.setValue(t,e[i],this.renderer)},j.prototype.setOptional=function(t,e,i){var n=e[i];void 0!==n&&this.setValue(t,i,n)},j.upload=function(t,e,i,n){for(var r=0,a=e.length;r!==a;++r){var o=e[r],s=i[o.id];s.needsUpdate!==!1&&o.setValue(t,s.value,n)}},j.seqWithValue=function(t,e){for(var i=[],n=0,r=t.length;n!==r;++n){var a=t[n];a.id in e&&i.push(a)}return i};var rs={merge:function(t){for(var e={},i=0;i<t.length;i++){var n=this.clone(t[i]);for(var r in n)e[r]=n[r]}return e},clone:function(t){var e={};for(var i in t){e[i]={};for(var n in t[i]){var r=t[i][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?e[i][n]=r.clone():Array.isArray(r)?e[i][n]=r.slice():e[i][n]=r}}return e}},as="#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",os="#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",ss="#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",cs="#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",hs="#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",ls="\nvec3 transformed = vec3( position );\n",us="\nvec3 objectNormal = vec3( normal );\n",ps="float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t\t}\n\t\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 ltcTextureCoords( const in GeometricContext geometry, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = (LUT_SIZE - 1.0)/LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5/LUT_SIZE;\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 P = geometry.position;\n\tfloat theta = acos( dot( N, V ) );\n\tvec2 uv = vec2(\n\t\tsqrt( saturate( roughness ) ),\n\t\tsaturate( theta / ( 0.5 * PI ) ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nvoid clipQuadToHorizon( inout vec3 L[5], out int n ) {\n\tint config = 0;\n\tif ( L[0].z > 0.0 ) config += 1;\n\tif ( L[1].z > 0.0 ) config += 2;\n\tif ( L[2].z > 0.0 ) config += 4;\n\tif ( L[3].z > 0.0 ) config += 8;\n\tn = 0;\n\tif ( config == 0 ) {\n\t} else if ( config == 1 ) {\n\t\tn = 3;\n\t\tL[1] = -L[1].z * L[0] + L[0].z * L[1];\n\t\tL[2] = -L[3].z * L[0] + L[0].z * L[3];\n\t} else if ( config == 2 ) {\n\t\tn = 3;\n\t\tL[0] = -L[0].z * L[1] + L[1].z * L[0];\n\t\tL[2] = -L[2].z * L[1] + L[1].z * L[2];\n\t} else if ( config == 3 ) {\n\t\tn = 4;\n\t\tL[2] = -L[2].z * L[1] + L[1].z * L[2];\n\t\tL[3] = -L[3].z * L[0] + L[0].z * L[3];\n\t} else if ( config == 4 ) {\n\t\tn = 3;\n\t\tL[0] = -L[3].z * L[2] + L[2].z * L[3];\n\t\tL[1] = -L[1].z * L[2] + L[2].z * L[1];\n\t} else if ( config == 5 ) {\n\t\tn = 0;\n\t} else if ( config == 6 ) {\n\t\tn = 4;\n\t\tL[0] = -L[0].z * L[1] + L[1].z * L[0];\n\t\tL[3] = -L[3].z * L[2] + L[2].z * L[3];\n\t} else if ( config == 7 ) {\n\t\tn = 5;\n\t\tL[4] = -L[3].z * L[0] + L[0].z * L[3];\n\t\tL[3] = -L[3].z * L[2] + L[2].z * L[3];\n\t} else if ( config == 8 ) {\n\t\tn = 3;\n\t\tL[0] = -L[0].z * L[3] + L[3].z * L[0];\n\t\tL[1] = -L[2].z * L[3] + L[3].z * L[2];\n\t\tL[2] =  L[3];\n\t} else if ( config == 9 ) {\n\t\tn = 4;\n\t\tL[1] = -L[1].z * L[0] + L[0].z * L[1];\n\t\tL[2] = -L[2].z * L[3] + L[3].z * L[2];\n\t} else if ( config == 10 ) {\n\t\tn = 0;\n\t} else if ( config == 11 ) {\n\t\tn = 5;\n\t\tL[4] = L[3];\n\t\tL[3] = -L[2].z * L[3] + L[3].z * L[2];\n\t\tL[2] = -L[2].z * L[1] + L[1].z * L[2];\n\t} else if ( config == 12 ) {\n\t\tn = 4;\n\t\tL[1] = -L[1].z * L[2] + L[2].z * L[1];\n\t\tL[0] = -L[0].z * L[3] + L[3].z * L[0];\n\t} else if ( config == 13 ) {\n\t\tn = 5;\n\t\tL[4] = L[3];\n\t\tL[3] = L[2];\n\t\tL[2] = -L[1].z * L[2] + L[2].z * L[1];\n\t\tL[1] = -L[1].z * L[0] + L[0].z * L[1];\n\t} else if ( config == 14 ) {\n\t\tn = 5;\n\t\tL[4] = -L[0].z * L[3] + L[3].z * L[0];\n\t\tL[0] = -L[0].z * L[1] + L[1].z * L[0];\n\t} else if ( config == 15 ) {\n\t\tn = 4;\n\t}\n\tif ( n == 3 )\n\t\tL[3] = L[0];\n\tif ( n == 4 )\n\t\tL[4] = L[0];\n}\nfloat integrateLtcBrdfOverRectEdge( vec3 v1, vec3 v2 ) {\n\tfloat cosTheta = dot( v1, v2 );\n\tfloat theta = acos( cosTheta );\n\tfloat res = cross( v1, v2 ).z * ( ( theta > 0.001 ) ? theta / sin( theta ) : 1.0 );\n\treturn res;\n}\nvoid initRectPoints( const in vec3 pos, const in vec3 halfWidth, const in vec3 halfHeight, out vec3 rectPoints[4] ) {\n\trectPoints[0] = pos - halfWidth - halfHeight;\n\trectPoints[1] = pos + halfWidth - halfHeight;\n\trectPoints[2] = pos + halfWidth + halfHeight;\n\trectPoints[3] = pos - halfWidth + halfHeight;\n}\nvec3 integrateLtcBrdfOverRect( const in GeometricContext geometry, const in mat3 brdfMat, const in vec3 rectPoints[4] ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 P = geometry.position;\n\tvec3 T1, T2;\n\tT1 = normalize(V - N * dot( V, N ));\n\tT2 = - cross( N, T1 );\n\tmat3 brdfWrtSurface = brdfMat * transpose( mat3( T1, T2, N ) );\n\tvec3 clippedRect[5];\n\tclippedRect[0] = brdfWrtSurface * ( rectPoints[0] - P );\n\tclippedRect[1] = brdfWrtSurface * ( rectPoints[1] - P );\n\tclippedRect[2] = brdfWrtSurface * ( rectPoints[2] - P );\n\tclippedRect[3] = brdfWrtSurface * ( rectPoints[3] - P );\n\tint n;\n\tclipQuadToHorizon(clippedRect, n);\n\tif ( n == 0 )\n\t\treturn vec3( 0, 0, 0 );\n\tclippedRect[0] = normalize( clippedRect[0] );\n\tclippedRect[1] = normalize( clippedRect[1] );\n\tclippedRect[2] = normalize( clippedRect[2] );\n\tclippedRect[3] = normalize( clippedRect[3] );\n\tclippedRect[4] = normalize( clippedRect[4] );\n\tfloat sum = 0.0;\n\tsum += integrateLtcBrdfOverRectEdge( clippedRect[0], clippedRect[1] );\n\tsum += integrateLtcBrdfOverRectEdge( clippedRect[1], clippedRect[2] );\n\tsum += integrateLtcBrdfOverRectEdge( clippedRect[2], clippedRect[3] );\n\tif (n >= 4)\n\t\tsum += integrateLtcBrdfOverRectEdge( clippedRect[3], clippedRect[4] );\n\tif (n == 5)\n\t\tsum += integrateLtcBrdfOverRectEdge( clippedRect[4], clippedRect[0] );\n\tsum = max( 0.0, sum );\n\tvec3 Lo_i = vec3( sum, sum, sum );\n\treturn Lo_i;\n}\nvec3 Rect_Area_Light_Specular_Reflectance(\n\t\tconst in GeometricContext geometry,\n\t\tconst in vec3 lightPos, const in vec3 lightHalfWidth, const in vec3 lightHalfHeight,\n\t\tconst in float roughness,\n\t\tconst in sampler2D ltcMat, const in sampler2D ltcMag ) {\n\tvec3 rectPoints[4];\n\tinitRectPoints( lightPos, lightHalfWidth, lightHalfHeight, rectPoints );\n\tvec2 uv = ltcTextureCoords( geometry, roughness );\n\tvec4 brdfLtcApproxParams, t;\n\tbrdfLtcApproxParams = texture2D( ltcMat, uv );\n\tt = texture2D( ltcMat, uv );\n\tfloat brdfLtcScalar = texture2D( ltcMag, uv ).a;\n\tmat3 brdfLtcApproxMat = mat3(\n\t\tvec3(   1,   0, t.y ),\n\t\tvec3(   0, t.z,   0 ),\n\t\tvec3( t.w,   0, t.x )\n\t);\n\tvec3 specularReflectance = integrateLtcBrdfOverRect( geometry, brdfLtcApproxMat, rectPoints );\n\tspecularReflectance *= brdfLtcScalar;\n\treturn specularReflectance;\n}\nvec3 Rect_Area_Light_Diffuse_Reflectance(\n\t\tconst in GeometricContext geometry,\n\t\tconst in vec3 lightPos, const in vec3 lightHalfWidth, const in vec3 lightHalfHeight ) {\n\tvec3 rectPoints[4];\n\tinitRectPoints( lightPos, lightHalfWidth, lightHalfHeight, rectPoints );\n\tmat3 diffuseBrdfMat = mat3(1);\n\tvec3 diffuseReflectance = integrateLtcBrdfOverRect( geometry, diffuseBrdfMat, rectPoints );\n\treturn diffuseReflectance;\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",ds="#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos );\n\t\tvec3 vSigmaY = dFdy( surf_pos );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",fs="#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t\t\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\t\tvec4 plane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t\n\t#endif\n#endif\n",ms="#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",gs="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",vs="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",ys="#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",xs="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",_s="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",bs="#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",ws="#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transpose( const in mat3 v ) {\n\tmat3 tmp;\n\ttmp[0] = vec3(v[0].x, v[1].x, v[2].x);\n\ttmp[1] = vec3(v[0].y, v[1].y, v[2].y);\n\ttmp[2] = vec3(v[0].z, v[1].z, v[2].z);\n\treturn tmp;\n}\n",Ms="#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",Es="#ifdef FLIP_SIDED\n\tobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;\n",Ts="#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",Ss="#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",As="#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",Ls="#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",Rs="  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",Ps="\nvec4 LinearToLinear( in vec4 value ) {\n  return value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n  return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n  return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n  return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n  float maxComponent = max( max( value.r, value.g ), value.b );\n  float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n  return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n  return vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n  float maxRGB = max( value.x, max( value.g, value.b ) );\n  float M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n  M            = ceil( M * 255.0 ) / 255.0;\n  return vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n    return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n    float maxRGB = max( value.x, max( value.g, value.b ) );\n    float D      = max( maxRange / maxRGB, 1.0 );\n    D            = min( floor( D ) / 255.0, 1.0 );\n    return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n  vec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n  Xp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n  vec4 vResult;\n  vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n  float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n  vResult.w = fract(Le);\n  vResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n  return vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n  float Le = value.z * 255.0 + value.w;\n  vec3 Xp_Y_XYZp;\n  Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n  Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n  Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n  vec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n  return vec4( max(vRGB, 0.0), 1.0 );\n}\n",Cs="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",Is="#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",Us="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",Ns="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",Ds="#ifdef USE_FOG\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\t#else\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\t#endif\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",Os="#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",Fs="#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",zs="#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",Bs="#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",Gs="vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",Hs="uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltcMat;\tuniform sampler2D ltcMag;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = saturate( reflectVec.y * 0.5 + 0.5 );\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",Vs="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",ks="varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\n#if NUM_RECT_AREA_LIGHTS > 0\n    void RE_Direct_RectArea_BlinnPhong( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n        vec3 matDiffColor = material.diffuseColor;\n        vec3 matSpecColor = material.specularColor;\n        vec3 lightColor   = rectAreaLight.color;\n        float roughness = BlinnExponentToGGXRoughness( material.specularShininess );\n        vec3 spec = Rect_Area_Light_Specular_Reflectance(\n                geometry,\n                rectAreaLight.position, rectAreaLight.halfWidth, rectAreaLight.halfHeight,\n                roughness,\n                ltcMat, ltcMag );\n        vec3 diff = Rect_Area_Light_Diffuse_Reflectance(\n                geometry,\n                rectAreaLight.position, rectAreaLight.halfWidth, rectAreaLight.halfHeight );\n        reflectedLight.directSpecular += lightColor * matSpecColor * spec / PI2;\n        reflectedLight.directDiffuse  += lightColor * matDiffColor * diff / PI2;\n    }\n#endif\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",js="PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",Ws="struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n    void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n        vec3 matDiffColor = material.diffuseColor;\n        vec3 matSpecColor = material.specularColor;\n        vec3 lightColor   = rectAreaLight.color;\n        float roughness = material.specularRoughness;\n        vec3 spec = Rect_Area_Light_Specular_Reflectance(\n                geometry,\n                rectAreaLight.position, rectAreaLight.halfWidth, rectAreaLight.halfHeight,\n                roughness,\n                ltcMat, ltcMag );\n        vec3 diff = Rect_Area_Light_Diffuse_Reflectance(\n                geometry,\n                rectAreaLight.position, rectAreaLight.halfWidth, rectAreaLight.halfHeight );\n        reflectedLight.directSpecular += lightColor * matSpecColor * spec;\n        reflectedLight.directDiffuse  += lightColor * matDiffColor * diff;\n    }\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",Xs="\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t \tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\t\t\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",Ys="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif",qs="#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",Zs="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",Js="#ifdef USE_LOGDEPTHBUF\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\t#endif\n#endif\n",Qs="#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",Ks="#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",$s="#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",tc="#ifdef USE_MAP\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n#endif\n",ec="float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.r;\n#endif\n",ic="#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",nc="#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",rc="#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",ac="#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",oc="#ifdef DOUBLE_SIDED\n\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n#else\n\tfloat flipNormal = 1.0;\n#endif\n",sc="#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal ) * flipNormal;\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",cc="#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",hc="vec3 packNormalToRGB( const in vec3 normal ) {\n  return normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n  return 1.0 - 2.0 * rgb.xyz;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n  return ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n  return linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n  return (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n  return ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",lc="#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",uc="#ifdef USE_SKINNING\n\tvec4 mvPosition = modelViewMatrix * skinned;\n#else\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;\n",pc="float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.r;\n#endif\n",dc="#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",fc="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n    #if NUM_RECT_AREA_LIGHTS > 0\n    #endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn 1.0;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",mc="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n    #if NUM_RECT_AREA_LIGHTS > 0\n    #endif\n#endif\n",gc="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n    #if NUM_RECT_AREA_LIGHTS > 0\n    #endif\n#endif\n",vc="float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_RECT_AREA_LIGHTS > 0\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",yc="#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",xc="#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureWidth;\n\t\tuniform int boneTextureHeight;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",_c="#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n#endif\n",bc="#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",wc="float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",Mc="#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",Ec="#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",Tc="#define saturate(a) clamp( a, 0.0, 1.0 )\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n  return toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  color = max( vec3( 0.0 ), color - 0.004 );\n  return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",Sc="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",Ac="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n#endif\n",Lc="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",Rc="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",Pc="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",Cc="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",Ic="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( PHYSICAL ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\t#ifdef USE_SKINNING\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\t#else\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\t#endif\n#endif\n",Uc="uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",Nc="varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",Dc="#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",Oc="#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",Fc="uniform vec3 lightPos;\nvarying vec4 vWorldPosition;\n#include <common>\n#include <packing>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = packDepthToRGBA( length( vWorldPosition.xyz - lightPos.xyz ) / 1000.0 );\n}\n",zc="varying vec4 vWorldPosition;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition;\n}\n",Bc="uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",Gc="varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",Hc="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",Vc="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",kc="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",jc="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n}\n",Wc="uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",Xc="#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n}\n",Yc="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",qc="#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n}\n",Zc="#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",Jc="#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n",Qc="#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED  ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#include <premultiplied_alpha_fragment>\n\t#include <encodings_fragment>\n}\n",Kc="#define NORMAL\n#if defined( FLAT_SHADED  ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED  ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",$c="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",th="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n",eh="uniform float opacity;\n#include <common>\n#include <packing>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( 0.0, 0.0, 0.0, opacity * ( 1.0  - getShadowMask() ) );\n}\n",ih="#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n",nh={
alphamap_fragment:as,alphamap_pars_fragment:os,alphatest_fragment:ss,aomap_fragment:cs,aomap_pars_fragment:hs,begin_vertex:ls,beginnormal_vertex:us,bsdfs:ps,bumpmap_pars_fragment:ds,clipping_planes_fragment:fs,clipping_planes_pars_fragment:ms,clipping_planes_pars_vertex:gs,clipping_planes_vertex:vs,color_fragment:ys,color_pars_fragment:xs,color_pars_vertex:_s,color_vertex:bs,common:ws,cube_uv_reflection_fragment:Ms,defaultnormal_vertex:Es,displacementmap_pars_vertex:Ts,displacementmap_vertex:Ss,emissivemap_fragment:As,emissivemap_pars_fragment:Ls,encodings_fragment:Rs,encodings_pars_fragment:Ps,envmap_fragment:Cs,envmap_pars_fragment:Is,envmap_pars_vertex:Us,envmap_vertex:Ns,fog_fragment:Ds,fog_pars_fragment:Os,gradientmap_pars_fragment:Fs,lightmap_fragment:zs,lightmap_pars_fragment:Bs,lights_lambert_vertex:Gs,lights_pars:Hs,lights_phong_fragment:Vs,lights_phong_pars_fragment:ks,lights_physical_fragment:js,lights_physical_pars_fragment:Ws,lights_template:Xs,logdepthbuf_fragment:Ys,logdepthbuf_pars_fragment:qs,logdepthbuf_pars_vertex:Zs,logdepthbuf_vertex:Js,map_fragment:Qs,map_pars_fragment:Ks,map_particle_fragment:$s,map_particle_pars_fragment:tc,metalnessmap_fragment:ec,metalnessmap_pars_fragment:ic,morphnormal_vertex:nc,morphtarget_pars_vertex:rc,morphtarget_vertex:ac,normal_flip:oc,normal_fragment:sc,normalmap_pars_fragment:cc,packing:hc,premultiplied_alpha_fragment:lc,project_vertex:uc,roughnessmap_fragment:pc,roughnessmap_pars_fragment:dc,shadowmap_pars_fragment:fc,shadowmap_pars_vertex:mc,shadowmap_vertex:gc,shadowmask_pars_fragment:vc,skinbase_vertex:yc,skinning_pars_vertex:xc,skinning_vertex:_c,skinnormal_vertex:bc,specularmap_fragment:wc,specularmap_pars_fragment:Mc,tonemapping_fragment:Ec,tonemapping_pars_fragment:Tc,uv_pars_fragment:Sc,uv_pars_vertex:Ac,uv_vertex:Lc,uv2_pars_fragment:Rc,uv2_pars_vertex:Pc,uv2_vertex:Cc,worldpos_vertex:Ic,cube_frag:Uc,cube_vert:Nc,depth_frag:Dc,depth_vert:Oc,distanceRGBA_frag:Fc,distanceRGBA_vert:zc,equirect_frag:Bc,equirect_vert:Gc,linedashed_frag:Hc,linedashed_vert:Vc,meshbasic_frag:kc,meshbasic_vert:jc,meshlambert_frag:Wc,meshlambert_vert:Xc,meshphong_frag:Yc,meshphong_vert:qc,meshphysical_frag:Zc,meshphysical_vert:Jc,normal_frag:Qc,normal_vert:Kc,points_frag:$c,points_vert:th,shadow_frag:eh,shadow_vert:ih};W.prototype={constructor:W,isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,i){return this.r=t,this.g=e,this.b=i,this},setHSL:function(){function t(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+6*(e-t)*(2/3-i):t}return function(e,i,n){if(e=Qo.euclideanModulo(e,1),i=Qo.clamp(i,0,1),n=Qo.clamp(n,0,1),0===i)this.r=this.g=this.b=n;else{var r=n<=.5?n*(1+i):n+i-n*i,a=2*n-r;this.r=t(a,r,e+1/3),this.g=t(a,r,e),this.b=t(a,r,e-1/3)}return this}}(),setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var i;if(i=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var n,r=i[1],a=i[2];switch(r){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,e(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,e(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var o=parseFloat(n[1])/360,s=parseInt(n[2],10)/100,c=parseInt(n[3],10)/100;return e(n[5]),this.setHSL(o,s,c)}}}else if(i=/^\#([A-Fa-f0-9]+)$/.exec(t)){var h=i[1],l=h.length;if(3===l)return this.r=parseInt(h.charAt(0)+h.charAt(0),16)/255,this.g=parseInt(h.charAt(1)+h.charAt(1),16)/255,this.b=parseInt(h.charAt(2)+h.charAt(2),16)/255,this;if(6===l)return this.r=parseInt(h.charAt(0)+h.charAt(1),16)/255,this.g=parseInt(h.charAt(2)+h.charAt(3),16)/255,this.b=parseInt(h.charAt(4)+h.charAt(5),16)/255,this}if(t&&t.length>0){var h=rh[t];void 0!==h?this.setHex(h):console.warn("THREE.Color: Unknown color "+t)}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var i=e>0?1/e:1;return this.r=Math.pow(t.r,i),this.g=Math.pow(t.g,i),this.b=Math.pow(t.b,i),this},convertGammaToLinear:function(){var t=this.r,e=this.g,i=this.b;return this.r=t*t,this.g=e*e,this.b=i*i,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){var e,i,n=t||{h:0,s:0,l:0},r=this.r,a=this.g,o=this.b,s=Math.max(r,a,o),c=Math.min(r,a,o),h=(c+s)/2;if(c===s)e=0,i=0;else{var l=s-c;switch(i=h<=.5?l/(s+c):l/(2-s-c),s){case r:e=(a-o)/l+(a<o?6:0);break;case a:e=(o-r)/l+2;break;case o:e=(r-a)/l+4}e/=6}return n.h=e,n.s=i,n.l=h,n},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,i){var n=this.getHSL();return n.h+=t,n.s+=e,n.l+=i,this.setHSL(n.h,n.s,n.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}};var rh={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};X.prototype=Object.create(n.prototype),X.prototype.constructor=X,X.prototype.isDataTexture=!0;var ah={common:{diffuse:{value:new W(15658734)},opacity:{value:1},map:{value:null},offsetRepeat:{value:new r(0,0,1,1)},specularMap:{value:null},alphaMap:{value:null},envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new i(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new W(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new W(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},offsetRepeat:{value:new r(0,0,1,1)}}},oh={basic:{uniforms:rs.merge([ah.common,ah.aomap,ah.lightmap,ah.fog]),vertexShader:nh.meshbasic_vert,fragmentShader:nh.meshbasic_frag},lambert:{uniforms:rs.merge([ah.common,ah.aomap,ah.lightmap,ah.emissivemap,ah.fog,ah.lights,{emissive:{value:new W(0)}}]),vertexShader:nh.meshlambert_vert,fragmentShader:nh.meshlambert_frag},phong:{uniforms:rs.merge([ah.common,ah.aomap,ah.lightmap,ah.emissivemap,ah.bumpmap,ah.normalmap,ah.displacementmap,ah.gradientmap,ah.fog,ah.lights,{emissive:{value:new W(0)},specular:{value:new W(1118481)},shininess:{value:30}}]),vertexShader:nh.meshphong_vert,fragmentShader:nh.meshphong_frag},standard:{uniforms:rs.merge([ah.common,ah.aomap,ah.lightmap,ah.emissivemap,ah.bumpmap,ah.normalmap,ah.displacementmap,ah.roughnessmap,ah.metalnessmap,ah.fog,ah.lights,{emissive:{value:new W(0)},roughness:{value:.5},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:nh.meshphysical_vert,fragmentShader:nh.meshphysical_frag},points:{uniforms:rs.merge([ah.points,ah.fog]),vertexShader:nh.points_vert,fragmentShader:nh.points_frag},dashed:{uniforms:rs.merge([ah.common,ah.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:nh.linedashed_vert,fragmentShader:nh.linedashed_frag},depth:{uniforms:rs.merge([ah.common,ah.displacementmap]),vertexShader:nh.depth_vert,fragmentShader:nh.depth_frag},normal:{uniforms:rs.merge([ah.common,ah.bumpmap,ah.normalmap,ah.displacementmap,{opacity:{value:1}}]),vertexShader:nh.normal_vert,fragmentShader:nh.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:nh.cube_vert,fragmentShader:nh.cube_frag},equirect:{uniforms:{tEquirect:{value:null},tFlip:{value:-1}},vertexShader:nh.equirect_vert,fragmentShader:nh.equirect_frag},distanceRGBA:{uniforms:{lightPos:{value:new c}},vertexShader:nh.distanceRGBA_vert,fragmentShader:nh.distanceRGBA_frag}};oh.physical={uniforms:rs.merge([oh.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:nh.meshphysical_vert,fragmentShader:nh.meshphysical_frag},Y.prototype={constructor:Y,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new i;return function(e,i){var n=t.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=+(1/0),this.max.x=this.max.y=-(1/0),this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){var e=t||new i;return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){var e=t||new i;return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){var n=e||new i;return n.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){var n=e||new i;return n.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new i;return function(e){var i=t.copy(e).clamp(this.min,this.max);return i.sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}};var sh=0;J.prototype={constructor:J,isMaterial:!0,get needsUpdate(){return this._needsUpdate},set needsUpdate(t){t===!0&&this.update(),this._needsUpdate=t},setValues:function(t){if(void 0!==t)for(var e in t){var i=t[e];if(void 0!==i){var n=this[e];void 0!==n?n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):"overdraw"===e?this[e]=Number(i):this[e]=i:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}else console.warn("THREE.Material: '"+e+"' parameter is undefined.")}},toJSON:function(t){function e(t){var e=[];for(var i in t){var n=t[i];delete n.metadata,e.push(n)}return e}var i=void 0===t;i&&(t={textures:{},images:{}});var n={metadata:{version:4.4,type:"Material",generator:"Material.toJSON"}};if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearCoat&&(n.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(n.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,n.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Zr&&(n.blending=this.blending),this.shading!==jr&&(n.shading=this.shading),this.side!==Gr&&(n.side=this.side),this.vertexColors!==Wr&&(n.vertexColors=this.vertexColors),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),n.skinning=this.skinning,n.morphTargets=this.morphTargets,i){var r=e(t.textures),a=e(t.images);r.length>0&&(n.textures=r),a.length>0&&(n.images=a)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.lights=t.lights,this.blending=t.blending,this.side=t.side,this.shading=t.shading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.overdraw=t.overdraw,this.visible=t.visible,this.clipShadows=t.clipShadows,this.clipIntersection=t.clipIntersection;var e=t.clippingPlanes,i=null;if(null!==e){var n=e.length;i=new Array(n);for(var r=0;r!==n;++r)i[r]=e[r].clone()}return this.clippingPlanes=i,this},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},Object.assign(J.prototype,e.prototype),Q.prototype=Object.create(J.prototype),Q.prototype.constructor=Q,Q.prototype.isShaderMaterial=!0,Q.prototype.copy=function(t){return J.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=rs.clone(t.uniforms),this.defines=t.defines,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},Q.prototype.toJSON=function(t){var e=J.prototype.toJSON.call(this,t);return e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e},K.prototype=Object.create(J.prototype),K.prototype.constructor=K,K.prototype.isMeshDepthMaterial=!0,K.prototype.copy=function(t){return J.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},$.prototype={constructor:$,isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=+(1/0),i=+(1/0),n=+(1/0),r=-(1/0),a=-(1/0),o=-(1/0),s=0,c=t.length;s<c;s+=3){var h=t[s],l=t[s+1],u=t[s+2];h<e&&(e=h),l<i&&(i=l),u<n&&(n=u),h>r&&(r=h),l>a&&(a=l),u>o&&(o=u)}this.min.set(e,i,n),this.max.set(r,a,o)},setFromBufferAttribute:function(t){for(var e=+(1/0),i=+(1/0),n=+(1/0),r=-(1/0),a=-(1/0),o=-(1/0),s=0,c=t.count;s<c;s++){var h=t.getX(s),l=t.getY(s),u=t.getZ(s);h<e&&(e=h),l<i&&(i=l),u<n&&(n=u),h>r&&(r=h),l>a&&(a=l),u>o&&(o=u)}this.min.set(e,i,n),this.max.set(r,a,o)},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new c;return function(e,i){var n=t.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}}(),setFromObject:function(){var t=new c;return function(e){var i=this;return e.updateMatrixWorld(!0),this.makeEmpty(),e.traverse(function(e){var n,r,a=e.geometry;if(void 0!==a)if(a.isGeometry){var o=a.vertices;for(n=0,r=o.length;n<r;n++)t.copy(o[n]),t.applyMatrix4(e.matrixWorld),i.expandByPoint(t)}else if(a.isBufferGeometry){var s=a.attributes.position;if(void 0!==s)for(n=0,r=s.count;n<r;n++)t.fromAttribute(s,n).applyMatrix4(e.matrixWorld),i.expandByPoint(t)}}),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=+(1/0),this.max.x=this.max.y=this.max.z=-(1/0),this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){var e=t||new c;return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){var e=t||new c;return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){var i=e||new c;return i.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(){var t;return function(e){return void 0===t&&(t=new c),this.clampPoint(e.center,t),t.distanceToSquared(e.center)<=e.radius*e.radius}}(),intersectsPlane:function(t){var e,i;return t.normal.x>0?(e=t.normal.x*this.min.x,i=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,i=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),e<=t.constant&&i>=t.constant},clampPoint:function(t,e){var i=e||new c;return i.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new c;return function(e){var i=t.copy(e).clamp(this.min,this.max);return i.sub(e).length()}}(),getBoundingSphere:function(){var t=new c;return function(e){var i=e||new tt;return this.getCenter(i.center),i.radius=.5*this.getSize(t).length(),i}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(){var t=[new c,new c,new c,new c,new c,new c,new c,new c];return function(e){return this.isEmpty()?this:(t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(t),this)}}(),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},tt.prototype={constructor:tt,set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(){var t=new $;return function(e,i){var n=this.center;void 0!==i?n.copy(i):t.setFromPoints(e).getCenter(n);for(var r=0,a=0,o=e.length;a<o;a++)r=Math.max(r,n.distanceToSquared(e[a]));return this.radius=Math.sqrt(r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(this.center.dot(t.normal)-t.constant)<=this.radius},clampPoint:function(t,e){var i=this.center.distanceToSquared(t),n=e||new c;return n.copy(t),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n},getBoundingBox:function(t){var e=t||new $;return e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}},et.prototype={constructor:et,isMatrix3:!0,set:function(t,e,i,n,r,a,o,s,c){var h=this.elements;return h[0]=t,h[1]=n,h[2]=o,h[3]=e,h[4]=r,h[5]=s,h[6]=i,h[7]=a,h[8]=c,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=t.elements;return this.set(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]),this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},applyToVector3Array:function(){var t;return function(e,i,n){void 0===t&&(t=new c),void 0===i&&(i=0),void 0===n&&(n=e.length);for(var r=0,a=i;r<n;r+=3,a+=3)t.fromArray(e,a),t.applyMatrix3(this),t.toArray(e,a);return e}}(),applyToBufferAttribute:function(){var t;return function(e){void 0===t&&(t=new c);for(var i=0,n=e.count;i<n;i++)t.x=e.getX(i),t.y=e.getY(i),t.z=e.getZ(i),t.applyMatrix3(this),e.setXYZ(i,t.x,t.y,t.z);return e}}(),multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],i=t[1],n=t[2],r=t[3],a=t[4],o=t[5],s=t[6],c=t[7],h=t[8];return e*a*h-e*o*c-i*r*h+i*o*s+n*r*c-n*a*s},getInverse:function(t,e){t&&t.isMatrix4&&console.error("THREE.Matrix3.getInverse no longer takes a Matrix4 argument.");var i=t.elements,n=this.elements,r=i[0],a=i[1],o=i[2],s=i[3],c=i[4],h=i[5],l=i[6],u=i[7],p=i[8],d=p*c-h*u,f=h*l-p*s,m=u*s-c*l,g=r*d+a*f+o*m;if(0===g){var v="THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0";if(e===!0)throw new Error(v);return console.warn(v),this.identity()}var y=1/g;return n[0]=d*y,n[1]=(o*u-p*a)*y,n[2]=(h*a-o*c)*y,n[3]=f*y,n[4]=(p*r-o*l)*y,n[5]=(o*s-h*r)*y,n[6]=m*y,n[7]=(a*l-u*r)*y,n[8]=(c*r-a*s)*y,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},fromArray:function(t,e){void 0===e&&(e=0);for(var i=0;i<9;i++)this.elements[i]=t[i+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t}},it.prototype={constructor:it,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,i,n){return this.normal.set(t,e,i),this.constant=n,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new c,e=new c;return function(i,n,r){var a=t.subVectors(r,n).cross(e.subVectors(i,n)).normalize();return this.setFromNormalAndCoplanarPoint(a,i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return this.orthoPoint(t,e).sub(t).negate()},orthoPoint:function(t,e){var i=this.distanceToPoint(t),n=e||new c;return n.copy(this.normal).multiplyScalar(i)},intersectLine:function(){var t=new c;return function(e,i){var n=i||new c,r=e.delta(t),a=this.normal.dot(r);if(0!==a){var o=-(e.start.dot(this.normal)+this.constant)/a;if(!(o<0||o>1))return n.copy(r).multiplyScalar(o).add(e.start)}else if(0===this.distanceToPoint(e.start))return n.copy(e.start)}}(),intersectsLine:function(t){var e=this.distanceToPoint(t.start),i=this.distanceToPoint(t.end);return e<0&&i>0||i<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){var e=t||new c;return e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new c,e=new et;return function(i,n){var r=this.coplanarPoint(t).applyMatrix4(i),a=n||e.getNormalMatrix(i),o=this.normal.applyMatrix3(a).normalize();
return this.constant=-r.dot(o),this}}(),translate:function(t){return this.constant=this.constant-t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}},nt.prototype={constructor:nt,set:function(t,e,i,n,r,a){var o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(i),o[3].copy(n),o[4].copy(r),o[5].copy(a),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,i=0;i<6;i++)e[i].copy(t.planes[i]);return this},setFromMatrix:function(t){var e=this.planes,i=t.elements,n=i[0],r=i[1],a=i[2],o=i[3],s=i[4],c=i[5],h=i[6],l=i[7],u=i[8],p=i[9],d=i[10],f=i[11],m=i[12],g=i[13],v=i[14],y=i[15];return e[0].setComponents(o-n,l-s,f-u,y-m).normalize(),e[1].setComponents(o+n,l+s,f+u,y+m).normalize(),e[2].setComponents(o+r,l+c,f+p,y+g).normalize(),e[3].setComponents(o-r,l-c,f-p,y-g).normalize(),e[4].setComponents(o-a,l-h,f-d,y-v).normalize(),e[5].setComponents(o+a,l+h,f+d,y+v).normalize(),this},intersectsObject:function(){var t=new tt;return function(e){var i=e.geometry;return null===i.boundingSphere&&i.computeBoundingSphere(),t.copy(i.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSprite:function(){var t=new tt;return function(e){return t.center.set(0,0,0),t.radius=.7071067811865476,t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){for(var e=this.planes,i=t.center,n=-t.radius,r=0;r<6;r++){var a=e[r].distanceToPoint(i);if(a<n)return!1}return!0},intersectsBox:function(){var t=new c,e=new c;return function(i){for(var n=this.planes,r=0;r<6;r++){var a=n[r];t.x=a.normal.x>0?i.min.x:i.max.x,e.x=a.normal.x>0?i.max.x:i.min.x,t.y=a.normal.y>0?i.min.y:i.max.y,e.y=a.normal.y>0?i.max.y:i.min.y,t.z=a.normal.z>0?i.min.z:i.max.z,e.z=a.normal.z>0?i.max.z:i.min.z;var o=a.distanceToPoint(t),s=a.distanceToPoint(e);if(o<0&&s<0)return!1}return!0}}(),containsPoint:function(t){for(var e=this.planes,i=0;i<6;i++)if(e[i].distanceToPoint(t)<0)return!1;return!0}},at.prototype={constructor:at,set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){var i=e||new c;return i.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(){var t=new c;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){var i=e||new c;i.subVectors(t,this.origin);var n=i.dot(this.direction);return n<0?i.copy(this.origin):i.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(){var t=new c;return function(e){var i=t.subVectors(e,this.origin).dot(this.direction);return i<0?this.origin.distanceToSquared(e):(t.copy(this.direction).multiplyScalar(i).add(this.origin),t.distanceToSquared(e))}}(),distanceSqToSegment:function(){var t=new c,e=new c,i=new c;return function(n,r,a,o){t.copy(n).add(r).multiplyScalar(.5),e.copy(r).sub(n).normalize(),i.copy(this.origin).sub(t);var s,c,h,l,u=.5*n.distanceTo(r),p=-this.direction.dot(e),d=i.dot(this.direction),f=-i.dot(e),m=i.lengthSq(),g=Math.abs(1-p*p);if(g>0)if(s=p*f-d,c=p*d-f,l=u*g,s>=0)if(c>=-l)if(c<=l){var v=1/g;s*=v,c*=v,h=s*(s+p*c+2*d)+c*(p*s+c+2*f)+m}else c=u,s=Math.max(0,-(p*c+d)),h=-s*s+c*(c+2*f)+m;else c=-u,s=Math.max(0,-(p*c+d)),h=-s*s+c*(c+2*f)+m;else c<=-l?(s=Math.max(0,-(-p*u+d)),c=s>0?-u:Math.min(Math.max(-u,-f),u),h=-s*s+c*(c+2*f)+m):c<=l?(s=0,c=Math.min(Math.max(-u,-f),u),h=c*(c+2*f)+m):(s=Math.max(0,-(p*u+d)),c=s>0?u:Math.min(Math.max(-u,-f),u),h=-s*s+c*(c+2*f)+m);else c=p>0?-u:u,s=Math.max(0,-(p*c+d)),h=-s*s+c*(c+2*f)+m;return a&&a.copy(this.direction).multiplyScalar(s).add(this.origin),o&&o.copy(e).multiplyScalar(c).add(t),h}}(),intersectSphere:function(){var t=new c;return function(e,i){t.subVectors(e.center,this.origin);var n=t.dot(this.direction),r=t.dot(t)-n*n,a=e.radius*e.radius;if(r>a)return null;var o=Math.sqrt(a-r),s=n-o,c=n+o;return s<0&&c<0?null:s<0?this.at(c,i):this.at(s,i)}}(),intersectsSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var i=-(this.origin.dot(t.normal)+t.constant)/e;return i>=0?i:null},intersectPlane:function(t,e){var i=this.distanceToPlane(t);return null===i?null:this.at(i,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);if(0===e)return!0;var i=t.normal.dot(this.direction);return i*e<0},intersectBox:function(t,e){var i,n,r,a,o,s,c=1/this.direction.x,h=1/this.direction.y,l=1/this.direction.z,u=this.origin;return c>=0?(i=(t.min.x-u.x)*c,n=(t.max.x-u.x)*c):(i=(t.max.x-u.x)*c,n=(t.min.x-u.x)*c),h>=0?(r=(t.min.y-u.y)*h,a=(t.max.y-u.y)*h):(r=(t.max.y-u.y)*h,a=(t.min.y-u.y)*h),i>a||r>n?null:((r>i||i!==i)&&(i=r),(a<n||n!==n)&&(n=a),l>=0?(o=(t.min.z-u.z)*l,s=(t.max.z-u.z)*l):(o=(t.max.z-u.z)*l,s=(t.min.z-u.z)*l),i>s||o>n?null:((o>i||i!==i)&&(i=o),(s<n||n!==n)&&(n=s),n<0?null:this.at(i>=0?i:n,e)))},intersectsBox:function(){var t=new c;return function(e){return null!==this.intersectBox(e,t)}}(),intersectTriangle:function(){var t=new c,e=new c,i=new c,n=new c;return function(r,a,o,s,c){e.subVectors(a,r),i.subVectors(o,r),n.crossVectors(e,i);var h,l=this.direction.dot(n);if(l>0){if(s)return null;h=1}else{if(!(l<0))return null;h=-1,l=-l}t.subVectors(this.origin,r);var u=h*this.direction.dot(i.crossVectors(t,i));if(u<0)return null;var p=h*this.direction.dot(e.cross(t));if(p<0)return null;if(u+p>l)return null;var d=-h*t.dot(n);return d<0?null:this.at(d/l,c)}}(),applyMatrix4:function(t){return this.direction.add(this.origin).applyMatrix4(t),this.origin.applyMatrix4(t),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}},ot.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],ot.DefaultOrder="XYZ",ot.prototype={constructor:ot,isEuler:!0,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get order(){return this._order},set order(t){this._order=t,this.onChangeCallback()},set:function(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._order=n||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e,i){var n=Qo.clamp,r=t.elements,a=r[0],o=r[4],s=r[8],c=r[1],h=r[5],l=r[9],u=r[2],p=r[6],d=r[10];return e=e||this._order,"XYZ"===e?(this._y=Math.asin(n(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-l,d),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(p,h),this._z=0)):"YXZ"===e?(this._x=Math.asin(-n(l,-1,1)),Math.abs(l)<.99999?(this._y=Math.atan2(s,d),this._z=Math.atan2(c,h)):(this._y=Math.atan2(-u,a),this._z=0)):"ZXY"===e?(this._x=Math.asin(n(p,-1,1)),Math.abs(p)<.99999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-o,h)):(this._y=0,this._z=Math.atan2(c,a))):"ZYX"===e?(this._y=Math.asin(-n(u,-1,1)),Math.abs(u)<.99999?(this._x=Math.atan2(p,d),this._z=Math.atan2(c,a)):(this._x=0,this._z=Math.atan2(-o,h))):"YZX"===e?(this._z=Math.asin(n(c,-1,1)),Math.abs(c)<.99999?(this._x=Math.atan2(-l,h),this._y=Math.atan2(-u,a)):(this._x=0,this._y=Math.atan2(s,d))):"XZY"===e?(this._z=Math.asin(-n(o,-1,1)),Math.abs(o)<.99999?(this._x=Math.atan2(p,h),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-l,d),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,i!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var t;return function(e,i,n){return void 0===t&&(t=new h),t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t,i,n)}}(),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(){var t=new s;return function(e){return t.setFromEuler(this),this.setFromQuaternion(t,e)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new c(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},st.prototype={constructor:st,set:function(t){this.mask=1<<t},enable:function(t){this.mask|=1<<t},toggle:function(t){this.mask^=1<<t},disable:function(t){this.mask&=~(1<<t)},test:function(t){return 0!==(this.mask&t.mask)}};var ch=0;ct.DefaultUp=new c(0,1,0),ct.DefaultMatrixAutoUpdate=!0,Object.assign(ct.prototype,e.prototype,{isObject3D:!0,applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(){var t=new s;return function(e,i){return t.setFromAxisAngle(e,i),this.quaternion.multiply(t),this}}(),rotateX:function(){var t=new c(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new c(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new c(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new c;return function(e,i){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(i)),this}}(),translateX:function(){var t=new c(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new c(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new c(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new h;return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new h;return function(e){t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1)for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);var i=this.children.indexOf(t);i!==-1&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(i,1))},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var i=0,n=this.children.length;i<n;i++){var r=this.children[i],a=r.getObjectByProperty(t,e);if(void 0!==a)return a}},getWorldPosition:function(t){var e=t||new c;return this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var t=new c,e=new c;return function(i){var n=i||new s;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,n,e),n}}(),getWorldRotation:function(){var t=new s;return function(e){var i=e||new ot;return this.getWorldQuaternion(t),i.setFromQuaternion(t,this.rotation.order,!1)}}(),getWorldScale:function(){var t=new c,e=new s;return function(i){var n=i||new c;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,n),n}}(),getWorldDirection:function(){var t=new s;return function(e){var i=e||new c;return this.getWorldQuaternion(t),i.set(0,0,1).applyQuaternion(t)}}(),raycast:function(){},traverse:function(t){t(this);for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].traverse(t)},traverseVisible:function(t){if(this.visible!==!1){t(this);for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate===!0&&this.updateMatrix(),this.matrixWorldNeedsUpdate!==!0&&t!==!0||(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].updateMatrixWorld(t)},toJSON:function(t){function e(t){var e=[];for(var i in t){var n=t[i];delete n.metadata,e.push(n)}return e}var i=void 0===t||""===t,n={};i&&(t={geometries:{},materials:{},textures:{},images:{}},n.metadata={version:4.4,type:"Object",generator:"Object3D.toJSON"});var r={};if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),r.matrix=this.matrix.toArray(),void 0!==this.geometry&&(void 0===t.geometries[this.geometry.uuid]&&(t.geometries[this.geometry.uuid]=this.geometry.toJSON(t)),r.geometry=this.geometry.uuid),void 0!==this.material&&(void 0===t.materials[this.material.uuid]&&(t.materials[this.material.uuid]=this.material.toJSON(t)),r.material=this.material.uuid),this.children.length>0){r.children=[];for(var a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(t).object)}if(i){var o=e(t.geometries),s=e(t.materials),c=e(t.textures),h=e(t.images);o.length>0&&(n.geometries=o),s.length>0&&(n.materials=s),c.length>0&&(n.textures=c),h.length>0&&(n.images=h)}return n.object=r,n},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(var i=0;i<t.children.length;i++){var n=t.children[i];this.add(n.clone())}return this}}),ht.prototype={constructor:ht,set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){var e=t||new c;return e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){var e=t||new c;return e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){var i=e||new c;return this.delta(i).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var t=new c,e=new c;return function(i,n){t.subVectors(i,this.start),e.subVectors(this.end,this.start);var r=e.dot(e),a=e.dot(t),o=a/r;return n&&(o=Qo.clamp(o,0,1)),o}}(),closestPointToPoint:function(t,e,i){var n=this.closestPointToPointParameter(t,e),r=i||new c;return this.delta(r).multiplyScalar(n).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}},lt.normal=function(){var t=new c;return function(e,i,n,r){var a=r||new c;a.subVectors(n,i),t.subVectors(e,i),a.cross(t);var o=a.lengthSq();return o>0?a.multiplyScalar(1/Math.sqrt(o)):a.set(0,0,0)}}(),lt.barycoordFromPoint=function(){var t=new c,e=new c,i=new c;return function(n,r,a,o,s){t.subVectors(o,r),e.subVectors(a,r),i.subVectors(n,r);var h=t.dot(t),l=t.dot(e),u=t.dot(i),p=e.dot(e),d=e.dot(i),f=h*p-l*l,m=s||new c;if(0===f)return m.set(-2,-1,-1);var g=1/f,v=(p*u-l*d)*g,y=(h*d-l*u)*g;return m.set(1-v-y,y,v)}}(),lt.containsPoint=function(){var t=new c;return function(e,i,n,r){var a=lt.barycoordFromPoint(e,i,n,r,t);return a.x>=0&&a.y>=0&&a.x+a.y<=1}}(),lt.prototype={constructor:lt,set:function(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this},setFromPointsAndIndices:function(t,e,i,n){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[n]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},area:function(){var t=new c,e=new c;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),midpoint:function(t){var e=t||new c;return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(t){return lt.normal(this.a,this.b,this.c,t)},plane:function(t){var e=t||new it;return e.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(t,e){return lt.barycoordFromPoint(t,this.a,this.b,this.c,e)},containsPoint:function(t){return lt.containsPoint(t,this.a,this.b,this.c)},closestPointToPoint:function(){var t,e,i,n;return function(r,a){void 0===t&&(t=new it,e=[new ht,new ht,new ht],i=new c,n=new c);var o=a||new c,s=1/0;if(t.setFromCoplanarPoints(this.a,this.b,this.c),t.projectPoint(r,i),this.containsPoint(i)===!0)o.copy(i);else{e[0].set(this.a,this.b),e[1].set(this.b,this.c),e[2].set(this.c,this.a);for(var h=0;h<e.length;h++){e[h].closestPointToPoint(i,!0,n);var l=i.distanceToSquared(n);l<s&&(s=l,o.copy(n))}}return o}}(),equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}},ut.prototype={constructor:ut,clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,i=t.vertexNormals.length;e<i;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(var e=0,i=t.vertexColors.length;e<i;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}},pt.prototype=Object.create(J.prototype),pt.prototype.constructor=pt,pt.prototype.isMeshBasicMaterial=!0,pt.prototype.copy=function(t){return J.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},dt.prototype={constructor:dt,isBufferAttribute:!0,set needsUpdate(t){t===!0&&this.version++},setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.itemSize:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.dynamic=t.dynamic,this},copyAt:function(t,e,i){t*=this.itemSize,i*=e.itemSize;for(var n=0,r=this.itemSize;n<r;n++)this.array[t+n]=e.array[i+n];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),a=new W),e[i++]=a.r,e[i++]=a.g,e[i++]=a.b}return this},copyIndicesArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var a=t[n];e[i++]=a.a,e[i++]=a.b,e[i++]=a.c}return this},copyVector2sArray:function(t){for(var e=this.array,n=0,r=0,a=t.length;r<a;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new i),e[n++]=o.x,e[n++]=o.y}return this},copyVector3sArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),a=new c),e[i++]=a.x,e[i++]=a.y,e[i++]=a.z}return this},copyVector4sArray:function(t){for(var e=this.array,i=0,n=0,a=t.length;n<a;n++){var o=t[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),o=new r),e[i++]=o.x,e[i++]=o.y,e[i++]=o.z,e[i++]=o.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this},setXYZ:function(t,e,i,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this},setXYZW:function(t,e,i,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this.array[t+3]=r,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return(new this.constructor).copy(this)}},ft.prototype=Object.create(dt.prototype),ft.prototype.constructor=ft,mt.prototype=Object.create(dt.prototype),mt.prototype.constructor=mt,gt.prototype=Object.create(dt.prototype),gt.prototype.constructor=gt,vt.prototype=Object.create(dt.prototype),vt.prototype.constructor=vt,yt.prototype=Object.create(dt.prototype),yt.prototype.constructor=yt,xt.prototype=Object.create(dt.prototype),xt.prototype.constructor=xt,_t.prototype=Object.create(dt.prototype),_t.prototype.constructor=_t,bt.prototype=Object.create(dt.prototype),bt.prototype.constructor=bt,wt.prototype=Object.create(dt.prototype),wt.prototype.constructor=wt,Object.assign(Mt.prototype,{computeGroups:function(t){for(var e,i=[],n=void 0,r=t.faces,a=0;a<r.length;a++){var o=r[a];o.materialIndex!==n&&(n=o.materialIndex,void 0!==e&&(e.count=3*a-e.start,i.push(e)),e={start:3*a,materialIndex:n})}void 0!==e&&(e.count=3*a-e.start,i.push(e)),this.groups=i},fromGeometry:function(t){var e,n=t.faces,r=t.vertices,a=t.faceVertexUvs,o=a[0]&&a[0].length>0,s=a[1]&&a[1].length>0,c=t.morphTargets,h=c.length;if(h>0){e=[];for(var l=0;l<h;l++)e[l]=[];this.morphTargets.position=e}var u,p=t.morphNormals,d=p.length;if(d>0){u=[];for(var l=0;l<d;l++)u[l]=[];this.morphTargets.normal=u}for(var f=t.skinIndices,m=t.skinWeights,g=f.length===r.length,v=m.length===r.length,l=0;l<n.length;l++){var y=n[l];this.vertices.push(r[y.a],r[y.b],r[y.c]);var x=y.vertexNormals;if(3===x.length)this.normals.push(x[0],x[1],x[2]);else{var _=y.normal;this.normals.push(_,_,_)}var b=y.vertexColors;if(3===b.length)this.colors.push(b[0],b[1],b[2]);else{var w=y.color;this.colors.push(w,w,w)}if(o===!0){var M=a[0][l];void 0!==M?this.uvs.push(M[0],M[1],M[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",l),this.uvs.push(new i,new i,new i))}if(s===!0){var M=a[1][l];void 0!==M?this.uvs2.push(M[0],M[1],M[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",l),this.uvs2.push(new i,new i,new i))}for(var E=0;E<h;E++){var T=c[E].vertices;e[E].push(T[y.a],T[y.b],T[y.c])}for(var E=0;E<d;E++){var S=p[E].vertexNormals[l];u[E].push(S.a,S.b,S.c)}g&&this.skinIndices.push(f[y.a],f[y.b],f[y.c]),v&&this.skinWeights.push(m[y.a],m[y.b],m[y.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this}}),Object.assign(Et.prototype,e.prototype,{isGeometry:!0,applyMatrix:function(t){for(var e=(new et).getNormalMatrix(t),i=0,n=this.vertices.length;i<n;i++){var r=this.vertices[i];r.applyMatrix4(t)}for(var i=0,n=this.faces.length;i<n;i++){var a=this.faces[i];a.normal.applyMatrix3(e).normalize();for(var o=0,s=a.vertexNormals.length;o<s;o++)a.vertexNormals[o].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var t;return function(e){return void 0===t&&(t=new h),t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t;return function(e){return void 0===t&&(t=new h),t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t;return function(e){return void 0===t&&(t=new h),t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t;return function(e,i,n){return void 0===t&&(t=new h),t.makeTranslation(e,i,n),this.applyMatrix(t),this}}(),scale:function(){var t;return function(e,i,n){return void 0===t&&(t=new h),t.makeScale(e,i,n),this.applyMatrix(t),this}}(),lookAt:function(){var t;return function(e){void 0===t&&(t=new ct),t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),fromBufferGeometry:function(t){function e(t,e,i,r){var a=void 0!==s?[p[t].clone(),p[e].clone(),p[i].clone()]:[],o=void 0!==h?[n.colors[t].clone(),n.colors[e].clone(),n.colors[i].clone()]:[],c=new ut(t,e,i,a,o,r);n.faces.push(c),void 0!==l&&n.faceVertexUvs[0].push([d[t].clone(),d[e].clone(),d[i].clone()]),void 0!==u&&n.faceVertexUvs[1].push([f[t].clone(),f[e].clone(),f[i].clone()])}var n=this,r=null!==t.index?t.index.array:void 0,a=t.attributes,o=a.position.array,s=void 0!==a.normal?a.normal.array:void 0,h=void 0!==a.color?a.color.array:void 0,l=void 0!==a.uv?a.uv.array:void 0,u=void 0!==a.uv2?a.uv2.array:void 0;void 0!==u&&(this.faceVertexUvs[1]=[]);for(var p=[],d=[],f=[],m=0,g=0;m<o.length;m+=3,g+=2)n.vertices.push(new c(o[m],o[m+1],o[m+2])),void 0!==s&&p.push(new c(s[m],s[m+1],s[m+2])),void 0!==h&&n.colors.push(new W(h[m],h[m+1],h[m+2])),void 0!==l&&d.push(new i(l[g],l[g+1])),void 0!==u&&f.push(new i(u[g],u[g+1]));if(void 0!==r){var v=t.groups;if(v.length>0)for(var m=0;m<v.length;m++)for(var y=v[m],x=y.start,_=y.count,g=x,b=x+_;g<b;g+=3)e(r[g],r[g+1],r[g+2],y.materialIndex);else for(var m=0;m<r.length;m+=3)e(r[m],r[m+1],r[m+2])}else for(var m=0;m<o.length/3;m+=3)e(m,m+1,m+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var t=this.boundingBox.getCenter().negate();return this.translate(t.x,t.y,t.z),t},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,i=0===e?1:1/e,n=new h;return n.set(i,0,0,-i*t.x,0,i,0,-i*t.y,0,0,i,-i*t.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var t=new c,e=new c,i=0,n=this.faces.length;i<n;i++){var r=this.faces[i],a=this.vertices[r.a],o=this.vertices[r.b],s=this.vertices[r.c];t.subVectors(s,o),e.subVectors(a,o),t.cross(e),t.normalize(),r.normal.copy(t)}},computeVertexNormals:function(t){void 0===t&&(t=!0);var e,i,n,r,a,o;for(o=new Array(this.vertices.length),e=0,i=this.vertices.length;e<i;e++)o[e]=new c;if(t){var s,h,l,u=new c,p=new c;for(n=0,r=this.faces.length;n<r;n++)a=this.faces[n],s=this.vertices[a.a],h=this.vertices[a.b],l=this.vertices[a.c],u.subVectors(l,h),p.subVectors(s,h),u.cross(p),o[a.a].add(u),o[a.b].add(u),o[a.c].add(u)}else for(this.computeFaceNormals(),n=0,r=this.faces.length;n<r;n++)a=this.faces[n],o[a.a].add(a.normal),o[a.b].add(a.normal),o[a.c].add(a.normal);for(e=0,i=this.vertices.length;e<i;e++)o[e].normalize();for(n=0,r=this.faces.length;n<r;n++){a=this.faces[n];var d=a.vertexNormals;3===d.length?(d[0].copy(o[a.a]),d[1].copy(o[a.b]),d[2].copy(o[a.c])):(d[0]=o[a.a].clone(),d[1]=o[a.b].clone(),d[2]=o[a.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,e,i;for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++){i=this.faces[t];var n=i.vertexNormals;3===n.length?(n[0].copy(i.normal),n[1].copy(i.normal),n[2].copy(i.normal)):(n[0]=i.normal.clone(),n[1]=i.normal.clone(),n[2]=i.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,i,n,r;for(i=0,n=this.faces.length;i<n;i++)for(r=this.faces[i],r.__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]),t=0,e=r.vertexNormals.length;t<e;t++)r.__originalVertexNormals[t]?r.__originalVertexNormals[t].copy(r.vertexNormals[t]):r.__originalVertexNormals[t]=r.vertexNormals[t].clone();var a=new Et;for(a.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var o,s,h=this.morphNormals[t].faceNormals,l=this.morphNormals[t].vertexNormals;for(i=0,n=this.faces.length;i<n;i++)o=new c,s={a:new c,b:new c,c:new c},h.push(o),l.push(s)}var u=this.morphNormals[t];a.vertices=this.morphTargets[t].vertices,a.computeFaceNormals(),a.computeVertexNormals();var o,s;for(i=0,n=this.faces.length;i<n;i++)r=this.faces[i],o=u.faceNormals[i],s=u.vertexNormals[i],o.copy(r.normal),s.a.copy(r.vertexNormals[0]),s.b.copy(r.vertexNormals[1]),s.c.copy(r.vertexNormals[2])}for(i=0,n=this.faces.length;i<n;i++)r=this.faces[i],r.normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals},computeLineDistances:function(){for(var t=0,e=this.vertices,i=0,n=e.length;i<n;i++)i>0&&(t+=e[i].distanceTo(e[i-1])),this.lineDistances[i]=t},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new $),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new tt),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,i){if((t&&t.isGeometry)===!1)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);var n,r=this.vertices.length,a=this.vertices,o=t.vertices,s=this.faces,c=t.faces,h=this.faceVertexUvs[0],l=t.faceVertexUvs[0],u=this.colors,p=t.colors;void 0===i&&(i=0),void 0!==e&&(n=(new et).getNormalMatrix(e));for(var d=0,f=o.length;d<f;d++){var m=o[d],g=m.clone();void 0!==e&&g.applyMatrix4(e),a.push(g)}for(var d=0,f=p.length;d<f;d++)u.push(p[d].clone());for(d=0,f=c.length;d<f;d++){var v,y,x,_=c[d],b=_.vertexNormals,w=_.vertexColors;v=new ut(_.a+r,_.b+r,_.c+r),v.normal.copy(_.normal),void 0!==n&&v.normal.applyMatrix3(n).normalize();for(var M=0,E=b.length;M<E;M++)y=b[M].clone(),void 0!==n&&y.applyMatrix3(n).normalize(),v.vertexNormals.push(y);v.color.copy(_.color);for(var M=0,E=w.length;M<E;M++)x=w[M],v.vertexColors.push(x.clone());v.materialIndex=_.materialIndex+i,s.push(v)}for(d=0,f=l.length;d<f;d++){var T=l[d],S=[];if(void 0!==T){for(var M=0,E=T.length;M<E;M++)S.push(T[M].clone());h.push(S);
}}},mergeMesh:function(t){return(t&&t.isMesh)===!1?void console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t):(t.matrixAutoUpdate&&t.updateMatrix(),void this.merge(t.geometry,t.matrix))},mergeVertices:function(){var t,e,i,n,r,a,o,s,c={},h=[],l=[],u=4,p=Math.pow(10,u);for(i=0,n=this.vertices.length;i<n;i++)t=this.vertices[i],e=Math.round(t.x*p)+"_"+Math.round(t.y*p)+"_"+Math.round(t.z*p),void 0===c[e]?(c[e]=i,h.push(this.vertices[i]),l[i]=h.length-1):l[i]=l[c[e]];var d=[];for(i=0,n=this.faces.length;i<n;i++){r=this.faces[i],r.a=l[r.a],r.b=l[r.b],r.c=l[r.c],a=[r.a,r.b,r.c];for(var f=-1,m=0;m<3;m++)if(a[m]===a[(m+1)%3]){f=m,d.push(i);break}}for(i=d.length-1;i>=0;i--){var g=d[i];for(this.faces.splice(g,1),o=0,s=this.faceVertexUvs.length;o<s;o++)this.faceVertexUvs[o].splice(g,1)}var v=this.vertices.length-h.length;return this.vertices=h,v},sortFacesByMaterialIndex:function(){function t(t,e){return t.materialIndex-e.materialIndex}for(var e=this.faces,i=e.length,n=0;n<i;n++)e[n]._id=n;e.sort(t);var r,a,o=this.faceVertexUvs[0],s=this.faceVertexUvs[1];o&&o.length===i&&(r=[]),s&&s.length===i&&(a=[]);for(var n=0;n<i;n++){var c=e[n]._id;r&&r.push(o[c]),a&&a.push(s[c])}r&&(this.faceVertexUvs[0]=r),a&&(this.faceVertexUvs[1]=a)},toJSON:function(){function t(t,e,i){return i?t|1<<e:t&~(1<<e)}function e(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==p[e]?p[e]:(p[e]=u.length/3,u.push(t.x,t.y,t.z),p[e])}function i(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==f[e]?f[e]:(f[e]=d.length,d.push(t.getHex()),f[e])}function n(t){var e=t.x.toString()+t.y.toString();return void 0!==g[e]?g[e]:(g[e]=m.length/2,m.push(t.x,t.y),g[e])}var r={metadata:{version:4.4,type:"Geometry",generator:"Geometry.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),void 0!==this.parameters){var a=this.parameters;for(var o in a)void 0!==a[o]&&(r[o]=a[o]);return r}for(var s=[],c=0;c<this.vertices.length;c++){var h=this.vertices[c];s.push(h.x,h.y,h.z)}for(var l=[],u=[],p={},d=[],f={},m=[],g={},c=0;c<this.faces.length;c++){var v=this.faces[c],y=!0,x=!1,_=void 0!==this.faceVertexUvs[0][c],b=v.normal.length()>0,w=v.vertexNormals.length>0,M=1!==v.color.r||1!==v.color.g||1!==v.color.b,E=v.vertexColors.length>0,T=0;if(T=t(T,0,0),T=t(T,1,y),T=t(T,2,x),T=t(T,3,_),T=t(T,4,b),T=t(T,5,w),T=t(T,6,M),T=t(T,7,E),l.push(T),l.push(v.a,v.b,v.c),l.push(v.materialIndex),_){var S=this.faceVertexUvs[0][c];l.push(n(S[0]),n(S[1]),n(S[2]))}if(b&&l.push(e(v.normal)),w){var A=v.vertexNormals;l.push(e(A[0]),e(A[1]),e(A[2]))}if(M&&l.push(i(v.color)),E){var L=v.vertexColors;l.push(i(L[0]),i(L[1]),i(L[2]))}}return r.data={},r.data.vertices=s,r.data.normals=u,d.length>0&&(r.data.colors=d),m.length>0&&(r.data.uvs=[m]),r.data.faces=l,r},clone:function(){return(new Et).copy(this)},copy:function(t){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]],this.colors=[];for(var e=t.vertices,i=0,n=e.length;i<n;i++)this.vertices.push(e[i].clone());for(var r=t.colors,i=0,n=r.length;i<n;i++)this.colors.push(r[i].clone());for(var a=t.faces,i=0,n=a.length;i<n;i++)this.faces.push(a[i].clone());for(var i=0,n=t.faceVertexUvs.length;i<n;i++){var o=t.faceVertexUvs[i];void 0===this.faceVertexUvs[i]&&(this.faceVertexUvs[i]=[]);for(var s=0,c=o.length;s<c;s++){for(var h=o[s],l=[],u=0,p=h.length;u<p;u++){var d=h[u];l.push(d.clone())}this.faceVertexUvs[i].push(l)}}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var hh=0;Object.assign(St.prototype,e.prototype,{isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){this.index=t},addAttribute:function(t,e){return(e&&e.isBufferAttribute)===!1&&(e&&e.isInterleavedBufferAttribute)===!1?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(t,new dt(arguments[1],arguments[2]))):"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(e)):(this.attributes[t]=e,this)},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,i){this.groups.push({start:t,count:e,materialIndex:void 0!==i?i:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;void 0!==e&&(t.applyToVector3Array(e.array),e.needsUpdate=!0);var i=this.attributes.normal;if(void 0!==i){var n=(new et).getNormalMatrix(t);n.applyToVector3Array(i.array),i.needsUpdate=!0}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var t;return function(e){return void 0===t&&(t=new h),t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t;return function(e){return void 0===t&&(t=new h),t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t;return function(e){return void 0===t&&(t=new h),t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t;return function(e,i,n){return void 0===t&&(t=new h),t.makeTranslation(e,i,n),this.applyMatrix(t),this}}(),scale:function(){var t;return function(e,i,n){return void 0===t&&(t=new h),t.makeScale(e,i,n),this.applyMatrix(t),this}}(),lookAt:function(){var t;return function(e){void 0===t&&(t=new ct),t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),center:function(){this.computeBoundingBox();var t=this.boundingBox.getCenter().negate();return this.translate(t.x,t.y,t.z),t},setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){var i=new bt(3*e.vertices.length,3),n=new bt(3*e.colors.length,3);if(this.addAttribute("position",i.copyVector3sArray(e.vertices)),this.addAttribute("color",n.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var r=new bt(e.lineDistances.length,1);this.addAttribute("lineDistance",r.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},updateFromObject:function(t){var e=t.geometry;if(t.isMesh){var i=e.__directGeometry;if(e.elementsNeedUpdate===!0&&(i=void 0,e.elementsNeedUpdate=!1),void 0===i)return this.fromGeometry(e);i.verticesNeedUpdate=e.verticesNeedUpdate,i.normalsNeedUpdate=e.normalsNeedUpdate,i.colorsNeedUpdate=e.colorsNeedUpdate,i.uvsNeedUpdate=e.uvsNeedUpdate,i.groupsNeedUpdate=e.groupsNeedUpdate,e.verticesNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.groupsNeedUpdate=!1,e=i}var n;return e.verticesNeedUpdate===!0&&(n=this.attributes.position,void 0!==n&&(n.copyVector3sArray(e.vertices),n.needsUpdate=!0),e.verticesNeedUpdate=!1),e.normalsNeedUpdate===!0&&(n=this.attributes.normal,void 0!==n&&(n.copyVector3sArray(e.normals),n.needsUpdate=!0),e.normalsNeedUpdate=!1),e.colorsNeedUpdate===!0&&(n=this.attributes.color,void 0!==n&&(n.copyColorsArray(e.colors),n.needsUpdate=!0),e.colorsNeedUpdate=!1),e.uvsNeedUpdate&&(n=this.attributes.uv,void 0!==n&&(n.copyVector2sArray(e.uvs),n.needsUpdate=!0),e.uvsNeedUpdate=!1),e.lineDistancesNeedUpdate&&(n=this.attributes.lineDistance,void 0!==n&&(n.copyArray(e.lineDistances),n.needsUpdate=!0),e.lineDistancesNeedUpdate=!1),e.groupsNeedUpdate&&(e.computeGroups(t.geometry),this.groups=e.groups,e.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new Mt).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.addAttribute("position",new dt(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var i=new Float32Array(3*t.normals.length);this.addAttribute("normal",new dt(i,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var n=new Float32Array(3*t.colors.length);this.addAttribute("color",new dt(n,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var r=new Float32Array(2*t.uvs.length);this.addAttribute("uv",new dt(r,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var a=new Float32Array(2*t.uvs2.length);this.addAttribute("uv2",new dt(a,2).copyVector2sArray(t.uvs2))}if(t.indices.length>0){var o=t.vertices.length>65535?Uint32Array:Uint16Array,s=new o(3*t.indices.length);this.setIndex(new dt(s,1).copyIndicesArray(t.indices))}this.groups=t.groups;for(var c in t.morphTargets){for(var h=[],l=t.morphTargets[c],u=0,p=l.length;u<p;u++){var d=l[u],f=new bt(3*d.length,3);h.push(f.copyVector3sArray(d))}this.morphAttributes[c]=h}if(t.skinIndices.length>0){var m=new bt(4*t.skinIndices.length,4);this.addAttribute("skinIndex",m.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var g=new bt(4*t.skinWeights.length,4);this.addAttribute("skinWeight",g.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new $);var t=this.attributes.position;void 0!==t?this.boundingBox.setFromBufferAttribute(t):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var t=new $,e=new c;return function(){null===this.boundingSphere&&(this.boundingSphere=new tt);var i=this.attributes.position;if(i){var n=this.boundingSphere.center;t.setFromBufferAttribute(i),t.getCenter(n);for(var r=0,a=0,o=i.count;a<o;a++)e.x=i.getX(a),e.y=i.getY(a),e.z=i.getZ(a),r=Math.max(r,n.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes,i=this.groups;if(e.position){var n=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new dt(new Float32Array(n.length),3));else for(var r=e.normal.array,a=0,o=r.length;a<o;a++)r[a]=0;var s,h,l,u=e.normal.array,p=new c,d=new c,f=new c,m=new c,g=new c;if(t){var v=t.array;0===i.length&&this.addGroup(0,v.length);for(var y=0,x=i.length;y<x;++y)for(var _=i[y],b=_.start,w=_.count,a=b,o=b+w;a<o;a+=3)s=3*v[a+0],h=3*v[a+1],l=3*v[a+2],p.fromArray(n,s),d.fromArray(n,h),f.fromArray(n,l),m.subVectors(f,d),g.subVectors(p,d),m.cross(g),u[s]+=m.x,u[s+1]+=m.y,u[s+2]+=m.z,u[h]+=m.x,u[h+1]+=m.y,u[h+2]+=m.z,u[l]+=m.x,u[l+1]+=m.y,u[l+2]+=m.z}else for(var a=0,o=n.length;a<o;a+=9)p.fromArray(n,a),d.fromArray(n,a+3),f.fromArray(n,a+6),m.subVectors(f,d),g.subVectors(p,d),m.cross(g),u[a]=m.x,u[a+1]=m.y,u[a+2]=m.z,u[a+3]=m.x,u[a+4]=m.y,u[a+5]=m.z,u[a+6]=m.x,u[a+7]=m.y,u[a+8]=m.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if((t&&t.isBufferGeometry)===!1)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===e&&(e=0);var i=this.attributes;for(var n in i)if(void 0!==t.attributes[n])for(var r=i[n],a=r.array,o=t.attributes[n],s=o.array,c=o.itemSize,h=0,l=c*e;h<s.length;h++,l++)a[l]=s[h];return this},normalizeNormals:function(){for(var t,e,i,n,r=this.attributes.normal.array,a=0,o=r.length;a<o;a+=3)t=r[a],e=r[a+1],i=r[a+2],n=1/Math.sqrt(t*t+e*e+i*i),r[a]*=n,r[a+1]*=n,r[a+2]*=n},toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new St,e=this.index.array,i=this.attributes;for(var n in i){for(var r=i[n],a=r.array,o=r.itemSize,s=new a.constructor(e.length*o),c=0,h=0,l=0,u=e.length;l<u;l++){c=e[l]*o;for(var p=0;p<o;p++)s[h++]=a[c++]}t.addAttribute(n,new dt(s,o))}return t},toJSON:function(){var t={metadata:{version:4.4,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var i in e)void 0!==e[i]&&(t[i]=e[i]);return t}t.data={attributes:{}};var n=this.index;if(null!==n){var r=Array.prototype.slice.call(n.array);t.data.index={type:n.array.constructor.name,array:r}}var a=this.attributes;for(var i in a){var o=a[i],r=Array.prototype.slice.call(o.array);t.data.attributes[i]={itemSize:o.itemSize,type:o.array.constructor.name,array:r,normalized:o.normalized}}var s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));var c=this.boundingSphere;return null!==c&&(t.data.boundingSphere={center:c.center.toArray(),radius:c.radius}),t},clone:function(){return(new St).copy(this)},copy:function(t){var e=t.index;null!==e&&this.setIndex(e.clone());var i=t.attributes;for(var n in i){var r=i[n];this.addAttribute(n,r.clone())}for(var a=t.groups,o=0,s=a.length;o<s;o++){var c=a[o];this.addGroup(c.start,c.count,c.materialIndex)}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),St.MaxIndex=65535,At.prototype=Object.assign(Object.create(ct.prototype),{constructor:At,isMesh:!0,setDrawMode:function(t){this.drawMode=t},copy:function(t){return ct.prototype.copy.call(this,t),this.drawMode=t.drawMode,this},updateMorphTargets:function(){var t=this.geometry.morphTargets;if(void 0!==t&&t.length>0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var e=0,i=t.length;e<i;e++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[t[e].name]=e}},raycast:function(){function t(t,e,i,n,r,a,o){return lt.barycoordFromPoint(t,e,i,n,y),r.multiplyScalar(y.x),a.multiplyScalar(y.y),o.multiplyScalar(y.z),r.add(a).add(o),r.clone()}function e(t,e,i,n,r,a,o){var s,c=t.material;if(s=c.side===Hr?i.intersectTriangle(a,r,n,!0,o):i.intersectTriangle(n,r,a,c.side!==Vr,o),null===s)return null;_.copy(o),_.applyMatrix4(t.matrixWorld);var h=e.ray.origin.distanceTo(_);return h<e.near||h>e.far?null:{distance:h,point:_.clone(),object:t}}function n(i,n,r,a,o,c,h,p){s.fromArray(a,3*c),l.fromArray(a,3*h),u.fromArray(a,3*p);var d=e(i,n,r,s,l,u,x);return d&&(o&&(m.fromArray(o,2*c),g.fromArray(o,2*h),v.fromArray(o,2*p),d.uv=t(x,s,l,u,m,g,v)),d.face=new ut(c,h,p,lt.normal(s,l,u)),d.faceIndex=c),d}var r=new h,a=new at,o=new tt,s=new c,l=new c,u=new c,p=new c,d=new c,f=new c,m=new i,g=new i,v=new i,y=new c,x=new c,_=new c;return function(i,c){var h=this.geometry,y=this.material,_=this.matrixWorld;if(void 0!==y&&(null===h.boundingSphere&&h.computeBoundingSphere(),o.copy(h.boundingSphere),o.applyMatrix4(_),i.ray.intersectsSphere(o)!==!1&&(r.getInverse(_),a.copy(i.ray).applyMatrix4(r),null===h.boundingBox||a.intersectsBox(h.boundingBox)!==!1))){var b,w;if(h.isBufferGeometry){var M,E,T,S=h.index,A=h.attributes,L=A.position.array;if(void 0!==A.uv&&(b=A.uv.array),null!==S)for(var R=S.array,P=0,C=R.length;P<C;P+=3)M=R[P],E=R[P+1],T=R[P+2],w=n(this,i,a,L,b,M,E,T),w&&(w.faceIndex=Math.floor(P/3),c.push(w));else for(var P=0,C=L.length;P<C;P+=9)M=P/3,E=M+1,T=M+2,w=n(this,i,a,L,b,M,E,T),w&&(w.index=M,c.push(w))}else if(h.isGeometry){var I,U,N,D=y&&y.isMultiMaterial,O=D===!0?y.materials:null,F=h.vertices,z=h.faces,B=h.faceVertexUvs[0];B.length>0&&(b=B);for(var G=0,H=z.length;G<H;G++){var V=z[G],k=D===!0?O[V.materialIndex]:y;if(void 0!==k){if(I=F[V.a],U=F[V.b],N=F[V.c],k.morphTargets===!0){var j=h.morphTargets,W=this.morphTargetInfluences;s.set(0,0,0),l.set(0,0,0),u.set(0,0,0);for(var X=0,Y=j.length;X<Y;X++){var q=W[X];if(0!==q){var Z=j[X].vertices;s.addScaledVector(p.subVectors(Z[V.a],I),q),l.addScaledVector(d.subVectors(Z[V.b],U),q),u.addScaledVector(f.subVectors(Z[V.c],N),q)}}s.add(I),l.add(U),u.add(N),I=s,U=l,N=u}if(w=e(this,i,a,I,U,N,x)){if(b){var J=b[G];m.copy(J[0]),g.copy(J[1]),v.copy(J[2]),w.uv=t(x,I,U,N,m,g,v)}w.face=V,w.faceIndex=G,c.push(w)}}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Lt.prototype=Object.create(St.prototype),Lt.prototype.constructor=Lt,Rt.prototype=Object.create(St.prototype),Rt.prototype.constructor=Rt,Pt.prototype=Object.create(ct.prototype),Pt.prototype.constructor=Pt,Pt.prototype.isCamera=!0,Pt.prototype.getWorldDirection=function(){var t=new s;return function(e){var i=e||new c;return this.getWorldQuaternion(t),i.set(0,0,-1).applyQuaternion(t)}}(),Pt.prototype.lookAt=function(){var t=new h;return function(e){t.lookAt(this.position,e,this.up),this.quaternion.setFromRotationMatrix(t)}}(),Pt.prototype.clone=function(){return(new this.constructor).copy(this)},Pt.prototype.copy=function(t){return ct.prototype.copy.call(this,t),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this},Ct.prototype=Object.assign(Object.create(Pt.prototype),{constructor:Ct,isPerspectiveCamera:!0,copy:function(t){return Pt.prototype.copy.call(this,t),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var e=.5*this.getFilmHeight()/t;this.fov=2*Qo.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*Qo.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*Qo.RAD2DEG*Math.atan(Math.tan(.5*Qo.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,i,n,r,a){this.aspect=t/e,this.view={fullWidth:t,fullHeight:e,offsetX:i,offsetY:n,width:r,height:a},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=t*Math.tan(.5*Qo.DEG2RAD*this.fov)/this.zoom,i=2*e,n=this.aspect*i,r=-.5*n,a=this.view;if(null!==a){var o=a.fullWidth,s=a.fullHeight;r+=a.offsetX*n/o,e-=a.offsetY*i/s,n*=a.width/o,i*=a.height/s}var c=this.filmOffset;0!==c&&(r+=t*c/this.getFilmWidth()),this.projectionMatrix.makeFrustum(r,r+n,e-i,e,t,this.far)},toJSON:function(t){var e=ct.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}),It.prototype=Object.assign(Object.create(Pt.prototype),{constructor:It,isOrthographicCamera:!0,copy:function(t){return Pt.prototype.copy.call(this,t),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,i,n,r,a){this.view={fullWidth:t,fullHeight:e,offsetX:i,offsetY:n,width:r,height:a},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2,r=i-t,a=i+t,o=n+e,s=n-e;if(null!==this.view){var c=this.zoom/(this.view.width/this.view.fullWidth),h=this.zoom/(this.view.height/this.view.fullHeight),l=(this.right-this.left)/this.view.width,u=(this.top-this.bottom)/this.view.height;r+=l*(this.view.offsetX/c),a=r+l*(this.view.width/c),o-=u*(this.view.offsetY/h),s=o-u*(this.view.height/h)}this.projectionMatrix.makeOrthographic(r,a,o,s,this.near,this.far)},toJSON:function(t){var e=ct.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}});var lh=0;oe.prototype.isFogExp2=!0,oe.prototype.clone=function(){return new oe(this.color.getHex(),this.density)},oe.prototype.toJSON=function(t){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},se.prototype.isFog=!0,se.prototype.clone=function(){return new se(this.color.getHex(),this.near,this.far)},se.prototype.toJSON=function(t){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},ce.prototype=Object.create(ct.prototype),ce.prototype.constructor=ce,ce.prototype.copy=function(t,e){return ct.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},ce.prototype.toJSON=function(t){var e=ct.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e},he.prototype=Object.assign(Object.create(ct.prototype),{constructor:he,isLensFlare:!0,copy:function(t){ct.prototype.copy.call(this,t),this.positionScreen.copy(t.positionScreen),this.customUpdateCallback=t.customUpdateCallback;for(var e=0,i=t.lensFlares.length;e<i;e++)this.lensFlares.push(t.lensFlares[e]);return this},add:function(t,e,i,n,r,a){void 0===e&&(e=-1),void 0===i&&(i=0),void 0===a&&(a=1),void 0===r&&(r=new W(16777215)),void 0===n&&(n=Zr),i=Math.min(i,Math.max(0,i)),this.lensFlares.push({texture:t,size:e,distance:i,x:0,y:0,z:0,scale:1,rotation:0,opacity:a,color:r,blending:n})},updateLensFlares:function(){var t,e,i=this.lensFlares.length,n=2*-this.positionScreen.x,r=2*-this.positionScreen.y;for(t=0;t<i;t++)e=this.lensFlares[t],e.x=this.positionScreen.x+n*e.distance,e.y=this.positionScreen.y+r*e.distance,e.wantedRotation=e.x*Math.PI*.25,e.rotation+=.25*(e.wantedRotation-e.rotation)}}),le.prototype=Object.create(J.prototype),le.prototype.constructor=le,le.prototype.copy=function(t){return J.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this},ue.prototype=Object.assign(Object.create(ct.prototype),{constructor:ue,isSprite:!0,raycast:function(){var t=new c;return function(e,i){t.setFromMatrixPosition(this.matrixWorld);var n=e.ray.distanceSqToPoint(t),r=this.scale.x*this.scale.y/4;n>r||i.push({distance:Math.sqrt(n),point:this.position,face:null,object:this})}}(),clone:function(){return new this.constructor(this.material).copy(this)}}),pe.prototype=Object.assign(Object.create(ct.prototype),{constructor:pe,copy:function(t){ct.prototype.copy.call(this,t,!1);for(var e=t.levels,i=0,n=e.length;i<n;i++){var r=e[i];this.addLevel(r.object.clone(),r.distance)}return this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var i=this.levels,n=0;n<i.length&&!(e<i[n].distance);n++);i.splice(n,0,{distance:e,object:t}),this.add(t)},getObjectForDistance:function(t){for(var e=this.levels,i=1,n=e.length;i<n&&!(t<e[i].distance);i++);return e[i-1].object},raycast:function(){var t=new c;return function(e,i){t.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(t);this.getObjectForDistance(n).raycast(e,i)}}(),update:function(){var t=new c,e=new c;return function(i){var n=this.levels;if(n.length>1){t.setFromMatrixPosition(i.matrixWorld),e.setFromMatrixPosition(this.matrixWorld);var r=t.distanceTo(e);n[0].object.visible=!0;for(var a=1,o=n.length;a<o&&r>=n[a].distance;a++)n[a-1].object.visible=!1,n[a].object.visible=!0;for(;a<o;a++)n[a].object.visible=!1}}}(),toJSON:function(t){var e=ct.prototype.toJSON.call(this,t);e.object.levels=[];for(var i=this.levels,n=0,r=i.length;n<r;n++){var a=i[n];e.object.levels.push({object:a.object.uuid,distance:a.distance})}return e}}),Object.assign(de.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var i=new h;this.bones[t]&&i.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(i)}},pose:function(){for(var t,e=0,i=this.bones.length;e<i;e++)t=this.bones[e],t&&t.matrixWorld.getInverse(this.boneInverses[e]);for(var e=0,i=this.bones.length;e<i;e++)t=this.bones[e],t&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){var t=new h;return function(){for(var e=0,i=this.bones.length;e<i;e++){var n=this.bones[e]?this.bones[e].matrixWorld:this.identityMatrix;t.multiplyMatrices(n,this.boneInverses[e]),t.toArray(this.boneMatrices,16*e)}this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}(),clone:function(){return new de(this.bones,this.boneInverses,this.useVertexTexture)}}),fe.prototype=Object.assign(Object.create(ct.prototype),{constructor:fe,isBone:!0}),me.prototype=Object.assign(Object.create(At.prototype),{constructor:me,isSkinnedMesh:!0,bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){if(this.geometry&&this.geometry.isGeometry)for(var t=0;t<this.geometry.skinWeights.length;t++){var e=this.geometry.skinWeights[t],i=1/e.lengthManhattan();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry)for(var n=new r,a=this.geometry.attributes.skinWeight,t=0;t<a.count;t++){n.x=a.getX(t),n.y=a.getY(t),n.z=a.getZ(t),n.w=a.getW(t);var i=1/n.lengthManhattan();i!==1/0?n.multiplyScalar(i):n.set(1,0,0,0),a.setXYZW(t,n.x,n.y,n.z,n.w)}},updateMatrixWorld:function(t){At.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material,this.skeleton.useVertexTexture).copy(this)}}),ge.prototype=Object.create(J.prototype),ge.prototype.constructor=ge,ge.prototype.isLineBasicMaterial=!0,ge.prototype.copy=function(t){return J.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this},ve.prototype=Object.assign(Object.create(ct.prototype),{constructor:ve,isLine:!0,raycast:function(){var t=new h,e=new at,i=new tt;return function(n,r){var a=n.linePrecision,o=a*a,s=this.geometry,h=this.matrixWorld;if(null===s.boundingSphere&&s.computeBoundingSphere(),i.copy(s.boundingSphere),i.applyMatrix4(h),n.ray.intersectsSphere(i)!==!1){t.getInverse(h),e.copy(n.ray).applyMatrix4(t);var l=new c,u=new c,p=new c,d=new c,f=this&&this.isLineSegments?2:1;if(s.isBufferGeometry){var m=s.index,g=s.attributes,v=g.position.array;if(null!==m)for(var y=m.array,x=0,_=y.length-1;x<_;x+=f){var b=y[x],w=y[x+1];l.fromArray(v,3*b),u.fromArray(v,3*w);var M=e.distanceSqToSegment(l,u,d,p);if(!(M>o)){d.applyMatrix4(this.matrixWorld);var E=n.ray.origin.distanceTo(d);E<n.near||E>n.far||r.push({distance:E,point:p.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}else for(var x=0,_=v.length/3-1;x<_;x+=f){l.fromArray(v,3*x),u.fromArray(v,3*x+3);var M=e.distanceSqToSegment(l,u,d,p);if(!(M>o)){d.applyMatrix4(this.matrixWorld);var E=n.ray.origin.distanceTo(d);E<n.near||E>n.far||r.push({distance:E,point:p.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}}else if(s.isGeometry)for(var T=s.vertices,S=T.length,x=0;x<S-1;x+=f){var M=e.distanceSqToSegment(T[x],T[x+1],d,p);if(!(M>o)){d.applyMatrix4(this.matrixWorld);var E=n.ray.origin.distanceTo(d);E<n.near||E>n.far||r.push({distance:E,point:p.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),ye.prototype=Object.assign(Object.create(ve.prototype),{constructor:ye,isLineSegments:!0}),xe.prototype=Object.create(J.prototype),xe.prototype.constructor=xe,xe.prototype.isPointsMaterial=!0,xe.prototype.copy=function(t){return J.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this},_e.prototype=Object.assign(Object.create(ct.prototype),{constructor:_e,isPoints:!0,raycast:function(){var t=new h,e=new at,i=new tt;return function(n,r){function a(t,i){var a=e.distanceSqToPoint(t);if(a<p){var s=e.closestPointToPoint(t);s.applyMatrix4(h);var c=n.ray.origin.distanceTo(s);if(c<n.near||c>n.far)return;r.push({distance:c,distanceToRay:Math.sqrt(a),point:s.clone(),index:i,face:null,object:o})}}var o=this,s=this.geometry,h=this.matrixWorld,l=n.params.Points.threshold;if(null===s.boundingSphere&&s.computeBoundingSphere(),i.copy(s.boundingSphere),i.applyMatrix4(h),n.ray.intersectsSphere(i)!==!1){t.getInverse(h),e.copy(n.ray).applyMatrix4(t);var u=l/((this.scale.x+this.scale.y+this.scale.z)/3),p=u*u,d=new c;if(s.isBufferGeometry){var f=s.index,m=s.attributes,g=m.position.array;if(null!==f)for(var v=f.array,y=0,x=v.length;y<x;y++){var _=v[y];d.fromArray(g,3*_),a(d,_)}else for(var y=0,b=g.length/3;y<b;y++)d.fromArray(g,3*y),a(d,y)}else for(var w=s.vertices,y=0,b=w.length;y<b;y++)a(w[y],y)}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),be.prototype=Object.assign(Object.create(ct.prototype),{constructor:be}),we.prototype=Object.create(n.prototype),we.prototype.constructor=we,Me.prototype=Object.create(n.prototype),Me.prototype.constructor=Me,Me.prototype.isCompressedTexture=!0,Ee.prototype=Object.create(n.prototype),Ee.prototype.constructor=Ee,Te.prototype=Object.create(n.prototype),Te.prototype.constructor=Te,Te.prototype.isDepthTexture=!0,Se.prototype=Object.create(St.prototype),Se.prototype.constructor=Se,Ae.prototype=Object.create(St.prototype),Ae.prototype.constructor=Ae,Le.prototype=Object.create(Et.prototype),Le.prototype.constructor=Le,Re.prototype=Object.create(St.prototype),Re.prototype.constructor=Re,Pe.prototype=Object.create(Re.prototype),Pe.prototype.constructor=Pe,Ce.prototype=Object.create(Et.prototype),Ce.prototype.constructor=Ce,Ie.prototype=Object.create(Re.prototype),Ie.prototype.constructor=Ie,Ue.prototype=Object.create(Et.prototype),Ue.prototype.constructor=Ue,Ne.prototype=Object.create(Re.prototype),Ne.prototype.constructor=Ne,De.prototype=Object.create(Et.prototype),De.prototype.constructor=De,Oe.prototype=Object.create(Re.prototype),Oe.prototype.constructor=Oe,Fe.prototype=Object.create(Et.prototype),Fe.prototype.constructor=Fe,ze.prototype=Object.create(Et.prototype),ze.prototype.constructor=ze,Be.prototype=Object.create(St.prototype),Be.prototype.constructor=Be,Ge.prototype=Object.create(Et.prototype),Ge.prototype.constructor=Ge,He.prototype=Object.create(St.prototype),He.prototype.constructor=He,Ve.prototype=Object.create(Et.prototype),Ve.prototype.constructor=Ve,ke.prototype=Object.create(St.prototype),ke.prototype.constructor=ke,je.prototype=Object.create(Et.prototype),je.prototype.constructor=je;var uh={area:function(t){for(var e=t.length,i=0,n=e-1,r=0;r<e;n=r++)i+=t[n].x*t[r].y-t[r].x*t[n].y;return.5*i},triangulate:function(){function t(t,e,i,n,r,a){var o,s,c,h,l,u,p,d,f;if(s=t[a[e]].x,c=t[a[e]].y,h=t[a[i]].x,l=t[a[i]].y,u=t[a[n]].x,p=t[a[n]].y,(h-s)*(p-c)-(l-c)*(u-s)<=0)return!1;var m,g,v,y,x,_,b,w,M,E,T,S,A,L,R;for(m=u-h,g=p-l,v=s-u,y=c-p,x=h-s,_=l-c,o=0;o<r;o++)if(d=t[a[o]].x,f=t[a[o]].y,!(d===s&&f===c||d===h&&f===l||d===u&&f===p)&&(b=d-s,w=f-c,M=d-h,E=f-l,T=d-u,S=f-p,R=m*E-g*M,A=x*w-_*b,L=v*S-y*T,R>=-Number.EPSILON&&L>=-Number.EPSILON&&A>=-Number.EPSILON))return!1;return!0}return function(e,i){var n=e.length;if(n<3)return null;var r,a,o,s=[],c=[],h=[];if(uh.area(e)>0)for(a=0;a<n;a++)c[a]=a;else for(a=0;a<n;a++)c[a]=n-1-a;
var l=n,u=2*l;for(a=l-1;l>2;){if(u--<=0)return console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()"),i?h:s;if(r=a,l<=r&&(r=0),a=r+1,l<=a&&(a=0),o=a+1,l<=o&&(o=0),t(e,r,a,o,l,c)){var p,d,f,m,g;for(p=c[r],d=c[a],f=c[o],s.push([e[p],e[d],e[f]]),h.push([c[r],c[a],c[o]]),m=a,g=a+1;g<l;m++,g++)c[m]=c[g];l--,u=2*l}}return i?h:s}}(),triangulateShape:function(t,e){function i(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function n(t,e,i){return t.x!==e.x?t.x<e.x?t.x<=i.x&&i.x<=e.x:e.x<=i.x&&i.x<=t.x:t.y<e.y?t.y<=i.y&&i.y<=e.y:e.y<=i.y&&i.y<=t.y}function r(t,e,i,r,a){var o=e.x-t.x,s=e.y-t.y,c=r.x-i.x,h=r.y-i.y,l=t.x-i.x,u=t.y-i.y,p=s*c-o*h,d=s*l-o*u;if(Math.abs(p)>Number.EPSILON){var f;if(p>0){if(d<0||d>p)return[];if(f=h*l-c*u,f<0||f>p)return[]}else{if(d>0||d<p)return[];if(f=h*l-c*u,f>0||f<p)return[]}if(0===f)return!a||0!==d&&d!==p?[t]:[];if(f===p)return!a||0!==d&&d!==p?[e]:[];if(0===d)return[i];if(d===p)return[r];var m=f/p;return[{x:t.x+m*o,y:t.y+m*s}]}if(0!==d||h*l!==c*u)return[];var g=0===o&&0===s,v=0===c&&0===h;if(g&&v)return t.x!==i.x||t.y!==i.y?[]:[t];if(g)return n(i,r,t)?[t]:[];if(v)return n(t,e,i)?[i]:[];var y,x,_,b,w,M,E,T;return 0!==o?(t.x<e.x?(y=t,_=t.x,x=e,b=e.x):(y=e,_=e.x,x=t,b=t.x),i.x<r.x?(w=i,E=i.x,M=r,T=r.x):(w=r,E=r.x,M=i,T=i.x)):(t.y<e.y?(y=t,_=t.y,x=e,b=e.y):(y=e,_=e.y,x=t,b=t.y),i.y<r.y?(w=i,E=i.y,M=r,T=r.y):(w=r,E=r.y,M=i,T=i.y)),_<=E?b<E?[]:b===E?a?[]:[w]:b<=T?[w,x]:[w,M]:_>T?[]:_===T?a?[]:[y]:b<=T?[y,x]:[y,M]}function a(t,e,i,n){var r=e.x-t.x,a=e.y-t.y,o=i.x-t.x,s=i.y-t.y,c=n.x-t.x,h=n.y-t.y,l=r*s-a*o,u=r*h-a*c;if(Math.abs(l)>Number.EPSILON){var p=c*s-h*o;return l>0?u>=0&&p>=0:u>=0||p>=0}return u>0}function o(t,e){function i(t,e){var i=y.length-1,n=t-1;n<0&&(n=i);var r=t+1;r>i&&(r=0);var o=a(y[t],y[n],y[r],s[e]);if(!o)return!1;var c=s.length-1,h=e-1;h<0&&(h=c);var l=e+1;return l>c&&(l=0),o=a(s[e],s[h],s[l],y[t]),!!o}function n(t,e){var i,n,a;for(i=0;i<y.length;i++)if(n=i+1,n%=y.length,a=r(t,e,y[i],y[n],!0),a.length>0)return!0;return!1}function o(t,i){var n,a,o,s,c;for(n=0;n<x.length;n++)for(a=e[x[n]],o=0;o<a.length;o++)if(s=o+1,s%=a.length,c=r(t,i,a[o],a[s],!0),c.length>0)return!0;return!1}for(var s,c,h,l,u,p,d,f,m,g,v,y=t.concat(),x=[],_=[],b=0,w=e.length;b<w;b++)x.push(b);for(var M=0,E=2*x.length;x.length>0;){if(E--,E<0){console.log("Infinite Loop! Holes left:"+x.length+", Probably Hole outside Shape!");break}for(h=M;h<y.length;h++){l=y[h],c=-1;for(var b=0;b<x.length;b++)if(p=x[b],d=l.x+":"+l.y+":"+p,void 0===_[d]){s=e[p];for(var T=0;T<s.length;T++)if(u=s[T],i(h,T)&&!n(l,u)&&!o(l,u)){c=T,x.splice(b,1),f=y.slice(0,h+1),m=y.slice(h),g=s.slice(c),v=s.slice(0,c+1),y=f.concat(g).concat(v).concat(m),M=h;break}if(c>=0)break;_[d]=!0}if(c>=0)break}}return y}i(t),e.forEach(i);for(var s,c,h,l,u,p,d={},f=t.concat(),m=0,g=e.length;m<g;m++)Array.prototype.push.apply(f,e[m]);for(s=0,c=f.length;s<c;s++)u=f[s].x+":"+f[s].y,void 0!==d[u]&&console.warn("THREE.ShapeUtils: Duplicate point",u,s),d[u]=s;var v=o(t,e),y=uh.triangulate(v,!1);for(s=0,c=y.length;s<c;s++)for(l=y[s],h=0;h<3;h++)u=l[h].x+":"+l[h].y,p=d[u],void 0!==p&&(l[h]=p);return y.concat()},isClockWise:function(t){return uh.area(t)<0},b2:function(){function t(t,e){var i=1-t;return i*i*e}function e(t,e){return 2*(1-t)*t*e}function i(t,e){return t*t*e}return function(n,r,a,o){return t(n,r)+e(n,a)+i(n,o)}}(),b3:function(){function t(t,e){var i=1-t;return i*i*i*e}function e(t,e){var i=1-t;return 3*i*i*t*e}function i(t,e){var i=1-t;return 3*i*t*t*e}function n(t,e){return t*t*t*e}return function(r,a,o,s,c){return t(r,a)+e(r,o)+i(r,s)+n(r,c)}}()};We.prototype=Object.create(Et.prototype),We.prototype.constructor=We,We.prototype.addShapeList=function(t,e){for(var i=t.length,n=0;n<i;n++){var r=t[n];this.addShape(r,e)}},We.prototype.addShape=function(t,e){function n(t,e,i){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(i).add(t)}function r(t,e,n){var r,a,o=1,s=t.x-e.x,c=t.y-e.y,h=n.x-t.x,l=n.y-t.y,u=s*s+c*c,p=s*l-c*h;if(Math.abs(p)>Number.EPSILON){var d=Math.sqrt(u),f=Math.sqrt(h*h+l*l),m=e.x-c/d,g=e.y+s/d,v=n.x-l/f,y=n.y+h/f,x=((v-m)*l-(y-g)*h)/(s*l-c*h);r=m+s*x-t.x,a=g+c*x-t.y;var _=r*r+a*a;if(_<=2)return new i(r,a);o=Math.sqrt(_/2)}else{var b=!1;s>Number.EPSILON?h>Number.EPSILON&&(b=!0):s<-Number.EPSILON?h<-Number.EPSILON&&(b=!0):Math.sign(c)===Math.sign(l)&&(b=!0),b?(r=-c,a=s,o=Math.sqrt(u)):(r=s,a=c,o=Math.sqrt(u/2))}return new i(r/o,a/o)}function a(){if(b){var t=0,e=j*t;for(Y=0;Y<W;Y++)k=O[Y],l(k[2]+e,k[1]+e,k[0]+e);for(t=M+2*_,e=j*t,Y=0;Y<W;Y++)k=O[Y],l(k[0]+e,k[1]+e,k[2]+e)}else{for(Y=0;Y<W;Y++)k=O[Y],l(k[2],k[1],k[0]);for(Y=0;Y<W;Y++)k=O[Y],l(k[0]+j*M,k[1]+j*M,k[2]+j*M)}}function o(){var t=0;for(s(F,t),t+=F.length,L=0,R=N.length;L<R;L++)A=N[L],s(A,t),t+=A.length}function s(t,e){var i,n;for(Y=t.length;--Y>=0;){i=Y,n=Y-1,n<0&&(n=t.length-1);var r=0,a=M+2*_;for(r=0;r<a;r++){var o=j*r,s=j*(r+1),c=e+i+o,h=e+n+o,l=e+n+s,p=e+i+s;u(c,h,l,p,t,r,a,i,n)}}}function h(t,e,i){P.vertices.push(new c(t,e,i))}function l(t,e,i){t+=C,e+=C,i+=C,P.faces.push(new ut(t,e,i,null,null,0));var n=S.generateTopUV(P,t,e,i);P.faceVertexUvs[0].push(n)}function u(t,e,i,n,r,a,o,s,c){t+=C,e+=C,i+=C,n+=C,P.faces.push(new ut(t,e,n,null,null,1)),P.faces.push(new ut(e,i,n,null,null,1));var h=S.generateSideWallUV(P,t,e,i,n);P.faceVertexUvs[0].push([h[0],h[1],h[3]]),P.faceVertexUvs[0].push([h[1],h[2],h[3]])}var p,d,f,m,g,v=void 0!==e.amount?e.amount:100,y=void 0!==e.bevelThickness?e.bevelThickness:6,x=void 0!==e.bevelSize?e.bevelSize:y-2,_=void 0!==e.bevelSegments?e.bevelSegments:3,b=void 0===e.bevelEnabled||e.bevelEnabled,w=void 0!==e.curveSegments?e.curveSegments:12,M=void 0!==e.steps?e.steps:1,E=e.extrudePath,T=!1,S=void 0!==e.UVGenerator?e.UVGenerator:We.WorldUVGenerator;E&&(p=E.getSpacedPoints(M),T=!0,b=!1,d=void 0!==e.frames?e.frames:E.computeFrenetFrames(M,!1),f=new c,m=new c,g=new c),b||(_=0,y=0,x=0);var A,L,R,P=this,C=this.vertices.length,I=t.extractPoints(w),U=I.shape,N=I.holes,D=!uh.isClockWise(U);if(D){for(U=U.reverse(),L=0,R=N.length;L<R;L++)A=N[L],uh.isClockWise(A)&&(N[L]=A.reverse());D=!1}var O=uh.triangulateShape(U,N),F=U;for(L=0,R=N.length;L<R;L++)A=N[L],U=U.concat(A);for(var z,B,G,H,V,k,j=U.length,W=O.length,X=[],Y=0,q=F.length,Z=q-1,J=Y+1;Y<q;Y++,Z++,J++)Z===q&&(Z=0),J===q&&(J=0),X[Y]=r(F[Y],F[Z],F[J]);var Q,K=[],$=X.concat();for(L=0,R=N.length;L<R;L++){for(A=N[L],Q=[],Y=0,q=A.length,Z=q-1,J=Y+1;Y<q;Y++,Z++,J++)Z===q&&(Z=0),J===q&&(J=0),Q[Y]=r(A[Y],A[Z],A[J]);K.push(Q),$=$.concat(Q)}for(z=0;z<_;z++){for(G=z/_,H=y*Math.cos(G*Math.PI/2),B=x*Math.sin(G*Math.PI/2),Y=0,q=F.length;Y<q;Y++)V=n(F[Y],X[Y],B),h(V.x,V.y,-H);for(L=0,R=N.length;L<R;L++)for(A=N[L],Q=K[L],Y=0,q=A.length;Y<q;Y++)V=n(A[Y],Q[Y],B),h(V.x,V.y,-H)}for(B=x,Y=0;Y<j;Y++)V=b?n(U[Y],$[Y],B):U[Y],T?(m.copy(d.normals[0]).multiplyScalar(V.x),f.copy(d.binormals[0]).multiplyScalar(V.y),g.copy(p[0]).add(m).add(f),h(g.x,g.y,g.z)):h(V.x,V.y,0);var tt;for(tt=1;tt<=M;tt++)for(Y=0;Y<j;Y++)V=b?n(U[Y],$[Y],B):U[Y],T?(m.copy(d.normals[tt]).multiplyScalar(V.x),f.copy(d.binormals[tt]).multiplyScalar(V.y),g.copy(p[tt]).add(m).add(f),h(g.x,g.y,g.z)):h(V.x,V.y,v/M*tt);for(z=_-1;z>=0;z--){for(G=z/_,H=y*Math.cos(G*Math.PI/2),B=x*Math.sin(G*Math.PI/2),Y=0,q=F.length;Y<q;Y++)V=n(F[Y],X[Y],B),h(V.x,V.y,v+H);for(L=0,R=N.length;L<R;L++)for(A=N[L],Q=K[L],Y=0,q=A.length;Y<q;Y++)V=n(A[Y],Q[Y],B),T?h(V.x,V.y+p[M-1].y,p[M-1].x+H):h(V.x,V.y,v+H)}a(),o()},We.WorldUVGenerator={generateTopUV:function(t,e,n,r){var a=t.vertices,o=a[e],s=a[n],c=a[r];return[new i(o.x,o.y),new i(s.x,s.y),new i(c.x,c.y)]},generateSideWallUV:function(t,e,n,r,a){var o=t.vertices,s=o[e],c=o[n],h=o[r],l=o[a];return Math.abs(s.y-c.y)<.01?[new i(s.x,1-s.z),new i(c.x,1-c.z),new i(h.x,1-h.z),new i(l.x,1-l.z)]:[new i(s.y,1-s.z),new i(c.y,1-c.z),new i(h.y,1-h.z),new i(l.y,1-l.z)]}},Xe.prototype=Object.create(We.prototype),Xe.prototype.constructor=Xe,Ye.prototype=Object.create(St.prototype),Ye.prototype.constructor=Ye,qe.prototype=Object.create(Et.prototype),qe.prototype.constructor=qe,Ze.prototype=Object.create(St.prototype),Ze.prototype.constructor=Ze,Je.prototype=Object.create(Et.prototype),Je.prototype.constructor=Je,Qe.prototype=Object.create(Et.prototype),Qe.prototype.constructor=Qe,Ke.prototype=Object.create(St.prototype),Ke.prototype.constructor=Ke,$e.prototype=Object.create(Et.prototype),$e.prototype.constructor=$e,ti.prototype=Object.create(St.prototype),ti.prototype.constructor=ti,ei.prototype=Object.create(Et.prototype),ei.prototype.constructor=ei,ii.prototype=Object.create(St.prototype),ii.prototype.constructor=ii,ni.prototype=Object.create(St.prototype),ni.prototype.constructor=ni,ri.prototype=Object.create(Et.prototype),ri.prototype.constructor=ri,ai.prototype=Object.create(ri.prototype),ai.prototype.constructor=ai,oi.prototype=Object.create(ni.prototype),oi.prototype.constructor=oi,si.prototype=Object.create(St.prototype),si.prototype.constructor=si,ci.prototype=Object.create(Et.prototype),ci.prototype.constructor=ci,hi.prototype=Object.create(Et.prototype),hi.prototype.constructor=hi;var ph=Object.freeze({WireframeGeometry:Se,ParametricGeometry:Le,ParametricBufferGeometry:Ae,TetrahedronGeometry:Ce,TetrahedronBufferGeometry:Pe,OctahedronGeometry:Ue,OctahedronBufferGeometry:Ie,IcosahedronGeometry:De,IcosahedronBufferGeometry:Ne,DodecahedronGeometry:Fe,DodecahedronBufferGeometry:Oe,PolyhedronGeometry:ze,PolyhedronBufferGeometry:Re,TubeGeometry:Ge,TubeBufferGeometry:Be,TorusKnotGeometry:Ve,TorusKnotBufferGeometry:He,TorusGeometry:je,TorusBufferGeometry:ke,TextGeometry:Xe,SphereBufferGeometry:Ye,SphereGeometry:qe,RingGeometry:Je,RingBufferGeometry:Ze,PlaneBufferGeometry:Rt,PlaneGeometry:Qe,LatheGeometry:$e,LatheBufferGeometry:Ke,ShapeGeometry:ei,ShapeBufferGeometry:ti,ExtrudeGeometry:We,EdgesGeometry:ii,ConeGeometry:ai,ConeBufferGeometry:oi,CylinderGeometry:ri,CylinderBufferGeometry:ni,CircleBufferGeometry:si,CircleGeometry:ci,BoxBufferGeometry:Lt,BoxGeometry:hi});li.prototype=Object.create(Q.prototype),li.prototype.constructor=li,li.prototype.isShadowMaterial=!0,ui.prototype=Object.create(Q.prototype),ui.prototype.constructor=ui,ui.prototype.isRawShaderMaterial=!0,pi.prototype={constructor:pi,isMultiMaterial:!0,toJSON:function(t){for(var e={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},i=this.materials,n=0,r=i.length;n<r;n++){var a=i[n].toJSON(t);delete a.metadata,e.materials.push(a)}return e.visible=this.visible,e},clone:function(){for(var t=new this.constructor,e=0;e<this.materials.length;e++)t.materials.push(this.materials[e].clone());return t.visible=this.visible,t}},di.prototype=Object.create(J.prototype),di.prototype.constructor=di,di.prototype.isMeshStandardMaterial=!0,di.prototype.copy=function(t){return J.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},fi.prototype=Object.create(di.prototype),fi.prototype.constructor=fi,fi.prototype.isMeshPhysicalMaterial=!0,fi.prototype.copy=function(t){return di.prototype.copy.call(this,t),this.defines={PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearCoat=t.clearCoat,this.clearCoatRoughness=t.clearCoatRoughness,this},mi.prototype=Object.create(J.prototype),mi.prototype.constructor=mi,mi.prototype.isMeshPhongMaterial=!0,mi.prototype.copy=function(t){return J.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},gi.prototype=Object.create(mi.prototype),gi.prototype.constructor=gi,gi.prototype.isMeshToonMaterial=!0,gi.prototype.copy=function(t){return mi.prototype.copy.call(this,t),this.gradientMap=t.gradientMap,this},vi.prototype=Object.create(J.prototype),vi.prototype.constructor=vi,vi.prototype.isMeshNormalMaterial=!0,vi.prototype.copy=function(t){return J.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},yi.prototype=Object.create(J.prototype),yi.prototype.constructor=yi,yi.prototype.isMeshLambertMaterial=!0,yi.prototype.copy=function(t){return J.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},xi.prototype=Object.create(J.prototype),xi.prototype.constructor=xi,xi.prototype.isLineDashedMaterial=!0,xi.prototype.copy=function(t){return J.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var dh=Object.freeze({ShadowMaterial:li,SpriteMaterial:le,RawShaderMaterial:ui,ShaderMaterial:Q,PointsMaterial:xe,MultiMaterial:pi,MeshPhysicalMaterial:fi,MeshStandardMaterial:di,MeshPhongMaterial:mi,MeshToonMaterial:gi,MeshNormalMaterial:vi,MeshLambertMaterial:yi,MeshDepthMaterial:K,MeshBasicMaterial:pt,LineDashedMaterial:xi,LineBasicMaterial:ge,Material:J}),fh={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},mh=new _i;Object.assign(bi.prototype,{load:function(t,e,i,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t);var r=this,a=fh.get(t);if(void 0!==a)return r.manager.itemStart(t),setTimeout(function(){e&&e(a),r.manager.itemEnd(t)},0),a;var o=/^data:(.*?)(;base64)?,(.*)$/,s=t.match(o);if(s){var c=s[1],h=!!s[2],l=s[3];l=window.decodeURIComponent(l),h&&(l=window.atob(l));try{var u,p=(this.responseType||"").toLowerCase();switch(p){case"arraybuffer":case"blob":u=new ArrayBuffer(l.length);for(var d=new Uint8Array(u),f=0;f<l.length;f++)d[f]=l.charCodeAt(f);"blob"===p&&(u=new Blob([u],{type:c}));break;case"document":var m=new DOMParser;u=m.parseFromString(l,c);break;case"json":u=JSON.parse(l);break;default:u=l}window.setTimeout(function(){e&&e(u),r.manager.itemEnd(t)},0)}catch(e){window.setTimeout(function(){n&&n(e),r.manager.itemError(t)},0)}}else{var g=new XMLHttpRequest;g.open("GET",t,!0),g.addEventListener("load",function(i){var a=i.target.response;fh.add(t,a),200===this.status?(e&&e(a),r.manager.itemEnd(t)):0===this.status?(console.warn("THREE.FileLoader: HTTP Status 0 received."),e&&e(a),r.manager.itemEnd(t)):(n&&n(i),r.manager.itemError(t))},!1),void 0!==i&&g.addEventListener("progress",function(t){i(t)},!1),g.addEventListener("error",function(e){n&&n(e),r.manager.itemError(t)},!1),void 0!==this.responseType&&(g.responseType=this.responseType),void 0!==this.withCredentials&&(g.withCredentials=this.withCredentials),g.overrideMimeType&&g.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),g.send(null)}return r.manager.itemStart(t),g},setPath:function(t){return this.path=t,this},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this}}),Object.assign(wi.prototype,{load:function(t,e,i,n){function r(r){c.load(t[r],function(t){var i=a._parser(t,!0);o[r]={width:i.width,height:i.height,format:i.format,mipmaps:i.mipmaps},h+=1,6===h&&(1===i.mipmapCount&&(s.minFilter=Za),s.format=i.format,s.needsUpdate=!0,e&&e(s))},i,n)}var a=this,o=[],s=new Me;s.image=o;var c=new bi(this.manager);if(c.setPath(this.path),c.setResponseType("arraybuffer"),Array.isArray(t))for(var h=0,l=0,u=t.length;l<u;++l)r(l);else c.load(t,function(t){var i=a._parser(t,!0);if(i.isCubemap)for(var n=i.mipmaps.length/i.mipmapCount,r=0;r<n;r++){o[r]={mipmaps:[]};for(var c=0;c<i.mipmapCount;c++)o[r].mipmaps.push(i.mipmaps[r*i.mipmapCount+c]),o[r].format=i.format,o[r].width=i.width,o[r].height=i.height}else s.image.width=i.width,s.image.height=i.height,s.mipmaps=i.mipmaps;1===i.mipmapCount&&(s.minFilter=Za),s.format=i.format,s.needsUpdate=!0,e&&e(s)},i,n);return s},setPath:function(t){return this.path=t,this}});var gh=Mi;Object.assign(Mi.prototype,{load:function(t,e,i,n){var r=this,a=new X,o=new bi(this.manager);return o.setResponseType("arraybuffer"),o.load(t,function(t){var i=r._parser(t);i&&(void 0!==i.image?a.image=i.image:void 0!==i.data&&(a.image.width=i.width,a.image.height=i.height,a.image.data=i.data),a.wrapS=void 0!==i.wrapS?i.wrapS:ka,a.wrapT=void 0!==i.wrapT?i.wrapT:ka,a.magFilter=void 0!==i.magFilter?i.magFilter:Za,a.minFilter=void 0!==i.minFilter?i.minFilter:Qa,a.anisotropy=void 0!==i.anisotropy?i.anisotropy:1,void 0!==i.format&&(a.format=i.format),void 0!==i.type&&(a.type=i.type),void 0!==i.mipmaps&&(a.mipmaps=i.mipmaps),1===i.mipmapCount&&(a.minFilter=Za),a.needsUpdate=!0,e&&e(a,i))},i,n),a}}),Object.assign(Ei.prototype,{load:function(t,e,i,n){var r=this,a=document.createElementNS("http://www.w3.org/1999/xhtml","img");if(a.onload=function(){a.onload=null,URL.revokeObjectURL(a.src),e&&e(a),r.manager.itemEnd(t)},a.onerror=n,0===t.indexOf("data:"))a.src=t;else if(void 0!==this.crossOrigin)a.crossOrigin=this.crossOrigin,a.src=t;else{var o=new bi;o.setPath(this.path),o.setResponseType("blob"),o.setWithCredentials(this.withCredentials),o.load(t,function(t){a.src=URL.createObjectURL(t)},i,n)}return r.manager.itemStart(t),a},setCrossOrigin:function(t){return this.crossOrigin=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Ti.prototype,{load:function(t,e,i,n){function r(i){o.load(t[i],function(t){a.images[i]=t,s++,6===s&&(a.needsUpdate=!0,e&&e(a))},void 0,n)}var a=new l,o=new Ei(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);for(var s=0,c=0;c<t.length;++c)r(c);return a},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Si.prototype,{load:function(t,e,i,r){var a=new n,o=new Ei(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setWithCredentials(this.withCredentials),o.setPath(this.path),o.load(t,function(i){var n=t.search(/\.(jpg|jpeg)$/)>0||0===t.search(/^data\:image\/jpeg/);a.format=n?po:fo,a.image=i,a.needsUpdate=!0,void 0!==e&&e(a)},i,r),a},setCrossOrigin:function(t){return this.crossOrigin=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setPath:function(t){return this.path=t,this}}),Ai.prototype=Object.assign(Object.create(ct.prototype),{constructor:Ai,isLight:!0,copy:function(t){return ct.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var e=ct.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),Li.prototype=Object.assign(Object.create(Ai.prototype),{constructor:Li,isHemisphereLight:!0,copy:function(t){return Ai.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(Ri.prototype,{copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),Pi.prototype=Object.assign(Object.create(Ri.prototype),{constructor:Pi,isSpotLightShadow:!0,update:function(t){var e=2*Qo.RAD2DEG*t.angle,i=this.mapSize.width/this.mapSize.height,n=t.distance||500,r=this.camera;e===r.fov&&i===r.aspect&&n===r.far||(r.fov=e,r.aspect=i,r.far=n,r.updateProjectionMatrix())}}),Ci.prototype=Object.assign(Object.create(Ai.prototype),{constructor:Ci,isSpotLight:!0,copy:function(t){return Ai.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Ii.prototype=Object.assign(Object.create(Ai.prototype),{constructor:Ii,isPointLight:!0,copy:function(t){return Ai.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),Ui.prototype=Object.assign(Object.create(Ri.prototype),{constructor:Ui}),Ni.prototype=Object.assign(Object.create(Ai.prototype),{constructor:Ni,isDirectionalLight:!0,copy:function(t){return Ai.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Di.prototype=Object.assign(Object.create(Ai.prototype),{constructor:Di,isAmbientLight:!0});var vh={arraySlice:function(t,e,i){return vh.isTypedArray(t)?new t.constructor(t.subarray(e,i)):t.slice(e,i)},convertArray:function(t,e,i){return!t||!i&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){function e(e,i){return t[e]-t[i]}for(var i=t.length,n=new Array(i),r=0;r!==i;++r)n[r]=r;return n.sort(e),n},sortedArray:function(t,e,i){for(var n=t.length,r=new t.constructor(n),a=0,o=0;o!==n;++a)for(var s=i[a]*e,c=0;c!==e;++c)r[o++]=t[s+c];return r},flattenJSON:function(t,e,i,n){for(var r=1,a=t[0];void 0!==a&&void 0===a[n];)a=t[r++];if(void 0!==a){var o=a[n];if(void 0!==o)if(Array.isArray(o)){do o=a[n],void 0!==o&&(e.push(a.time),i.push.apply(i,o)),a=t[r++];while(void 0!==a)}else if(void 0!==o.toArray){do o=a[n],void 0!==o&&(e.push(a.time),o.toArray(i,i.length)),a=t[r++];while(void 0!==a)}else do o=a[n],void 0!==o&&(e.push(a.time),i.push(o)),a=t[r++];while(void 0!==a)}}};Oi.prototype={constructor:Oi,evaluate:function(t){var e=this.parameterPositions,i=this._cachedIndex,n=e[i],r=e[i-1];t:{e:{var a;i:{n:if(!(t<n)){for(var o=i+2;;){if(void 0===n){if(t<r)break n;return i=e.length,this._cachedIndex=i,this.afterEnd_(i-1,t,r)}if(i===o)break;if(r=n,n=e[++i],t<n)break e}a=e.length;break i}{if(t>=r)break t;var s=e[1];t<s&&(i=2,r=s);for(var o=i-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(i===o)break;if(n=r,r=e[--i-1],t>=r)break e}a=i,i=0}}for(;i<a;){var c=i+a>>>1;t<e[c]?a=c:i=c+1}if(n=e[i],r=e[i-1],void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(void 0===n)return i=e.length,this._cachedIndex=i,this.afterEnd_(i-1,r,t)}this._cachedIndex=i,this.intervalChanged_(i,r,n)}return this.interpolate_(i,r,t,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,i=this.sampleValues,n=this.valueSize,r=t*n,a=0;a!==n;++a)e[a]=i[r+a];return e},interpolate_:function(t,e,i,n){throw new Error("call to abstract method")},intervalChanged_:function(t,e,i){}},Object.assign(Oi.prototype,{beforeStart_:Oi.prototype.copySampleValue_,afterEnd_:Oi.prototype.copySampleValue_}),Fi.prototype=Object.assign(Object.create(Oi.prototype),{constructor:Fi,DefaultSettings_:{endingStart:Do,endingEnd:Do},intervalChanged_:function(t,e,i){var n=this.parameterPositions,r=t-2,a=t+1,o=n[r],s=n[a];if(void 0===o)switch(this.getSettings_().endingStart){case Oo:r=t,o=2*e-i;break;case Fo:r=n.length-2,o=e+n[r]-n[r+1];break;default:r=t,o=i}if(void 0===s)switch(this.getSettings_().endingEnd){case Oo:a=t,s=2*i-e;break;case Fo:a=1,s=i+n[1]-n[0];break;default:a=t-1,s=e}var c=.5*(i-e),h=this.valueSize;this._weightPrev=c/(e-o),this._weightNext=c/(s-i),this._offsetPrev=r*h,this._offsetNext=a*h},interpolate_:function(t,e,i,n){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,c=s-o,h=this._offsetPrev,l=this._offsetNext,u=this._weightPrev,p=this._weightNext,d=(i-e)/(n-e),f=d*d,m=f*d,g=-u*m+2*u*f-u*d,v=(1+u)*m+(-1.5-2*u)*f+(-.5+u)*d+1,y=(-1-p)*m+(1.5+p)*f+.5*d,x=p*m-p*f,_=0;_!==o;++_)r[_]=g*a[h+_]+v*a[c+_]+y*a[s+_]+x*a[l+_];return r}}),zi.prototype=Object.assign(Object.create(Oi.prototype),{constructor:zi,interpolate_:function(t,e,i,n){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,c=s-o,h=(i-e)/(n-e),l=1-h,u=0;u!==o;++u)r[u]=a[c+u]*l+a[s+u]*h;return r}}),Bi.prototype=Object.assign(Object.create(Oi.prototype),{constructor:Bi,interpolate_:function(t,e,i,n){return this.copySampleValue_(t-1)}});var yh;yh={TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Uo,InterpolantFactoryMethodDiscrete:function(t){return new Bi(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new zi(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new Fi(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case Io:e=this.InterpolantFactoryMethodDiscrete;break;case Uo:e=this.InterpolantFactoryMethodLinear;break;case No:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){var i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return void console.warn(i)}this.createInterpolant=e},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Io;case this.InterpolantFactoryMethodLinear:return Uo;case this.InterpolantFactoryMethodSmooth:return No}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,i=0,n=e.length;i!==n;++i)e[i]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,i=0,n=e.length;i!==n;++i)e[i]*=t;return this},trim:function(t,e){for(var i=this.times,n=i.length,r=0,a=n-1;r!==n&&i[r]<t;)++r;for(;a!==-1&&i[a]>e;)--a;if(++a,0!==r||a!==n){r>=a&&(a=Math.max(a,1),r=a-1);var o=this.getValueSize();this.times=vh.arraySlice(i,r,a),this.values=vh.arraySlice(this.values,r*o,a*o)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!==0&&(console.error("invalid value size in track",this),t=!1);var i=this.times,n=this.values,r=i.length;0===r&&(console.error("track is empty",this),t=!1);for(var a=null,o=0;o!==r;o++){var s=i[o];if("number"==typeof s&&isNaN(s)){console.error("time is not a valid number",this,o,s),t=!1;break}if(null!==a&&a>s){console.error("out of order keys",this,o,s,a),t=!1;break}a=s}if(void 0!==n&&vh.isTypedArray(n))for(var o=0,c=n.length;o!==c;++o){var h=n[o];if(isNaN(h)){console.error("value is not a valid number",this,o,h),t=!1;break}}return t},optimize:function(){for(var t=this.times,e=this.values,i=this.getValueSize(),n=this.getInterpolation()===No,r=1,a=t.length-1,o=1;o<a;++o){var s=!1,c=t[o],h=t[o+1];if(c!==h&&(1!==o||c!==c[0]))if(n)s=!0;else for(var l=o*i,u=l-i,p=l+i,d=0;d!==i;++d){var f=e[l+d];if(f!==e[u+d]||f!==e[p+d]){s=!0;break}}if(s){if(o!==r){t[r]=t[o];for(var m=o*i,g=r*i,d=0;d!==i;++d)e[g+d]=e[m+d]}++r}}if(a>0){t[r]=t[a];for(var m=a*i,g=r*i,d=0;d!==i;++d)e[g+d]=e[m+d];++r}return r!==t.length&&(this.times=vh.arraySlice(t,0,r),this.values=vh.arraySlice(e,0,r*i)),this}},Hi.prototype=Object.assign(Object.create(yh),{constructor:Hi,ValueTypeName:"vector"}),Vi.prototype=Object.assign(Object.create(Oi.prototype),{constructor:Vi,interpolate_:function(t,e,i,n){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,c=t*o,h=(i-e)/(n-e),l=c+o;c!==l;c+=4)s.slerpFlat(r,0,a,c-o,a,c,h);return r}}),ki.prototype=Object.assign(Object.create(yh),{constructor:ki,ValueTypeName:"quaternion",DefaultInterpolation:Uo,InterpolantFactoryMethodLinear:function(t){return new Vi(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),ji.prototype=Object.assign(Object.create(yh),{constructor:ji,ValueTypeName:"number"}),Wi.prototype=Object.assign(Object.create(yh),{constructor:Wi,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Io,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Xi.prototype=Object.assign(Object.create(yh),{constructor:Xi,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Io,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Yi.prototype=Object.assign(Object.create(yh),{constructor:Yi,ValueTypeName:"color"}),qi.prototype=yh,yh.constructor=qi,Object.assign(qi,{parse:function(t){if(void 0===t.type)throw new Error("track type undefined, can not parse");var e=qi._getTrackTypeForValueTypeName(t.type);if(void 0===t.times){var i=[],n=[];vh.flattenJSON(t.keys,i,n,"value"),t.times=i,t.values=n}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)},toJSON:function(t){var e,i=t.constructor;if(void 0!==i.toJSON)e=i.toJSON(t);else{e={name:t.name,times:vh.convertArray(t.times,Array),values:vh.convertArray(t.values,Array)};var n=t.getInterpolation();n!==t.DefaultInterpolation&&(e.interpolation=n)}return e.type=t.ValueTypeName,e},_getTrackTypeForValueTypeName:function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return ji;case"vector":case"vector2":case"vector3":case"vector4":return Hi;case"color":return Yi;case"quaternion":return ki;
case"bool":case"boolean":return Xi;case"string":return Wi}throw new Error("Unsupported typeName: "+t)}}),Zi.prototype={constructor:Zi,resetDuration:function(){for(var t=this.tracks,e=0,i=0,n=t.length;i!==n;++i){var r=this.tracks[i];e=Math.max(e,r.times[r.times.length-1])}this.duration=e},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}},Object.assign(Zi,{parse:function(t){for(var e=[],i=t.tracks,n=1/(t.fps||1),r=0,a=i.length;r!==a;++r)e.push(qi.parse(i[r]).scale(n));return new Zi(t.name,t.duration,e)},toJSON:function(t){for(var e=[],i=t.tracks,n={name:t.name,duration:t.duration,tracks:e},r=0,a=i.length;r!==a;++r)e.push(qi.toJSON(i[r]));return n},CreateFromMorphTargetSequence:function(t,e,i,n){for(var r=e.length,a=[],o=0;o<r;o++){var s=[],c=[];s.push((o+r-1)%r,o,(o+1)%r),c.push(0,1,0);var h=vh.getKeyframeOrder(s);s=vh.sortedArray(s,1,h),c=vh.sortedArray(c,1,h),n||0!==s[0]||(s.push(r),c.push(c[0])),a.push(new ji(".morphTargetInfluences["+e[o].name+"]",s,c).scale(1/i))}return new Zi(t,-1,a)},findByName:function(t,e){var i=t;if(!Array.isArray(t)){var n=t;i=n.geometry&&n.geometry.animations||n.animations}for(var r=0;r<i.length;r++)if(i[r].name===e)return i[r];return null},CreateClipsFromMorphTargetSequences:function(t,e,i){for(var n={},r=/^([\w-]*?)([\d]+)$/,a=0,o=t.length;a<o;a++){var s=t[a],c=s.name.match(r);if(c&&c.length>1){var h=c[1],l=n[h];l||(n[h]=l=[]),l.push(s)}}var u=[];for(var h in n)u.push(Zi.CreateFromMorphTargetSequence(h,n[h],e,i));return u},parseAnimation:function(t,e){if(!t)return console.error("  no animation in JSONLoader data"),null;for(var i=function(t,e,i,n,r){if(0!==i.length){var a=[],o=[];vh.flattenJSON(i,a,o,n),0!==a.length&&r.push(new t(e,a,o))}},n=[],r=t.name||"default",a=t.length||-1,o=t.fps||30,s=t.hierarchy||[],c=0;c<s.length;c++){var h=s[c].keys;if(h&&0!==h.length)if(h[0].morphTargets){for(var l={},u=0;u<h.length;u++)if(h[u].morphTargets)for(var p=0;p<h[u].morphTargets.length;p++)l[h[u].morphTargets[p]]=-1;for(var d in l){for(var f=[],m=[],p=0;p!==h[u].morphTargets.length;++p){var g=h[u];f.push(g.time),m.push(g.morphTarget===d?1:0)}n.push(new ji(".morphTargetInfluence["+d+"]",f,m))}a=l.length*(o||1)}else{var v=".bones["+e[c].name+"]";i(Hi,v+".position",h,"pos",n),i(ki,v+".quaternion",h,"rot",n),i(Hi,v+".scale",h,"scl",n)}}if(0===n.length)return null;var y=new Zi(r,a,n);return y}}),Object.assign(Ji.prototype,{load:function(t,e,i,n){var r=this,a=new bi(r.manager);a.load(t,function(t){e(r.parse(JSON.parse(t)))},i,n)},setTextures:function(t){this.textures=t},parse:function(t){function e(t){return void 0===n[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),n[t]}var n=this.textures,r=new dh[t.type];if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&r.specular.setHex(t.specular),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.clearCoat&&(r.clearCoat=t.clearCoat),void 0!==t.clearCoatRoughness&&(r.clearCoatRoughness=t.clearCoatRoughness),void 0!==t.uniforms&&(r.uniforms=t.uniforms),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(r.vertexColors=t.vertexColors),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.shading&&(r.shading=t.shading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.side&&(r.side=t.side),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.skinning&&(r.skinning=t.skinning),void 0!==t.morphTargets&&(r.morphTargets=t.morphTargets),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=e(t.map)),void 0!==t.alphaMap&&(r.alphaMap=e(t.alphaMap),r.transparent=!0),void 0!==t.bumpMap&&(r.bumpMap=e(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=e(t.normalMap)),void 0!==t.normalScale){var a=t.normalScale;Array.isArray(a)===!1&&(a=[a,a]),r.normalScale=(new i).fromArray(a)}if(void 0!==t.displacementMap&&(r.displacementMap=e(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=e(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=e(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=e(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=e(t.specularMap)),void 0!==t.envMap&&(r.envMap=e(t.envMap)),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.lightMap&&(r.lightMap=e(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=e(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(r.gradientMap=e(t.gradientMap)),void 0!==t.materials)for(var o=0,s=t.materials.length;o<s;o++)r.materials.push(this.parse(t.materials[o]));return r}}),Object.assign(Qi.prototype,{load:function(t,e,i,n){var r=this,a=new bi(r.manager);a.load(t,function(t){e(r.parse(JSON.parse(t)))},i,n)},parse:function(t){var e=new St,i=t.data.index,n={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};if(void 0!==i){var r=new n[i.type](i.array);e.setIndex(new dt(r,1))}var a=t.data.attributes;for(var o in a){var s=a[o],r=new n[s.type](s.array);e.addAttribute(o,new dt(r,s.itemSize,s.normalized))}var h=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==h)for(var l=0,u=h.length;l!==u;++l){var p=h[l];e.addGroup(p.start,p.count,p.materialIndex)}var d=t.data.boundingSphere;if(void 0!==d){var f=new c;void 0!==d.center&&f.fromArray(d.center),e.boundingSphere=new tt(f,d.radius)}return e}}),Ki.prototype={constructor:Ki,crossOrigin:void 0,extractUrlBase:function(t){var e=t.split("/");return 1===e.length?"./":(e.pop(),e.join("/")+"/")},initMaterials:function(t,e,i){for(var n=[],r=0;r<t.length;++r)n[r]=this.createMaterial(t[r],e,i);return n},createMaterial:function(){var t,e,i;return function(n,r,a){function o(t,i,n,o,c){var h,l=r+t,u=Ki.Handlers.get(l);null!==u?h=u.load(l):(e.setCrossOrigin(a),h=e.load(l)),void 0!==i&&(h.repeat.fromArray(i),1!==i[0]&&(h.wrapS=Va),1!==i[1]&&(h.wrapT=Va)),void 0!==n&&h.offset.fromArray(n),void 0!==o&&("repeat"===o[0]&&(h.wrapS=Va),"mirror"===o[0]&&(h.wrapS=ja),"repeat"===o[1]&&(h.wrapT=Va),"mirror"===o[1]&&(h.wrapT=ja)),void 0!==c&&(h.anisotropy=c);var p=Qo.generateUUID();return s[p]=h,p}void 0===t&&(t=new W),void 0===e&&(e=new Si),void 0===i&&(i=new Ji);var s={},c={uuid:Qo.generateUUID(),type:"MeshLambertMaterial"};for(var h in n){var l=n[h];switch(h){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":c.name=l;break;case"blending":c.blending=ta[l];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",h,"is no longer supported.");break;case"colorDiffuse":c.color=t.fromArray(l).getHex();break;case"colorSpecular":c.specular=t.fromArray(l).getHex();break;case"colorEmissive":c.emissive=t.fromArray(l).getHex();break;case"specularCoef":c.shininess=l;break;case"shading":"basic"===l.toLowerCase()&&(c.type="MeshBasicMaterial"),"phong"===l.toLowerCase()&&(c.type="MeshPhongMaterial"),"standard"===l.toLowerCase()&&(c.type="MeshStandardMaterial");break;case"mapDiffuse":c.map=o(l,n.mapDiffuseRepeat,n.mapDiffuseOffset,n.mapDiffuseWrap,n.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":c.emissiveMap=o(l,n.mapEmissiveRepeat,n.mapEmissiveOffset,n.mapEmissiveWrap,n.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":c.lightMap=o(l,n.mapLightRepeat,n.mapLightOffset,n.mapLightWrap,n.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":c.aoMap=o(l,n.mapAORepeat,n.mapAOOffset,n.mapAOWrap,n.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":c.bumpMap=o(l,n.mapBumpRepeat,n.mapBumpOffset,n.mapBumpWrap,n.mapBumpAnisotropy);break;case"mapBumpScale":c.bumpScale=l;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":c.normalMap=o(l,n.mapNormalRepeat,n.mapNormalOffset,n.mapNormalWrap,n.mapNormalAnisotropy);break;case"mapNormalFactor":c.normalScale=[l,l];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":c.specularMap=o(l,n.mapSpecularRepeat,n.mapSpecularOffset,n.mapSpecularWrap,n.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":c.metalnessMap=o(l,n.mapMetalnessRepeat,n.mapMetalnessOffset,n.mapMetalnessWrap,n.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":c.roughnessMap=o(l,n.mapRoughnessRepeat,n.mapRoughnessOffset,n.mapRoughnessWrap,n.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":c.alphaMap=o(l,n.mapAlphaRepeat,n.mapAlphaOffset,n.mapAlphaWrap,n.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":c.side=Hr;break;case"doubleSided":c.side=Vr;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),c.opacity=l;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":c[h]=l;break;case"vertexColors":l===!0&&(c.vertexColors=Yr),"face"===l&&(c.vertexColors=Xr);break;default:console.error("THREE.Loader.createMaterial: Unsupported",h,l)}}return"MeshBasicMaterial"===c.type&&delete c.emissive,"MeshPhongMaterial"!==c.type&&delete c.specular,c.opacity<1&&(c.transparent=!0),i.setTextures(s),i.parse(c)}}()},Ki.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=this.handlers,i=0,n=e.length;i<n;i+=2){var r=e[i],a=e[i+1];if(r.test(t))return a}return null}},Object.assign($i.prototype,{load:function(t,e,i,n){var r=this,a=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:Ki.prototype.extractUrlBase(t),o=new bi(this.manager);o.setWithCredentials(this.withCredentials),o.load(t,function(i){var n=JSON.parse(i),o=n.metadata;if(void 0!==o){var s=o.type;if(void 0!==s){if("object"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.ObjectLoader instead.");if("scene"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.SceneLoader instead.")}}var c=r.parse(n,a);e(c.geometry,c.materials)},i,n)},setTexturePath:function(t){this.texturePath=t},parse:function(t,e){function n(e){function n(t,e){return t&1<<e}var r,a,o,s,l,u,p,d,f,m,g,v,y,x,_,b,w,M,E,T,S,A,L,R,P,C,I,U=t.faces,N=t.vertices,D=t.normals,O=t.colors,F=0;if(void 0!==t.uvs){for(r=0;r<t.uvs.length;r++)t.uvs[r].length&&F++;for(r=0;r<F;r++)h.faceVertexUvs[r]=[]}for(s=0,l=N.length;s<l;)M=new c,M.x=N[s++]*e,M.y=N[s++]*e,M.z=N[s++]*e,h.vertices.push(M);for(s=0,l=U.length;s<l;)if(m=U[s++],g=n(m,0),v=n(m,1),y=n(m,3),x=n(m,4),_=n(m,5),b=n(m,6),w=n(m,7),g){if(T=new ut,T.a=U[s],T.b=U[s+1],T.c=U[s+3],S=new ut,S.a=U[s+1],S.b=U[s+2],S.c=U[s+3],s+=4,v&&(f=U[s++],T.materialIndex=f,S.materialIndex=f),o=h.faces.length,y)for(r=0;r<F;r++)for(R=t.uvs[r],h.faceVertexUvs[r][o]=[],h.faceVertexUvs[r][o+1]=[],a=0;a<4;a++)d=U[s++],C=R[2*d],I=R[2*d+1],P=new i(C,I),2!==a&&h.faceVertexUvs[r][o].push(P),0!==a&&h.faceVertexUvs[r][o+1].push(P);if(x&&(p=3*U[s++],T.normal.set(D[p++],D[p++],D[p]),S.normal.copy(T.normal)),_)for(r=0;r<4;r++)p=3*U[s++],L=new c(D[p++],D[p++],D[p]),2!==r&&T.vertexNormals.push(L),0!==r&&S.vertexNormals.push(L);if(b&&(u=U[s++],A=O[u],T.color.setHex(A),S.color.setHex(A)),w)for(r=0;r<4;r++)u=U[s++],A=O[u],2!==r&&T.vertexColors.push(new W(A)),0!==r&&S.vertexColors.push(new W(A));h.faces.push(T),h.faces.push(S)}else{if(E=new ut,E.a=U[s++],E.b=U[s++],E.c=U[s++],v&&(f=U[s++],E.materialIndex=f),o=h.faces.length,y)for(r=0;r<F;r++)for(R=t.uvs[r],h.faceVertexUvs[r][o]=[],a=0;a<3;a++)d=U[s++],C=R[2*d],I=R[2*d+1],P=new i(C,I),h.faceVertexUvs[r][o].push(P);if(x&&(p=3*U[s++],E.normal.set(D[p++],D[p++],D[p])),_)for(r=0;r<3;r++)p=3*U[s++],L=new c(D[p++],D[p++],D[p]),E.vertexNormals.push(L);if(b&&(u=U[s++],E.color.setHex(O[u])),w)for(r=0;r<3;r++)u=U[s++],E.vertexColors.push(new W(O[u]));h.faces.push(E)}}function a(){var e=void 0!==t.influencesPerVertex?t.influencesPerVertex:2;if(t.skinWeights)for(var i=0,n=t.skinWeights.length;i<n;i+=e){var a=t.skinWeights[i],o=e>1?t.skinWeights[i+1]:0,s=e>2?t.skinWeights[i+2]:0,c=e>3?t.skinWeights[i+3]:0;h.skinWeights.push(new r(a,o,s,c))}if(t.skinIndices)for(var i=0,n=t.skinIndices.length;i<n;i+=e){var l=t.skinIndices[i],u=e>1?t.skinIndices[i+1]:0,p=e>2?t.skinIndices[i+2]:0,d=e>3?t.skinIndices[i+3]:0;h.skinIndices.push(new r(l,u,p,d))}h.bones=t.bones,h.bones&&h.bones.length>0&&(h.skinWeights.length!==h.skinIndices.length||h.skinIndices.length!==h.vertices.length)&&console.warn("When skinning, number of vertices ("+h.vertices.length+"), skinIndices ("+h.skinIndices.length+"), and skinWeights ("+h.skinWeights.length+") should match.")}function o(e){if(void 0!==t.morphTargets)for(var i=0,n=t.morphTargets.length;i<n;i++){h.morphTargets[i]={},h.morphTargets[i].name=t.morphTargets[i].name,h.morphTargets[i].vertices=[];for(var r=h.morphTargets[i].vertices,a=t.morphTargets[i].vertices,o=0,s=a.length;o<s;o+=3){var l=new c;l.x=a[o]*e,l.y=a[o+1]*e,l.z=a[o+2]*e,r.push(l)}}if(void 0!==t.morphColors&&t.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');for(var u=h.faces,p=t.morphColors[0].colors,i=0,n=u.length;i<n;i++)u[i].color.fromArray(p,3*i)}}function s(){var e=[],i=[];void 0!==t.animation&&i.push(t.animation),void 0!==t.animations&&(t.animations.length?i=i.concat(t.animations):i.push(t.animations));for(var n=0;n<i.length;n++){var r=Zi.parseAnimation(i[n],h.bones);r&&e.push(r)}if(h.morphTargets){var a=Zi.CreateClipsFromMorphTargetSequences(h.morphTargets,10);e=e.concat(a)}e.length>0&&(h.animations=e)}var h=new Et,l=void 0!==t.scale?1/t.scale:1;if(n(l),a(),o(l),s(),h.computeFaceNormals(),h.computeBoundingSphere(),void 0===t.materials||0===t.materials.length)return{geometry:h};var u=Ki.prototype.initMaterials(t.materials,e,this.crossOrigin);return{geometry:h,materials:u}}}),Object.assign(tn.prototype,{load:function(t,e,i,n){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var r=this,a=new bi(r.manager);a.load(t,function(i){var n=null;try{n=JSON.parse(i)}catch(e){return void console.error("THREE:ObjectLoader: Can't parse "+t+".",e.message)}var a=n.metadata;return void 0===a||void 0===a.type||"geometry"===a.type.toLowerCase()?void console.error("THREE.ObjectLoader: Can't load "+t+". Use THREE.JSONLoader instead."):void r.parse(n,e)},i,n)},setTexturePath:function(t){this.texturePath=t},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){var i=this.parseGeometries(t.geometries),n=this.parseImages(t.images,function(){void 0!==e&&e(o)}),r=this.parseTextures(t.textures,n),a=this.parseMaterials(t.materials,r),o=this.parseObject(t.object,i,a);return t.animations&&(o.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==e&&e(o),o},parseGeometries:function(t){var e={};if(void 0!==t)for(var i=new $i,n=new Qi,r=0,a=t.length;r<a;r++){var o,s=t[r];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":o=new ph[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":o=new ph[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":o=new ph[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":o=new ph[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":o=new ph[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":o=new ph[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"IcosahedronGeometry":case"OctahedronGeometry":case"TetrahedronGeometry":o=new ph[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":o=new ph[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":o=new ph[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":o=new ph[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"LatheGeometry":case"LatheBufferGeometry":o=new ph[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"BufferGeometry":o=n.parse(s);break;case"Geometry":o=i.parse(s.data,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),e[s.uuid]=o}return e},parseMaterials:function(t,e){var i={};if(void 0!==t){var n=new Ji;n.setTextures(e);for(var r=0,a=t.length;r<a;r++){var o=n.parse(t[r]);i[o.uuid]=o}}return i},parseAnimations:function(t){for(var e=[],i=0;i<t.length;i++){var n=Zi.parse(t[i]);e.push(n)}return e},parseImages:function(t,e){function i(t){return n.manager.itemStart(t),o.load(t,function(){n.manager.itemEnd(t)},void 0,function(){n.manager.itemError(t)})}var n=this,r={};if(void 0!==t&&t.length>0){var a=new _i(e),o=new Ei(a);o.setCrossOrigin(this.crossOrigin);for(var s=0,c=t.length;s<c;s++){var h=t[s],l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h.url)?h.url:n.texturePath+h.url;r[h.uuid]=i(l)}}return r},parseTextures:function(t,e){function i(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var r={};if(void 0!==t)for(var a=0,o=t.length;a<o;a++){var s=t[a];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===e[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image);var c=new n(e[s.image]);c.needsUpdate=!0,c.uuid=s.uuid,void 0!==s.name&&(c.name=s.name),void 0!==s.mapping&&(c.mapping=i(s.mapping,Ha)),void 0!==s.offset&&c.offset.fromArray(s.offset),void 0!==s.repeat&&c.repeat.fromArray(s.repeat),void 0!==s.wrap&&(c.wrapS=i(s.wrap[0],Wa),c.wrapT=i(s.wrap[1],Wa)),void 0!==s.minFilter&&(c.minFilter=i(s.minFilter,Ka)),void 0!==s.magFilter&&(c.magFilter=i(s.magFilter,Ka)),void 0!==s.anisotropy&&(c.anisotropy=s.anisotropy),void 0!==s.flipY&&(c.flipY=s.flipY),r[s.uuid]=c}return r},parseObject:function(){var t=new h;return function(e,i,n){function r(t){return void 0===i[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),i[t]}function a(t){if(void 0!==t)return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),n[t]}var o;switch(e.type){case"Scene":o=new ce,void 0!==e.background&&Number.isInteger(e.background)&&(o.background=new W(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?o.fog=new se(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(o.fog=new oe(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":o=new Ct(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(o.focus=e.focus),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.filmGauge&&(o.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(o.filmOffset=e.filmOffset),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new It(e.left,e.right,e.top,e.bottom,e.near,e.far);break;case"AmbientLight":o=new Di(e.color,e.intensity);break;case"DirectionalLight":o=new Ni(e.color,e.intensity);break;case"PointLight":o=new Ii(e.color,e.intensity,e.distance,e.decay);break;case"SpotLight":o=new Ci(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new Li(e.color,e.groundColor,e.intensity);break;case"Mesh":var s=r(e.geometry),c=a(e.material);o=s.bones&&s.bones.length>0?new me(s,c):new At(s,c);break;case"LOD":o=new pe;break;case"Line":o=new ve(r(e.geometry),a(e.material),e.mode);break;case"LineSegments":o=new ye(r(e.geometry),a(e.material));break;case"PointCloud":case"Points":o=new _e(r(e.geometry),a(e.material));break;case"Sprite":o=new ue(a(e.material));break;case"Group":o=new be;break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh type. Instantiates Object3D instead.");default:o=new ct}if(o.uuid=e.uuid,void 0!==e.name&&(o.name=e.name),void 0!==e.matrix?(t.fromArray(e.matrix),t.decompose(o.position,o.quaternion,o.scale)):(void 0!==e.position&&o.position.fromArray(e.position),void 0!==e.rotation&&o.rotation.fromArray(e.rotation),void 0!==e.quaternion&&o.quaternion.fromArray(e.quaternion),void 0!==e.scale&&o.scale.fromArray(e.scale)),void 0!==e.castShadow&&(o.castShadow=e.castShadow),void 0!==e.receiveShadow&&(o.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(o.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(o.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&o.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(o.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(o.visible=e.visible),void 0!==e.userData&&(o.userData=e.userData),void 0!==e.children)for(var h in e.children)o.add(this.parseObject(e.children[h],i,n));if("LOD"===e.type)for(var l=e.levels,u=0;u<l.length;u++){var p=l[u],h=o.getObjectByProperty("uuid",p.object);void 0!==h&&o.addLevel(h,p.distance)}return o}}()}),en.prototype={constructor:en,getPoint:function(t){return console.warn("THREE.Curve: Warning, getPoint() not implemented!"),null},getPointAt:function(t){var e=this.getUtoTmapping(t);return this.getPoint(e)},getPoints:function(t){t||(t=5);for(var e=[],i=0;i<=t;i++)e.push(this.getPoint(i/t));return e},getSpacedPoints:function(t){t||(t=5);for(var e=[],i=0;i<=t;i++)e.push(this.getPointAt(i/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(t||(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,i,n=[],r=this.getPoint(0),a=0;for(n.push(0),i=1;i<=t;i++)e=this.getPoint(i/t),a+=e.distanceTo(r),n.push(a),r=e;return this.cacheArcLengths=n,n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var i,n=this.getLengths(),r=0,a=n.length;i=e?e:t*n[a-1];for(var o,s=0,c=a-1;s<=c;)if(r=Math.floor(s+(c-s)/2),o=n[r]-i,o<0)s=r+1;else{if(!(o>0)){c=r;break}c=r-1}if(r=c,n[r]===i){var h=r/(a-1);return h}var l=n[r],u=n[r+1],p=u-l,d=(i-l)/p,h=(r+d)/(a-1);return h},getTangent:function(t){var e=1e-4,i=t-e,n=t+e;i<0&&(i=0),n>1&&(n=1);var r=this.getPoint(i),a=this.getPoint(n),o=a.clone().sub(r);return o.normalize()},getTangentAt:function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)},computeFrenetFrames:function(t,e){var i,n,r,a=new c,o=[],s=[],l=[],u=new c,p=new h;for(i=0;i<=t;i++)n=i/t,o[i]=this.getTangentAt(n),o[i].normalize();s[0]=new c,l[0]=new c;var d=Number.MAX_VALUE,f=Math.abs(o[0].x),m=Math.abs(o[0].y),g=Math.abs(o[0].z);for(f<=d&&(d=f,a.set(1,0,0)),m<=d&&(d=m,a.set(0,1,0)),g<=d&&a.set(0,0,1),u.crossVectors(o[0],a).normalize(),s[0].crossVectors(o[0],u),l[0].crossVectors(o[0],s[0]),i=1;i<=t;i++)s[i]=s[i-1].clone(),l[i]=l[i-1].clone(),u.crossVectors(o[i-1],o[i]),u.length()>Number.EPSILON&&(u.normalize(),r=Math.acos(Qo.clamp(o[i-1].dot(o[i]),-1,1)),s[i].applyMatrix4(p.makeRotationAxis(u,r))),l[i].crossVectors(o[i],s[i]);if(e===!0)for(r=Math.acos(Qo.clamp(s[0].dot(s[t]),-1,1)),r/=t,o[0].dot(u.crossVectors(s[0],s[t]))>0&&(r=-r),i=1;i<=t;i++)s[i].applyMatrix4(p.makeRotationAxis(o[i],r*i)),l[i].crossVectors(o[i],s[i]);return{tangents:o,normals:s,binormals:l}}},en.create=function(t,e){return t.prototype=Object.create(en.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},nn.prototype=Object.create(en.prototype),nn.prototype.constructor=nn,nn.prototype.isLineCurve=!0,nn.prototype.getPoint=function(t){if(1===t)return this.v2.clone();var e=this.v2.clone().sub(this.v1);return e.multiplyScalar(t).add(this.v1),e},nn.prototype.getPointAt=function(t){return this.getPoint(t)},nn.prototype.getTangent=function(t){var e=this.v2.clone().sub(this.v1);return e.normalize()},rn.prototype=Object.assign(Object.create(en.prototype),{constructor:rn,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new nn(e,t))},getPoint:function(t){for(var e=t*this.getLength(),i=this.getCurveLengths(),n=0;n<i.length;){if(i[n]>=e){var r=i[n]-e,a=this.curves[n],o=a.getLength(),s=0===o?0:1-r/o;return a.getPointAt(s)}n++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,i=0,n=this.curves.length;i<n;i++)e+=this.curves[i].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t){t||(t=40);for(var e=[],i=0;i<=t;i++)e.push(this.getPoint(i/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,i=[],n=0,r=this.curves;n<r.length;n++)for(var a=r[n],o=a&&a.isEllipseCurve?2*t:a&&a.isLineCurve?1:a&&a.isSplineCurve?t*a.points.length:t,s=a.getPoints(o),c=0;c<s.length;c++){var h=s[c];e&&e.equals(h)||(i.push(h),e=h)}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i},createPointsGeometry:function(t){var e=this.getPoints(t);return this.createGeometry(e)},createSpacedPointsGeometry:function(t){var e=this.getSpacedPoints(t);return this.createGeometry(e)},createGeometry:function(t){for(var e=new Et,i=0,n=t.length;i<n;i++){var r=t[i];e.vertices.push(new c(r.x,r.y,r.z||0))}return e}}),an.prototype=Object.create(en.prototype),an.prototype.constructor=an,an.prototype.isEllipseCurve=!0,an.prototype.getPoint=function(t){for(var e=2*Math.PI,n=this.aEndAngle-this.aStartAngle,r=Math.abs(n)<Number.EPSILON;n<0;)n+=e;for(;n>e;)n-=e;n<Number.EPSILON&&(n=r?0:e),this.aClockwise!==!0||r||(n===e?n=-e:n-=e);var a=this.aStartAngle+t*n,o=this.aX+this.xRadius*Math.cos(a),s=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){var c=Math.cos(this.aRotation),h=Math.sin(this.aRotation),l=o-this.aX,u=s-this.aY;o=l*c-u*h+this.aX,s=l*h+u*c+this.aY}return new i(o,s)};var xh={tangentQuadraticBezier:function(t,e,i,n){return 2*(1-t)*(i-e)+2*t*(n-i)},tangentCubicBezier:function(t,e,i,n,r){return-3*e*(1-t)*(1-t)+3*i*(1-t)*(1-t)-6*t*i*(1-t)+6*t*n*(1-t)-3*t*t*n+3*t*t*r},tangentSpline:function(t,e,i,n,r){var a=6*t*t-6*t,o=3*t*t-4*t+1,s=-6*t*t+6*t,c=3*t*t-2*t;return a+o+s+c},interpolate:function(t,e,i,n,r){var a=.5*(i-t),o=.5*(n-e),s=r*r,c=r*s;return(2*e-2*i+a+o)*c+(-3*e+3*i-2*a-o)*s+a*r+e}};on.prototype=Object.create(en.prototype),on.prototype.constructor=on,on.prototype.isSplineCurve=!0,on.prototype.getPoint=function(t){var e=this.points,n=(e.length-1)*t,r=Math.floor(n),a=n-r,o=e[0===r?r:r-1],s=e[r],c=e[r>e.length-2?e.length-1:r+1],h=e[r>e.length-3?e.length-1:r+2],l=xh.interpolate;return new i(l(o.x,s.x,c.x,h.x,a),l(o.y,s.y,c.y,h.y,a))},sn.prototype=Object.create(en.prototype),sn.prototype.constructor=sn,sn.prototype.getPoint=function(t){var e=uh.b3;return new i(e(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y))},sn.prototype.getTangent=function(t){var e=xh.tangentCubicBezier;return new i(e(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y)).normalize()},cn.prototype=Object.create(en.prototype),cn.prototype.constructor=cn,cn.prototype.getPoint=function(t){var e=uh.b2;return new i(e(t,this.v0.x,this.v1.x,this.v2.x),e(t,this.v0.y,this.v1.y,this.v2.y))},cn.prototype.getTangent=function(t){var e=xh.tangentQuadraticBezier;return new i(e(t,this.v0.x,this.v1.x,this.v2.x),e(t,this.v0.y,this.v1.y,this.v2.y)).normalize()};var _h=Object.assign(Object.create(rn.prototype),{fromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,i=t.length;e<i;e++)this.lineTo(t[e].x,t[e].y)},moveTo:function(t,e){this.currentPoint.set(t,e)},lineTo:function(t,e){var n=new nn(this.currentPoint.clone(),new i(t,e));this.curves.push(n),this.currentPoint.set(t,e)},quadraticCurveTo:function(t,e,n,r){var a=new cn(this.currentPoint.clone(),new i(t,e),new i(n,r));this.curves.push(a),this.currentPoint.set(n,r)},bezierCurveTo:function(t,e,n,r,a,o){var s=new sn(this.currentPoint.clone(),new i(t,e),new i(n,r),new i(a,o));this.curves.push(s),this.currentPoint.set(a,o)},splineThru:function(t){var e=[this.currentPoint.clone()].concat(t),i=new on(e);this.curves.push(i),this.currentPoint.copy(t[t.length-1])},arc:function(t,e,i,n,r,a){var o=this.currentPoint.x,s=this.currentPoint.y;this.absarc(t+o,e+s,i,n,r,a)},absarc:function(t,e,i,n,r,a){this.absellipse(t,e,i,i,n,r,a)},ellipse:function(t,e,i,n,r,a,o,s){var c=this.currentPoint.x,h=this.currentPoint.y;this.absellipse(t+c,e+h,i,n,r,a,o,s)},absellipse:function(t,e,i,n,r,a,o,s){var c=new an(t,e,i,n,r,a,o,s);if(this.curves.length>0){var h=c.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(c);var l=c.getPoint(1);this.currentPoint.copy(l)}});hn.prototype=Object.assign(Object.create(_h),{constructor:hn,getPointsHoles:function(t){for(var e=[],i=0,n=this.holes.length;i<n;i++)e[i]=this.holes[i].getPoints(t);return e},extractAllPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},extractPoints:function(t){return this.extractAllPoints(t)}}),ln.prototype=_h,_h.constructor=ln,un.prototype={moveTo:function(t,e){this.currentPath=new ln,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e)},lineTo:function(t,e){this.currentPath.lineTo(t,e)},quadraticCurveTo:function(t,e,i,n){this.currentPath.quadraticCurveTo(t,e,i,n)},bezierCurveTo:function(t,e,i,n,r,a){this.currentPath.bezierCurveTo(t,e,i,n,r,a)},splineThru:function(t){this.currentPath.splineThru(t)},toShapes:function(t,e){function i(t){for(var e=[],i=0,n=t.length;i<n;i++){var r=t[i],a=new hn;a.curves=r.curves,e.push(a)}return e}function n(t,e){for(var i=e.length,n=!1,r=i-1,a=0;a<i;r=a++){var o=e[r],s=e[a],c=s.x-o.x,h=s.y-o.y;
if(Math.abs(h)>Number.EPSILON){if(h<0&&(o=e[a],c=-c,s=e[r],h=-h),t.y<o.y||t.y>s.y)continue;if(t.y===o.y){if(t.x===o.x)return!0}else{var l=h*(t.x-o.x)-c*(t.y-o.y);if(0===l)return!0;if(l<0)continue;n=!n}}else{if(t.y!==o.y)continue;if(s.x<=t.x&&t.x<=o.x||o.x<=t.x&&t.x<=s.x)return!0}}return n}var r=uh.isClockWise,a=this.subPaths;if(0===a.length)return[];if(e===!0)return i(a);var o,s,c,h=[];if(1===a.length)return s=a[0],c=new hn,c.curves=s.curves,h.push(c),h;var l=!r(a[0].getPoints());l=t?!l:l;var u,p=[],d=[],f=[],m=0;d[m]=void 0,f[m]=[];for(var g=0,v=a.length;g<v;g++)s=a[g],u=s.getPoints(),o=r(u),o=t?!o:o,o?(!l&&d[m]&&m++,d[m]={s:new hn,p:u},d[m].s.curves=s.curves,l&&m++,f[m]=[]):f[m].push({h:s,p:u[0]});if(!d[0])return i(a);if(d.length>1){for(var y=!1,x=[],_=0,b=d.length;_<b;_++)p[_]=[];for(var _=0,b=d.length;_<b;_++)for(var w=f[_],M=0;M<w.length;M++){for(var E=w[M],T=!0,S=0;S<d.length;S++)n(E.p,d[S].p)&&(_!==S&&x.push({froms:_,tos:S,hole:M}),T?(T=!1,p[S].push(E)):y=!0);T&&p[_].push(E)}x.length>0&&(y||(f=p))}for(var A,g=0,L=d.length;g<L;g++){c=d[g].s,h.push(c),A=f[g];for(var R=0,P=A.length;R<P;R++)c.holes.push(A[R].h)}return h}},Object.assign(pn.prototype,{isFont:!0,generateShapes:function(t,e,i){function n(t){for(var i=String(t).split(""),n=e/a.resolution,o=0,s=[],c=0;c<i.length;c++){var h=r(i[c],n,o);o+=h.offset,s.push(h.path)}return s}function r(t,e,n){var r=a.glyphs[t]||a.glyphs["?"];if(r){var o,s,c,h,l,u,p,d,f,m,g,v=new un,y=[],x=uh.b2,_=uh.b3;if(r.o)for(var b=r._cachedOutline||(r._cachedOutline=r.o.split(" ")),w=0,M=b.length;w<M;){var E=b[w++];switch(E){case"m":o=b[w++]*e+n,s=b[w++]*e,v.moveTo(o,s);break;case"l":o=b[w++]*e+n,s=b[w++]*e,v.lineTo(o,s);break;case"q":if(c=b[w++]*e+n,h=b[w++]*e,p=b[w++]*e+n,d=b[w++]*e,v.quadraticCurveTo(p,d,c,h),g=y[y.length-1]){l=g.x,u=g.y;for(var T=1;T<=i;T++){var S=T/i;x(S,l,p,c),x(S,u,d,h)}}break;case"b":if(c=b[w++]*e+n,h=b[w++]*e,p=b[w++]*e+n,d=b[w++]*e,f=b[w++]*e+n,m=b[w++]*e,v.bezierCurveTo(p,d,f,m,c,h),g=y[y.length-1]){l=g.x,u=g.y;for(var T=1;T<=i;T++){var S=T/i;_(S,l,p,f,c),_(S,u,d,m,h)}}}}return{offset:r.ha*e,path:v}}}void 0===e&&(e=100),void 0===i&&(i=4);for(var a=this.data,o=n(t),s=[],c=0,h=o.length;c<h;c++)Array.prototype.push.apply(s,o[c].toShapes());return s}}),Object.assign(dn.prototype,{load:function(t,e,i,n){var r=this,a=new bi(this.manager);a.load(t,function(t){var i;try{i=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),i=JSON.parse(t.substring(65,t.length-2))}var n=r.parse(i);e&&e(n)},i,n)},parse:function(t){return new pn(t)}});var bh,wh={getContext:function(){return void 0===bh&&(bh=new(window.AudioContext||window.webkitAudioContext)),bh},setContext:function(t){bh=t}};Object.assign(fn.prototype,{load:function(t,e,i,n){var r=new bi(this.manager);r.setResponseType("arraybuffer"),r.load(t,function(t){var i=wh.getContext();i.decodeAudioData(t,function(t){e(t)})},i,n)}}),mn.prototype=Object.assign(Object.create(Ai.prototype),{constructor:mn,isRectAreaLight:!0,copy:function(t){return Ai.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this}}),Object.assign(gn.prototype,{update:function(){var t,e,i,n,r,a,o,s=new h,c=new h;return function(h){var l=t!==this||e!==h.focus||i!==h.fov||n!==h.aspect*this.aspect||r!==h.near||a!==h.far||o!==h.zoom;if(l){t=this,e=h.focus,i=h.fov,n=h.aspect*this.aspect,r=h.near,a=h.far,o=h.zoom;var u,p,d=h.projectionMatrix.clone(),f=this.eyeSep/2,m=f*r/e,g=r*Math.tan(Qo.DEG2RAD*i*.5)/o;c.elements[12]=-f,s.elements[12]=f,u=-g*n+m,p=g*n+m,d.elements[0]=2*r/(p-u),d.elements[8]=(p+u)/(p-u),this.cameraL.projectionMatrix.copy(d),u=-g*n-m,p=g*n-m,d.elements[0]=2*r/(p-u),d.elements[8]=(p+u)/(p-u),this.cameraR.projectionMatrix.copy(d)}this.cameraL.matrixWorld.copy(h.matrixWorld).multiply(c),this.cameraR.matrixWorld.copy(h.matrixWorld).multiply(s)}}()}),vn.prototype=Object.create(ct.prototype),vn.prototype.constructor=vn,yn.prototype=Object.assign(Object.create(ct.prototype),{constructor:yn,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(t){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){this.gain.gain.value=t},updateMatrixWorld:function(){var t=new c,e=new s,i=new c,n=new c;return function(r){ct.prototype.updateMatrixWorld.call(this,r);var a=this.context.listener,o=this.up;this.matrixWorld.decompose(t,e,i),n.set(0,0,-1).applyQuaternion(e),a.positionX?(a.positionX.setValueAtTime(t.x,this.context.currentTime),a.positionY.setValueAtTime(t.y,this.context.currentTime),a.positionZ.setValueAtTime(t.z,this.context.currentTime),a.forwardX.setValueAtTime(n.x,this.context.currentTime),a.forwardY.setValueAtTime(n.y,this.context.currentTime),a.forwardZ.setValueAtTime(n.z,this.context.currentTime),a.upX.setValueAtTime(o.x,this.context.currentTime),a.upY.setValueAtTime(o.y,this.context.currentTime),a.upZ.setValueAtTime(o.z,this.context.currentTime)):(a.setPosition(t.x,t.y,t.z),a.setOrientation(n.x,n.y,n.z,o.x,o.y,o.z))}}()}),xn.prototype=Object.assign(Object.create(ct.prototype),{constructor:xn,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(this.isPlaying===!0)return void console.warn("THREE.Audio: Audio is already playing.");if(this.hasPlaybackControl===!1)return void console.warn("THREE.Audio: this Audio has no playback control.");var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.onended=this.onEnded.bind(this),t.playbackRate.setValueAtTime(this.playbackRate,this.startTime),t.start(0,this.startTime),this.isPlaying=!0,this.source=t,this.connect()},pause:function(){return this.hasPlaybackControl===!1?void console.warn("THREE.Audio: this Audio has no playback control."):(this.source.stop(),this.startTime=this.context.currentTime,this.isPlaying=!1,this)},stop:function(){return this.hasPlaybackControl===!1?void console.warn("THREE.Audio: this Audio has no playback control."):(this.source.stop(),this.startTime=0,this.isPlaying=!1,this)},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),this.isPlaying===!0?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){return this.hasPlaybackControl===!1?void console.warn("THREE.Audio: this Audio has no playback control."):(this.playbackRate=t,this.isPlaying===!0&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this)},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){return this.hasPlaybackControl===!1?void console.warn("THREE.Audio: this Audio has no playback control."):(this.loop=t,this.isPlaying===!0&&(this.source.loop=this.loop),this)},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.value=t,this}}),_n.prototype=Object.assign(Object.create(xn.prototype),{constructor:_n,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){this.panner.refDistance=t},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){this.panner.rolloffFactor=t},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){this.panner.distanceModel=t},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){this.panner.maxDistance=t},updateMatrixWorld:function(){var t=new c;return function(e){ct.prototype.updateMatrixWorld.call(this,e),t.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(t.x,t.y,t.z)}}()}),Object.assign(bn.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),i=0;i<e.length;i++)t+=e[i];return t/e.length}}),wn.prototype={constructor:wn,accumulate:function(t,e){var i=this.buffer,n=this.valueSize,r=t*n+n,a=this.cumulativeWeight;if(0===a){for(var o=0;o!==n;++o)i[r+o]=i[o];a=e}else{a+=e;var s=e/a;this._mixBufferRegion(i,r,0,s,n)}this.cumulativeWeight=a},apply:function(t){var e=this.valueSize,i=this.buffer,n=t*e+e,r=this.cumulativeWeight,a=this.binding;if(this.cumulativeWeight=0,r<1){var o=3*e;this._mixBufferRegion(i,n,o,1-r,e)}for(var s=e,c=e+e;s!==c;++s)if(i[s]!==i[s+e]){a.setValue(i,n);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,i=this.valueSize,n=3*i;t.getValue(e,n);for(var r=i,a=n;r!==a;++r)e[r]=e[n+r%i];this.cumulativeWeight=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_select:function(t,e,i,n,r){if(n>=.5)for(var a=0;a!==r;++a)t[e+a]=t[i+a]},_slerp:function(t,e,i,n,r){s.slerpFlat(t,e,t,e,t,i,n)},_lerp:function(t,e,i,n,r){for(var a=1-n,o=0;o!==r;++o){var s=e+o;t[s]=t[s]*a+t[i+o]*n}}},Mn.prototype={constructor:Mn,getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,i=e.objectName,n=e.propertyName,r=e.propertyIndex;if(t||(t=Mn.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("  trying to update node for track: "+this.path+" but it wasn't found.");if(i){var a=e.objectIndex;switch(i){case"materials":if(!t.material)return void console.error("  can not bind to material as node does not have a material",this);if(!t.material.materials)return void console.error("  can not bind to material.materials as node.material does not have a materials array",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("  can not bind to bones as node does not have a skeleton",this);t=t.skeleton.bones;for(var o=0;o<t.length;o++)if(t[o].name===a){a=o;break}break;default:if(void 0===t[i])return void console.error("  can not bind to objectName of node, undefined",this);t=t[i]}if(void 0!==a){if(void 0===t[a])return void console.error("  trying to bind to objectIndex of objectName, but is undefined:",this,t);t=t[a]}}var s=t[n];if(void 0===s){var c=e.nodeName;return void console.error("  trying to update property for track: "+c+"."+n+" but it wasn't found.",t)}var h=this.Versioning.None;void 0!==t.needsUpdate?(h=this.Versioning.NeedsUpdate,this.targetObject=t):void 0!==t.matrixWorldNeedsUpdate&&(h=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=t);var l=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===n){if(!t.geometry)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry",this);if(!t.geometry.morphTargets)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry.morphTargets",this);for(var o=0;o<this.node.geometry.morphTargets.length;o++)if(t.geometry.morphTargets[o].name===r){r=o;break}}l=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=s):void 0!==s.length?(l=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][h]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}},Object.assign(Mn.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},_getValue_unbound:Mn.prototype.getValue,_setValue_unbound:Mn.prototype.setValue,BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)t[e++]=i[n]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.node[this.propertyName]=t[e]},function(t,e){this.node[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.node[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=t[e++]},function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]]}),Mn.Composite=function(t,e,i){var n=i||Mn.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,n)},Mn.Composite.prototype={constructor:Mn.Composite,getValue:function(t,e){this.bind();var i=this._targetGroup.nCachedObjects_,n=this._bindings[i];void 0!==n&&n.getValue(t,e)},setValue:function(t,e){for(var i=this._bindings,n=this._targetGroup.nCachedObjects_,r=i.length;n!==r;++n)i[n].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].unbind()}},Mn.create=function(t,e,i){return t&&t.isAnimationObjectGroup?new Mn.Composite(t,e,i):new Mn(t,e,i)},Mn.parseTrackName=function(t){var e=/^((?:[\w-]+[\/:])*)([\w-]+)?(?:\.([\w-]+)(?:\[(.+)\])?)?\.([\w-]+)(?:\[(.+)\])?$/,i=e.exec(t);if(!i)throw new Error("cannot parse trackName at all: "+t);var n={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]};if(null===n.propertyName||0===n.propertyName.length)throw new Error("can not parse propertyName from trackName: "+t);return n},Mn.findNode=function(t,e){if(!e||""===e||"root"===e||"."===e||e===-1||e===t.name||e===t.uuid)return t;if(t.skeleton){var i=function(t){for(var i=0;i<t.bones.length;i++){var n=t.bones[i];if(n.name===e)return n}return null},n=i(t.skeleton);if(n)return n}if(t.children){var r=function(t){for(var i=0;i<t.length;i++){var n=t[i];if(n.name===e||n.uuid===e)return n;var a=r(n.children);if(a)return a}return null},a=r(t.children);if(a)return a}return null},En.prototype={constructor:En,isAnimationObjectGroup:!0,add:function(t){for(var e=this._objects,i=e.length,n=this.nCachedObjects_,r=this._indicesByUUID,a=this._paths,o=this._parsedPaths,s=this._bindings,c=s.length,h=0,l=arguments.length;h!==l;++h){var u=arguments[h],p=u.uuid,d=r[p],f=void 0;if(void 0===d){d=i++,r[p]=d,e.push(u);for(var m=0,g=c;m!==g;++m)s[m].push(new Mn(u,a[m],o[m]))}else if(d<n){f=e[d];var v=--n,y=e[v];r[y.uuid]=d,e[d]=y,r[p]=v,e[v]=u;for(var m=0,g=c;m!==g;++m){var x=s[m],_=x[v],b=x[d];x[d]=_,void 0===b&&(b=new Mn(u,a[m],o[m])),x[v]=b}}else e[d]!==f&&console.error("Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes...")}this.nCachedObjects_=n},remove:function(t){for(var e=this._objects,i=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,a=r.length,o=0,s=arguments.length;o!==s;++o){var c=arguments[o],h=c.uuid,l=n[h];if(void 0!==l&&l>=i){var u=i++,p=e[u];n[p.uuid]=l,e[l]=p,n[h]=u,e[u]=c;for(var d=0,f=a;d!==f;++d){var m=r[d],g=m[u],v=m[l];m[l]=g,m[u]=v}}}this.nCachedObjects_=i},uncache:function(t){for(var e=this._objects,i=e.length,n=this.nCachedObjects_,r=this._indicesByUUID,a=this._bindings,o=a.length,s=0,c=arguments.length;s!==c;++s){var h=arguments[s],l=h.uuid,u=r[l];if(void 0!==u)if(delete r[l],u<n){var p=--n,d=e[p],f=--i,m=e[f];r[d.uuid]=u,e[u]=d,r[m.uuid]=p,e[p]=m,e.pop();for(var g=0,v=o;g!==v;++g){var y=a[g],x=y[p],_=y[f];y[u]=x,y[p]=_,y.pop()}}else{var f=--i,m=e[f];r[m.uuid]=u,e[u]=m,e.pop();for(var g=0,v=o;g!==v;++g){var y=a[g];y[u]=y[f],y.pop()}}}this.nCachedObjects_=n},subscribe_:function(t,e){var i=this._bindingsIndicesByPath,n=i[t],r=this._bindings;if(void 0!==n)return r[n];var a=this._paths,o=this._parsedPaths,s=this._objects,c=s.length,h=this.nCachedObjects_,l=new Array(c);n=r.length,i[t]=n,a.push(t),o.push(e),r.push(l);for(var u=h,p=s.length;u!==p;++u){var d=s[u];l[u]=new Mn(d,t,e)}return l},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,i=e[t];if(void 0!==i){var n=this._paths,r=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o],c=t[o];e[c]=i,a[i]=s,a.pop(),r[i]=r[o],r.pop(),n[i]=n[o],n.pop()}}},Tn.prototype={constructor:Tn,play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,i){if(t.fadeOut(e),this.fadeIn(e),i){var n=this._clip.duration,r=t._clip.duration,a=r/n,o=n/r;t.warp(1,a,e),this.warp(o,1,e)}return this},crossFadeTo:function(t,e,i){return t.crossFadeFrom(this,e,i)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,i){var n=this._mixer,r=n.time,a=this._timeScaleInterpolant,o=this.timeScale;null===a&&(a=n._lendControlInterpolant(),this._timeScaleInterpolant=a);var s=a.parameterPositions,c=a.sampleValues;return s[0]=r,s[1]=r+i,c[0]=t/o,c[1]=e/o,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,i,n){var r=this._startTime;if(null!==r){var a=(t-r)*i;if(a<0||0===i)return;this._startTime=null,e=i*a}e*=this._updateTimeScale(t);var o=this._updateTime(e),s=this._updateWeight(t);if(s>0)for(var c=this._interpolants,h=this._propertyBindings,l=0,u=c.length;l!==u;++l)c[l].evaluate(o),h[l].accumulate(n,s)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var i=this._weightInterpolant;if(null!==i){var n=i.evaluate(t)[0];e*=n,t>i.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var i=this._timeScaleInterpolant;if(null!==i){var n=i.evaluate(t)[0];e*=n,t>i.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t;if(0===t)return e;var i=this._clip.duration,n=this.loop,r=this._loopCount;if(n===Ro){r===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(e>=i)e=i;else{if(!(e<0))break t;e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{var a=n===Co;if(r===-1&&(t>=0?(r=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),e>=i||e<0){var o=Math.floor(e/i);e-=i*o,r+=Math.abs(o);var s=this.repetitions-r;if(s<0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?i:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(0===s){var c=t<0;this._setEndings(c,!c,a)}else this._setEndings(!1,!1,a);this._loopCount=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}if(a&&1===(1&r))return this.time=e,i-e}return this.time=e,e},_setEndings:function(t,e,i){var n=this._interpolantSettings;i?(n.endingStart=Oo,n.endingEnd=Oo):(t?n.endingStart=this.zeroSlopeAtStart?Oo:Do:n.endingStart=Fo,e?n.endingEnd=this.zeroSlopeAtEnd?Oo:Do:n.endingEnd=Fo)},_scheduleFading:function(t,e,i){var n=this._mixer,r=n.time,a=this._weightInterpolant;null===a&&(a=n._lendControlInterpolant(),this._weightInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=r,s[0]=e,o[1]=r+t,s[1]=i,this}},Object.assign(Sn.prototype,e.prototype,{clipAction:function(t,e){var i=e||this._root,n=i.uuid,r="string"==typeof t?Zi.findByName(i,t):t,a=null!==r?r.uuid:t,o=this._actionsByClip[a],s=null;if(void 0!==o){var c=o.actionByRoot[n];if(void 0!==c)return c;s=o.knownActions[0],null===r&&(r=s._clip)}if(null===r)return null;var h=new Tn(this,r,e);return this._bindAction(h,s),this._addInactiveAction(h,a,n),h},existingAction:function(t,e){var i=e||this._root,n=i.uuid,r="string"==typeof t?Zi.findByName(i,t):t,a=r?r.uuid:t,o=this._actionsByClip[a];return void 0!==o?o.actionByRoot[n]||null:null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,i=this._bindings,n=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var r=0;r!==e;++r)t[r].reset();for(var r=0;r!==n;++r)i[r].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,i=this._nActiveActions,n=this.time+=t,r=Math.sign(t),a=this._accuIndex^=1,o=0;o!==i;++o){var s=e[o];s.enabled&&s._update(n,t,r,a)}for(var c=this._bindings,h=this._nActiveBindings,o=0;o!==h;++o)c[o].apply(a);return this},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,i=t.uuid,n=this._actionsByClip,r=n[i];if(void 0!==r){for(var a=r.knownActions,o=0,s=a.length;o!==s;++o){var c=a[o];this._deactivateAction(c);var h=c._cacheIndex,l=e[e.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,l._cacheIndex=h,e[h]=l,e.pop(),this._removeInactiveBindingsForAction(c)}delete n[i]}},uncacheRoot:function(t){var e=t.uuid,i=this._actionsByClip;for(var n in i){var r=i[n].actionByRoot,a=r[e];void 0!==a&&(this._deactivateAction(a),this._removeInactiveAction(a))}var o=this._bindingsByRootAndName,s=o[e];if(void 0!==s)for(var c in s){var h=s[c];h.restoreOriginalState(),this._removeInactiveBinding(h)}},uncacheAction:function(t,e){var i=this.existingAction(t,e);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}}),Object.assign(Sn.prototype,{_bindAction:function(t,e){var i=t._localRoot||this._root,n=t._clip.tracks,r=n.length,a=t._propertyBindings,o=t._interpolants,s=i.uuid,c=this._bindingsByRootAndName,h=c[s];void 0===h&&(h={},c[s]=h);for(var l=0;l!==r;++l){var u=n[l],p=u.name,d=h[p];if(void 0!==d)a[l]=d;else{if(d=a[l],void 0!==d){null===d._cacheIndex&&(++d.referenceCount,this._addInactiveBinding(d,s,p));continue}var f=e&&e._propertyBindings[l].binding.parsedPath;d=new wn(Mn.create(i,p,f),u.ValueTypeName,u.getValueSize()),++d.referenceCount,this._addInactiveBinding(d,s,p),a[l]=d}o[l].resultBuffer=d.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,i=t._clip.uuid,n=this._actionsByClip[i];this._bindAction(t,n&&n.knownActions[0]),this._addInactiveAction(t,i,e)}for(var r=t._propertyBindings,a=0,o=r.length;a!==o;++a){var s=r[a];0===s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,i=0,n=e.length;i!==n;++i){var r=e[i];0===--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,i){var n=this._actions,r=this._actionsByClip,a=r[e];if(void 0===a)a={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,r[e]=a;else{var o=a.knownActions;t._byClipCacheIndex=o.length,o.push(t)}t._cacheIndex=n.length,n.push(t),a.actionByRoot[i]=t},_removeInactiveAction:function(t){var e=this._actions,i=e[e.length-1],n=t._cacheIndex;i._cacheIndex=n,e[n]=i,e.pop(),t._cacheIndex=null;var r=t._clip.uuid,a=this._actionsByClip,o=a[r],s=o.knownActions,c=s[s.length-1],h=t._byClipCacheIndex;c._byClipCacheIndex=h,s[h]=c,s.pop(),t._byClipCacheIndex=null;var l=o.actionByRoot,u=(e._localRoot||this._root).uuid;delete l[u],0===s.length&&delete a[r],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,i=0,n=e.length;i!==n;++i){var r=e[i];0===--r.referenceCount&&this._removeInactiveBinding(r)}},_lendAction:function(t){var e=this._actions,i=t._cacheIndex,n=this._nActiveActions++,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r},_takeBackAction:function(t){var e=this._actions,i=t._cacheIndex,n=--this._nActiveActions,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r},_addInactiveBinding:function(t,e,i){var n=this._bindingsByRootAndName,r=n[e],a=this._bindings;void 0===r&&(r={},n[e]=r),r[i]=t,t._cacheIndex=a.length,a.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,i=t.binding,n=i.rootNode.uuid,r=i.path,a=this._bindingsByRootAndName,o=a[n],s=e[e.length-1],c=t._cacheIndex;s._cacheIndex=c,e[c]=s,e.pop(),delete o[r];t:{for(var h in o)break t;delete a[n]}},_lendBinding:function(t){var e=this._bindings,i=t._cacheIndex,n=this._nActiveBindings++,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r},_takeBackBinding:function(t){var e=this._bindings,i=t._cacheIndex,n=--this._nActiveBindings,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,i=t[e];return void 0===i&&(i=new zi(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),i.__cacheIndex=e,t[e]=i),i},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,i=t.__cacheIndex,n=--this._nActiveControlInterpolants,r=e[n];t.__cacheIndex=n,e[n]=t,r.__cacheIndex=i,e[i]=r},_controlInterpolantsResultBuffer:new Float32Array(1)}),An.prototype.clone=function(){return new An(void 0===this.value.clone?this.value:this.value.clone())},Ln.prototype=Object.create(St.prototype),Ln.prototype.constructor=Ln,Ln.prototype.isInstancedBufferGeometry=!0,Ln.prototype.addGroup=function(t,e,i){this.groups.push({start:t,count:e,materialIndex:i})},Ln.prototype.copy=function(t){var e=t.index;null!==e&&this.setIndex(e.clone());var i=t.attributes;for(var n in i){var r=i[n];this.addAttribute(n,r.clone())}for(var a=t.groups,o=0,s=a.length;o<s;o++){var c=a[o];this.addGroup(c.start,c.count,c.materialIndex)}return this},Rn.prototype={constructor:Rn,isInterleavedBufferAttribute:!0,get count(){return this.data.count},get array(){return this.data.array},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this},setXYZ:function(t,e,i,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this},setXYZW:function(t,e,i,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this.data.array[t+3]=r,this}},Pn.prototype={constructor:Pn,isInterleavedBuffer:!0,set needsUpdate(t){t===!0&&this.version++},setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.stride:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.dynamic=t.dynamic,this},copyAt:function(t,e,i){t*=this.stride,i*=e.stride;for(var n=0,r=this.stride;n<r;n++)this.array[t+n]=e.array[i+n];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}},Cn.prototype=Object.create(Pn.prototype),Cn.prototype.constructor=Cn,Cn.prototype.isInstancedInterleavedBuffer=!0,Cn.prototype.copy=function(t){return Pn.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},In.prototype=Object.create(dt.prototype),In.prototype.constructor=In,In.prototype.isInstancedBufferAttribute=!0,In.prototype.copy=function(t){return dt.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},Un.prototype={constructor:Un,linePrecision:1,set:function(t,e){
this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize()):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e){var i=[];return Dn(t,this,i,e),i.sort(Nn),i},intersectObjects:function(t,e){var i=[];if(Array.isArray(t)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(var n=0,r=t.length;n<r;n++)Dn(t[n],this,i,e);return i.sort(Nn),i}},On.prototype={constructor:On,start:function(){this.startTime=(performance||Date).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running&&this.start(),this.running){var e=(performance||Date).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}},zn.prototype={constructor:zn,set:function(t,e,i){return this.radius=t,this.phi=e,this.theta=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){var t=1e-6;return this.phi=Math.max(t,Math.min(Math.PI-t,this.phi)),this},setFromVector3:function(t){return this.radius=t.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t.x,t.z),this.phi=Math.acos(Qo.clamp(t.y/this.radius,-1,1))),this}},Bn.prototype={constructor:Bn,set:function(t,e,i){return this.radius=t,this.theta=e,this.y=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.radius=Math.sqrt(t.x*t.x+t.z*t.z),this.theta=Math.atan2(t.x,t.z),this.y=t.y,this}},Gn.prototype=Object.create(At.prototype),Gn.prototype.constructor=Gn,Gn.prototype.createAnimation=function(t,e,i,n){var r={start:e,end:i,length:i-e+1,fps:n,duration:(i-e)/n,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[t]=r,this.animationsList.push(r)},Gn.prototype.autoCreateAnimations=function(t){for(var e,i=/([a-z]+)_?(\d+)/i,n={},r=this.geometry,a=0,o=r.morphTargets.length;a<o;a++){var s=r.morphTargets[a],c=s.name.match(i);if(c&&c.length>1){var h=c[1];n[h]||(n[h]={start:1/0,end:-(1/0)});var l=n[h];a<l.start&&(l.start=a),a>l.end&&(l.end=a),e||(e=h)}}for(var h in n){var l=n[h];this.createAnimation(h,l.start,l.end,t)}this.firstAnimation=e},Gn.prototype.setAnimationDirectionForward=function(t){var e=this.animationsMap[t];e&&(e.direction=1,e.directionBackwards=!1)},Gn.prototype.setAnimationDirectionBackward=function(t){var e=this.animationsMap[t];e&&(e.direction=-1,e.directionBackwards=!0)},Gn.prototype.setAnimationFPS=function(t,e){var i=this.animationsMap[t];i&&(i.fps=e,i.duration=(i.end-i.start)/i.fps)},Gn.prototype.setAnimationDuration=function(t,e){var i=this.animationsMap[t];i&&(i.duration=e,i.fps=(i.end-i.start)/i.duration)},Gn.prototype.setAnimationWeight=function(t,e){var i=this.animationsMap[t];i&&(i.weight=e)},Gn.prototype.setAnimationTime=function(t,e){var i=this.animationsMap[t];i&&(i.time=e)},Gn.prototype.getAnimationTime=function(t){var e=0,i=this.animationsMap[t];return i&&(e=i.time),e},Gn.prototype.getAnimationDuration=function(t){var e=-1,i=this.animationsMap[t];return i&&(e=i.duration),e},Gn.prototype.playAnimation=function(t){var e=this.animationsMap[t];e?(e.time=0,e.active=!0):console.warn("THREE.MorphBlendMesh: animation["+t+"] undefined in .playAnimation()")},Gn.prototype.stopAnimation=function(t){var e=this.animationsMap[t];e&&(e.active=!1)},Gn.prototype.update=function(t){for(var e=0,i=this.animationsList.length;e<i;e++){var n=this.animationsList[e];if(n.active){var r=n.duration/n.length;n.time+=n.direction*t,n.mirroredLoop?(n.time>n.duration||n.time<0)&&(n.direction*=-1,n.time>n.duration&&(n.time=n.duration,n.directionBackwards=!0),n.time<0&&(n.time=0,n.directionBackwards=!1)):(n.time=n.time%n.duration,n.time<0&&(n.time+=n.duration));var a=n.start+Qo.clamp(Math.floor(n.time/r),0,n.length-1),o=n.weight;a!==n.currentFrame&&(this.morphTargetInfluences[n.lastFrame]=0,this.morphTargetInfluences[n.currentFrame]=1*o,this.morphTargetInfluences[a]=0,n.lastFrame=n.currentFrame,n.currentFrame=a);var s=n.time%r/r;n.directionBackwards&&(s=1-s),n.currentFrame!==n.lastFrame?(this.morphTargetInfluences[n.currentFrame]=s*o,this.morphTargetInfluences[n.lastFrame]=(1-s)*o):this.morphTargetInfluences[n.currentFrame]=o}}},Hn.prototype=Object.create(ct.prototype),Hn.prototype.constructor=Hn,Hn.prototype.isImmediateRenderObject=!0,Vn.prototype=Object.create(ye.prototype),Vn.prototype.constructor=Vn,Vn.prototype.update=function(){var t=new c,e=new c,i=new et;return function(){var n=["a","b","c"];this.object.updateMatrixWorld(!0),i.getNormalMatrix(this.object.matrixWorld);var r=this.object.matrixWorld,a=this.geometry.attributes.position,o=this.object.geometry;if(o&&o.isGeometry)for(var s=o.vertices,c=o.faces,h=0,l=0,u=c.length;l<u;l++)for(var p=c[l],d=0,f=p.vertexNormals.length;d<f;d++){var m=s[p[n[d]]],g=p.vertexNormals[d];t.copy(m).applyMatrix4(r),e.copy(g).applyMatrix3(i).normalize().multiplyScalar(this.size).add(t),a.setXYZ(h,t.x,t.y,t.z),h+=1,a.setXYZ(h,e.x,e.y,e.z),h+=1}else if(o&&o.isBufferGeometry)for(var v=o.attributes.position,y=o.attributes.normal,h=0,d=0,f=v.count;d<f;d++)t.set(v.getX(d),v.getY(d),v.getZ(d)).applyMatrix4(r),e.set(y.getX(d),y.getY(d),y.getZ(d)),e.applyMatrix3(i).normalize().multiplyScalar(this.size).add(t),a.setXYZ(h,t.x,t.y,t.z),h+=1,a.setXYZ(h,e.x,e.y,e.z),h+=1;return a.needsUpdate=!0,this}}(),kn.prototype=Object.create(ct.prototype),kn.prototype.constructor=kn,kn.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},kn.prototype.update=function(){var t=new c,e=new c;return function(){var i=this.light.distance?this.light.distance:1e3,n=i*Math.tan(this.light.angle);this.cone.scale.set(n,n,i),t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e.sub(t)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),jn.prototype=Object.create(ye.prototype),jn.prototype.constructor=jn,jn.prototype.getBoneList=function(t){var e=[];t&&t.isBone&&e.push(t);for(var i=0;i<t.children.length;i++)e.push.apply(e,this.getBoneList(t.children[i]));return e},jn.prototype.update=function(){var t=new c,e=new h,i=new h;return function(){var n=this.geometry,r=n.getAttribute("position");i.getInverse(this.root.matrixWorld);for(var a=0,o=0;a<this.bones.length;a++){var s=this.bones[a];s.parent&&s.parent.isBone&&(e.multiplyMatrices(i,s.matrixWorld),t.setFromMatrixPosition(e),r.setXYZ(o,t.x,t.y,t.z),e.multiplyMatrices(i,s.parent.matrixWorld),t.setFromMatrixPosition(e),r.setXYZ(o+1,t.x,t.y,t.z),o+=2)}n.getAttribute("position").needsUpdate=!0}}(),Wn.prototype=Object.create(At.prototype),Wn.prototype.constructor=Wn,Wn.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Wn.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},Xn.prototype=Object.create(ct.prototype),Xn.prototype.constructor=Xn,Xn.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose(),this.children[1].geometry.dispose(),this.children[1].material.dispose()},Xn.prototype.update=function(){var t=new c,e=new c;return function(){var i=this.children[0],n=this.children[1];if(this.light.target){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld);var r=e.clone().sub(t);i.lookAt(r),n.lookAt(r)}i.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),n.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);var a=.5*this.light.width,o=.5*this.light.height,s=i.geometry.getAttribute("position"),c=s.array;c[0]=a,c[1]=-o,c[2]=0,c[3]=a,c[4]=o,c[5]=0,c[6]=-a,c[7]=o,c[8]=0,c[9]=-a,c[10]=o,c[11]=0,c[12]=-a,c[13]=-o,c[14]=0,c[15]=a,c[16]=-o,c[17]=0,s.needsUpdate=!0}}(),Yn.prototype=Object.create(ct.prototype),Yn.prototype.constructor=Yn,Yn.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Yn.prototype.update=function(){var t=new c,e=new W,i=new W;return function(){var n=this.children[0],r=n.geometry.getAttribute("color");e.copy(this.light.color).multiplyScalar(this.light.intensity),i.copy(this.light.groundColor).multiplyScalar(this.light.intensity);for(var a=0,o=r.count;a<o;a++){var s=a<o/2?e:i;r.setXYZ(a,s.r,s.g,s.b)}n.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate()),r.needsUpdate=!0}}(),qn.prototype=Object.create(ye.prototype),qn.prototype.constructor=qn,Zn.prototype=Object.create(ye.prototype),Zn.prototype.constructor=Zn,Jn.prototype=Object.create(ye.prototype),Jn.prototype.constructor=Jn,Jn.prototype.update=function(){var t=new c,e=new c,i=new et;return function(){this.object.updateMatrixWorld(!0),i.getNormalMatrix(this.object.matrixWorld);for(var n=this.object.matrixWorld,r=this.geometry.attributes.position,a=this.object.geometry,o=a.vertices,s=a.faces,c=0,h=0,l=s.length;h<l;h++){var u=s[h],p=u.normal;t.copy(o[u.a]).add(o[u.b]).add(o[u.c]).divideScalar(3).applyMatrix4(n),e.copy(p).applyMatrix3(i).normalize().multiplyScalar(this.size).add(t),r.setXYZ(c,t.x,t.y,t.z),c+=1,r.setXYZ(c,e.x,e.y,e.z),c+=1}return r.needsUpdate=!0,this}}(),Qn.prototype=Object.create(ct.prototype),Qn.prototype.constructor=Qn,Qn.prototype.dispose=function(){var t=this.children[0],e=this.children[1];t.geometry.dispose(),t.material.dispose(),e.geometry.dispose(),e.material.dispose()},Qn.prototype.update=function(){var t=new c,e=new c,i=new c;return function(){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),i.subVectors(e,t);var n=this.children[0],r=this.children[1];n.lookAt(i),n.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),r.lookAt(i),r.scale.z=i.length()}}(),Kn.prototype=Object.create(ye.prototype),Kn.prototype.constructor=Kn,Kn.prototype.update=function(){function t(t,a,o,s){n.set(a,o,s).unproject(r);var c=i[t];if(void 0!==c)for(var h=e.getAttribute("position"),l=0,u=c.length;l<u;l++)h.setXYZ(c[l],n.x,n.y,n.z)}var e,i,n=new c,r=new Pt;return function(){e=this.geometry,i=this.pointMap;var n=1,a=1;r.projectionMatrix.copy(this.camera.projectionMatrix),t("c",0,0,-1),t("t",0,0,1),t("n1",-n,-a,-1),t("n2",n,-a,-1),t("n3",-n,a,-1),t("n4",n,a,-1),t("f1",-n,-a,1),t("f2",n,-a,1),t("f3",-n,a,1),t("f4",n,a,1),t("u1",.7*n,1.1*a,-1),t("u2",.7*-n,1.1*a,-1),t("u3",0,2*a,-1),t("cf1",-n,0,1),t("cf2",n,0,1),t("cf3",0,-a,1),t("cf4",0,a,1),t("cn1",-n,0,-1),t("cn2",n,0,-1),t("cn3",0,-a,-1),t("cn4",0,a,-1),e.getAttribute("position").needsUpdate=!0}}(),$n.prototype=Object.create(ye.prototype),$n.prototype.constructor=$n,$n.prototype.update=function(){var t=new $;return function(e){if(e&&e.isBox3?t.copy(e):t.setFromObject(e),!t.isEmpty()){var i=t.min,n=t.max,r=this.geometry.attributes.position,a=r.array;a[0]=n.x,a[1]=n.y,a[2]=n.z,a[3]=i.x,a[4]=n.y,a[5]=n.z,a[6]=i.x,a[7]=i.y,a[8]=n.z,a[9]=n.x,a[10]=i.y,a[11]=n.z,a[12]=n.x,a[13]=n.y,a[14]=i.z,a[15]=i.x,a[16]=n.y,a[17]=i.z,a[18]=i.x,a[19]=i.y,a[20]=i.z,a[21]=n.x,a[22]=i.y,a[23]=i.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}();var Mh=new St;Mh.addAttribute("position",new bt([0,0,0,0,1,0],3));var Eh=new ni(0,.5,1,5,1);Eh.translate(0,-.5,0),tr.prototype=Object.create(ct.prototype),tr.prototype.constructor=tr,tr.prototype.setDirection=function(){var t,e=new c;return function(i){i.y>.99999?this.quaternion.set(0,0,0,1):i.y<-.99999?this.quaternion.set(1,0,0,0):(e.set(i.z,0,-i.x).normalize(),t=Math.acos(i.y),this.quaternion.setFromAxisAngle(e,t))}}(),tr.prototype.setLength=function(t,e,i){void 0===e&&(e=.2*t),void 0===i&&(i=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(i,e,i),this.cone.position.y=t,this.cone.updateMatrix()},tr.prototype.setColor=function(t){this.line.material.color.copy(t),this.cone.material.color.copy(t)},er.prototype=Object.create(ye.prototype),er.prototype.constructor=er;var Th=function(){function t(){}var e=new c,i=new t,n=new t,r=new t;return t.prototype.init=function(t,e,i,n){this.c0=t,this.c1=i,this.c2=-3*t+3*e-2*i-n,this.c3=2*t-2*e+i+n},t.prototype.initNonuniformCatmullRom=function(t,e,i,n,r,a,o){var s=(e-t)/r-(i-t)/(r+a)+(i-e)/a,c=(i-e)/a-(n-e)/(a+o)+(n-i)/o;s*=a,c*=a,this.init(e,i,s,c)},t.prototype.initCatmullRom=function(t,e,i,n,r){this.init(e,i,r*(i-t),r*(n-e))},t.prototype.calc=function(t){var e=t*t,i=e*t;return this.c0+this.c1*t+this.c2*e+this.c3*i},en.create(function(t){this.points=t||[],this.closed=!1},function(t){var a,o,s,h,l=this.points;h=l.length,h<2&&console.log("duh, you need at least 2 points"),a=(h-(this.closed?0:1))*t,o=Math.floor(a),s=a-o,this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/l.length)+1)*l.length:0===s&&o===h-1&&(o=h-2,s=1);var u,p,d,f;if(this.closed||o>0?u=l[(o-1)%h]:(e.subVectors(l[0],l[1]).add(l[0]),u=e),p=l[o%h],d=l[(o+1)%h],this.closed||o+2<h?f=l[(o+2)%h]:(e.subVectors(l[h-1],l[h-2]).add(l[h-1]),f=e),void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var m="chordal"===this.type?.5:.25,g=Math.pow(u.distanceToSquared(p),m),v=Math.pow(p.distanceToSquared(d),m),y=Math.pow(d.distanceToSquared(f),m);v<1e-4&&(v=1),g<1e-4&&(g=v),y<1e-4&&(y=v),i.initNonuniformCatmullRom(u.x,p.x,d.x,f.x,g,v,y),n.initNonuniformCatmullRom(u.y,p.y,d.y,f.y,g,v,y),r.initNonuniformCatmullRom(u.z,p.z,d.z,f.z,g,v,y)}else if("catmullrom"===this.type){var x=void 0!==this.tension?this.tension:.5;i.initCatmullRom(u.x,p.x,d.x,f.x,x),n.initCatmullRom(u.y,p.y,d.y,f.y,x),r.initCatmullRom(u.z,p.z,d.z,f.z,x)}var _=new c(i.calc(s),n.calc(s),r.calc(s));return _})}(),Sh=en.create(function(t){console.warn("THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3"),this.points=void 0===t?[]:t},function(t){var e=this.points,i=(e.length-1)*t,n=Math.floor(i),r=i-n,a=e[0==n?n:n-1],o=e[n],s=e[n>e.length-2?e.length-1:n+1],h=e[n>e.length-3?e.length-1:n+2],l=xh.interpolate;return new c(l(a.x,o.x,s.x,h.x,r),l(a.y,o.y,s.y,h.y,r),l(a.z,o.z,s.z,h.z,r))}),Ah=en.create(function(t,e,i,n){this.v0=t,this.v1=e,this.v2=i,this.v3=n},function(t){var e=uh.b3;return new c(e(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y),e(t,this.v0.z,this.v1.z,this.v2.z,this.v3.z))}),Lh=en.create(function(t,e,i){this.v0=t,this.v1=e,this.v2=i},function(t){var e=uh.b2;return new c(e(t,this.v0.x,this.v1.x,this.v2.x),e(t,this.v0.y,this.v1.y,this.v2.y),e(t,this.v0.z,this.v1.z,this.v2.z))}),Rh=en.create(function(t,e){this.v1=t,this.v2=e},function(t){if(1===t)return this.v2.clone();var e=new c;return e.subVectors(this.v2,this.v1),e.multiplyScalar(t),e.add(this.v1),e});ir.prototype=Object.create(an.prototype),ir.prototype.constructor=ir;var Ph={createMultiMaterialObject:function(t,e){for(var i=new be,n=0,r=e.length;n<r;n++)i.add(new At(t,e[n]));return i},detach:function(t,e,i){t.applyMatrix(e.matrixWorld),e.remove(t),i.add(t)},attach:function(t,e,i){var n=new h;n.getInverse(i.matrixWorld),t.applyMatrix(n),e.remove(t),i.add(t)}},Ch=0,Ih=1;wr.prototype=Object.create(Th.prototype),qn.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Object.assign(Y.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign($.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),ht.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Qo.random16=function(){return console.warn("THREE.Math.random16() has been deprecated. Use Math.random() instead."),Math.random()},Object.assign(et.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(t){return console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)},applyToBuffer:function(t,e,i){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)}}),Object.assign(h.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){var t;return function(){return void 0===t&&(t=new c),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),t.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),t.applyProjection(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(t){return console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(t,e,i){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)}}),it.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},s.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(at.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(hn.prototype,{extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new We(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new ei(this,t)}}),Object.assign(c.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)}}),Et.prototype.computeTangents=function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},Object.assign(ct.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)}}),Object.defineProperties(ct.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(pe.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Ct.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(Ai.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(dt.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}}}),Object.assign(St.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addDrawCall:function(t,e,i){void 0!==i&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(St.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(An.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(J.prototype,{wrapAround:{get:function(){console.warn("THREE."+this.type+": .wrapAround has been removed.")},set:function(){console.warn("THREE."+this.type+": .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE."+this.type+": .wrapRGB has been removed."),new W}}}),Object.defineProperties(mi.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Q.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),e.prototype=Object.assign(Object.create({constructor:e,apply:function(t){console.warn("THREE.EventDispatcher: .apply is deprecated, just inherit or Object.assign the prototype to mix-in."),Object.assign(t,this)}}),e.prototype),Object.assign(ae.prototype,{supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}}),Object.defineProperties(ae.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),this.shadowMap.cullFace=t}}}),Object.defineProperties(rt.prototype,{cullFace:{get:function(){return this.renderReverseSided?Ur:Ir},set:function(t){var e=t!==Ir;console.warn("WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to "+e+"."),this.renderReverseSided=e}}}),Object.defineProperties(a.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter;
},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),xn.prototype.load=function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this,i=new fn;return i.load(t,function(t){e.setBuffer(t)}),this},bn.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()};var Uh={merge:function(t,e,i){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var n;e.isMesh&&(e.matrixAutoUpdate&&e.updateMatrix(),n=e.matrix,e=e.geometry),t.merge(e,n,i)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},Nh={crossOrigin:void 0,loadTexture:function(t,e,i,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var r=new Si;r.setCrossOrigin(this.crossOrigin);var a=r.load(t,i,void 0,n);return e&&(a.mapping=e),a},loadTextureCube:function(t,e,i,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var r=new Ti;r.setCrossOrigin(this.crossOrigin);var a=r.load(t,i,void 0,n);return e&&(a.mapping=e),a},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}};t.WebGLRenderTargetCube=o,t.WebGLRenderTarget=a,t.WebGLRenderer=ae,t.ShaderLib=oh,t.UniformsLib=ah,t.UniformsUtils=rs,t.ShaderChunk=nh,t.FogExp2=oe,t.Fog=se,t.Scene=ce,t.LensFlare=he,t.Sprite=ue,t.LOD=pe,t.SkinnedMesh=me,t.Skeleton=de,t.Bone=fe,t.Mesh=At,t.LineSegments=ye,t.Line=ve,t.Points=_e,t.Group=be,t.VideoTexture=we,t.DataTexture=X,t.CompressedTexture=Me,t.CubeTexture=l,t.CanvasTexture=Ee,t.DepthTexture=Te,t.Texture=n,t.CompressedTextureLoader=wi,t.BinaryTextureLoader=Mi,t.DataTextureLoader=gh,t.CubeTextureLoader=Ti,t.TextureLoader=Si,t.ObjectLoader=tn,t.MaterialLoader=Ji,t.BufferGeometryLoader=Qi,t.DefaultLoadingManager=mh,t.LoadingManager=_i,t.JSONLoader=$i,t.ImageLoader=Ei,t.FontLoader=dn,t.FileLoader=bi,t.Loader=Ki,t.Cache=fh,t.AudioLoader=fn,t.SpotLightShadow=Pi,t.SpotLight=Ci,t.PointLight=Ii,t.RectAreaLight=mn,t.HemisphereLight=Li,t.DirectionalLightShadow=Ui,t.DirectionalLight=Ni,t.AmbientLight=Di,t.LightShadow=Ri,t.Light=Ai,t.StereoCamera=gn,t.PerspectiveCamera=Ct,t.OrthographicCamera=It,t.CubeCamera=vn,t.Camera=Pt,t.AudioListener=yn,t.PositionalAudio=_n,t.AudioContext=wh,t.AudioAnalyser=bn,t.Audio=xn,t.VectorKeyframeTrack=Hi,t.StringKeyframeTrack=Wi,t.QuaternionKeyframeTrack=ki,t.NumberKeyframeTrack=ji,t.ColorKeyframeTrack=Yi,t.BooleanKeyframeTrack=Xi,t.PropertyMixer=wn,t.PropertyBinding=Mn,t.KeyframeTrack=qi,t.AnimationUtils=vh,t.AnimationObjectGroup=En,t.AnimationMixer=Sn,t.AnimationClip=Zi,t.Uniform=An,t.InstancedBufferGeometry=Ln,t.BufferGeometry=St,t.GeometryIdCount=Tt,t.Geometry=Et,t.InterleavedBufferAttribute=Rn,t.InstancedInterleavedBuffer=Cn,t.InterleavedBuffer=Pn,t.InstancedBufferAttribute=In,t.Face3=ut,t.Object3D=ct,t.Raycaster=Un,t.Layers=st,t.EventDispatcher=e,t.Clock=On,t.QuaternionLinearInterpolant=Vi,t.LinearInterpolant=zi,t.DiscreteInterpolant=Bi,t.CubicInterpolant=Fi,t.Interpolant=Oi,t.Triangle=lt,t.Spline=Fn,t.Math=Qo,t.Spherical=zn,t.Cylindrical=Bn,t.Plane=it,t.Frustum=nt,t.Sphere=tt,t.Ray=at,t.Matrix4=h,t.Matrix3=et,t.Box3=$,t.Box2=Y,t.Line3=ht,t.Euler=ot,t.Vector4=r,t.Vector3=c,t.Vector2=i,t.Quaternion=s,t.Color=W,t.MorphBlendMesh=Gn,t.ImmediateRenderObject=Hn,t.VertexNormalsHelper=Vn,t.SpotLightHelper=kn,t.SkeletonHelper=jn,t.PointLightHelper=Wn,t.RectAreaLightHelper=Xn,t.HemisphereLightHelper=Yn,t.GridHelper=qn,t.PolarGridHelper=Zn,t.FaceNormalsHelper=Jn,t.DirectionalLightHelper=Qn,t.CameraHelper=Kn,t.BoxHelper=$n,t.ArrowHelper=tr,t.AxisHelper=er,t.CatmullRomCurve3=Th,t.SplineCurve3=Sh,t.CubicBezierCurve3=Ah,t.QuadraticBezierCurve3=Lh,t.LineCurve3=Rh,t.ArcCurve=ir,t.EllipseCurve=an,t.SplineCurve=on,t.CubicBezierCurve=sn,t.QuadraticBezierCurve=cn,t.LineCurve=nn,t.Shape=hn,t.ShapePath=un,t.Path=ln,t.Font=pn,t.CurvePath=rn,t.Curve=en,t.ShapeUtils=uh,t.SceneUtils=Ph,t.CurveUtils=xh,t.WireframeGeometry=Se,t.ParametricGeometry=Le,t.ParametricBufferGeometry=Ae,t.TetrahedronGeometry=Ce,t.TetrahedronBufferGeometry=Pe,t.OctahedronGeometry=Ue,t.OctahedronBufferGeometry=Ie,t.IcosahedronGeometry=De,t.IcosahedronBufferGeometry=Ne,t.DodecahedronGeometry=Fe,t.DodecahedronBufferGeometry=Oe,t.PolyhedronGeometry=ze,t.PolyhedronBufferGeometry=Re,t.TubeGeometry=Ge,t.TubeBufferGeometry=Be,t.TorusKnotGeometry=Ve,t.TorusKnotBufferGeometry=He,t.TorusGeometry=je,t.TorusBufferGeometry=ke,t.TextGeometry=Xe,t.SphereBufferGeometry=Ye,t.SphereGeometry=qe,t.RingGeometry=Je,t.RingBufferGeometry=Ze,t.PlaneBufferGeometry=Rt,t.PlaneGeometry=Qe,t.LatheGeometry=$e,t.LatheBufferGeometry=Ke,t.ShapeGeometry=ei,t.ShapeBufferGeometry=ti,t.ExtrudeGeometry=We,t.EdgesGeometry=ii,t.ConeGeometry=ai,t.ConeBufferGeometry=oi,t.CylinderGeometry=ri,t.CylinderBufferGeometry=ni,t.CircleBufferGeometry=si,t.CircleGeometry=ci,t.BoxBufferGeometry=Lt,t.BoxGeometry=hi,t.ShadowMaterial=li,t.SpriteMaterial=le,t.RawShaderMaterial=ui,t.ShaderMaterial=Q,t.PointsMaterial=xe,t.MultiMaterial=pi;t.MeshPhysicalMaterial=fi;t.MeshStandardMaterial=di,t.MeshPhongMaterial=mi,t.MeshToonMaterial=gi,t.MeshNormalMaterial=vi,t.MeshLambertMaterial=yi,t.MeshDepthMaterial=K,t.MeshBasicMaterial=pt,t.LineDashedMaterial=xi,t.LineBasicMaterial=ge,t.Material=J,t.Float64BufferAttribute=wt,t.Float32BufferAttribute=bt,t.Uint32BufferAttribute=_t,t.Int32BufferAttribute=xt,t.Uint16BufferAttribute=yt,t.Int16BufferAttribute=vt,t.Uint8ClampedBufferAttribute=gt,t.Uint8BufferAttribute=mt,t.Int8BufferAttribute=ft,t.BufferAttribute=dt,t.REVISION=Rr,t.MOUSE=Pr,t.CullFaceNone=Cr,t.CullFaceBack=Ir,t.CullFaceFront=Ur,t.CullFaceFrontBack=Nr,t.FrontFaceDirectionCW=Dr,t.FrontFaceDirectionCCW=Or,t.BasicShadowMap=Fr,t.PCFShadowMap=zr,t.PCFSoftShadowMap=Br,t.FrontSide=Gr,t.BackSide=Hr,t.DoubleSide=Vr,t.FlatShading=kr,t.SmoothShading=jr,t.NoColors=Wr,t.FaceColors=Xr,t.VertexColors=Yr,t.NoBlending=qr,t.NormalBlending=Zr,t.AdditiveBlending=Jr,t.SubtractiveBlending=Qr,t.MultiplyBlending=Kr,t.CustomBlending=$r,t.BlendingMode=ta,t.AddEquation=ea,t.SubtractEquation=ia,t.ReverseSubtractEquation=na,t.MinEquation=ra,t.MaxEquation=aa,t.ZeroFactor=oa,t.OneFactor=sa,t.SrcColorFactor=ca,t.OneMinusSrcColorFactor=ha,t.SrcAlphaFactor=la,t.OneMinusSrcAlphaFactor=ua,t.DstAlphaFactor=pa,t.OneMinusDstAlphaFactor=da,t.DstColorFactor=fa,t.OneMinusDstColorFactor=ma,t.SrcAlphaSaturateFactor=ga,t.NeverDepth=va,t.AlwaysDepth=ya,t.LessDepth=xa,t.LessEqualDepth=_a,t.EqualDepth=ba,t.GreaterEqualDepth=wa,t.GreaterDepth=Ma,t.NotEqualDepth=Ea,t.MultiplyOperation=Ta,t.MixOperation=Sa,t.AddOperation=Aa,t.NoToneMapping=La,t.LinearToneMapping=Ra,t.ReinhardToneMapping=Pa,t.Uncharted2ToneMapping=Ca,t.CineonToneMapping=Ia,t.UVMapping=Ua,t.CubeReflectionMapping=Na,t.CubeRefractionMapping=Da,t.EquirectangularReflectionMapping=Oa,t.EquirectangularRefractionMapping=Fa,t.SphericalReflectionMapping=za,t.CubeUVReflectionMapping=Ba,t.CubeUVRefractionMapping=Ga,t.TextureMapping=Ha,t.RepeatWrapping=Va,t.ClampToEdgeWrapping=ka,t.MirroredRepeatWrapping=ja,t.TextureWrapping=Wa,t.NearestFilter=Xa,t.NearestMipMapNearestFilter=Ya,t.NearestMipMapLinearFilter=qa,t.LinearFilter=Za,t.LinearMipMapNearestFilter=Ja,t.LinearMipMapLinearFilter=Qa,t.TextureFilter=Ka,t.UnsignedByteType=$a,t.ByteType=to,t.ShortType=eo,t.UnsignedShortType=io,t.IntType=no,t.UnsignedIntType=ro,t.FloatType=ao,t.HalfFloatType=oo,t.UnsignedShort4444Type=so,t.UnsignedShort5551Type=co,t.UnsignedShort565Type=ho,t.UnsignedInt248Type=lo,t.AlphaFormat=uo,t.RGBFormat=po,t.RGBAFormat=fo,t.LuminanceFormat=mo,t.LuminanceAlphaFormat=go,t.RGBEFormat=vo,t.DepthFormat=yo,t.DepthStencilFormat=xo,t.RGB_S3TC_DXT1_Format=_o,t.RGBA_S3TC_DXT1_Format=bo,t.RGBA_S3TC_DXT3_Format=wo,t.RGBA_S3TC_DXT5_Format=Mo,t.RGB_PVRTC_4BPPV1_Format=Eo,t.RGB_PVRTC_2BPPV1_Format=To,t.RGBA_PVRTC_4BPPV1_Format=So,t.RGBA_PVRTC_2BPPV1_Format=Ao,t.RGB_ETC1_Format=Lo,t.LoopOnce=Ro,t.LoopRepeat=Po,t.LoopPingPong=Co,t.InterpolateDiscrete=Io,t.InterpolateLinear=Uo,t.InterpolateSmooth=No,t.ZeroCurvatureEnding=Do,t.ZeroSlopeEnding=Oo,t.WrapAroundEnding=Fo,t.TrianglesDrawMode=zo,t.TriangleStripDrawMode=Bo,t.TriangleFanDrawMode=Go,t.LinearEncoding=Ho,t.sRGBEncoding=Vo,t.GammaEncoding=ko,t.RGBEEncoding=jo,t.LogLuvEncoding=Wo,t.RGBM7Encoding=Xo,t.RGBM16Encoding=Yo,t.RGBDEncoding=qo,t.BasicDepthPacking=Zo,t.RGBADepthPacking=Jo,t.CubeGeometry=hi,t.Face4=nr,t.LineStrip=Ch,t.LinePieces=Ih,t.MeshFaceMaterial=rr,t.PointCloud=ar,t.Particle=or,t.ParticleSystem=sr,t.PointCloudMaterial=cr,t.ParticleBasicMaterial=hr,t.ParticleSystemMaterial=lr,t.Vertex=ur,t.DynamicBufferAttribute=pr,t.Int8Attribute=dr,t.Uint8Attribute=fr,t.Uint8ClampedAttribute=mr,t.Int16Attribute=gr,t.Uint16Attribute=vr,t.Int32Attribute=yr,t.Uint32Attribute=xr,t.Float32Attribute=_r,t.Float64Attribute=br,t.ClosedSplineCurve3=wr,t.BoundingBoxHelper=Mr,t.EdgesHelper=Er,t.WireframeHelper=Tr,t.XHRLoader=Sr,t.GeometryUtils=Uh,t.ImageUtils=Nh,t.Projector=Ar,t.CanvasRenderer=Lr,Object.defineProperty(t,"__esModule",{value:!0})});
},{}],215:[function(require,module,exports){
THREE.VRControls=function(t,s){function n(t){i=t,t.length>0?e=t[0]:s&&s("VR input not available.")}var e,i,o=this,a=new THREE.Matrix4,r=null;"VRFrameData"in window&&(r=new VRFrameData),navigator.getVRDisplays&&navigator.getVRDisplays().then(n).catch(function(){console.warn("THREE.VRControls: Unable to get VR Displays")}),this.scale=1,this.standing=!1,this.userHeight=1.6,this.getVRDisplay=function(){return e},this.setVRDisplay=function(t){e=t},this.getVRDisplays=function(){return console.warn("THREE.VRControls: getVRDisplays() is being deprecated."),i},this.getStandingMatrix=function(){return a},this.update=function(){if(e){var s;e.getFrameData?(e.getFrameData(r),s=r.pose):e.getPose&&(s=e.getPose()),null!==s.orientation&&t.quaternion.fromArray(s.orientation),null!==s.position?t.position.fromArray(s.position):t.position.set(0,0,0),this.standing&&(e.stageParameters?(t.updateMatrix(),a.fromArray(e.stageParameters.sittingToStandingTransform),t.applyMatrix(a)):t.position.setY(t.position.y+this.userHeight)),t.position.multiplyScalar(o.scale)}},this.resetPose=function(){e&&e.resetPose()},this.resetSensor=function(){console.warn("THREE.VRControls: .resetSensor() is now .resetPose()."),this.resetPose()},this.zeroSensor=function(){console.warn("THREE.VRControls: .zeroSensor() is now .resetPose()."),this.resetPose()},this.dispose=function(){e=null}};
},{}],216:[function(require,module,exports){
THREE.VREffect=function(e,t){function i(e){h=e,e.length>0?o=e[0]:t&&t("HMD not available")}function r(){var t=f.isPresenting;if(f.isPresenting=void 0!==o&&o.isPresenting,f.isPresenting){var i=o.getEyeParameters("left"),r=i.renderWidth,n=i.renderHeight;t||(p=e.getPixelRatio(),w=e.getSize(),e.setPixelRatio(1),e.setSize(2*r,n,!1))}else t&&(e.setPixelRatio(p),e.setSize(w.width,w.height,m))}function n(e){var t=2/(e.leftTan+e.rightTan),i=(e.leftTan-e.rightTan)*t*.5,r=2/(e.upTan+e.downTan),n=(e.upTan-e.downTan)*r*.5;return{scale:[t,r],offset:[i,n]}}function a(e,t,i,r){t=void 0===t||t,i=void 0===i?.01:i,r=void 0===r?1e4:r;var a=t?-1:1,s=new THREE.Matrix4,o=s.elements,h=n(e);return o[0]=h.scale[0],o[1]=0,o[2]=h.offset[0]*a,o[3]=0,o[4]=0,o[5]=h.scale[1],o[6]=-h.offset[1]*a,o[7]=0,o[8]=0,o[9]=0,o[10]=r/(i-r)*-a,o[11]=r*i/(i-r),o[12]=0,o[13]=0,o[14]=a,o[15]=0,s.transpose(),s}function s(e,t,i,r){var n=Math.PI/180,s={upTan:Math.tan(e.upDegrees*n),downTan:Math.tan(e.downDegrees*n),leftTan:Math.tan(e.leftDegrees*n),rightTan:Math.tan(e.rightDegrees*n)};return a(s,t,i,r)}var o,h,d,l,u=new THREE.Vector3,g=new THREE.Vector3,c=null;"VRFrameData"in window&&(c=new window.VRFrameData),navigator.getVRDisplays&&navigator.getVRDisplays().then(i).catch(function(){console.warn("THREE.VREffect: Unable to get VR Displays")}),this.isPresenting=!1,this.scale=1;var f=this,w=e.getSize(),m=!1,p=e.getPixelRatio();this.getVRDisplay=function(){return o},this.setVRDisplay=function(e){o=e},this.getVRDisplays=function(){return console.warn("THREE.VREffect: getVRDisplays() is being deprecated."),h},this.setSize=function(t,i,r){if(w={width:t,height:i},m=r,f.isPresenting){var n=o.getEyeParameters("left");e.setPixelRatio(1),e.setSize(2*n.renderWidth,n.renderHeight,!1)}else e.setPixelRatio(p),e.setSize(t,i,r)};var v=e.domElement,y=[0,0,.5,1],R=[.5,0,.5,1];window.addEventListener("vrdisplaypresentchange",r,!1),this.setFullScreen=function(e){return new Promise(function(t,i){return void 0===o?void i(new Error("No VR hardware found.")):f.isPresenting===e?void t():void t(e?o.requestPresent([{source:v}]):o.exitPresent())})},this.requestPresent=function(){return this.setFullScreen(!0)},this.exitPresent=function(){return this.setFullScreen(!1)},this.requestAnimationFrame=function(e){return void 0!==o?o.requestAnimationFrame(e):window.requestAnimationFrame(e)},this.cancelAnimationFrame=function(e){void 0!==o?o.cancelAnimationFrame(e):window.cancelAnimationFrame(e)},this.submitFrame=function(){void 0!==o&&f.isPresenting&&o.submitFrame()},this.autoSubmitFrame=!0;var x=new THREE.PerspectiveCamera;x.layers.enable(1);var E=new THREE.PerspectiveCamera;E.layers.enable(2),this.render=function(t,i,r,n){if(o&&f.isPresenting){var a=t.autoUpdate;a&&(t.updateMatrixWorld(),t.autoUpdate=!1);var h=o.getEyeParameters("left"),w=o.getEyeParameters("right");u.fromArray(h.offset),g.fromArray(w.offset),Array.isArray(t)&&(console.warn("THREE.VREffect.render() no longer supports arrays. Use object.layers instead."),t=t[0]);var m,p,v=e.getSize(),P=o.getLayers();if(P.length){var T=P[0];m=null!==T.leftBounds&&4===T.leftBounds.length?T.leftBounds:y,p=null!==T.rightBounds&&4===T.rightBounds.length?T.rightBounds:R}else m=y,p=R;d={x:Math.round(v.width*m[0]),y:Math.round(v.height*m[1]),width:Math.round(v.width*m[2]),height:Math.round(v.height*m[3])},l={x:Math.round(v.width*p[0]),y:Math.round(v.height*p[1]),width:Math.round(v.width*p[2]),height:Math.round(v.height*p[3])},r?(e.setRenderTarget(r),r.scissorTest=!0):(e.setRenderTarget(null),e.setScissorTest(!0)),(e.autoClear||n)&&e.clear(),null===i.parent&&i.updateMatrixWorld(),i.matrixWorld.decompose(x.position,x.quaternion,x.scale),i.matrixWorld.decompose(E.position,E.quaternion,E.scale);var M=this.scale;return x.translateOnAxis(u,M),E.translateOnAxis(g,M),o.getFrameData?(o.depthNear=i.near,o.depthFar=i.far,o.getFrameData(c),x.projectionMatrix.elements=c.leftProjectionMatrix,E.projectionMatrix.elements=c.rightProjectionMatrix):(x.projectionMatrix=s(h.fieldOfView,!0,i.near,i.far),E.projectionMatrix=s(w.fieldOfView,!0,i.near,i.far)),r?(r.viewport.set(d.x,d.y,d.width,d.height),r.scissor.set(d.x,d.y,d.width,d.height)):(e.setViewport(d.x,d.y,d.width,d.height),e.setScissor(d.x,d.y,d.width,d.height)),e.render(t,x,r,n),r?(r.viewport.set(l.x,l.y,l.width,l.height),r.scissor.set(l.x,l.y,l.width,l.height)):(e.setViewport(l.x,l.y,l.width,l.height),e.setScissor(l.x,l.y,l.width,l.height)),e.render(t,E,r,n),r?(r.viewport.set(0,0,v.width,v.height),r.scissor.set(0,0,v.width,v.height),r.scissorTest=!1,e.setRenderTarget(null)):(e.setViewport(0,0,v.width,v.height),e.setScissorTest(!1)),a&&(t.autoUpdate=!0),void(f.autoSubmitFrame&&f.submitFrame())}e.render(t,i,r,n)},this.dispose=function(){window.removeEventListener("vrdisplaypresentchange",r,!1)}};
},{}],217:[function(require,module,exports){
function trim(r){return r.replace(/^\s*|\s*$/g,"")}exports=module.exports=trim,exports.left=function(r){return r.replace(/^\s*/,"")},exports.right=function(r){return r.replace(/\s*$/,"")};
},{}],218:[function(require,module,exports){
function clean(n){return n.replace(/\n\r?\s*/g,"")}module.exports=function(n){for(var e="",r=0;r<arguments.length;r++)e+=clean(n[r])+(arguments[r+1]||"");return e};
},{}],219:[function(require,module,exports){
!function(e){var t=/^([^#]*)(.*)$/,r=/^([^\?]*)(.*)$/,o=/^(((?:[a-z]+:)?\/\/)?[^:\/]+(?::[0-9]+)?)?(\/?.*)$/i,n={buildAbsoluteURL:function(e,i){if(i=i.trim(),/^[a-z]+:/i.test(i))return i;var u=null,l=null,s=t.exec(i);s&&(l=s[2],i=s[1]);var a=r.exec(i);a&&(u=a[2],i=a[1]);var b=t.exec(e);b&&(e=b[1]);var c=r.exec(e);c&&(e=c[1]);var f=o.exec(e);if(!f)throw new Error("Error trying to parse base URL.");var d=f[2]||"//",p=f[1]||"",x=f[3];0!==x.indexOf("/")&&""!==p&&(x="/"+x);var v=null;return v=/^\/\//.test(i)?d+n.buildAbsolutePath("",i.substring(2)):/^\//.test(i)?p+"/"+n.buildAbsolutePath("",i.substring(1)):n.buildAbsolutePath(p+x,i),u&&(v+=u),l&&(v+=l),v},buildAbsolutePath:function(e,t){for(var r,o,n=t,i="",u=e.replace(/[^\/]*$/,n.replace(/(\/|^)(?:\.?\/+)+/g,"$1")),l=0;o=u.indexOf("/../",l),o>-1;l=o+r)r=/^\/(?:\.\.\/)*/.exec(u.slice(o))[0].length,i=(i+u.substring(l,o)).replace(new RegExp("(?:\\/+[^\\/]*){0,"+(r-1)/3+"}$"),"/");return i+u.substr(l)}};"object"==typeof exports&&"object"==typeof module?module.exports=n:"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof exports?exports.URLToolkit=n:e.URLToolkit=n}(this);
},{}],220:[function(require,module,exports){
"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}exports.__esModule=!0;var _button=require("./button.js"),_button2=_interopRequireDefault(_button),_component=require("./component.js"),_component2=_interopRequireDefault(_component),BigPlayButton=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,t.apply(this,arguments))}return _inherits(e,t),e.prototype.buildCSSClass=function(){return"vjs-big-play-button"},e.prototype.handleClick=function(t){this.player_.play()},e}(_button2.default);BigPlayButton.prototype.controlText_="Play Video",_component2.default.registerComponent("BigPlayButton",BigPlayButton),exports.default=BigPlayButton;
},{"./button.js":221,"./component.js":224}],221:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _clickableComponent=require("./clickable-component.js"),_clickableComponent2=_interopRequireDefault(_clickableComponent),_component=require("./component"),_component2=_interopRequireDefault(_component),_log=require("./utils/log.js"),_log2=_interopRequireDefault(_log),_obj=require("./utils/obj"),Button=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,e.apply(this,arguments))}return _inherits(t,e),t.prototype.createEl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"button",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t=(0,_obj.assign)({className:this.buildCSSClass()},t),"button"!==e&&(_log2.default.warn("Creating a Button with an HTML element of "+e+" is deprecated; use ClickableComponent instead."),t=(0,_obj.assign)({tabIndex:0},t),o=(0,_obj.assign)({role:"button"},o)),o=(0,_obj.assign)({type:"button","aria-live":"polite"},o);var n=_component2.default.prototype.createEl.call(this,e,t,o);return this.createControlTextEl(n),n},t.prototype.addChild=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=this.constructor.name;return _log2.default.warn("Adding an actionable (user controllable) child to a Button ("+o+") is not supported; use a ClickableComponent instead."),_component2.default.prototype.addChild.call(this,e,t)},t.prototype.enable=function(){e.prototype.enable.call(this),this.el_.removeAttribute("disabled")},t.prototype.disable=function(){e.prototype.disable.call(this),this.el_.setAttribute("disabled","disabled")},t.prototype.handleKeyPress=function(t){32!==t.which&&13!==t.which&&e.prototype.handleKeyPress.call(this,t)},t}(_clickableComponent2.default);_component2.default.registerComponent("Button",Button),exports.default=Button;
},{"./clickable-component.js":222,"./component":224,"./utils/log.js":305,"./utils/obj":307}],222:[function(require,module,exports){
"use strict";function _interopRequireWildcard(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}exports.__esModule=!0;var _component=require("./component"),_component2=_interopRequireDefault(_component),_dom=require("./utils/dom.js"),Dom=_interopRequireWildcard(_dom),_events=require("./utils/events.js"),Events=_interopRequireWildcard(_events),_fn=require("./utils/fn.js"),Fn=_interopRequireWildcard(_fn),_log=require("./utils/log.js"),_log2=_interopRequireDefault(_log),_document=require("global/document"),_document2=_interopRequireDefault(_document),_obj=require("./utils/obj"),ClickableComponent=function(t){function e(n,o){_classCallCheck(this,e);var i=_possibleConstructorReturn(this,t.call(this,n,o));return i.emitTapEvents(),i.enable(),i}return _inherits(e,t),e.prototype.createEl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n=(0,_obj.assign)({className:this.buildCSSClass(),tabIndex:0},n),"button"===e&&_log2.default.error("Creating a ClickableComponent with an HTML element of "+e+" is not supported; use a Button instead."),o=(0,_obj.assign)({role:"button","aria-live":"polite"},o),this.tabIndex_=n.tabIndex;var i=t.prototype.createEl.call(this,e,n,o);return this.createControlTextEl(i),i},e.prototype.createControlTextEl=function(t){return this.controlTextEl_=Dom.createEl("span",{className:"vjs-control-text"}),t&&t.appendChild(this.controlTextEl_),this.controlText(this.controlText_,t),this.controlTextEl_},e.prototype.controlText=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.el();if(!t)return this.controlText_||"Need Text";var n=this.localize(t);return this.controlText_=t,this.controlTextEl_.innerHTML=n,e.setAttribute("title",n),this},e.prototype.buildCSSClass=function(){return"vjs-control vjs-button "+t.prototype.buildCSSClass.call(this)},e.prototype.enable=function(){return this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),"undefined"!=typeof this.tabIndex_&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on("tap",this.handleClick),this.on("click",this.handleClick),this.on("focus",this.handleFocus),this.on("blur",this.handleBlur),this},e.prototype.disable=function(){return this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),"undefined"!=typeof this.tabIndex_&&this.el_.removeAttribute("tabIndex"),this.off("tap",this.handleClick),this.off("click",this.handleClick),this.off("focus",this.handleFocus),this.off("blur",this.handleBlur),this},e.prototype.handleClick=function(t){},e.prototype.handleFocus=function(t){Events.on(_document2.default,"keydown",Fn.bind(this,this.handleKeyPress))},e.prototype.handleKeyPress=function(e){32===e.which||13===e.which?(e.preventDefault(),this.handleClick(e)):t.prototype.handleKeyPress&&t.prototype.handleKeyPress.call(this,e)},e.prototype.handleBlur=function(t){Events.off(_document2.default,"keydown",Fn.bind(this,this.handleKeyPress))},e}(_component2.default);_component2.default.registerComponent("ClickableComponent",ClickableComponent),exports.default=ClickableComponent;
},{"./component":224,"./utils/dom.js":300,"./utils/events.js":301,"./utils/fn.js":302,"./utils/log.js":305,"./utils/obj":307,"global/document":193}],223:[function(require,module,exports){
"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}exports.__esModule=!0;var _button=require("./button"),_button2=_interopRequireDefault(_button),_component=require("./component"),_component2=_interopRequireDefault(_component),CloseButton=function(t){function e(o,n){_classCallCheck(this,e);var r=_possibleConstructorReturn(this,t.call(this,o,n));return r.controlText(n&&n.controlText||r.localize("Close")),r}return _inherits(e,t),e.prototype.buildCSSClass=function(){return"vjs-close-button "+t.prototype.buildCSSClass.call(this)},e.prototype.handleClick=function(t){this.trigger({type:"close",bubbles:!1})},e}(_button2.default);_component2.default.registerComponent("CloseButton",CloseButton),exports.default=CloseButton;
},{"./button":221,"./component":224}],224:[function(require,module,exports){
"use strict";function _interopRequireWildcard(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _window=require("global/window"),_window2=_interopRequireDefault(_window),_dom=require("./utils/dom.js"),Dom=_interopRequireWildcard(_dom),_fn=require("./utils/fn.js"),Fn=_interopRequireWildcard(_fn),_guid=require("./utils/guid.js"),Guid=_interopRequireWildcard(_guid),_events=require("./utils/events.js"),Events=_interopRequireWildcard(_events),_log=require("./utils/log.js"),_log2=_interopRequireDefault(_log),_toTitleCase=require("./utils/to-title-case.js"),_toTitleCase2=_interopRequireDefault(_toTitleCase),_mergeOptions=require("./utils/merge-options.js"),_mergeOptions2=_interopRequireDefault(_mergeOptions),Component=function(){function t(e,i,n){if(_classCallCheck(this,t),!e&&this.play?this.player_=e=this:this.player_=e,this.options_=(0,_mergeOptions2.default)({},this.options_),i=this.options_=(0,_mergeOptions2.default)(this.options_,i),this.id_=i.id||i.el&&i.el.id,!this.id_){var o=e&&e.id&&e.id()||"no_player";this.id_=o+"_component_"+Guid.newGUID()}this.name_=i.name||null,i.el?this.el_=i.el:i.createEl!==!1&&(this.el_=this.createEl()),this.children_=[],this.childIndex_={},this.childNameIndex_={},i.initChildren!==!1&&this.initChildren(),this.ready(n),i.reportTouchActivity!==!1&&this.enableTouchActivity()}return t.prototype.dispose=function(){if(this.trigger({type:"dispose",bubbles:!1}),this.children_)for(var t=this.children_.length-1;t>=0;t--)this.children_[t].dispose&&this.children_[t].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.off(),this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),Dom.removeElData(this.el_),this.el_=null},t.prototype.player=function(){return this.player_},t.prototype.options=function(t){return _log2.default.warn("this.options() has been deprecated and will be moved to the constructor in 6.0"),t?(this.options_=(0,_mergeOptions2.default)(this.options_,t),this.options_):this.options_},t.prototype.el=function(){return this.el_},t.prototype.createEl=function(t,e,i){return Dom.createEl(t,e,i)},t.prototype.localize=function(t){var e=this.player_.language&&this.player_.language(),i=this.player_.languages&&this.player_.languages();if(!e||!i)return t;var n=i[e];if(n&&n[t])return n[t];var o=e.split("-")[0],r=i[o];return r&&r[t]?r[t]:t},t.prototype.contentEl=function(){return this.contentEl_||this.el_},t.prototype.id=function(){return this.id_},t.prototype.name=function(){return this.name_},t.prototype.children=function(){return this.children_},t.prototype.getChildById=function(t){return this.childIndex_[t]},t.prototype.getChild=function(t){if(t)return t=(0,_toTitleCase2.default)(t),this.childNameIndex_[t]},t.prototype.addChild=function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.children_.length,o=void 0,r=void 0;if("string"==typeof e){r=(0,_toTitleCase2.default)(e),i||(i={}),i===!0&&(_log2.default.warn("Initializing a child component with `true` is deprecated.Children should be defined in an array when possible, but if necessary use an object instead of `true`."),i={});var s=i.componentClass||r;i.name=r;var l=t.getComponent(s);if(!l)throw new Error("Component "+s+" does not exist");if("function"!=typeof l)return null;o=new l(this.player_||this,i)}else o=e;if(this.children_.splice(n,0,o),"function"==typeof o.id&&(this.childIndex_[o.id()]=o),r=r||o.name&&o.name(),r&&(this.childNameIndex_[r]=o),"function"==typeof o.el&&o.el()){var u=this.contentEl().children,a=u[n]||null;this.contentEl().insertBefore(o.el(),a)}return o},t.prototype.removeChild=function(t){if("string"==typeof t&&(t=this.getChild(t)),t&&this.children_){for(var e=!1,i=this.children_.length-1;i>=0;i--)if(this.children_[i]===t){e=!0,this.children_.splice(i,1);break}if(e){this.childIndex_[t.id()]=null,this.childNameIndex_[t.name()]=null;var n=t.el();n&&n.parentNode===this.contentEl()&&this.contentEl().removeChild(t.el())}}},t.prototype.initChildren=function(){var e=this,i=this.options_.children;i&&!function(){var n=e.options_,o=function(t){var i=t.name,o=t.opts;if(void 0!==n[i]&&(o=n[i]),o!==!1){o===!0&&(o={}),o.playerOptions=e.options_.playerOptions;var r=e.addChild(i,o);r&&(e[i]=r)}},r=void 0,s=t.getComponent("Tech");r=Array.isArray(i)?i:Object.keys(i),r.concat(Object.keys(e.options_).filter(function(t){return!r.some(function(e){return"string"==typeof e?t===e:t===e.name})})).map(function(t){var n=void 0,o=void 0;return"string"==typeof t?(n=t,o=i[n]||e.options_[n]||{}):(n=t.name,o=t),{name:n,opts:o}}).filter(function(e){var i=t.getComponent(e.opts.componentClass||(0,_toTitleCase2.default)(e.name));return i&&!s.isTech(i)}).forEach(o)}()},t.prototype.buildCSSClass=function(){return""},t.prototype.on=function(t,e,i){var n=this;return"string"==typeof t||Array.isArray(t)?Events.on(this.el_,t,Fn.bind(this,e)):!function(){var o=t,r=e,s=Fn.bind(n,i),l=function(){return n.off(o,r,s)};l.guid=s.guid,n.on("dispose",l);var u=function(){return n.off("dispose",l)};u.guid=s.guid,t.nodeName?(Events.on(o,r,s),Events.on(o,"dispose",u)):"function"==typeof t.on&&(o.on(r,s),o.on("dispose",u))}(),this},t.prototype.off=function(t,e,i){if(!t||"string"==typeof t||Array.isArray(t))Events.off(this.el_,t,e);else{var n=t,o=e,r=Fn.bind(this,i);this.off("dispose",r),t.nodeName?(Events.off(n,o,r),Events.off(n,"dispose",r)):(n.off(o,r),n.off("dispose",r))}return this},t.prototype.one=function(t,e,i){var n=this,o=arguments;return"string"==typeof t||Array.isArray(t)?Events.one(this.el_,t,Fn.bind(this,e)):!function(){var r=t,s=e,l=Fn.bind(n,i),u=function t(){n.off(r,s,t),l.apply(null,o)};u.guid=l.guid,n.on(r,s,u)}(),this},t.prototype.trigger=function(t,e){return Events.trigger(this.el_,t,e),this},t.prototype.ready=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t&&(this.isReady_?e?t.call(this):this.setTimeout(t,1):(this.readyQueue_=this.readyQueue_||[],this.readyQueue_.push(t))),this},t.prototype.triggerReady=function(){this.isReady_=!0,this.setTimeout(function(){var t=this.readyQueue_;this.readyQueue_=[],t&&t.length>0&&t.forEach(function(t){t.call(this)},this),this.trigger("ready")},1)},t.prototype.$=function(t,e){return Dom.$(t,e||this.contentEl())},t.prototype.$$=function(t,e){return Dom.$$(t,e||this.contentEl())},t.prototype.hasClass=function(t){return Dom.hasElClass(this.el_,t)},t.prototype.addClass=function(t){return Dom.addElClass(this.el_,t),this},t.prototype.removeClass=function(t){return Dom.removeElClass(this.el_,t),this},t.prototype.toggleClass=function(t,e){return Dom.toggleElClass(this.el_,t,e),this},t.prototype.show=function(){return this.removeClass("vjs-hidden"),this},t.prototype.hide=function(){return this.addClass("vjs-hidden"),this},t.prototype.lockShowing=function(){return this.addClass("vjs-lock-showing"),this},t.prototype.unlockShowing=function(){return this.removeClass("vjs-lock-showing"),this},t.prototype.getAttribute=function(t){return Dom.getAttribute(this.el_,t)},t.prototype.setAttribute=function(t,e){return Dom.setAttribute(this.el_,t,e),this},t.prototype.removeAttribute=function(t){return Dom.removeAttribute(this.el_,t),this},t.prototype.width=function(t,e){return this.dimension("width",t,e)},t.prototype.height=function(t,e){return this.dimension("height",t,e)},t.prototype.dimensions=function(t,e){return this.width(t,!0).height(e)},t.prototype.dimension=function(t,e,i){if(void 0!==e)return null!==e&&e===e||(e=0),(""+e).indexOf("%")!==-1||(""+e).indexOf("px")!==-1?this.el_.style[t]=e:"auto"===e?this.el_.style[t]="":this.el_.style[t]=e+"px",i||this.trigger("resize"),this;if(!this.el_)return 0;var n=this.el_.style[t],o=n.indexOf("px");return o!==-1?parseInt(n.slice(0,o),10):parseInt(this.el_["offset"+(0,_toTitleCase2.default)(t)],10)},t.prototype.currentDimension=function(t){var e=0;if("width"!==t&&"height"!==t)throw new Error("currentDimension only accepts width or height value");if("function"==typeof _window2.default.getComputedStyle){var i=_window2.default.getComputedStyle(this.el_);e=i.getPropertyValue(t)||i[t]}if(e=parseFloat(e),0===e){var n="offset"+(0,_toTitleCase2.default)(t);e=this.el_[n]}return e},t.prototype.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},t.prototype.currentWidth=function(){return this.currentDimension("width")},t.prototype.currentHeight=function(){return this.currentDimension("height")},t.prototype.emitTapEvents=function(){var t=0,e=null,i=10,n=200,o=void 0;this.on("touchstart",function(i){1===i.touches.length&&(e={pageX:i.touches[0].pageX,pageY:i.touches[0].pageY},t=(new Date).getTime(),o=!0)}),this.on("touchmove",function(t){if(t.touches.length>1)o=!1;else if(e){var n=t.touches[0].pageX-e.pageX,r=t.touches[0].pageY-e.pageY,s=Math.sqrt(n*n+r*r);s>i&&(o=!1)}});var r=function(){o=!1};this.on("touchleave",r),this.on("touchcancel",r),this.on("touchend",function(i){if(e=null,o===!0){var r=(new Date).getTime()-t;r<n&&(i.preventDefault(),this.trigger("tap"))}})},t.prototype.enableTouchActivity=function(){if(this.player()&&this.player().reportUserActivity){var t=Fn.bind(this.player(),this.player().reportUserActivity),e=void 0;this.on("touchstart",function(){t(),this.clearInterval(e),e=this.setInterval(t,250)});var i=function(i){t(),this.clearInterval(e)};this.on("touchmove",t),this.on("touchend",i),this.on("touchcancel",i)}},t.prototype.setTimeout=function(t,e){t=Fn.bind(this,t);var i=_window2.default.setTimeout(t,e),n=function(){this.clearTimeout(i)};return n.guid="vjs-timeout-"+i,this.on("dispose",n),i},t.prototype.clearTimeout=function(t){_window2.default.clearTimeout(t);var e=function(){};return e.guid="vjs-timeout-"+t,this.off("dispose",e),t},t.prototype.setInterval=function(t,e){t=Fn.bind(this,t);var i=_window2.default.setInterval(t,e),n=function(){this.clearInterval(i)};return n.guid="vjs-interval-"+i,this.on("dispose",n),i},t.prototype.clearInterval=function(t){_window2.default.clearInterval(t);var e=function(){};return e.guid="vjs-interval-"+t,this.off("dispose",e),t},t.registerComponent=function(e,i){if(e)return e=(0,_toTitleCase2.default)(e),t.components_||(t.components_={}),"Player"===e&&t.components_[e]&&!function(){var i=t.components_[e];if(i.players&&Object.keys(i.players).length>0&&Object.keys(i.players).map(function(t){return i.players[t]}).every(Boolean))throw new Error("Can not register Player component after player has been created")}(),t.components_[e]=i,i},t.getComponent=function(e){if(e)return e=(0,_toTitleCase2.default)(e),t.components_&&t.components_[e]?t.components_[e]:_window2.default&&_window2.default.videojs&&_window2.default.videojs[e]?(_log2.default.warn("The "+e+" component was added to the videojs object when it should be registered using videojs.registerComponent(name, component)"),_window2.default.videojs[e]):void 0},t.extend=function(e){e=e||{},_log2.default.warn("Component.extend({}) has been deprecated,  use videojs.extend(Component, {}) instead");var i=e.init||e.init||this.prototype.init||this.prototype.init||function(){},n=function(){i.apply(this,arguments)};n.prototype=Object.create(this.prototype),n.prototype.constructor=n,n.extend=t.extend;for(var o in e)e.hasOwnProperty(o)&&(n.prototype[o]=e[o]);return n},t}();Component.registerComponent("Component",Component),exports.default=Component;
},{"./utils/dom.js":300,"./utils/events.js":301,"./utils/fn.js":302,"./utils/guid.js":304,"./utils/log.js":305,"./utils/merge-options.js":306,"./utils/to-title-case.js":310,"global/window":194}],225:[function(require,module,exports){
"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}exports.__esModule=!0;var _trackButton=require("../track-button.js"),_trackButton2=_interopRequireDefault(_trackButton),_component=require("../../component.js"),_component2=_interopRequireDefault(_component),_audioTrackMenuItem=require("./audio-track-menu-item.js"),_audioTrackMenuItem2=_interopRequireDefault(_audioTrackMenuItem),AudioTrackButton=function(t){function e(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,e),o.tracks=r.audioTracks&&r.audioTracks();var n=_possibleConstructorReturn(this,t.call(this,r,o));return n.el_.setAttribute("aria-label","Audio Menu"),n}return _inherits(e,t),e.prototype.buildCSSClass=function(){return"vjs-audio-button "+t.prototype.buildCSSClass.call(this)},e.prototype.createItems=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=this.player_.audioTracks&&this.player_.audioTracks();if(!e)return t;for(var r=0;r<e.length;r++){var o=e[r];t.push(new _audioTrackMenuItem2.default(this.player_,{track:o,selectable:!0}))}return t},e}(_trackButton2.default);AudioTrackButton.prototype.controlText_="Audio Track",_component2.default.registerComponent("AudioTrackButton",AudioTrackButton),exports.default=AudioTrackButton;
},{"../../component.js":224,"../track-button.js":255,"./audio-track-menu-item.js":226}],226:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _menuItem=require("../../menu/menu-item.js"),_menuItem2=_interopRequireDefault(_menuItem),_component=require("../../component.js"),_component2=_interopRequireDefault(_component),_fn=require("../../utils/fn.js"),Fn=_interopRequireWildcard(_fn),AudioTrackMenuItem=function(e){function t(n,r){_classCallCheck(this,t);var o=r.track,i=n.audioTracks();r.label=o.label||o.language||"Unknown",r.selected=o.enabled;var a=_possibleConstructorReturn(this,e.call(this,n,r));return a.track=o,i&&!function(){var e=Fn.bind(a,a.handleTracksChange);i.addEventListener("change",e),a.on("dispose",function(){i.removeEventListener("change",e)})}(),a}return _inherits(t,e),t.prototype.handleClick=function(t){var n=this.player_.audioTracks();if(e.prototype.handleClick.call(this,t),n)for(var r=0;r<n.length;r++){var o=n[r];o.enabled=o===this.track}},t.prototype.handleTracksChange=function(e){this.selected(this.track.enabled)},t}(_menuItem2.default);_component2.default.registerComponent("AudioTrackMenuItem",AudioTrackMenuItem),exports.default=AudioTrackMenuItem;
},{"../../component.js":224,"../../menu/menu-item.js":267,"../../utils/fn.js":302}],227:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _component=require("../component.js"),_component2=_interopRequireDefault(_component);require("./play-toggle.js"),require("./time-controls/current-time-display.js"),require("./time-controls/duration-display.js"),require("./time-controls/time-divider.js"),require("./time-controls/remaining-time-display.js"),require("./live-display.js"),require("./progress-control/progress-control.js"),require("./fullscreen-toggle.js"),require("./volume-control/volume-control.js"),require("./volume-menu-button.js"),require("./mute-toggle.js"),require("./text-track-controls/chapters-button.js"),require("./text-track-controls/descriptions-button.js"),require("./text-track-controls/subtitles-button.js"),require("./text-track-controls/captions-button.js"),require("./audio-track-controls/audio-track-button.js"),require("./playback-rate-menu/playback-rate-menu-button.js"),require("./spacer-controls/custom-control-spacer.js");var ControlBar=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,e.apply(this,arguments))}return _inherits(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"},{role:"group"})},t}(_component2.default);ControlBar.prototype.options_={children:["playToggle","volumeMenuButton","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subtitlesButton","captionsButton","audioTrackButton","fullscreenToggle"]},_component2.default.registerComponent("ControlBar",ControlBar),exports.default=ControlBar;
},{"../component.js":224,"./audio-track-controls/audio-track-button.js":225,"./fullscreen-toggle.js":228,"./live-display.js":229,"./mute-toggle.js":230,"./play-toggle.js":231,"./playback-rate-menu/playback-rate-menu-button.js":232,"./progress-control/progress-control.js":237,"./spacer-controls/custom-control-spacer.js":240,"./text-track-controls/captions-button.js":243,"./text-track-controls/chapters-button.js":244,"./text-track-controls/descriptions-button.js":246,"./text-track-controls/subtitles-button.js":248,"./time-controls/current-time-display.js":251,"./time-controls/duration-display.js":252,"./time-controls/remaining-time-display.js":253,"./time-controls/time-divider.js":254,"./volume-control/volume-control.js":257,"./volume-menu-button.js":259}],228:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _button=require("../button.js"),_button2=_interopRequireDefault(_button),_component=require("../component.js"),_component2=_interopRequireDefault(_component),FullscreenToggle=function(e){function t(n,o){_classCallCheck(this,t);var r=_possibleConstructorReturn(this,e.call(this,n,o));return r.on(n,"fullscreenchange",r.handleFullscreenChange),r}return _inherits(t,e),t.prototype.buildCSSClass=function(){return"vjs-fullscreen-control "+e.prototype.buildCSSClass.call(this)},t.prototype.handleFullscreenChange=function(e){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},t.prototype.handleClick=function(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},t}(_button2.default);FullscreenToggle.prototype.controlText_="Fullscreen",_component2.default.registerComponent("FullscreenToggle",FullscreenToggle),exports.default=FullscreenToggle;
},{"../button.js":221,"../component.js":224}],229:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _component=require("../component"),_component2=_interopRequireDefault(_component),_dom=require("../utils/dom.js"),Dom=_interopRequireWildcard(_dom),LiveDisplay=function(e){function t(o,n){_classCallCheck(this,t);var r=_possibleConstructorReturn(this,e.call(this,o,n));return r.updateShowing(),r.on(r.player(),"durationchange",r.updateShowing),r}return _inherits(t,e),t.prototype.createEl=function(){var t=e.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=Dom.createEl("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+"</span>"+this.localize("LIVE")},{"aria-live":"off"}),t.appendChild(this.contentEl_),t},t.prototype.updateShowing=function(e){this.player().duration()===1/0?this.show():this.hide()},t}(_component2.default);_component2.default.registerComponent("LiveDisplay",LiveDisplay),exports.default=LiveDisplay;
},{"../component":224,"../utils/dom.js":300}],230:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _button=require("../button"),_button2=_interopRequireDefault(_button),_component=require("../component"),_component2=_interopRequireDefault(_component),_dom=require("../utils/dom.js"),Dom=_interopRequireWildcard(_dom),MuteToggle=function(e){function t(o,r){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,e.call(this,o,r));return n.on(o,"volumechange",n.update),o.tech_&&o.tech_.featuresVolumeControl===!1&&n.addClass("vjs-hidden"),n.on(o,"loadstart",function(){this.update(),o.tech_.featuresVolumeControl===!1?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")}),n}return _inherits(t,e),t.prototype.buildCSSClass=function(){return"vjs-mute-control "+e.prototype.buildCSSClass.call(this)},t.prototype.handleClick=function(e){this.player_.muted(!this.player_.muted())},t.prototype.update=function(e){var t=this.player_.volume(),o=3;0===t||this.player_.muted()?o=0:t<.33?o=1:t<.67&&(o=2);var r=this.player_.muted()?"Unmute":"Mute";this.controlText()!==r&&this.controlText(r);for(var n=0;n<4;n++)Dom.removeElClass(this.el_,"vjs-vol-"+n);Dom.addElClass(this.el_,"vjs-vol-"+o)},t}(_button2.default);MuteToggle.prototype.controlText_="Mute",_component2.default.registerComponent("MuteToggle",MuteToggle),exports.default=MuteToggle;
},{"../button":221,"../component":224,"../utils/dom.js":300}],231:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _button=require("../button.js"),_button2=_interopRequireDefault(_button),_component=require("../component.js"),_component2=_interopRequireDefault(_component),PlayToggle=function(e){function t(o,n){_classCallCheck(this,t);var r=_possibleConstructorReturn(this,e.call(this,o,n));return r.on(o,"play",r.handlePlay),r.on(o,"pause",r.handlePause),r}return _inherits(t,e),t.prototype.buildCSSClass=function(){return"vjs-play-control "+e.prototype.buildCSSClass.call(this)},t.prototype.handleClick=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},t.prototype.handlePlay=function(e){this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},t.prototype.handlePause=function(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},t}(_button2.default);PlayToggle.prototype.controlText_="Play",_component2.default.registerComponent("PlayToggle",PlayToggle),exports.default=PlayToggle;
},{"../button.js":221,"../component.js":224}],232:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _menuButton=require("../../menu/menu-button.js"),_menuButton2=_interopRequireDefault(_menuButton),_menu=require("../../menu/menu.js"),_menu2=_interopRequireDefault(_menu),_playbackRateMenuItem=require("./playback-rate-menu-item.js"),_playbackRateMenuItem2=_interopRequireDefault(_playbackRateMenuItem),_component=require("../../component.js"),_component2=_interopRequireDefault(_component),_dom=require("../../utils/dom.js"),Dom=_interopRequireWildcard(_dom),PlaybackRateMenuButton=function(e){function t(a,n){_classCallCheck(this,t);var r=_possibleConstructorReturn(this,e.call(this,a,n));return r.updateVisibility(),r.updateLabel(),r.on(a,"loadstart",r.updateVisibility),r.on(a,"ratechange",r.updateLabel),r}return _inherits(t,e),t.prototype.createEl=function(){var t=e.prototype.createEl.call(this);return this.labelEl_=Dom.createEl("div",{className:"vjs-playback-rate-value",innerHTML:1}),t.appendChild(this.labelEl_),t},t.prototype.buildCSSClass=function(){return"vjs-playback-rate "+e.prototype.buildCSSClass.call(this)},t.prototype.createMenu=function(){var e=new _menu2.default(this.player()),t=this.playbackRates();if(t)for(var a=t.length-1;a>=0;a--)e.addChild(new _playbackRateMenuItem2.default(this.player(),{rate:t[a]+"x"}));return e},t.prototype.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},t.prototype.handleClick=function(e){for(var t=this.player().playbackRate(),a=this.playbackRates(),n=a[0],r=0;r<a.length;r++)if(a[r]>t){n=a[r];break}this.player().playbackRate(n)},t.prototype.playbackRates=function(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates},t.prototype.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0},t.prototype.updateVisibility=function(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},t.prototype.updateLabel=function(e){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},t}(_menuButton2.default);PlaybackRateMenuButton.prototype.controlText_="Playback Rate",_component2.default.registerComponent("PlaybackRateMenuButton",PlaybackRateMenuButton),exports.default=PlaybackRateMenuButton;
},{"../../component.js":224,"../../menu/menu-button.js":266,"../../menu/menu.js":268,"../../utils/dom.js":300,"./playback-rate-menu-item.js":233}],233:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _menuItem=require("../../menu/menu-item.js"),_menuItem2=_interopRequireDefault(_menuItem),_component=require("../../component.js"),_component2=_interopRequireDefault(_component),PlaybackRateMenuItem=function(e){function t(n,o){_classCallCheck(this,t);var r=o.rate,a=parseFloat(r,10);o.label=r,o.selected=1===a;var u=_possibleConstructorReturn(this,e.call(this,n,o));return u.label=r,u.rate=a,u.on(n,"ratechange",u.update),u}return _inherits(t,e),t.prototype.handleClick=function(t){e.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},t.prototype.update=function(e){this.selected(this.player().playbackRate()===this.rate)},t}(_menuItem2.default);PlaybackRateMenuItem.prototype.contentElType="button",_component2.default.registerComponent("PlaybackRateMenuItem",PlaybackRateMenuItem),exports.default=PlaybackRateMenuItem;
},{"../../component.js":224,"../../menu/menu-item.js":267}],234:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _component=require("../../component.js"),_component2=_interopRequireDefault(_component),_dom=require("../../utils/dom.js"),Dom=_interopRequireWildcard(_dom),LoadProgressBar=function(e){function t(r,o){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,e.call(this,r,o));return n.partEls_=[],n.on(r,"progress",n.update),n}return _inherits(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Loaded")+"</span>: 0%</span>"})},t.prototype.update=function(e){var t=this.player_.buffered(),r=this.player_.duration(),o=this.player_.bufferedEnd(),n=this.partEls_,s=function(e,t){var r=e/t||0;return 100*(r>=1?1:r)+"%"};this.el_.style.width=s(o,r);for(var a=0;a<t.length;a++){var i=t.start(a),l=t.end(a),u=n[a];u||(u=this.el_.appendChild(Dom.createEl()),n[a]=u),u.style.left=s(i,o),u.style.width=s(l-i,o)}for(var p=n.length;p>t.length;p--)this.el_.removeChild(n[p-1]);n.length=t.length},t}(_component2.default);_component2.default.registerComponent("LoadProgressBar",LoadProgressBar),exports.default=LoadProgressBar;
},{"../../component.js":224,"../../utils/dom.js":300}],235:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _component=require("../../component.js"),_component2=_interopRequireDefault(_component),_dom=require("../../utils/dom.js"),Dom=_interopRequireWildcard(_dom),_fn=require("../../utils/fn.js"),Fn=_interopRequireWildcard(_fn),_formatTime=require("../../utils/format-time.js"),_formatTime2=_interopRequireDefault(_formatTime),_computedStyle=require("../../utils/computed-style.js"),_computedStyle2=_interopRequireDefault(_computedStyle),MouseTimeDisplay=function(e){function t(o,r){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,e.call(this,o,r));return r.playerOptions&&r.playerOptions.controlBar&&r.playerOptions.controlBar.progressControl&&r.playerOptions.controlBar.progressControl.keepTooltipsInside&&(i.keepTooltipsInside=r.playerOptions.controlBar.progressControl.keepTooltipsInside),i.keepTooltipsInside&&(i.tooltip=Dom.createEl("div",{className:"vjs-time-tooltip"}),i.el().appendChild(i.tooltip),i.addClass("vjs-keep-tooltips-inside")),i.update(0,0),o.on("ready",function(){i.on(o.controlBar.progressControl.el(),"mousemove",Fn.throttle(Fn.bind(i,i.handleMouseMove),25))}),i}return _inherits(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},t.prototype.handleMouseMove=function(e){var t=this.player_.duration(),o=this.calculateDistance(e)*t,r=e.pageX-Dom.findElPosition(this.el().parentNode).left;this.update(o,r)},t.prototype.update=function(e,t){var o=(0,_formatTime2.default)(e,this.player_.duration());if(this.el().style.left=t+"px",this.el().setAttribute("data-current-time",o),this.keepTooltipsInside){var r=this.clampPosition_(t),i=t-r+1,n=parseFloat((0,_computedStyle2.default)(this.tooltip,"width")),l=n/2;this.tooltip.innerHTML=o,this.tooltip.style.right="-"+(l-i)+"px"}},t.prototype.calculateDistance=function(e){return Dom.getPointerPosition(this.el().parentNode,e).x},t.prototype.clampPosition_=function(e){if(!this.keepTooltipsInside)return e;var t=parseFloat((0,_computedStyle2.default)(this.player().el(),"width")),o=parseFloat((0,_computedStyle2.default)(this.tooltip,"width")),r=o/2,i=e;return e<r?i=Math.ceil(r):e>t-r&&(i=Math.floor(t-r)),i},t}(_component2.default);_component2.default.registerComponent("MouseTimeDisplay",MouseTimeDisplay),exports.default=MouseTimeDisplay;
},{"../../component.js":224,"../../utils/computed-style.js":299,"../../utils/dom.js":300,"../../utils/fn.js":302,"../../utils/format-time.js":303}],236:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _component=require("../../component.js"),_component2=_interopRequireDefault(_component),_fn=require("../../utils/fn.js"),Fn=_interopRequireWildcard(_fn),_formatTime=require("../../utils/format-time.js"),_formatTime2=_interopRequireDefault(_formatTime),PlayProgressBar=function(e){function t(r,o){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,e.call(this,r,o));return n.updateDataAttr(),n.on(r,"timeupdate",n.updateDataAttr),r.ready(Fn.bind(n,n.updateDataAttr)),o.playerOptions&&o.playerOptions.controlBar&&o.playerOptions.controlBar.progressControl&&o.playerOptions.controlBar.progressControl.keepTooltipsInside&&(n.keepTooltipsInside=o.playerOptions.controlBar.progressControl.keepTooltipsInside),n.keepTooltipsInside&&n.addClass("vjs-keep-tooltips-inside"),n}return _inherits(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Progress")+"</span>: 0%</span>"})},t.prototype.updateDataAttr=function(e){var t=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.el_.setAttribute("data-current-time",(0,_formatTime2.default)(t,this.player_.duration()))},t}(_component2.default);_component2.default.registerComponent("PlayProgressBar",PlayProgressBar),exports.default=PlayProgressBar;
},{"../../component.js":224,"../../utils/fn.js":302,"../../utils/format-time.js":303}],237:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _component=require("../../component.js"),_component2=_interopRequireDefault(_component);require("./seek-bar.js"),require("./mouse-time-display.js");var ProgressControl=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,e.apply(this,arguments))}return _inherits(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},t}(_component2.default);ProgressControl.prototype.options_={children:["seekBar"]},_component2.default.registerComponent("ProgressControl",ProgressControl),exports.default=ProgressControl;
},{"../../component.js":224,"./mouse-time-display.js":235,"./seek-bar.js":238}],238:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _slider=require("../../slider/slider.js"),_slider2=_interopRequireDefault(_slider),_component=require("../../component.js"),_component2=_interopRequireDefault(_component),_fn=require("../../utils/fn.js"),Fn=_interopRequireWildcard(_fn),_formatTime=require("../../utils/format-time.js"),_formatTime2=_interopRequireDefault(_formatTime),_computedStyle=require("../../utils/computed-style.js"),_computedStyle2=_interopRequireDefault(_computedStyle);require("./load-progress-bar.js"),require("./play-progress-bar.js"),require("./tooltip-progress-bar.js");var SeekBar=function(e){function t(r,o){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,e.call(this,r,o));return i.on(r,"timeupdate",i.updateProgress),i.on(r,"ended",i.updateProgress),r.ready(Fn.bind(i,i.updateProgress)),o.playerOptions&&o.playerOptions.controlBar&&o.playerOptions.controlBar.progressControl&&o.playerOptions.controlBar.progressControl.keepTooltipsInside&&(i.keepTooltipsInside=o.playerOptions.controlBar.progressControl.keepTooltipsInside),i.keepTooltipsInside&&(i.tooltipProgressBar=i.addChild("TooltipProgressBar")),i}return _inherits(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":"progress bar"})},t.prototype.updateProgress=function(e){if(this.updateAriaAttributes(this.el_),this.keepTooltipsInside){this.updateAriaAttributes(this.tooltipProgressBar.el_),this.tooltipProgressBar.el_.style.width=this.bar.el_.style.width;var t=parseFloat((0,_computedStyle2.default)(this.player().el(),"width")),r=parseFloat((0,_computedStyle2.default)(this.tooltipProgressBar.tooltip,"width")),o=this.tooltipProgressBar.el().style;o.maxWidth=Math.floor(t-r/2)+"px",o.minWidth=Math.ceil(r/2)+"px",o.right="-"+r/2+"px"}},t.prototype.updateAriaAttributes=function(e){var t=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();e.setAttribute("aria-valuenow",(100*this.getPercent()).toFixed(2)),e.setAttribute("aria-valuetext",(0,_formatTime2.default)(t,this.player_.duration()))},t.prototype.getPercent=function(){var e=this.player_.currentTime()/this.player_.duration();return e>=1?1:e},t.prototype.handleMouseDown=function(t){this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),e.prototype.handleMouseDown.call(this,t)},t.prototype.handleMouseMove=function(e){var t=this.calculateDistance(e)*this.player_.duration();t===this.player_.duration()&&(t-=.1),this.player_.currentTime(t)},t.prototype.handleMouseUp=function(t){e.prototype.handleMouseUp.call(this,t),this.player_.scrubbing(!1),this.videoWasPlaying&&this.player_.play()},t.prototype.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+5)},t.prototype.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-5)},t}(_slider2.default);SeekBar.prototype.options_={children:["loadProgressBar","mouseTimeDisplay","playProgressBar"],barName:"playProgressBar"},SeekBar.prototype.playerEvent="timeupdate",_component2.default.registerComponent("SeekBar",SeekBar),exports.default=SeekBar;
},{"../../component.js":224,"../../slider/slider.js":276,"../../utils/computed-style.js":299,"../../utils/fn.js":302,"../../utils/format-time.js":303,"./load-progress-bar.js":234,"./play-progress-bar.js":236,"./tooltip-progress-bar.js":239}],239:[function(require,module,exports){
"use strict";function _interopRequireWildcard(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}exports.__esModule=!0;var _component=require("../../component.js"),_component2=_interopRequireDefault(_component),_fn=require("../../utils/fn.js"),Fn=_interopRequireWildcard(_fn),_formatTime=require("../../utils/format-time.js"),_formatTime2=_interopRequireDefault(_formatTime),TooltipProgressBar=function(t){function e(r,o){_classCallCheck(this,e);var n=_possibleConstructorReturn(this,t.call(this,r,o));return n.updateDataAttr(),n.on(r,"timeupdate",n.updateDataAttr),r.ready(Fn.bind(n,n.updateDataAttr)),n}return _inherits(e,t),e.prototype.createEl=function(){var e=t.prototype.createEl.call(this,"div",{className:"vjs-tooltip-progress-bar vjs-slider-bar",innerHTML:'<div class="vjs-time-tooltip"></div>\n        <span class="vjs-control-text"><span>'+this.localize("Progress")+"</span>: 0%</span>"});return this.tooltip=e.querySelector(".vjs-time-tooltip"),e},e.prototype.updateDataAttr=function(t){var e=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),r=(0,_formatTime2.default)(e,this.player_.duration());this.el_.setAttribute("data-current-time",r),this.tooltip.innerHTML=r},e}(_component2.default);_component2.default.registerComponent("TooltipProgressBar",TooltipProgressBar),exports.default=TooltipProgressBar;
},{"../../component.js":224,"../../utils/fn.js":302,"../../utils/format-time.js":303}],240:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _spacer=require("./spacer.js"),_spacer2=_interopRequireDefault(_spacer),_component=require("../../component.js"),_component2=_interopRequireDefault(_component),CustomControlSpacer=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,e.apply(this,arguments))}return _inherits(t,e),t.prototype.buildCSSClass=function(){return"vjs-custom-control-spacer "+e.prototype.buildCSSClass.call(this)},t.prototype.createEl=function(){var t=e.prototype.createEl.call(this,{className:this.buildCSSClass()});return t.innerHTML="&nbsp;",t},t}(_spacer2.default);_component2.default.registerComponent("CustomControlSpacer",CustomControlSpacer),exports.default=CustomControlSpacer;
},{"../../component.js":224,"./spacer.js":241}],241:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _component=require("../../component.js"),_component2=_interopRequireDefault(_component),Spacer=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,e.apply(this,arguments))}return _inherits(t,e),t.prototype.buildCSSClass=function(){return"vjs-spacer "+e.prototype.buildCSSClass.call(this)},t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},t}(_component2.default);_component2.default.registerComponent("Spacer",Spacer),exports.default=Spacer;
},{"../../component.js":224}],242:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _textTrackMenuItem=require("./text-track-menu-item.js"),_textTrackMenuItem2=_interopRequireDefault(_textTrackMenuItem),_component=require("../../component.js"),_component2=_interopRequireDefault(_component),CaptionSettingsMenuItem=function(e){function t(n,o){_classCallCheck(this,t),o.track={player:n,kind:o.kind,label:o.kind+" settings",selectable:!1,default:!1,mode:"disabled"},o.selectable=!1;var r=_possibleConstructorReturn(this,e.call(this,n,o));return r.addClass("vjs-texttrack-settings"),r.controlText(", opens "+o.kind+" settings dialog"),r}return _inherits(t,e),t.prototype.handleClick=function(e){this.player().getChild("textTrackSettings").show(),this.player().getChild("textTrackSettings").el_.focus()},t}(_textTrackMenuItem2.default);_component2.default.registerComponent("CaptionSettingsMenuItem",CaptionSettingsMenuItem),exports.default=CaptionSettingsMenuItem;
},{"../../component.js":224,"./text-track-menu-item.js":250}],243:[function(require,module,exports){
"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}exports.__esModule=!0;var _textTrackButton=require("./text-track-button.js"),_textTrackButton2=_interopRequireDefault(_textTrackButton),_component=require("../../component.js"),_component2=_interopRequireDefault(_component),_captionSettingsMenuItem=require("./caption-settings-menu-item.js"),_captionSettingsMenuItem2=_interopRequireDefault(_captionSettingsMenuItem),CaptionsButton=function(t){function e(n,o,r){_classCallCheck(this,e);var i=_possibleConstructorReturn(this,t.call(this,n,o,r));return i.el_.setAttribute("aria-label","Captions Menu"),i}return _inherits(e,t),e.prototype.buildCSSClass=function(){return"vjs-captions-button "+t.prototype.buildCSSClass.call(this)},e.prototype.update=function(e){var n=2;t.prototype.update.call(this),this.player().tech_&&this.player().tech_.featuresNativeTextTracks&&(n=1),this.items&&this.items.length>n?this.show():this.hide()},e.prototype.createItems=function(){var e=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||e.push(new _captionSettingsMenuItem2.default(this.player_,{kind:this.kind_})),t.prototype.createItems.call(this,e)},e}(_textTrackButton2.default);CaptionsButton.prototype.kind_="captions",CaptionsButton.prototype.controlText_="Captions",_component2.default.registerComponent("CaptionsButton",CaptionsButton),exports.default=CaptionsButton;
},{"../../component.js":224,"./caption-settings-menu-item.js":242,"./text-track-button.js":249}],244:[function(require,module,exports){
"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}exports.__esModule=!0;var _textTrackButton=require("./text-track-button.js"),_textTrackButton2=_interopRequireDefault(_textTrackButton),_component=require("../../component.js"),_component2=_interopRequireDefault(_component),_chaptersTrackMenuItem=require("./chapters-track-menu-item.js"),_chaptersTrackMenuItem2=_interopRequireDefault(_chaptersTrackMenuItem),_toTitleCase=require("../../utils/to-title-case.js"),_toTitleCase2=_interopRequireDefault(_toTitleCase),ChaptersButton=function(t){function e(r,a,n){_classCallCheck(this,e);var o=_possibleConstructorReturn(this,t.call(this,r,a,n));return o.el_.setAttribute("aria-label","Chapters Menu"),o}return _inherits(e,t),e.prototype.buildCSSClass=function(){return"vjs-chapters-button "+t.prototype.buildCSSClass.call(this)},e.prototype.update=function(e){this.track_&&(!e||"addtrack"!==e.type&&"removetrack"!==e.type)||this.setTrack(this.findChaptersTrack()),t.prototype.update.call(this)},e.prototype.setTrack=function(t){if(this.track_!==t){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var e=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);e&&e.removeEventListener("load",this.updateHandler_),this.track_=null}if(this.track_=t,this.track_){this.track_.mode="hidden";var r=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);r&&r.addEventListener("load",this.updateHandler_)}}},e.prototype.findChaptersTrack=function(){for(var t=this.player_.textTracks()||[],e=t.length-1;e>=0;e--){var r=t[e];if(r.kind===this.kind_)return r}},e.prototype.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize((0,_toTitleCase2.default)(this.kind_))},e.prototype.createMenu=function(){return this.options_.title=this.getMenuCaption(),t.prototype.createMenu.call(this)},e.prototype.createItems=function(){var t=[];if(!this.track_)return t;var e=this.track_.cues;if(!e)return t;for(var r=0,a=e.length;r<a;r++){var n=e[r],o=new _chaptersTrackMenuItem2.default(this.player_,{track:this.track_,cue:n});t.push(o)}return t},e}(_textTrackButton2.default);ChaptersButton.prototype.kind_="chapters",ChaptersButton.prototype.controlText_="Chapters",_component2.default.registerComponent("ChaptersButton",ChaptersButton),exports.default=ChaptersButton;
},{"../../component.js":224,"../../utils/to-title-case.js":310,"./chapters-track-menu-item.js":245,"./text-track-button.js":249}],245:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _menuItem=require("../../menu/menu-item.js"),_menuItem2=_interopRequireDefault(_menuItem),_component=require("../../component.js"),_component2=_interopRequireDefault(_component),_fn=require("../../utils/fn.js"),Fn=_interopRequireWildcard(_fn),ChaptersTrackMenuItem=function(e){function t(r,n){_classCallCheck(this,t);var o=n.track,i=n.cue,u=r.currentTime();n.selectable=!0,n.label=i.text,n.selected=i.startTime<=u&&u<i.endTime;var a=_possibleConstructorReturn(this,e.call(this,r,n));return a.track=o,a.cue=i,o.addEventListener("cuechange",Fn.bind(a,a.update)),a}return _inherits(t,e),t.prototype.handleClick=function(t){e.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},t.prototype.update=function(e){var t=this.cue,r=this.player_.currentTime();this.selected(t.startTime<=r&&r<t.endTime)},t}(_menuItem2.default);_component2.default.registerComponent("ChaptersTrackMenuItem",ChaptersTrackMenuItem),exports.default=ChaptersTrackMenuItem;
},{"../../component.js":224,"../../menu/menu-item.js":267,"../../utils/fn.js":302}],246:[function(require,module,exports){
"use strict";function _interopRequireWildcard(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}exports.__esModule=!0;var _textTrackButton=require("./text-track-button.js"),_textTrackButton2=_interopRequireDefault(_textTrackButton),_component=require("../../component.js"),_component2=_interopRequireDefault(_component),_fn=require("../../utils/fn.js"),Fn=_interopRequireWildcard(_fn),DescriptionsButton=function(t){function e(n,r,o){_classCallCheck(this,e);var i=_possibleConstructorReturn(this,t.call(this,n,r,o));i.el_.setAttribute("aria-label","Descriptions Menu");var s=n.textTracks();return s&&!function(){var t=Fn.bind(i,i.handleTracksChange);s.addEventListener("change",t),i.on("dispose",function(){s.removeEventListener("change",t)})}(),i}return _inherits(e,t),e.prototype.handleTracksChange=function(t){for(var e=this.player().textTracks(),n=!1,r=0,o=e.length;r<o;r++){var i=e[r];if(i.kind!==this.kind_&&"showing"===i.mode){n=!0;break}}n?this.disable():this.enable()},e.prototype.buildCSSClass=function(){return"vjs-descriptions-button "+t.prototype.buildCSSClass.call(this)},e}(_textTrackButton2.default);DescriptionsButton.prototype.kind_="descriptions",DescriptionsButton.prototype.controlText_="Descriptions",_component2.default.registerComponent("DescriptionsButton",DescriptionsButton),exports.default=DescriptionsButton;
},{"../../component.js":224,"../../utils/fn.js":302,"./text-track-button.js":249}],247:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _textTrackMenuItem=require("./text-track-menu-item.js"),_textTrackMenuItem2=_interopRequireDefault(_textTrackMenuItem),_component=require("../../component.js"),_component2=_interopRequireDefault(_component),OffTextTrackMenuItem=function(e){function t(n,r){_classCallCheck(this,t),r.track={player:n,kind:r.kind,label:r.kind+" off",default:!1,mode:"disabled"},r.selectable=!0;var o=_possibleConstructorReturn(this,e.call(this,n,r));return o.selected(!0),o}return _inherits(t,e),t.prototype.handleTracksChange=function(e){for(var t=this.player().textTracks(),n=!0,r=0,o=t.length;r<o;r++){var a=t[r];if(a.kind===this.track.kind&&"showing"===a.mode){n=!1;break}}this.selected(n)},t}(_textTrackMenuItem2.default);_component2.default.registerComponent("OffTextTrackMenuItem",OffTextTrackMenuItem),exports.default=OffTextTrackMenuItem;
},{"../../component.js":224,"./text-track-menu-item.js":250}],248:[function(require,module,exports){
"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}exports.__esModule=!0;var _textTrackButton=require("./text-track-button.js"),_textTrackButton2=_interopRequireDefault(_textTrackButton),_component=require("../../component.js"),_component2=_interopRequireDefault(_component),SubtitlesButton=function(t){function e(o,n,r){_classCallCheck(this,e);var u=_possibleConstructorReturn(this,t.call(this,o,n,r));return u.el_.setAttribute("aria-label","Subtitles Menu"),u}return _inherits(e,t),e.prototype.buildCSSClass=function(){return"vjs-subtitles-button "+t.prototype.buildCSSClass.call(this)},e}(_textTrackButton2.default);SubtitlesButton.prototype.kind_="subtitles",SubtitlesButton.prototype.controlText_="Subtitles",_component2.default.registerComponent("SubtitlesButton",SubtitlesButton),exports.default=SubtitlesButton;
},{"../../component.js":224,"./text-track-button.js":249}],249:[function(require,module,exports){
"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}exports.__esModule=!0;var _trackButton=require("../track-button.js"),_trackButton2=_interopRequireDefault(_trackButton),_component=require("../../component.js"),_component2=_interopRequireDefault(_component),_textTrackMenuItem=require("./text-track-menu-item.js"),_textTrackMenuItem2=_interopRequireDefault(_textTrackMenuItem),_offTextTrackMenuItem=require("./off-text-track-menu-item.js"),_offTextTrackMenuItem2=_interopRequireDefault(_offTextTrackMenuItem),TextTrackButton=function(t){function e(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _classCallCheck(this,e),n.tracks=r.textTracks(),_possibleConstructorReturn(this,t.call(this,r,n))}return _inherits(e,t),e.prototype.createItems=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.push(new _offTextTrackMenuItem2.default(this.player_,{kind:this.kind_}));var e=this.player_.textTracks();if(!e)return t;for(var r=0;r<e.length;r++){var n=e[r];n.kind===this.kind_&&t.push(new _textTrackMenuItem2.default(this.player_,{track:n,selectable:!0}))}return t},e}(_trackButton2.default);_component2.default.registerComponent("TextTrackButton",TextTrackButton),exports.default=TextTrackButton;
},{"../../component.js":224,"../track-button.js":255,"./off-text-track-menu-item.js":247,"./text-track-menu-item.js":250}],250:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_menuItem=require("../../menu/menu-item.js"),_menuItem2=_interopRequireDefault(_menuItem),_component=require("../../component.js"),_component2=_interopRequireDefault(_component),_fn=require("../../utils/fn.js"),Fn=_interopRequireWildcard(_fn),_window=require("global/window"),_window2=_interopRequireDefault(_window),_document=require("global/document"),_document2=_interopRequireDefault(_document),TextTrackMenuItem=function(e){function t(n,o){_classCallCheck(this,t);var r=o.track,i=n.textTracks();o.label=r.label||r.language||"Unknown",o.selected=r.default||"showing"===r.mode;var u=_possibleConstructorReturn(this,e.call(this,n,o));return u.track=r,i&&!function(){var e=Fn.bind(u,u.handleTracksChange);i.addEventListener("change",e),u.on("dispose",function(){i.removeEventListener("change",e)})}(),i&&void 0===i.onchange&&!function(){var e=void 0;u.on(["tap","click"],function(){if("object"!==_typeof(_window2.default.Event))try{e=new _window2.default.Event("change")}catch(e){}e||(e=_document2.default.createEvent("Event"),e.initEvent("change",!0,!0)),i.dispatchEvent(e)})}(),u}return _inherits(t,e),t.prototype.handleClick=function(t){var n=this.track.kind,o=this.player_.textTracks();if(e.prototype.handleClick.call(this,t),o)for(var r=0;r<o.length;r++){var i=o[r];i.kind===n&&(i===this.track?i.mode="showing":i.mode="disabled")}},t.prototype.handleTracksChange=function(e){this.selected("showing"===this.track.mode)},t}(_menuItem2.default);_component2.default.registerComponent("TextTrackMenuItem",TextTrackMenuItem),exports.default=TextTrackMenuItem;
},{"../../component.js":224,"../../menu/menu-item.js":267,"../../utils/fn.js":302,"global/document":193,"global/window":194}],251:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _component=require("../../component.js"),_component2=_interopRequireDefault(_component),_dom=require("../../utils/dom.js"),Dom=_interopRequireWildcard(_dom),_formatTime=require("../../utils/format-time.js"),_formatTime2=_interopRequireDefault(_formatTime),CurrentTimeDisplay=function(e){function t(r,n){_classCallCheck(this,t);var o=_possibleConstructorReturn(this,e.call(this,r,n));return o.on(r,"timeupdate",o.updateContent),o}return _inherits(t,e),t.prototype.createEl=function(){var t=e.prototype.createEl.call(this,"div",{className:"vjs-current-time vjs-time-control vjs-control"});return this.contentEl_=Dom.createEl("div",{className:"vjs-current-time-display",innerHTML:'<span class="vjs-control-text">Current Time </span>0:00'},{"aria-live":"off"}),t.appendChild(this.contentEl_),t},t.prototype.updateContent=function(e){var t=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),r=this.localize("Current Time"),n=(0,_formatTime2.default)(t,this.player_.duration());n!==this.formattedTime_&&(this.formattedTime_=n,this.contentEl_.innerHTML='<span class="vjs-control-text">'+r+"</span> "+n)},t}(_component2.default);_component2.default.registerComponent("CurrentTimeDisplay",CurrentTimeDisplay),exports.default=CurrentTimeDisplay;
},{"../../component.js":224,"../../utils/dom.js":300,"../../utils/format-time.js":303}],252:[function(require,module,exports){
"use strict";function _interopRequireWildcard(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e.default=t,e}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}exports.__esModule=!0;var _component=require("../../component.js"),_component2=_interopRequireDefault(_component),_dom=require("../../utils/dom.js"),Dom=_interopRequireWildcard(_dom),_formatTime=require("../../utils/format-time.js"),_formatTime2=_interopRequireDefault(_formatTime),DurationDisplay=function(t){function e(o,n){_classCallCheck(this,e);var r=_possibleConstructorReturn(this,t.call(this,o,n));return r.on(o,"durationchange",r.updateContent),r.on(o,"timeupdate",r.updateContent),r.on(o,"loadedmetadata",r.updateContent),r}return _inherits(e,t),e.prototype.createEl=function(){var e=t.prototype.createEl.call(this,"div",{className:"vjs-duration vjs-time-control vjs-control"});return this.contentEl_=Dom.createEl("div",{className:"vjs-duration-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Duration Time")+"</span> 0:00"},{"aria-live":"off"}),e.appendChild(this.contentEl_),e},e.prototype.updateContent=function(t){var e=this.player_.duration();if(e&&this.duration_!==e){this.duration_=e;var o=this.localize("Duration Time"),n=(0,_formatTime2.default)(e);this.contentEl_.innerHTML='<span class="vjs-control-text">'+o+"</span> "+n}},e}(_component2.default);_component2.default.registerComponent("DurationDisplay",DurationDisplay),exports.default=DurationDisplay;
},{"../../component.js":224,"../../utils/dom.js":300,"../../utils/format-time.js":303}],253:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _component=require("../../component.js"),_component2=_interopRequireDefault(_component),_dom=require("../../utils/dom.js"),Dom=_interopRequireWildcard(_dom),_formatTime=require("../../utils/format-time.js"),_formatTime2=_interopRequireDefault(_formatTime),RemainingTimeDisplay=function(e){function t(n,i){_classCallCheck(this,t);var o=_possibleConstructorReturn(this,e.call(this,n,i));return o.on(n,"timeupdate",o.updateContent),o.on(n,"durationchange",o.updateContent),o}return _inherits(t,e),t.prototype.createEl=function(){var t=e.prototype.createEl.call(this,"div",{className:"vjs-remaining-time vjs-time-control vjs-control"});return this.contentEl_=Dom.createEl("div",{className:"vjs-remaining-time-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Remaining Time")+"</span> -0:00"},{"aria-live":"off"}),t.appendChild(this.contentEl_),t},t.prototype.updateContent=function(e){if(this.player_.duration()){var t=this.localize("Remaining Time"),n=(0,_formatTime2.default)(this.player_.remainingTime());n!==this.formattedTime_&&(this.formattedTime_=n,this.contentEl_.innerHTML='<span class="vjs-control-text">'+t+"</span> -"+n)}},t}(_component2.default);_component2.default.registerComponent("RemainingTimeDisplay",RemainingTimeDisplay),exports.default=RemainingTimeDisplay;
},{"../../component.js":224,"../../utils/dom.js":300,"../../utils/format-time.js":303}],254:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _component=require("../../component.js"),_component2=_interopRequireDefault(_component),TimeDivider=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,e.apply(this,arguments))}return _inherits(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"})},t}(_component2.default);_component2.default.registerComponent("TimeDivider",TimeDivider),exports.default=TimeDivider;
},{"../../component.js":224}],255:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _menuButton=require("../menu/menu-button.js"),_menuButton2=_interopRequireDefault(_menuButton),_component=require("../component.js"),_component2=_interopRequireDefault(_component),_fn=require("../utils/fn.js"),Fn=_interopRequireWildcard(_fn),TrackButton=function(e){function t(n,r){_classCallCheck(this,t);var o=r.tracks,u=_possibleConstructorReturn(this,e.call(this,n,r));if(u.items.length<=1&&u.hide(),!o)return _possibleConstructorReturn(u);var i=Fn.bind(u,u.update);return o.addEventListener("removetrack",i),o.addEventListener("addtrack",i),u.player_.on("dispose",function(){o.removeEventListener("removetrack",i),o.removeEventListener("addtrack",i)}),u}return _inherits(t,e),t}(_menuButton2.default);_component2.default.registerComponent("TrackButton",TrackButton),exports.default=TrackButton;
},{"../component.js":224,"../menu/menu-button.js":266,"../utils/fn.js":302}],256:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _slider=require("../../slider/slider.js"),_slider2=_interopRequireDefault(_slider),_component=require("../../component.js"),_component2=_interopRequireDefault(_component),_fn=require("../../utils/fn.js"),Fn=_interopRequireWildcard(_fn);require("./volume-level.js");var VolumeBar=function(e){function t(r,o){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,e.call(this,r,o));return n.on(r,"volumechange",n.updateARIAAttributes),r.ready(Fn.bind(n,n.updateARIAAttributes)),n}return _inherits(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":"volume level"})},t.prototype.handleMouseMove=function(e){this.checkMuted(),this.player_.volume(this.calculateDistance(e))},t.prototype.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},t.prototype.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},t.prototype.stepForward=function(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},t.prototype.stepBack=function(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},t.prototype.updateARIAAttributes=function(e){var t=(100*this.player_.volume()).toFixed(2);this.el_.setAttribute("aria-valuenow",t),this.el_.setAttribute("aria-valuetext",t+"%")},t}(_slider2.default);VolumeBar.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},VolumeBar.prototype.playerEvent="volumechange",_component2.default.registerComponent("VolumeBar",VolumeBar),exports.default=VolumeBar;
},{"../../component.js":224,"../../slider/slider.js":276,"../../utils/fn.js":302,"./volume-level.js":258}],257:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _component=require("../../component.js"),_component2=_interopRequireDefault(_component);require("./volume-bar.js");var VolumeControl=function(e){function t(o,n){_classCallCheck(this,t);var r=_possibleConstructorReturn(this,e.call(this,o,n));return o.tech_&&o.tech_.featuresVolumeControl===!1&&r.addClass("vjs-hidden"),r.on(o,"loadstart",function(){o.tech_.featuresVolumeControl===!1?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")}),r}return _inherits(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control"})},t}(_component2.default);VolumeControl.prototype.options_={children:["volumeBar"]},_component2.default.registerComponent("VolumeControl",VolumeControl),exports.default=VolumeControl;
},{"../../component.js":224,"./volume-bar.js":256}],258:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _component=require("../../component.js"),_component2=_interopRequireDefault(_component),VolumeLevel=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,e.apply(this,arguments))}return _inherits(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})},t}(_component2.default);_component2.default.registerComponent("VolumeLevel",VolumeLevel),exports.default=VolumeLevel;
},{"../../component.js":224}],259:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _fn=require("../utils/fn.js"),Fn=_interopRequireWildcard(_fn),_component=require("../component.js"),_component2=_interopRequireDefault(_component),_popup=require("../popup/popup.js"),_popup2=_interopRequireDefault(_popup),_popupButton=require("../popup/popup-button.js"),_popupButton2=_interopRequireDefault(_popupButton),_muteToggle=require("./mute-toggle.js"),_muteToggle2=_interopRequireDefault(_muteToggle),_volumeBar=require("./volume-control/volume-bar.js"),_volumeBar2=_interopRequireDefault(_volumeBar),VolumeMenuButton=function(e){function t(o){function n(){o.tech_&&o.tech_.featuresVolumeControl===!1?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")}var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,t),void 0===u.inline&&(u.inline=!0),void 0===u.vertical&&(u.inline?u.vertical=!1:u.vertical=!0),u.volumeBar=u.volumeBar||{},u.volumeBar.vertical=!!u.vertical;var r=_possibleConstructorReturn(this,e.call(this,o,u));return r.on(o,"volumechange",r.volumeUpdate),r.on(o,"loadstart",r.volumeUpdate),n.call(r),r.on(o,"loadstart",n),r.on(r.volumeBar,["slideractive","focus"],function(){this.addClass("vjs-slider-active")}),r.on(r.volumeBar,["sliderinactive","blur"],function(){this.removeClass("vjs-slider-active")}),r.on(r.volumeBar,["focus"],function(){this.addClass("vjs-lock-showing")}),r.on(r.volumeBar,["blur"],function(){this.removeClass("vjs-lock-showing")}),r}return _inherits(t,e),t.prototype.buildCSSClass=function(){var t="";return t=this.options_.vertical?"vjs-volume-menu-button-vertical":"vjs-volume-menu-button-horizontal","vjs-volume-menu-button "+e.prototype.buildCSSClass.call(this)+" "+t},t.prototype.createPopup=function(){var e=new _popup2.default(this.player_,{contentElType:"div"}),t=new _volumeBar2.default(this.player_,this.options_.volumeBar);return e.addChild(t),this.menuContent=e,this.volumeBar=t,this.attachVolumeBarEvents(),e},t.prototype.handleClick=function(t){_muteToggle2.default.prototype.handleClick.call(this),e.prototype.handleClick.call(this)},t.prototype.attachVolumeBarEvents=function(){this.menuContent.on(["mousedown","touchdown"],Fn.bind(this,this.handleMouseDown))},t.prototype.handleMouseDown=function(e){this.on(["mousemove","touchmove"],Fn.bind(this.volumeBar,this.volumeBar.handleMouseMove)),this.on(this.el_.ownerDocument,["mouseup","touchend"],this.handleMouseUp)},t.prototype.handleMouseUp=function(e){this.off(["mousemove","touchmove"],Fn.bind(this.volumeBar,this.volumeBar.handleMouseMove))},t}(_popupButton2.default);VolumeMenuButton.prototype.volumeUpdate=_muteToggle2.default.prototype.update,VolumeMenuButton.prototype.controlText_="Mute",_component2.default.registerComponent("VolumeMenuButton",VolumeMenuButton),exports.default=VolumeMenuButton;
},{"../component.js":224,"../popup/popup-button.js":272,"../popup/popup.js":273,"../utils/fn.js":302,"./mute-toggle.js":230,"./volume-control/volume-bar.js":256}],260:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,o){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!o||"object"!=typeof o&&"function"!=typeof o?e:o}function _inherits(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Super expression must either be null or a function, not "+typeof o);e.prototype=Object.create(o&&o.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),o&&(Object.setPrototypeOf?Object.setPrototypeOf(e,o):e.__proto__=o)}exports.__esModule=!0;var _component=require("./component"),_component2=_interopRequireDefault(_component),_modalDialog=require("./modal-dialog"),_modalDialog2=_interopRequireDefault(_modalDialog),_mergeOptions=require("./utils/merge-options"),_mergeOptions2=_interopRequireDefault(_mergeOptions),ErrorDisplay=function(e){function o(t,r){_classCallCheck(this,o);var n=_possibleConstructorReturn(this,e.call(this,t,r));return n.on(t,"error",n.open),n}return _inherits(o,e),o.prototype.buildCSSClass=function(){return"vjs-error-display "+e.prototype.buildCSSClass.call(this)},o.prototype.content=function(){var e=this.player().error();return e?this.localize(e.message):""},o}(_modalDialog2.default);ErrorDisplay.prototype.options_=(0,_mergeOptions2.default)(_modalDialog2.default.prototype.options_,{fillAlways:!0,temporary:!1,uncloseable:!0}),_component2.default.registerComponent("ErrorDisplay",ErrorDisplay),exports.default=ErrorDisplay;
},{"./component":224,"./modal-dialog":269,"./utils/merge-options":306}],261:[function(require,module,exports){
"use strict";function _interopRequireWildcard(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}exports.__esModule=!0;var _events=require("./utils/events.js"),Events=_interopRequireWildcard(_events),EventTarget=function(){};EventTarget.prototype.allowedEvents_={},EventTarget.prototype.on=function(t,e){var n=this.addEventListener;this.addEventListener=function(){},Events.on(this,t,e),this.addEventListener=n},EventTarget.prototype.addEventListener=EventTarget.prototype.on,EventTarget.prototype.off=function(t,e){Events.off(this,t,e)},EventTarget.prototype.removeEventListener=EventTarget.prototype.off,EventTarget.prototype.one=function(t,e){var n=this.addEventListener;this.addEventListener=function(){},Events.one(this,t,e),this.addEventListener=n},EventTarget.prototype.trigger=function(t){var e=t.type||t;"string"==typeof t&&(t={type:e}),t=Events.fixEvent(t),this.allowedEvents_[e]&&this["on"+e]&&this["on"+e](t),Events.trigger(this,t)},EventTarget.prototype.dispatchEvent=EventTarget.prototype.trigger,exports.default=EventTarget;
},{"./utils/events.js":301}],262:[function(require,module,exports){
"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}exports.__esModule=!0;var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_log=require("./utils/log"),_log2=_interopRequireDefault(_log),_obj=require("./utils/obj"),_inherits=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof e?"undefined":_typeof(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.super_=e)},extendFn=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=function(){t.apply(this,arguments)},r={};(0,_obj.isObject)(e)?("function"==typeof e.init&&(_log2.default.warn("Constructor logic via init() is deprecated; please use constructor() instead."),e.constructor=e.init),e.constructor!==Object.prototype.constructor&&(o=e.constructor),r=e):"function"==typeof e&&(o=e),_inherits(o,t);for(var n in r)r.hasOwnProperty(n)&&(o.prototype[n]=r[n]);return o};exports.default=extendFn;
},{"./utils/log":305,"./utils/obj":307}],263:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}exports.__esModule=!0;for(var _document=require("global/document"),_document2=_interopRequireDefault(_document),FullscreenApi={},apiMap=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],specApi=apiMap[0],browserApi=void 0,i=0;i<apiMap.length;i++)if(apiMap[i][1]in _document2.default){browserApi=apiMap[i];break}if(browserApi)for(var _i=0;_i<browserApi.length;_i++)FullscreenApi[specApi[_i]]=browserApi[_i];exports.default=FullscreenApi;
},{"global/document":193}],264:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _component=require("./component"),_component2=_interopRequireDefault(_component),LoadingSpinner=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,e.apply(this,arguments))}return _inherits(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"})},t}(_component2.default);_component2.default.registerComponent("LoadingSpinner",LoadingSpinner),exports.default=LoadingSpinner;
},{"./component":224}],265:[function(require,module,exports){
"use strict";function MediaError(e){return e instanceof MediaError?e:("number"==typeof e?this.code=e:"string"==typeof e?this.message=e:(0,_obj.isObject)(e)&&("number"==typeof e.code&&(this.code=e.code),(0,_obj.assign)(this,e)),void(this.message||(this.message=MediaError.defaultMessages[this.code]||"")))}exports.__esModule=!0;var _obj=require("./utils/obj");MediaError.prototype.code=0,MediaError.prototype.message="",MediaError.prototype.status=null,MediaError.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],MediaError.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var errNum=0;errNum<MediaError.errorTypes.length;errNum++)MediaError[MediaError.errorTypes[errNum]]=errNum,MediaError.prototype[MediaError.errorTypes[errNum]]=errNum;exports.default=MediaError;
},{"./utils/obj":307}],266:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _clickableComponent=require("../clickable-component.js"),_clickableComponent2=_interopRequireDefault(_clickableComponent),_component=require("../component.js"),_component2=_interopRequireDefault(_component),_menu=require("./menu.js"),_menu2=_interopRequireDefault(_menu),_dom=require("../utils/dom.js"),Dom=_interopRequireWildcard(_dom),_fn=require("../utils/fn.js"),Fn=_interopRequireWildcard(_fn),_toTitleCase=require("../utils/to-title-case.js"),_toTitleCase2=_interopRequireDefault(_toTitleCase),MenuButton=function(e){function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,t);var s=_possibleConstructorReturn(this,e.call(this,n,i));return s.update(),s.enabled_=!0,s.el_.setAttribute("aria-haspopup","true"),s.el_.setAttribute("role","menuitem"),s.on("keydown",s.handleSubmenuKeyPress),s}return _inherits(t,e),t.prototype.update=function(){var e=this.createMenu();this.menu&&this.removeChild(this.menu),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.el_.setAttribute("aria-expanded","false"),this.items&&0===this.items.length?this.hide():this.items&&this.items.length>1&&this.show()},t.prototype.createMenu=function(){var e=new _menu2.default(this.player_);if(this.options_.title){var t=Dom.createEl("li",{className:"vjs-menu-title",innerHTML:(0,_toTitleCase2.default)(this.options_.title),tabIndex:-1});e.children_.unshift(t),Dom.insertElFirst(t,e.contentEl())}if(this.items=this.createItems(),this.items)for(var n=0;n<this.items.length;n++)e.addItem(this.items[n]);return e},t.prototype.createItems=function(){},t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},t.prototype.buildCSSClass=function(){var t="vjs-menu-button";return t+=this.options_.inline===!0?"-inline":"-popup","vjs-menu-button "+t+" "+e.prototype.buildCSSClass.call(this)},t.prototype.handleClick=function(e){this.one(this.menu.contentEl(),"mouseleave",Fn.bind(this,function(e){this.unpressButton(),this.el_.blur()})),this.buttonPressed_?this.unpressButton():this.pressButton()},t.prototype.handleKeyPress=function(t){27===t.which||9===t.which?(this.buttonPressed_&&this.unpressButton(),9!==t.which&&t.preventDefault()):38===t.which||40===t.which?this.buttonPressed_||(this.pressButton(),t.preventDefault()):e.prototype.handleKeyPress.call(this,t)},t.prototype.handleSubmenuKeyPress=function(e){27!==e.which&&9!==e.which||(this.buttonPressed_&&this.unpressButton(),9!==e.which&&e.preventDefault())},t.prototype.pressButton=function(){this.enabled_&&(this.buttonPressed_=!0,this.menu.lockShowing(),this.el_.setAttribute("aria-expanded","true"),this.menu.focus())},t.prototype.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.el_.setAttribute("aria-expanded","false"),this.el_.focus())},t.prototype.disable=function(){return this.buttonPressed_=!1,this.menu.unlockShowing(),this.el_.setAttribute("aria-expanded","false"),this.enabled_=!1,e.prototype.disable.call(this)},t.prototype.enable=function(){return this.enabled_=!0,e.prototype.enable.call(this)},t}(_clickableComponent2.default);_component2.default.registerComponent("MenuButton",MenuButton),exports.default=MenuButton;
},{"../clickable-component.js":222,"../component.js":224,"../utils/dom.js":300,"../utils/fn.js":302,"../utils/to-title-case.js":310,"./menu.js":268}],267:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _clickableComponent=require("../clickable-component.js"),_clickableComponent2=_interopRequireDefault(_clickableComponent),_component=require("../component.js"),_component2=_interopRequireDefault(_component),_obj=require("../utils/obj"),MenuItem=function(e){function t(o,n){_classCallCheck(this,t);var r=_possibleConstructorReturn(this,e.call(this,o,n));return r.selectable=n.selectable,r.selected(n.selected),r.selectable?r.el_.setAttribute("role","menuitemcheckbox"):r.el_.setAttribute("role","menuitem"),r}return _inherits(t,e),t.prototype.createEl=function(t,o,n){return e.prototype.createEl.call(this,"li",(0,_obj.assign)({className:"vjs-menu-item",innerHTML:this.localize(this.options_.label),tabIndex:-1},o),n)},t.prototype.handleClick=function(e){this.selected(!0)},t.prototype.selected=function(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected")):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(" ")))},t}(_clickableComponent2.default);_component2.default.registerComponent("MenuItem",MenuItem),exports.default=MenuItem;
},{"../clickable-component.js":222,"../component.js":224,"../utils/obj":307}],268:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _component=require("../component.js"),_component2=_interopRequireDefault(_component),_dom=require("../utils/dom.js"),Dom=_interopRequireWildcard(_dom),_fn=require("../utils/fn.js"),Fn=_interopRequireWildcard(_fn),_events=require("../utils/events.js"),Events=_interopRequireWildcard(_events),Menu=function(e){function t(n,o){_classCallCheck(this,t);var r=_possibleConstructorReturn(this,e.call(this,n,o));return r.focusedChild_=-1,r.on("keydown",r.handleKeyPress),r}return _inherits(t,e),t.prototype.addItem=function(e){this.addChild(e),e.on("click",Fn.bind(this,function(e){this.unlockShowing()}))},t.prototype.createEl=function(){var t=this.options_.contentElType||"ul";this.contentEl_=Dom.createEl(t,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var n=e.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return n.setAttribute("role","presentation"),n.appendChild(this.contentEl_),Events.on(n,"click",function(e){e.preventDefault(),e.stopImmediatePropagation()}),n},t.prototype.handleKeyPress=function(e){37===e.which||40===e.which?(e.preventDefault(),this.stepForward()):38!==e.which&&39!==e.which||(e.preventDefault(),this.stepBack())},t.prototype.stepForward=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_+1),this.focus(e)},t.prototype.stepBack=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_-1),this.focus(e)},t.prototype.focus=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.children().slice(),n=t.length&&t[0].className&&/vjs-menu-title/.test(t[0].className);n&&t.shift(),t.length>0&&(e<0?e=0:e>=t.length&&(e=t.length-1),this.focusedChild_=e,t[e].el_.focus())},t}(_component2.default);_component2.default.registerComponent("Menu",Menu),exports.default=Menu;
},{"../component.js":224,"../utils/dom.js":300,"../utils/events.js":301,"../utils/fn.js":302}],269:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _dom=require("./utils/dom"),Dom=_interopRequireWildcard(_dom),_fn=require("./utils/fn"),Fn=_interopRequireWildcard(_fn),_component=require("./component"),_component2=_interopRequireDefault(_component),MODAL_CLASS_NAME="vjs-modal-dialog",ESC=27,ModalDialog=function(e){function t(o,i){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,e.call(this,o,i));return n.opened_=n.hasBeenOpened_=n.hasBeenFilled_=!1,n.closeable(!n.options_.uncloseable),n.content(n.options_.content),n.contentEl_=Dom.createEl("div",{className:MODAL_CLASS_NAME+"-content"},{role:"document"}),n.descEl_=Dom.createEl("p",{className:MODAL_CLASS_NAME+"-description vjs-offscreen",id:n.el().getAttribute("aria-describedby")}),Dom.textContent(n.descEl_,n.description()),n.el_.appendChild(n.descEl_),n.el_.appendChild(n.contentEl_),n}return _inherits(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},t.prototype.buildCSSClass=function(){return MODAL_CLASS_NAME+" vjs-hidden "+e.prototype.buildCSSClass.call(this)},t.prototype.handleKeyPress=function(e){e.which===ESC&&this.closeable()&&this.close()},t.prototype.label=function(){return this.options_.label||this.localize("Modal Window")},t.prototype.description=function(){var e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e},t.prototype.open=function(){if(!this.opened_){var e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!e.paused(),this.wasPlaying_&&e.pause(),this.closeable()&&this.on(this.el_.ownerDocument,"keydown",Fn.bind(this,this.handleKeyPress)),e.controls(!1),this.show(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}return this},t.prototype.opened=function(e){return"boolean"==typeof e&&this[e?"open":"close"](),this.opened_},t.prototype.close=function(){if(this.opened_){var e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&e.play(),this.closeable()&&this.off(this.el_.ownerDocument,"keydown",Fn.bind(this,this.handleKeyPress)),e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.options_.temporary&&this.dispose()}return this},t.prototype.closeable=function e(t){if("boolean"==typeof t){var e=this.closeable_=!!t,o=this.getChild("closeButton");if(e&&!o){var i=this.contentEl_;this.contentEl_=this.el_,o=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=i,this.on(o,"close",this.close)}!e&&o&&(this.off(o,"close",this.close),this.removeChild(o),o.dispose())}return this.closeable_},t.prototype.fill=function(){return this.fillWith(this.content())},t.prototype.fillWith=function(e){var t=this.contentEl(),o=t.parentNode,i=t.nextSibling;return this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,o.removeChild(t),this.empty(),Dom.insertContent(t,e),this.trigger("modalfill"),i?o.insertBefore(t,i):o.appendChild(t),this},t.prototype.empty=function(){return this.trigger("beforemodalempty"),Dom.emptyEl(this.contentEl()),this.trigger("modalempty"),this},t.prototype.content=function(e){return"undefined"!=typeof e&&(this.content_=e),this.content_},t}(_component2.default);ModalDialog.prototype.options_={temporary:!0},_component2.default.registerComponent("ModalDialog",ModalDialog),exports.default=ModalDialog;
},{"./component":224,"./utils/dom":300,"./utils/fn":302}],270:[function(require,module,exports){
"use strict";function _interopRequireWildcard(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}exports.__esModule=!0;var _component=require("./component.js"),_component2=_interopRequireDefault(_component),_document=require("global/document"),_document2=_interopRequireDefault(_document),_window=require("global/window"),_window2=_interopRequireDefault(_window),_events=require("./utils/events.js"),Events=_interopRequireWildcard(_events),_dom=require("./utils/dom.js"),Dom=_interopRequireWildcard(_dom),_fn=require("./utils/fn.js"),Fn=_interopRequireWildcard(_fn),_guid=require("./utils/guid.js"),Guid=_interopRequireWildcard(_guid),_browser=require("./utils/browser.js"),browser=_interopRequireWildcard(_browser),_log=require("./utils/log.js"),_log2=_interopRequireDefault(_log),_toTitleCase=require("./utils/to-title-case.js"),_toTitleCase2=_interopRequireDefault(_toTitleCase),_timeRanges=require("./utils/time-ranges.js"),_buffer=require("./utils/buffer.js"),_stylesheet=require("./utils/stylesheet.js"),stylesheet=_interopRequireWildcard(_stylesheet),_fullscreenApi=require("./fullscreen-api.js"),_fullscreenApi2=_interopRequireDefault(_fullscreenApi),_mediaError=require("./media-error.js"),_mediaError2=_interopRequireDefault(_mediaError),_tuple=require("safe-json-parse/tuple"),_tuple2=_interopRequireDefault(_tuple),_obj=require("./utils/obj"),_mergeOptions=require("./utils/merge-options.js"),_mergeOptions2=_interopRequireDefault(_mergeOptions),_textTrackListConverter=require("./tracks/text-track-list-converter.js"),_textTrackListConverter2=_interopRequireDefault(_textTrackListConverter),_modalDialog=require("./modal-dialog"),_modalDialog2=_interopRequireDefault(_modalDialog),_tech=require("./tech/tech.js"),_tech2=_interopRequireDefault(_tech),_audioTrackList=require("./tracks/audio-track-list.js"),_audioTrackList2=_interopRequireDefault(_audioTrackList),_videoTrackList=require("./tracks/video-track-list.js"),_videoTrackList2=_interopRequireDefault(_videoTrackList);require("./tech/loader.js"),require("./tech/flash.js"),require("./poster-image.js"),require("./tracks/text-track-display.js"),require("./loading-spinner.js"),require("./big-play-button.js"),require("./close-button.js"),require("./control-bar/control-bar.js"),require("./error-display.js"),require("./tracks/text-track-settings.js"),require("./tech/html5.js");var TECH_EVENTS_RETRIGGER=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","ratechange","volumechange","texttrackchange"],Player=function(t){function e(i,s,r){if(_classCallCheck(this,e),i.id=i.id||"vjs_video_"+Guid.newGUID(),s=(0,_obj.assign)(e.getTagSettings(i),s),s.initChildren=!1,s.createEl=!1,s.reportTouchActivity=!1,!s.language)if("function"==typeof i.closest){var o=i.closest("[lang]");o&&(s.language=o.getAttribute("lang"))}else for(var n=i;n&&1===n.nodeType;){if(Dom.getElAttributes(n).hasOwnProperty("lang")){s.language=n.getAttribute("lang");break}n=n.parentNode}var h=_possibleConstructorReturn(this,t.call(this,null,s,r));if(!h.options_||!h.options_.techOrder||!h.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");h.tag=i,h.tagAttributes=i&&Dom.getElAttributes(i),h.language(h.options_.language),s.languages?!function(){var t={};Object.getOwnPropertyNames(s.languages).forEach(function(e){t[e.toLowerCase()]=s.languages[e]}),h.languages_=t}():h.languages_=e.prototype.options_.languages,h.cache_={},h.poster_=s.poster||"",h.controls_=!!s.controls,i.controls=!1,h.scrubbing_=!1,h.el_=h.createEl();var a=(0,_mergeOptions2.default)(h.options_);return s.plugins&&!function(){var t=s.plugins;Object.getOwnPropertyNames(t).forEach(function(e){"function"==typeof this[e]?this[e](t[e]):_log2.default.error("Unable to find plugin:",e)},h)}(),h.options_.playerOptions=a,h.initChildren(),h.isAudio("audio"===i.nodeName.toLowerCase()),h.controls()?h.addClass("vjs-controls-enabled"):h.addClass("vjs-controls-disabled"),h.el_.setAttribute("role","region"),h.isAudio()?h.el_.setAttribute("aria-label","audio player"):h.el_.setAttribute("aria-label","video player"),h.isAudio()&&h.addClass("vjs-audio"),h.flexNotSupported_()&&h.addClass("vjs-no-flex"),browser.IS_IOS||h.addClass("vjs-workinghover"),e.players[h.id_]=h,h.userActive(!0),h.reportUserActivity(),h.listenForUserActivity_(),h.on("fullscreenchange",h.handleFullscreenChange_),h.on("stageclick",h.handleStageClick_),h}return _inherits(e,t),e.prototype.dispose=function(){this.trigger("dispose"),this.off("dispose"),this.styleEl_&&this.styleEl_.parentNode&&this.styleEl_.parentNode.removeChild(this.styleEl_),e.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&this.tech_.dispose(),t.prototype.dispose.call(this)},e.prototype.createEl=function(){var e=this.tag,i=void 0,s=this.playerElIngest_=e.parentNode&&e.parentNode.hasAttribute&&e.parentNode.hasAttribute("data-vjs-player");i=s?this.el_=e.parentNode:this.el_=t.prototype.createEl.call(this,"div"),e.removeAttribute("width"),e.removeAttribute("height");var r=Dom.getElAttributes(e);if(Object.getOwnPropertyNames(r).forEach(function(t){"class"===t?i.className+=" "+r[t]:i.setAttribute(t,r[t])}),e.playerId=e.id,e.id+="_html5_api",e.className="vjs-tech",e.player=i.player=this,this.addClass("vjs-paused"),_window2.default.VIDEOJS_NO_DYNAMIC_STYLE!==!0){this.styleEl_=stylesheet.createStyleElement("vjs-styles-dimensions");var o=Dom.$(".vjs-styles-defaults"),n=Dom.$("head");n.insertBefore(this.styleEl_,o?o.nextSibling:n.firstChild)}this.width(this.options_.width),this.height(this.options_.height),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio);for(var h=e.getElementsByTagName("a"),a=0;a<h.length;a++){var l=h.item(a);Dom.addElClass(l,"vjs-hidden"),l.setAttribute("hidden","hidden")}return e.initNetworkState_=e.networkState,e.parentNode&&!s&&e.parentNode.insertBefore(i,e),Dom.insertElFirst(e,i),this.children_.unshift(e),this.el_=i,i},e.prototype.width=function(t){return this.dimension("width",t)},e.prototype.height=function(t){return this.dimension("height",t)},e.prototype.dimension=function(t,e){var i=t+"_";if(void 0===e)return this[i]||0;if(""===e)this[i]=void 0;else{var s=parseFloat(e);if(isNaN(s))return _log2.default.error('Improper value "'+e+'" supplied for for '+t),this;this[i]=s}return this.updateStyleEl_(),this},e.prototype.fluid=function(t){return void 0===t?!!this.fluid_:(this.fluid_=!!t,t?this.addClass("vjs-fluid"):this.removeClass("vjs-fluid"),void this.updateStyleEl_())},e.prototype.aspectRatio=function(t){if(void 0===t)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(t))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=t,this.fluid(!0),this.updateStyleEl_()},e.prototype.updateStyleEl_=function(){if(_window2.default.VIDEOJS_NO_DYNAMIC_STYLE===!0){var t="number"==typeof this.width_?this.width_:this.options_.width,e="number"==typeof this.height_?this.height_:this.options_.height,i=this.tech_&&this.tech_.el();return void(i&&(t>=0&&(i.width=t),e>=0&&(i.height=e)))}var s=void 0,r=void 0,o=void 0,n=void 0;o=void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:this.videoWidth()>0?this.videoWidth()+":"+this.videoHeight():"16:9";var h=o.split(":"),a=h[1]/h[0];s=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/a:this.videoWidth()||300,r=void 0!==this.height_?this.height_:s*a,n=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(n),stylesheet.setTextContent(this.styleEl_,"\n      ."+n+" {\n        width: "+s+"px;\n        height: "+r+"px;\n      }\n\n      ."+n+".vjs-fluid {\n        padding-top: "+100*a+"%;\n      }\n    ")},e.prototype.loadTech_=function(t,e){var i=this;this.tech_&&this.unloadTech_(),"Html5"!==t&&this.tag&&(_tech2.default.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=t,this.isReady_=!1;var s=(0,_obj.assign)({source:e,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+t+"_api",videoTracks:this.videoTracks_,textTracks:this.textTracks_,audioTracks:this.audioTracks_,autoplay:this.options_.autoplay,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"]},this.options_[t.toLowerCase()]);this.tag&&(s.tag=this.tag),e&&(this.currentType_=e.type,e.src===this.cache_.src&&this.cache_.currentTime>0&&(s.startTime=this.cache_.currentTime),this.cache_.sources=null,this.cache_.source=e,this.cache_.src=e.src);var r=_tech2.default.getTech(t);r||(r=_component2.default.getComponent(t)),this.tech_=new r(s),this.tech_.ready(Fn.bind(this,this.handleTechReady_),!0),_textTrackListConverter2.default.jsonToTextTracks(this.textTracksJson_||[],this.tech_),TECH_EVENTS_RETRIGGER.forEach(function(t){i.on(i.tech_,t,i["handleTech"+(0,_toTitleCase2.default)(t)+"_"])}),this.on(this.tech_,"loadstart",this.handleTechLoadStart_),this.on(this.tech_,"waiting",this.handleTechWaiting_),this.on(this.tech_,"canplay",this.handleTechCanPlay_),this.on(this.tech_,"canplaythrough",this.handleTechCanPlayThrough_),this.on(this.tech_,"playing",this.handleTechPlaying_),this.on(this.tech_,"ended",this.handleTechEnded_),this.on(this.tech_,"seeking",this.handleTechSeeking_),this.on(this.tech_,"seeked",this.handleTechSeeked_),this.on(this.tech_,"play",this.handleTechPlay_),this.on(this.tech_,"firstplay",this.handleTechFirstPlay_),this.on(this.tech_,"pause",this.handleTechPause_),this.on(this.tech_,"durationchange",this.handleTechDurationChange_),this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_),this.on(this.tech_,"error",this.handleTechError_),this.on(this.tech_,"loadedmetadata",this.updateStyleEl_),this.on(this.tech_,"posterchange",this.handleTechPosterChange_),this.on(this.tech_,"textdata",this.handleTechTextData_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||"Html5"===t&&this.tag||Dom.insertElFirst(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},e.prototype.unloadTech_=function(){this.videoTracks_=this.videoTracks(),this.textTracks_=this.textTracks(),this.audioTracks_=this.audioTracks(),this.textTracksJson_=_textTrackListConverter2.default.textTracksToJson(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1},e.prototype.tech=function(t){if(t&&t.IWillNotUseThisInPlugins)return this.tech_;var e="\n      Please make sure that you are not using this inside of a plugin.\n      To disable this alert and error, please pass in an object with\n      `IWillNotUseThisInPlugins` to the `tech` method. See\n      https://github.com/videojs/video.js/issues/2617 for more info.\n    ";throw _window2.default.alert(e),new Error(e)},e.prototype.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"mousedown",this.handleTechClick_),this.on(this.tech_,"touchstart",this.handleTechTouchStart_),this.on(this.tech_,"touchmove",this.handleTechTouchMove_),this.on(this.tech_,"touchend",this.handleTechTouchEnd_),this.on(this.tech_,"tap",this.handleTechTap_)},e.prototype.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.handleTechTap_),this.off(this.tech_,"touchstart",this.handleTechTouchStart_),this.off(this.tech_,"touchmove",this.handleTechTouchMove_),this.off(this.tech_,"touchend",this.handleTechTouchEnd_),this.off(this.tech_,"mousedown",this.handleTechClick_)},e.prototype.handleTechReady_=function(){if(this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_(),(this.src()||this.currentSrc())&&this.tag&&this.options_.autoplay&&this.paused()){try{delete this.tag.poster}catch(t){(0,_log2.default)("deleting tag.poster throws in some browsers",t)}this.play()}},e.prototype.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-seeking"),this.error(null),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay"))},e.prototype.hasStarted=function(t){return void 0!==t?(this.hasStarted_!==t&&(this.hasStarted_=t,t?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started")),this):!!this.hasStarted_},e.prototype.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},e.prototype.handleTechWaiting_=function(){var t=this;this.addClass("vjs-waiting"),this.trigger("waiting"),this.one("timeupdate",function(){return t.removeClass("vjs-waiting")})},e.prototype.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},e.prototype.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},e.prototype.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},e.prototype.handleTechSeeking_=function(){this.addClass("vjs-seeking"),this.trigger("seeking")},e.prototype.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.trigger("seeked")},e.prototype.handleTechFirstPlay_=function(){this.options_.starttime&&(_log2.default.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},e.prototype.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},e.prototype.handleTechEnded_=function(){this.addClass("vjs-ended"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},e.prototype.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},e.prototype.handleTechClick_=function(t){0===t.button&&this.controls()&&(this.paused()?this.play():this.pause())},e.prototype.handleTechTap_=function(){this.userActive(!this.userActive())},e.prototype.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},e.prototype.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},e.prototype.handleTechTouchEnd_=function(t){t.preventDefault()},e.prototype.handleFullscreenChange_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},e.prototype.handleStageClick_=function(){this.reportUserActivity()},e.prototype.handleTechFullscreenChange_=function(t,e){e&&this.isFullscreen(e.isFullscreen),this.trigger("fullscreenchange")},e.prototype.handleTechError_=function(){var t=this.tech_.error();this.error(t)},e.prototype.handleTechTextData_=function(){var t=null;arguments.length>1&&(t=arguments[1]),this.trigger("textdata",t)},e.prototype.getCache=function(){return this.cache_},e.prototype.techCall_=function(t,e){if(this.tech_&&!this.tech_.isReady_)this.tech_.ready(function(){this[t](e)},!0);else try{this.tech_&&this.tech_[t](e)}catch(t){throw(0,_log2.default)(t),t}},e.prototype.techGet_=function(t){if(this.tech_&&this.tech_.isReady_)try{return this.tech_[t]()}catch(e){throw void 0===this.tech_[t]?(0,_log2.default)("Video.js: "+t+" method not defined for "+this.techName_+" playback technology.",e):"TypeError"===e.name?((0,_log2.default)("Video.js: "+t+" unavailable on "+this.techName_+" playback technology element.",e),this.tech_.isReady_=!1):(0,_log2.default)(e),e}},e.prototype.play=function(){return this.src()||this.currentSrc()?this.techCall_("play"):this.tech_.one("loadstart",function(){this.play()}),this},e.prototype.pause=function(){return this.techCall_("pause"),this},e.prototype.paused=function(){return this.techGet_("paused")!==!1},e.prototype.scrubbing=function(t){return void 0!==t?(this.scrubbing_=!!t,t?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing"),this):this.scrubbing_},e.prototype.currentTime=function(t){return void 0!==t?(this.techCall_("setCurrentTime",t),this):(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime)},e.prototype.duration=function(t){return void 0===t?this.cache_.duration||0:(t=parseFloat(t)||0,t<0&&(t=1/0),t!==this.cache_.duration&&(this.cache_.duration=t,t===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),this.trigger("durationchange")),this)},e.prototype.remainingTime=function(){return this.duration()-this.currentTime()},e.prototype.buffered=function t(){var t=this.techGet_("buffered");return t&&t.length||(t=(0,_timeRanges.createTimeRange)(0,0)),t},e.prototype.bufferedPercent=function(){return(0,_buffer.bufferedPercent)(this.buffered(),this.duration())},e.prototype.bufferedEnd=function(){var t=this.buffered(),e=this.duration(),i=t.end(t.length-1);return i>e&&(i=e),i},e.prototype.volume=function(t){var e=void 0;return void 0!==t?(e=Math.max(0,Math.min(1,parseFloat(t))),this.cache_.volume=e,this.techCall_("setVolume",e),this):(e=parseFloat(this.techGet_("volume")),isNaN(e)?1:e)},e.prototype.muted=function(t){return void 0!==t?(this.techCall_("setMuted",t),this):this.techGet_("muted")||!1},e.prototype.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},e.prototype.isFullscreen=function(t){return void 0!==t?(this.isFullscreen_=!!t,this):!!this.isFullscreen_},e.prototype.requestFullscreen=function(){var t=_fullscreenApi2.default;return this.isFullscreen(!0),t.requestFullscreen?(Events.on(_document2.default,t.fullscreenchange,Fn.bind(this,function e(i){this.isFullscreen(_document2.default[t.fullscreenElement]),this.isFullscreen()===!1&&Events.off(_document2.default,t.fullscreenchange,e),this.trigger("fullscreenchange")})),this.el_[t.requestFullscreen]()):this.tech_.supportsFullScreen()?this.techCall_("enterFullScreen"):(this.enterFullWindow(),this.trigger("fullscreenchange")),this},e.prototype.exitFullscreen=function(){var t=_fullscreenApi2.default;return this.isFullscreen(!1),t.requestFullscreen?_document2.default[t.exitFullscreen]():this.tech_.supportsFullScreen()?this.techCall_("exitFullScreen"):(this.exitFullWindow(),this.trigger("fullscreenchange")),this},e.prototype.enterFullWindow=function(){this.isFullWindow=!0,this.docOrigOverflow=_document2.default.documentElement.style.overflow,Events.on(_document2.default,"keydown",Fn.bind(this,this.fullWindowOnEscKey)),_document2.default.documentElement.style.overflow="hidden",Dom.addElClass(_document2.default.body,"vjs-full-window"),this.trigger("enterFullWindow")},e.prototype.fullWindowOnEscKey=function(t){27===t.keyCode&&(this.isFullscreen()===!0?this.exitFullscreen():this.exitFullWindow())},e.prototype.exitFullWindow=function(){this.isFullWindow=!1,Events.off(_document2.default,"keydown",this.fullWindowOnEscKey),_document2.default.documentElement.style.overflow=this.docOrigOverflow,Dom.removeElClass(_document2.default.body,"vjs-full-window"),this.trigger("exitFullWindow")},e.prototype.canPlayType=function(t){for(var e=void 0,i=0,s=this.options_.techOrder;i<s.length;i++){var r=(0,_toTitleCase2.default)(s[i]),o=_tech2.default.getTech(r);if(o||(o=_component2.default.getComponent(r)),o){if(o.isSupported()&&(e=o.canPlayType(t)))return e}else _log2.default.error('The "'+r+'" tech is undefined. Skipped browser support check for that tech.')}return""},e.prototype.selectSource=function(t){var e=this,i=this.options_.techOrder.map(_toTitleCase2.default).map(function(t){return[t,_tech2.default.getTech(t)||_component2.default.getComponent(t)]}).filter(function(t){var e=t[0],i=t[1];return i?i.isSupported():(_log2.default.error('The "'+e+'" tech is undefined. Skipped browser support check for that tech.'),!1)}),s=function(t,e,i){var s=void 0;return t.some(function(t){return e.some(function(e){if(s=i(t,e))return!0})}),s},r=void 0,o=function(t){return function(e,i){return t(i,e)}},n=function(t,i){var s=t[0],r=t[1];if(r.canPlaySource(i,e.options_[s.toLowerCase()]))return{source:i,tech:s}};return r=this.options_.sourceOrder?s(t,i,o(n)):s(i,t,n),r||!1},e.prototype.src=function(t){if(void 0===t)return this.techGet_("src");var e=_tech2.default.getTech(this.techName_);return e||(e=_component2.default.getComponent(this.techName_)),Array.isArray(t)?this.sourceList_(t):"string"==typeof t?this.src({src:t}):t instanceof Object&&(t.type&&!e.canPlaySource(t,this.options_[this.techName_.toLowerCase()])?this.sourceList_([t]):(this.cache_.sources=null,this.cache_.source=t,this.cache_.src=t.src,this.currentType_=t.type||"",this.ready(function(){e.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",t):this.techCall_("src",t.src),"auto"===this.options_.preload&&this.load(),this.options_.autoplay&&this.play()},!0))),this},e.prototype.sourceList_=function(t){var e=this.selectSource(t);e?(e.tech===this.techName_?this.src(e.source):this.loadTech_(e.tech,e.source),this.cache_.sources=t):(this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0),this.triggerReady())},e.prototype.load=function(){return this.techCall_("load"),this},e.prototype.reset=function(){return this.loadTech_((0,_toTitleCase2.default)(this.options_.techOrder[0]),null),this.techCall_("reset"),this},e.prototype.currentSources=function(){var t=this.currentSource(),e=[];return 0!==Object.keys(t).length&&e.push(t),this.cache_.sources||e},e.prototype.currentSource=function(){var t={},e=this.currentSrc();return e&&(t.src=e),this.cache_.source||t},e.prototype.currentSrc=function(){return this.techGet_("currentSrc")||this.cache_.src||""},e.prototype.currentType=function(){return this.currentType_||""},e.prototype.preload=function(t){return void 0!==t?(this.techCall_("setPreload",t),this.options_.preload=t,this):this.techGet_("preload")},e.prototype.autoplay=function(t){return void 0!==t?(this.techCall_("setAutoplay",t),this.options_.autoplay=t,this):this.techGet_("autoplay",t)},e.prototype.loop=function(t){return void 0!==t?(this.techCall_("setLoop",t),this.options_.loop=t,this):this.techGet_("loop")},e.prototype.poster=function(t){return void 0===t?this.poster_:(t||(t=""),this.poster_=t,this.techCall_("setPoster",t),this.trigger("posterchange"),this)},e.prototype.handleTechPosterChange_=function(){!this.poster_&&this.tech_&&this.tech_.poster&&(this.poster_=this.tech_.poster()||"",this.trigger("posterchange"))},e.prototype.controls=function(t){return void 0!==t?(t=!!t,this.controls_!==t&&(this.controls_=t,this.usingNativeControls()&&this.techCall_("setControls",t),t?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_())),this):!!this.controls_},e.prototype.usingNativeControls=function(t){return void 0!==t?(t=!!t,this.usingNativeControls_!==t&&(this.usingNativeControls_=t,t?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols"))),this):!!this.usingNativeControls_},e.prototype.error=function(t){return void 0===t?this.error_||null:null===t?(this.error_=t,this.removeClass("vjs-error"),this.errorDisplay&&this.errorDisplay.close(),this):(this.error_=new _mediaError2.default(t),this.addClass("vjs-error"),_log2.default.error("(CODE:"+this.error_.code+" "+_mediaError2.default.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this.trigger("error"),this)},e.prototype.reportUserActivity=function(t){this.userActivity_=!0},e.prototype.userActive=function(t){return void 0!==t?(t=!!t,t!==this.userActive_&&(this.userActive_=t,t?(this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive")):(this.userActivity_=!1,this.tech_&&this.tech_.one("mousemove",function(t){t.stopPropagation(),t.preventDefault()}),this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive"))),this):this.userActive_},e.prototype.listenForUserActivity_=function(){var t=void 0,e=void 0,i=void 0,s=Fn.bind(this,this.reportUserActivity),r=function(t){t.screenX===e&&t.screenY===i||(e=t.screenX,i=t.screenY,s())},o=function(){s(),this.clearInterval(t),t=this.setInterval(s,250)},n=function(e){s(),this.clearInterval(t)};this.on("mousedown",o),this.on("mousemove",r),this.on("mouseup",n),this.on("keydown",s),this.on("keyup",s);var h=void 0;this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(h);var t=this.options_.inactivityTimeout;t>0&&(h=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},t))}},250)},e.prototype.playbackRate=function(t){return void 0!==t?(this.techCall_("setPlaybackRate",t),this):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("playbackRate"):1},e.prototype.isAudio=function(t){return void 0!==t?(this.isAudio_=!!t,this):!!this.isAudio_},e.prototype.videoTracks=function(){return this.tech_?this.tech_.videoTracks():(this.videoTracks_=this.videoTracks_||new _videoTrackList2.default,this.videoTracks_)},e.prototype.audioTracks=function(){return this.tech_?this.tech_.audioTracks():(this.audioTracks_=this.audioTracks_||new _audioTrackList2.default,this.audioTracks_)},e.prototype.textTracks=function(){if(this.tech_)return this.tech_.textTracks()},e.prototype.remoteTextTracks=function(){if(this.tech_)return this.tech_.remoteTextTracks()},e.prototype.remoteTextTrackEls=function(){if(this.tech_)return this.tech_.remoteTextTrackEls()},e.prototype.addTextTrack=function(t,e,i){if(this.tech_)return this.tech_.addTextTrack(t,e,i)},e.prototype.addRemoteTextTrack=function(t,e){if(this.tech_)return this.tech_.addRemoteTextTrack(t,e)},e.prototype.removeRemoteTextTrack=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.track,i=void 0===e?arguments[0]:e;if(this.tech_)return this.tech_.removeRemoteTextTrack(i)},e.prototype.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},e.prototype.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},e.prototype.language=function(t){return void 0===t?this.language_:(this.language_=String(t).toLowerCase(),this)},e.prototype.languages=function(){return(0,_mergeOptions2.default)(e.prototype.options_.languages,this.languages_)},e.prototype.toJSON=function(){var t=(0,_mergeOptions2.default)(this.options_),e=t.tracks;t.tracks=[];for(var i=0;i<e.length;i++){var s=e[i];s=(0,_mergeOptions2.default)(s),s.player=void 0,t.tracks[i]=s}return t},e.prototype.createModal=function(t,e){var i=this;e=e||{},e.content=t||"";var s=new _modalDialog2.default(this,e);return this.addChild(s),s.on("dispose",function(){i.removeChild(s)}),s.open()},e.getTagSettings=function(t){var e={sources:[],tracks:[]},i=Dom.getElAttributes(t),s=i["data-setup"];if(Dom.hasElClass(t,"vjs-fluid")&&(i.fluid=!0),null!==s){var r=(0,_tuple2.default)(s||"{}"),o=r[0],n=r[1];o&&_log2.default.error(o),(0,_obj.assign)(i,n)}if((0,_obj.assign)(e,i),t.hasChildNodes())for(var h=t.childNodes,a=0,l=h.length;a<l;a++){var c=h[a],u=c.nodeName.toLowerCase();"source"===u?e.sources.push(Dom.getElAttributes(c)):"track"===u&&e.tracks.push(Dom.getElAttributes(c))}return e},e.prototype.flexNotSupported_=function(){var t=_document2.default.createElement("i");return!("flexBasis"in t.style||"webkitFlexBasis"in t.style||"mozFlexBasis"in t.style||"msFlexBasis"in t.style||"msFlexOrder"in t.style)},e}(_component2.default);Player.players={};var navigator=_window2.default.navigator;Player.prototype.options_={techOrder:["html5","flash"],html5:{},flash:{},defaultVolume:0,inactivityTimeout:2e3,playbackRates:[],children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","controlBar","errorDisplay","textTrackSettings"],language:navigator&&(navigator.languages&&navigator.languages[0]||navigator.userLanguage||navigator.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media."},["ended","seeking","seekable","networkState","readyState"].forEach(function(t){Player.prototype[t]=function(){return this.techGet_(t)}}),TECH_EVENTS_RETRIGGER.forEach(function(t){Player.prototype["handleTech"+(0,_toTitleCase2.default)(t)+"_"]=function(){return this.trigger(t)}}),_component2.default.registerComponent("Player",Player),exports.default=Player;
},{"./big-play-button.js":220,"./close-button.js":223,"./component.js":224,"./control-bar/control-bar.js":227,"./error-display.js":260,"./fullscreen-api.js":263,"./loading-spinner.js":264,"./media-error.js":265,"./modal-dialog":269,"./poster-image.js":274,"./tech/flash.js":278,"./tech/html5.js":279,"./tech/loader.js":280,"./tech/tech.js":281,"./tracks/audio-track-list.js":282,"./tracks/text-track-display.js":287,"./tracks/text-track-list-converter.js":288,"./tracks/text-track-settings.js":290,"./tracks/video-track-list.js":295,"./utils/browser.js":297,"./utils/buffer.js":298,"./utils/dom.js":300,"./utils/events.js":301,"./utils/fn.js":302,"./utils/guid.js":304,"./utils/log.js":305,"./utils/merge-options.js":306,"./utils/obj":307,"./utils/stylesheet.js":308,"./utils/time-ranges.js":309,"./utils/to-title-case.js":310,"global/document":193,"global/window":194,"safe-json-parse/tuple":213}],271:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}exports.__esModule=!0;var _player=require("./player.js"),_player2=_interopRequireDefault(_player),plugin=function(e,r){_player2.default.prototype[e]=r};exports.default=plugin;
},{"./player.js":270}],272:[function(require,module,exports){
"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}exports.__esModule=!0;var _clickableComponent=require("../clickable-component.js"),_clickableComponent2=_interopRequireDefault(_clickableComponent),_component=require("../component.js"),_component2=_interopRequireDefault(_component),PopupButton=function(t){function e(o){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,e);var i=_possibleConstructorReturn(this,t.call(this,o,n));return i.update(),i}return _inherits(e,t),e.prototype.update=function(){var t=this.createPopup();this.popup&&this.removeChild(this.popup),this.popup=t,this.addChild(t),this.items&&0===this.items.length?this.hide():this.items&&this.items.length>1&&this.show()},e.prototype.createPopup=function(){},e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},e.prototype.buildCSSClass=function(){var e="vjs-menu-button";return e+=this.options_.inline===!0?"-inline":"-popup","vjs-menu-button "+e+" "+t.prototype.buildCSSClass.call(this)},e}(_clickableComponent2.default);_component2.default.registerComponent("PopupButton",PopupButton),exports.default=PopupButton;
},{"../clickable-component.js":222,"../component.js":224}],273:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _component=require("../component.js"),_component2=_interopRequireDefault(_component),_dom=require("../utils/dom.js"),Dom=_interopRequireWildcard(_dom),_fn=require("../utils/fn.js"),Fn=_interopRequireWildcard(_fn),_events=require("../utils/events.js"),Events=_interopRequireWildcard(_events),Popup=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,e.apply(this,arguments))}return _inherits(t,e),t.prototype.addItem=function(e){this.addChild(e),e.on("click",Fn.bind(this,function(){this.unlockShowing()}))},t.prototype.createEl=function(){var t=this.options_.contentElType||"ul";this.contentEl_=Dom.createEl(t,{className:"vjs-menu-content"});var n=e.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return n.appendChild(this.contentEl_),Events.on(n,"click",function(e){e.preventDefault(),e.stopImmediatePropagation()}),n},t}(_component2.default);_component2.default.registerComponent("Popup",Popup),exports.default=Popup;
},{"../component.js":224,"../utils/dom.js":300,"../utils/events.js":301,"../utils/fn.js":302}],274:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _clickableComponent=require("./clickable-component.js"),_clickableComponent2=_interopRequireDefault(_clickableComponent),_component=require("./component.js"),_component2=_interopRequireDefault(_component),_fn=require("./utils/fn.js"),Fn=_interopRequireWildcard(_fn),_dom=require("./utils/dom.js"),Dom=_interopRequireWildcard(_dom),_browser=require("./utils/browser.js"),browser=_interopRequireWildcard(_browser),PosterImage=function(e){function t(r,o){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,e.call(this,r,o));return n.update(),r.on("posterchange",Fn.bind(n,n.update)),n}return _inherits(t,e),t.prototype.dispose=function(){this.player().off("posterchange",this.update),e.prototype.dispose.call(this)},t.prototype.createEl=function(){var e=Dom.createEl("div",{className:"vjs-poster",tabIndex:-1});return browser.BACKGROUND_SIZE_SUPPORTED||(this.fallbackImg_=Dom.createEl("img"),e.appendChild(this.fallbackImg_)),e},t.prototype.update=function(e){var t=this.player().poster();this.setSrc(t),t?this.show():this.hide()},t.prototype.setSrc=function(e){if(this.fallbackImg_)this.fallbackImg_.src=e;else{var t="";e&&(t='url("'+e+'")'),this.el_.style.backgroundImage=t}},t.prototype.handleClick=function(e){this.player_.controls()&&(this.player_.paused()?this.player_.play():this.player_.pause())},t}(_clickableComponent2.default);_component2.default.registerComponent("PosterImage",PosterImage),exports.default=PosterImage;
},{"./clickable-component.js":222,"./component.js":224,"./utils/browser.js":297,"./utils/dom.js":300,"./utils/fn.js":302}],275:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function autoSetupTimeout(e,t){t&&(videojs=t),_window2.default.setTimeout(autoSetup,e)}exports.__esModule=!0,exports.hasLoaded=exports.autoSetupTimeout=exports.autoSetup=void 0;var _dom=require("./utils/dom"),Dom=_interopRequireWildcard(_dom),_events=require("./utils/events.js"),Events=_interopRequireWildcard(_events),_document=require("global/document"),_document2=_interopRequireDefault(_document),_window=require("global/window"),_window2=_interopRequireDefault(_window),_windowLoaded=!1,videojs=void 0,autoSetup=function(){if(Dom.isReal()){var e=_document2.default.getElementsByTagName("video"),t=_document2.default.getElementsByTagName("audio"),o=[];if(e&&e.length>0)for(var u=0,i=e.length;u<i;u++)o.push(e[u]);if(t&&t.length>0)for(var d=0,a=t.length;d<a;d++)o.push(t[d]);if(o&&o.length>0)for(var r=0,n=o.length;r<n;r++){var l=o[r];if(!l||!l.getAttribute){autoSetupTimeout(1);break}if(void 0===l.player){var s=l.getAttribute("data-setup");null!==s&&videojs(l)}}else _windowLoaded||autoSetupTimeout(1)}};Dom.isReal()&&"complete"===_document2.default.readyState?_windowLoaded=!0:Events.one(_window2.default,"load",function(){_windowLoaded=!0});var hasLoaded=function(){return _windowLoaded};exports.autoSetup=autoSetup,exports.autoSetupTimeout=autoSetupTimeout,exports.hasLoaded=hasLoaded;
},{"./utils/dom":300,"./utils/events.js":301,"global/document":193,"global/window":194}],276:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _component=require("../component.js"),_component2=_interopRequireDefault(_component),_dom=require("../utils/dom.js"),Dom=_interopRequireWildcard(_dom),_obj=require("../utils/obj"),Slider=function(e){function t(o,n){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,e.call(this,o,n));return i.bar=i.getChild(i.options_.barName),i.vertical(!!i.options_.vertical),i.on("mousedown",i.handleMouseDown),i.on("touchstart",i.handleMouseDown),i.on("focus",i.handleFocus),i.on("blur",i.handleBlur),i.on("click",i.handleClick),i.on(o,"controlsvisible",i.update),i.on(o,i.playerEvent,i.update),i}return _inherits(t,e),t.prototype.createEl=function(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return o.className=o.className+" vjs-slider",o=(0,_obj.assign)({tabIndex:0},o),n=(0,_obj.assign)({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},n),e.prototype.createEl.call(this,t,o,n)},t.prototype.handleMouseDown=function(e){var t=this.bar.el_.ownerDocument;e.preventDefault(),Dom.blockTextSelection(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(t,"mousemove",this.handleMouseMove),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchmove",this.handleMouseMove),this.on(t,"touchend",this.handleMouseUp),this.handleMouseMove(e)},t.prototype.handleMouseMove=function(e){},t.prototype.handleMouseUp=function(){var e=this.bar.el_.ownerDocument;Dom.unblockTextSelection(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.update()},t.prototype.update=function(){if(this.el_){var e=this.getPercent(),t=this.bar;if(t){("number"!=typeof e||e!==e||e<0||e===1/0)&&(e=0);var o=(100*e).toFixed(2)+"%";this.vertical()?t.el().style.height=o:t.el().style.width=o}}},t.prototype.calculateDistance=function(e){var t=Dom.getPointerPosition(this.el_,e);return this.vertical()?t.y:t.x},t.prototype.handleFocus=function(){this.on(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress)},t.prototype.handleKeyPress=function(e){37===e.which||40===e.which?(e.preventDefault(),this.stepBack()):38!==e.which&&39!==e.which||(e.preventDefault(),this.stepForward())},t.prototype.handleBlur=function(){this.off(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress)},t.prototype.handleClick=function(e){e.stopImmediatePropagation(),e.preventDefault()},t.prototype.vertical=function(e){return void 0===e?this.vertical_||!1:(this.vertical_=!!e,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal"),this)},t}(_component2.default);_component2.default.registerComponent("Slider",Slider),exports.default=Slider;
},{"../component.js":224,"../utils/dom.js":300,"../utils/obj":307}],277:[function(require,module,exports){
"use strict";function FlashRtmpDecorator(r){return r.streamingFormats={"rtmp/mp4":"MP4","rtmp/flv":"FLV"},r.streamFromParts=function(r,t){return r+"&"+t},r.streamToParts=function(r){var t={connection:"",stream:""};if(!r)return t;var e=r.search(/&(?!\w+=)/),n=void 0;return e!==-1?n=e+1:(e=n=r.lastIndexOf("/")+1,0===e&&(e=n=r.length)),t.connection=r.substring(0,e),t.stream=r.substring(n,r.length),t},r.isStreamingType=function(t){return t in r.streamingFormats},r.RTMP_RE=/^rtmp[set]?:\/\//i,r.isStreamingSrc=function(t){return r.RTMP_RE.test(t)},r.rtmpSourceHandler={},r.rtmpSourceHandler.canPlayType=function(t){return r.isStreamingType(t)?"maybe":""},r.rtmpSourceHandler.canHandleSource=function(t,e){var n=r.rtmpSourceHandler.canPlayType(t.type);return n?n:r.isStreamingSrc(t.src)?"maybe":""},r.rtmpSourceHandler.handleSource=function(t,e,n){var a=r.streamToParts(t.src);e.setRtmpConnection(a.connection),e.setRtmpStream(a.stream)},r.registerSourceHandler(r.rtmpSourceHandler),r}exports.__esModule=!0,exports.default=FlashRtmpDecorator;
},{}],278:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _createSetter(e){var t=e.charAt(0).toUpperCase()+e.slice(1);_api["set"+t]=function(t){return this.el_.vjs_setProperty(e,t)}}function _createGetter(e){_api[e]=function(){return this.el_.vjs_getProperty(e)}}exports.__esModule=!0;for(var _tech=require("./tech"),_tech2=_interopRequireDefault(_tech),_dom=require("../utils/dom.js"),Dom=_interopRequireWildcard(_dom),_url=require("../utils/url.js"),Url=_interopRequireWildcard(_url),_timeRanges=require("../utils/time-ranges.js"),_flashRtmp=require("./flash-rtmp"),_flashRtmp2=_interopRequireDefault(_flashRtmp),_component=require("../component"),_component2=_interopRequireDefault(_component),_window=require("global/window"),_window2=_interopRequireDefault(_window),_obj=require("../utils/obj"),navigator=_window2.default.navigator,Flash=function(e){function t(r,o){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,e.call(this,r,o));return r.source&&n.ready(function(){this.setSource(r.source)},!0),r.startTime&&n.ready(function(){this.load(),this.play(),this.currentTime(r.startTime)},!0),_window2.default.videojs=_window2.default.videojs||{},_window2.default.videojs.Flash=_window2.default.videojs.Flash||{},_window2.default.videojs.Flash.onReady=t.onReady,_window2.default.videojs.Flash.onEvent=t.onEvent,_window2.default.videojs.Flash.onError=t.onError,n.on("seeked",function(){this.lastSeekTarget_=void 0}),n}return _inherits(t,e),t.prototype.createEl=function(){var e=this.options_;if(!e.swf){var r="5.1.0";e.swf="//vjs.zencdn.net/swf/"+r+"/video-js.swf"}var o=e.techId,n=(0,_obj.assign)({readyFunction:"videojs.Flash.onReady",eventProxyFunction:"videojs.Flash.onEvent",errorEventProxyFunction:"videojs.Flash.onError",autoplay:e.autoplay,preload:e.preload,loop:e.loop,muted:e.muted},e.flashVars),a=(0,_obj.assign)({wmode:"opaque",bgcolor:"#000000"},e.params),i=(0,_obj.assign)({id:o,name:o,class:"vjs-tech"},e.attributes);return this.el_=t.embed(e.swf,n,a,i),this.el_.tech=this,this.el_},t.prototype.play=function(){this.ended()&&this.setCurrentTime(0),this.el_.vjs_play()},t.prototype.pause=function(){this.el_.vjs_pause()},t.prototype.src=function(e){return void 0===e?this.currentSrc():this.setSrc(e)},t.prototype.setSrc=function(e){var t=this;e=Url.getAbsoluteURL(e),this.el_.vjs_src(e),this.autoplay()&&this.setTimeout(function(){return t.play()},0)},t.prototype.seeking=function(){return void 0!==this.lastSeekTarget_},t.prototype.setCurrentTime=function(t){var r=this.seekable();r.length&&(t=t>r.start(0)?t:r.start(0),t=t<r.end(r.length-1)?t:r.end(r.length-1),this.lastSeekTarget_=t,this.trigger("seeking"),this.el_.vjs_setProperty("currentTime",t),e.prototype.setCurrentTime.call(this))},t.prototype.currentTime=function(){return this.seeking()?this.lastSeekTarget_||0:this.el_.vjs_getProperty("currentTime")},t.prototype.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.vjs_getProperty("currentSrc")},t.prototype.duration=function e(){if(0===this.readyState())return NaN;var e=this.el_.vjs_getProperty("duration");return e>=0?e:1/0},t.prototype.load=function(){this.el_.vjs_load()},t.prototype.poster=function(){this.el_.vjs_getProperty("poster")},t.prototype.setPoster=function(){},t.prototype.seekable=function(){var e=this.duration();return 0===e?(0,_timeRanges.createTimeRange)():(0,_timeRanges.createTimeRange)(0,e)},t.prototype.buffered=function(){var e=this.el_.vjs_getProperty("buffered");return 0===e.length?(0,_timeRanges.createTimeRange)():(0,_timeRanges.createTimeRange)(e[0][0],e[0][1])},t.prototype.supportsFullScreen=function(){return!1},t.prototype.enterFullScreen=function(){return!1},t}(_tech2.default),_api=Flash.prototype,_readWrite="rtmpConnection,rtmpStream,preload,defaultPlaybackRate,playbackRate,autoplay,loop,mediaGroup,controller,controls,volume,muted,defaultMuted".split(","),_readOnly="networkState,readyState,initialTime,startOffsetTime,paused,ended,videoWidth,videoHeight".split(","),i=0;i<_readWrite.length;i++)_createGetter(_readWrite[i]),_createSetter(_readWrite[i]);for(var _i=0;_i<_readOnly.length;_i++)_createGetter(_readOnly[_i]);Flash.isSupported=function(){return Flash.version()[0]>=10},_tech2.default.withSourceHandlers(Flash),Flash.nativeSourceHandler={},Flash.nativeSourceHandler.canPlayType=function(e){return e in Flash.formats?"maybe":""},Flash.nativeSourceHandler.canHandleSource=function(e,t){function r(e){var t=Url.getFileExtension(e);return t?"video/"+t:""}var o=void 0;return o=e.type?e.type.replace(/;.*/,"").toLowerCase():r(e.src),Flash.nativeSourceHandler.canPlayType(o)},Flash.nativeSourceHandler.handleSource=function(e,t,r){t.setSrc(e.src)},Flash.nativeSourceHandler.dispose=function(){},Flash.registerSourceHandler(Flash.nativeSourceHandler),Flash.formats={"video/flv":"FLV","video/x-flv":"FLV","video/mp4":"MP4","video/m4v":"MP4"},Flash.onReady=function(e){var t=Dom.getEl(e),r=t&&t.tech;r&&r.el()&&Flash.checkReady(r)},Flash.checkReady=function(e){e.el()&&(e.el().vjs_getProperty?e.triggerReady():this.setTimeout(function(){Flash.checkReady(e)},50))},Flash.onEvent=function(e,t){var r=Dom.getEl(e).tech,o=Array.prototype.slice.call(arguments,2);r.setTimeout(function(){r.trigger(t,o)},1)},Flash.onError=function(e,t){var r=Dom.getEl(e).tech;return"srcnotfound"===t?r.error(4):void r.error("FLASH: "+t)},Flash.version=function(){var e="0,0,0";try{e=new _window2.default.ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(t){try{navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin&&(e=(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1])}catch(e){}}return e.split(",")},Flash.embed=function(e,t,r,o){var n=Flash.getEmbedCode(e,t,r,o),a=Dom.createEl("div",{innerHTML:n}).childNodes[0];return a},Flash.getEmbedCode=function(e,t,r,o){var n='<object type="application/x-shockwave-flash" ',a="",i="",s="";return t&&Object.getOwnPropertyNames(t).forEach(function(e){a+=e+"="+t[e]+"&amp;"}),r=(0,_obj.assign)({movie:e,flashvars:a,allowScriptAccess:"always",allowNetworking:"all"},r),Object.getOwnPropertyNames(r).forEach(function(e){i+='<param name="'+e+'" value="'+r[e]+'" />'}),o=(0,_obj.assign)({data:e,width:"100%",height:"100%"},o),Object.getOwnPropertyNames(o).forEach(function(e){s+=e+'="'+o[e]+'" '}),""+n+s+">"+i+"</object>"},(0,_flashRtmp2.default)(Flash),_component2.default.registerComponent("Flash",Flash),_tech2.default.registerTech("Flash",Flash),exports.default=Flash;
},{"../component":224,"../utils/dom.js":300,"../utils/obj":307,"../utils/time-ranges.js":309,"../utils/url.js":311,"./flash-rtmp":277,"./tech":281,"global/window":194}],279:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _taggedTemplateLiteralLoose(e,t){return e.raw=t,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_templateObject=_taggedTemplateLiteralLoose(["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n            This may prevent text tracks from loading."],["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n            This may prevent text tracks from loading."]),_tech=require("./tech.js"),_tech2=_interopRequireDefault(_tech),_component=require("../component"),_component2=_interopRequireDefault(_component),_dom=require("../utils/dom.js"),Dom=_interopRequireWildcard(_dom),_url=require("../utils/url.js"),Url=_interopRequireWildcard(_url),_fn=require("../utils/fn.js"),Fn=_interopRequireWildcard(_fn),_log=require("../utils/log.js"),_log2=_interopRequireDefault(_log),_tsml=require("tsml"),_tsml2=_interopRequireDefault(_tsml),_browser=require("../utils/browser.js"),browser=_interopRequireWildcard(_browser),_document=require("global/document"),_document2=_interopRequireDefault(_document),_window=require("global/window"),_window2=_interopRequireDefault(_window),_obj=require("../utils/obj"),_mergeOptions=require("../utils/merge-options.js"),_mergeOptions2=_interopRequireDefault(_mergeOptions),_toTitleCase=require("../utils/to-title-case.js"),_toTitleCase2=_interopRequireDefault(_toTitleCase),Html5=function(e){function t(r,o){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,e.call(this,r,o)),n=r.source,i=!1;if(n&&(a.el_.currentSrc!==n.src||r.tag&&3===r.tag.initNetworkState_)?a.setSource(n):a.handleLateInit_(a.el_),a.el_.hasChildNodes()){for(var l=a.el_.childNodes,s=l.length,c=[];s--;){var u=l[s],d=u.nodeName.toLowerCase();"track"===d&&(a.featuresNativeTextTracks?(a.remoteTextTrackEls().addTrackElement_(u),a.remoteTextTracks().addTrack_(u.track),i||a.el_.hasAttribute("crossorigin")||!Url.isCrossOrigin(u.src)||(i=!0)):c.push(u))}for(var p=0;p<c.length;p++)a.el_.removeChild(c[p])}var f=["audio","video"];return f.forEach(function(e){var t=a.el()[e+"Tracks"],r=a[e+"Tracks"](),o=(0,_toTitleCase2.default)(e);a["featuresNative"+o+"Tracks"]&&t&&t.addEventListener&&(a["handle"+o+"TrackChange_"]=function(e){r.trigger({type:"change",target:r,currentTarget:r,srcElement:r})},a["handle"+o+"TrackAdd_"]=function(e){return r.addTrack(e.track)},a["handle"+o+"TrackRemove_"]=function(e){return r.removeTrack(e.track)},t.addEventListener("change",a["handle"+o+"TrackChange_"]),t.addEventListener("addtrack",a["handle"+o+"TrackAdd_"]),t.addEventListener("removetrack",a["handle"+o+"TrackRemove_"]),a["removeOld"+o+"Tracks_"]=function(e){return a.removeOldTracks_(r,t)},a.on("loadstart",a["removeOld"+o+"Tracks_"]))}),a.featuresNativeTextTracks&&(i&&_log2.default.warn((0,_tsml2.default)(_templateObject)),a.handleTextTrackChange_=Fn.bind(a,a.handleTextTrackChange),a.handleTextTrackAdd_=Fn.bind(a,a.handleTextTrackAdd),a.handleTextTrackRemove_=Fn.bind(a,a.handleTextTrackRemove),a.proxyNativeTextTracks_()),(browser.TOUCH_ENABLED||browser.IS_IPHONE||browser.IS_NATIVE_ANDROID)&&r.nativeControlsForTouch===!0&&a.setControls(!0),a.proxyWebkitFullscreen_(),a.triggerReady(),a}return _inherits(t,e),t.prototype.dispose=function(){var r=this;["audio","video","text"].forEach(function(e){var t=(0,_toTitleCase2.default)(e),o=r.el_[e+"Tracks"];o&&o.removeEventListener&&(o.removeEventListener("change",r["handle"+t+"TrackChange_"]),o.removeEventListener("addtrack",r["handle"+t+"TrackAdd_"]),o.removeEventListener("removetrack",r["handle"+t+"TrackRemove_"])),o&&r.off("loadstart",r["removeOld"+t+"Tracks_"])}),t.disposeMediaElement(this.el_),e.prototype.dispose.call(this)},t.prototype.createEl=function(){var e=this.options_.tag;if(!e||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(e){var r=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(r,e),t.disposeMediaElement(e),e=r}else{e=_document2.default.createElement("video");var o=this.options_.tag&&Dom.getElAttributes(this.options_.tag),a=(0,_mergeOptions2.default)({},o);browser.TOUCH_ENABLED&&this.options_.nativeControlsForTouch===!0||delete a.controls,Dom.setElAttributes(e,(0,_obj.assign)(a,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}for(var n=["autoplay","preload","loop","muted"],i=n.length-1;i>=0;i--){var l=n[i],s={};"undefined"!=typeof this.options_[l]&&(s[l]=this.options_[l]),Dom.setElAttributes(e,s)}return e},t.prototype.handleLateInit_=function(e){var t=this;if(0!==e.networkState&&3!==e.networkState){if(0===e.readyState){var r=function(){var e=!1,r=function(){e=!0};t.on("loadstart",r);var o=function(){e||this.trigger("loadstart")};return t.on("loadedmetadata",o),t.ready(function(){this.off("loadstart",r),this.off("loadedmetadata",o),e||this.trigger("loadstart")}),{v:void 0}}();if("object"===("undefined"==typeof r?"undefined":_typeof(r)))return r.v}var o=["loadstart"];o.push("loadedmetadata"),e.readyState>=2&&o.push("loadeddata"),e.readyState>=3&&o.push("canplay"),e.readyState>=4&&o.push("canplaythrough"),this.ready(function(){o.forEach(function(e){this.trigger(e)},this)})}},t.prototype.proxyNativeTextTracks_=function(){var e=this.el().textTracks;if(e){for(var t=0;t<e.length;t++)this.textTracks().addTrack_(e[t]);e.addEventListener&&(e.addEventListener("change",this.handleTextTrackChange_),e.addEventListener("addtrack",this.handleTextTrackAdd_),e.addEventListener("removetrack",this.handleTextTrackRemove_)),this.on("loadstart",this.removeOldTextTracks_)}},t.prototype.handleTextTrackChange=function(e){var t=this.textTracks();this.textTracks().trigger({type:"change",target:t,currentTarget:t,srcElement:t})},t.prototype.handleTextTrackAdd=function(e){this.textTracks().addTrack_(e.track)},t.prototype.handleTextTrackRemove=function(e){this.textTracks().removeTrack_(e.track)},t.prototype.removeOldTracks_=function(e,t){var r=[];if(t){for(var o=0;o<e.length;o++){for(var a=e[o],n=!1,i=0;i<t.length;i++)if(t[i]===a){n=!0;break}n||r.push(a)}for(var l=0;l<r.length;l++){var s=r[l];e.removeTrack_(s)}}},t.prototype.removeOldTextTracks_=function(e){var t=this.textTracks(),r=this.el().textTracks;this.removeOldTracks_(t,r)},t.prototype.play=function(){var e=this.el_.play();void 0!==e&&"function"==typeof e.then&&e.then(null,function(e){})},t.prototype.setCurrentTime=function(e){try{this.el_.currentTime=e}catch(e){(0,_log2.default)(e,"Video is not ready. (Video.js)")}},t.prototype.duration=function(){var e=this;if(this.el_.duration===1/0&&browser.IS_ANDROID&&browser.IS_CHROME&&0===this.el_.currentTime){var t=function(){var t=function t(){e.el_.currentTime>0&&(e.el_.duration===1/0&&e.trigger("durationchange"),e.off("timeupdate",t))};return e.on("timeupdate",t),{v:NaN}}();if("object"===("undefined"==typeof t?"undefined":_typeof(t)))return t.v}return this.el_.duration||NaN},t.prototype.width=function(){return this.el_.offsetWidth},t.prototype.height=function(){return this.el_.offsetHeight},t.prototype.proxyWebkitFullscreen_=function(){var e=this;if("webkitDisplayingFullscreen"in this.el_){var t=function(){this.trigger("fullscreenchange",{isFullscreen:!1})},r=function(){this.one("webkitendfullscreen",t),this.trigger("fullscreenchange",{isFullscreen:!0})};this.on("webkitbeginfullscreen",r),this.on("dispose",function(){e.off("webkitbeginfullscreen",r),e.off("webkitendfullscreen",t)})}},t.prototype.supportsFullScreen=function(){if("function"==typeof this.el_.webkitEnterFullScreen){var e=_window2.default.navigator&&_window2.default.navigator.userAgent||"";if(/Android/.test(e)||!/Chrome|Mac OS X 10.5/.test(e))return!0}return!1},t.prototype.enterFullScreen=function(){var e=this.el_;e.paused&&e.networkState<=e.HAVE_METADATA?(this.el_.play(),this.setTimeout(function(){e.pause(),e.webkitEnterFullScreen()},0)):e.webkitEnterFullScreen()},t.prototype.exitFullScreen=function(){this.el_.webkitExitFullScreen()},t.prototype.src=function(e){return void 0===e?this.el_.src:void this.setSrc(e)},t.prototype.reset=function(){t.resetMediaElement(this.el_)},t.prototype.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},t.prototype.setControls=function(e){this.el_.controls=!!e},t.prototype.addTextTrack=function(t,r,o){return this.featuresNativeTextTracks?this.el_.addTextTrack(t,r,o):e.prototype.addTextTrack.call(this,t,r,o)},t.prototype.createRemoteTextTrack=function(t){if(!this.featuresNativeTextTracks)return e.prototype.createRemoteTextTrack.call(this,t);var r=_document2.default.createElement("track");return t.kind&&(r.kind=t.kind),t.label&&(r.label=t.label),(t.language||t.srclang)&&(r.srclang=t.language||t.srclang),t.default&&(r.default=t.default),t.id&&(r.id=t.id),t.src&&(r.src=t.src),r},t.prototype.addRemoteTextTrack=function(t,r){var o=e.prototype.addRemoteTextTrack.call(this,t,r);return this.featuresNativeTextTracks&&this.el().appendChild(o),o},t.prototype.removeRemoteTextTrack=function(t){if(e.prototype.removeRemoteTextTrack.call(this,t),this.featuresNativeTextTracks)for(var r=this.$$("track"),o=r.length;o--;)t!==r[o]&&t!==r[o].track||this.el().removeChild(r[o])},t}(_tech2.default);if(Dom.isReal()){Html5.TEST_VID=_document2.default.createElement("video");var track=_document2.default.createElement("track");track.kind="captions",track.srclang="en",track.label="English",Html5.TEST_VID.appendChild(track)}Html5.isSupported=function(){try{Html5.TEST_VID.volume=.5}catch(e){return!1}return!(!Html5.TEST_VID||!Html5.TEST_VID.canPlayType)},Html5.canControlVolume=function(){try{var e=Html5.TEST_VID.volume;return Html5.TEST_VID.volume=e/2+.1,e!==Html5.TEST_VID.volume}catch(e){return!1}},Html5.canControlPlaybackRate=function(){if(browser.IS_ANDROID&&browser.IS_CHROME)return!1;try{var e=Html5.TEST_VID.playbackRate;return Html5.TEST_VID.playbackRate=e/2+.1,e!==Html5.TEST_VID.playbackRate}catch(e){return!1}},Html5.supportsNativeTextTracks=function(){return browser.IS_ANY_SAFARI},Html5.supportsNativeVideoTracks=function(){return!(!Html5.TEST_VID||!Html5.TEST_VID.videoTracks)},Html5.supportsNativeAudioTracks=function(){return!(!Html5.TEST_VID||!Html5.TEST_VID.audioTracks)},Html5.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","volumechange"],Html5.prototype.featuresVolumeControl=Html5.canControlVolume(),Html5.prototype.featuresPlaybackRate=Html5.canControlPlaybackRate(),Html5.prototype.movingMediaElementInDOM=!browser.IS_IOS,Html5.prototype.featuresFullscreenResize=!0,Html5.prototype.featuresProgressEvents=!0,Html5.prototype.featuresTimeupdateEvents=!0,Html5.prototype.featuresNativeTextTracks=Html5.supportsNativeTextTracks(),Html5.prototype.featuresNativeVideoTracks=Html5.supportsNativeVideoTracks(),Html5.prototype.featuresNativeAudioTracks=Html5.supportsNativeAudioTracks();var canPlayType=Html5.TEST_VID&&Html5.TEST_VID.constructor.prototype.canPlayType,mpegurlRE=/^application\/(?:x-|vnd\.apple\.)mpegurl/i,mp4RE=/^video\/mp4/i;Html5.patchCanPlayType=function(){browser.ANDROID_VERSION>=4&&!browser.IS_FIREFOX?Html5.TEST_VID.constructor.prototype.canPlayType=function(e){return e&&mpegurlRE.test(e)?"maybe":canPlayType.call(this,e)}:browser.IS_OLD_ANDROID&&(Html5.TEST_VID.constructor.prototype.canPlayType=function(e){return e&&mp4RE.test(e)?"maybe":canPlayType.call(this,e)})},Html5.unpatchCanPlayType=function(){var e=Html5.TEST_VID.constructor.prototype.canPlayType;return Html5.TEST_VID.constructor.prototype.canPlayType=canPlayType,e},Html5.patchCanPlayType(),Html5.disposeMediaElement=function(e){if(e){for(e.parentNode&&e.parentNode.removeChild(e);e.hasChildNodes();)e.removeChild(e.firstChild);e.removeAttribute("src"),"function"==typeof e.load&&!function(){try{e.load()}catch(e){}}()}},Html5.resetMediaElement=function(e){if(e){for(var t=e.querySelectorAll("source"),r=t.length;r--;)e.removeChild(t[r]);e.removeAttribute("src"),"function"==typeof e.load&&!function(){try{e.load()}catch(e){}}()}},["paused","currentTime","buffered","volume","muted","poster","preload","autoplay","controls","loop","error","seeking","seekable","ended","defaultMuted","playbackRate","played","networkState","readyState","videoWidth","videoHeight"].forEach(function(e){Html5.prototype[e]=function(){return this.el_[e]}}),["volume","muted","src","poster","preload","autoplay","loop","playbackRate"].forEach(function(e){Html5.prototype["set"+(0,_toTitleCase2.default)(e)]=function(t){this.el_[e]=t}}),["pause","load"].forEach(function(e){Html5.prototype[e]=function(){return this.el_[e]()}}),_tech2.default.withSourceHandlers(Html5),Html5.nativeSourceHandler={},Html5.nativeSourceHandler.canPlayType=function(e){try{return Html5.TEST_VID.canPlayType(e)}catch(e){return""}},Html5.nativeSourceHandler.canHandleSource=function(e,t){if(e.type)return Html5.nativeSourceHandler.canPlayType(e.type);if(e.src){var r=Url.getFileExtension(e.src);return Html5.nativeSourceHandler.canPlayType("video/"+r)}return""},Html5.nativeSourceHandler.handleSource=function(e,t,r){t.setSrc(e.src)},Html5.nativeSourceHandler.dispose=function(){},Html5.registerSourceHandler(Html5.nativeSourceHandler),_component2.default.registerComponent("Html5",Html5),_tech2.default.registerTech("Html5",Html5),exports.default=Html5;
},{"../component":224,"../utils/browser.js":297,"../utils/dom.js":300,"../utils/fn.js":302,"../utils/log.js":305,"../utils/merge-options.js":306,"../utils/obj":307,"../utils/to-title-case.js":310,"../utils/url.js":311,"./tech.js":281,"global/document":193,"global/window":194,"tsml":218}],280:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _component=require("../component.js"),_component2=_interopRequireDefault(_component),_tech=require("./tech.js"),_tech2=_interopRequireDefault(_tech),_toTitleCase=require("../utils/to-title-case.js"),_toTitleCase2=_interopRequireDefault(_toTitleCase),MediaLoader=function(e){function t(o,r,n){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,e.call(this,o,r,n));if(r.playerOptions.sources&&0!==r.playerOptions.sources.length)o.src(r.playerOptions.sources);else for(var s=0,a=r.playerOptions.techOrder;s<a.length;s++){var u=(0,_toTitleCase2.default)(a[s]),c=_tech2.default.getTech(u);if(u||(c=_component2.default.getComponent(u)),c&&c.isSupported()){o.loadTech_(u);break}}return i}return _inherits(t,e),t}(_component2.default);_component2.default.registerComponent("MediaLoader",MediaLoader),exports.default=MediaLoader;
},{"../component.js":224,"../utils/to-title-case.js":310,"./tech.js":281}],281:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function createTrackHelper(e,t,r,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},n=e.textTracks();i.kind=t,r&&(i.label=r),o&&(i.language=o),i.tech=e;var a=new _textTrack2.default(i);return n.addTrack_(a),a}exports.__esModule=!0;var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_component=require("../component"),_component2=_interopRequireDefault(_component),_htmlTrackElement=require("../tracks/html-track-element"),_htmlTrackElement2=_interopRequireDefault(_htmlTrackElement),_htmlTrackElementList=require("../tracks/html-track-element-list"),_htmlTrackElementList2=_interopRequireDefault(_htmlTrackElementList),_mergeOptions=require("../utils/merge-options.js"),_mergeOptions2=_interopRequireDefault(_mergeOptions),_textTrack=require("../tracks/text-track"),_textTrack2=_interopRequireDefault(_textTrack),_textTrackList=require("../tracks/text-track-list"),_textTrackList2=_interopRequireDefault(_textTrackList),_videoTrackList=require("../tracks/video-track-list"),_videoTrackList2=_interopRequireDefault(_videoTrackList),_audioTrackList=require("../tracks/audio-track-list"),_audioTrackList2=_interopRequireDefault(_audioTrackList),_fn=require("../utils/fn.js"),Fn=_interopRequireWildcard(_fn),_log=require("../utils/log.js"),_log2=_interopRequireDefault(_log),_timeRanges=require("../utils/time-ranges.js"),_buffer=require("../utils/buffer.js"),_mediaError=require("../media-error.js"),_mediaError2=_interopRequireDefault(_mediaError),_window=require("global/window"),_window2=_interopRequireDefault(_window),_document=require("global/document"),_document2=_interopRequireDefault(_document),_obj=require("../utils/obj"),Tech=function(e){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};_classCallCheck(this,t),r.reportTouchActivity=!1;var i=_possibleConstructorReturn(this,e.call(this,null,r,o));return i.hasStarted_=!1,i.on("playing",function(){this.hasStarted_=!0}),i.on("loadstart",function(){this.hasStarted_=!1}),i.textTracks_=r.textTracks,i.videoTracks_=r.videoTracks,i.audioTracks_=r.audioTracks,i.featuresProgressEvents||i.manualProgressOn(),i.featuresTimeupdateEvents||i.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(function(e){r["native"+e+"Tracks"]===!1&&(i["featuresNative"+e+"Tracks"]=!1)}),r.nativeCaptions===!1&&(i.featuresNativeTextTracks=!1),i.featuresNativeTextTracks||i.emulateTextTracks(),i.autoRemoteTextTracks_=new _textTrackList2.default,i.initTextTrackListeners(),i.initTrackListeners(),r.nativeControlsForTouch||i.emitTapEvents(),i.constructor&&(i.name_=i.constructor.name||"Unknown Tech"),i}return _inherits(t,e),t.prototype.manualProgressOn=function(){this.on("durationchange",this.onDurationChange),this.manualProgress=!0,this.one("ready",this.trackProgress)},t.prototype.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange)},t.prototype.trackProgress=function(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(Fn.bind(this,function(){var e=this.bufferedPercent();this.bufferedPercent_!==e&&this.trigger("progress"),this.bufferedPercent_=e,1===e&&this.stopTrackingProgress()}),500)},t.prototype.onDurationChange=function(e){this.duration_=this.duration()},t.prototype.buffered=function(){return(0,_timeRanges.createTimeRange)(0,0)},t.prototype.bufferedPercent=function(){return(0,_buffer.bufferedPercent)(this.buffered(),this.duration_)},t.prototype.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},t.prototype.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime),this.on("pause",this.stopTrackingCurrentTime)},t.prototype.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime),this.off("pause",this.stopTrackingCurrentTime)},t.prototype.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)},t.prototype.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},t.prototype.dispose=function(){this.clearTracks(["audio","video","text"]),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),e.prototype.dispose.call(this)},t.prototype.clearTracks=function(e){var t=this;e=[].concat(e),e.forEach(function(e){for(var r=t[e+"Tracks"]()||[],o=r.length;o--;){var i=r[o];"text"===e&&t.removeRemoteTextTrack(i),r.removeTrack_(i)}})},t.prototype.cleanupAutoTextTracks=function(){for(var e=this.autoRemoteTextTracks_||[],t=e.length;t--;){var r=e[t];this.removeRemoteTextTrack(r)}},t.prototype.reset=function(){},t.prototype.error=function(e){return void 0!==e&&(this.error_=new _mediaError2.default(e),this.trigger("error")),this.error_},t.prototype.played=function(){return this.hasStarted_?(0,_timeRanges.createTimeRange)(0,0):(0,_timeRanges.createTimeRange)()},t.prototype.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},t.prototype.initTextTrackListeners=function(){var e=Fn.bind(this,function(){this.trigger("texttrackchange")}),t=this.textTracks();t&&(t.addEventListener("removetrack",e),t.addEventListener("addtrack",e),this.on("dispose",Fn.bind(this,function(){t.removeEventListener("removetrack",e),t.removeEventListener("addtrack",e)})))},t.prototype.initTrackListeners=function(){var e=this,t=["video","audio"];t.forEach(function(t){var r=function(){e.trigger(t+"trackchange")},o=e[t+"Tracks"]();o.addEventListener("removetrack",r),o.addEventListener("addtrack",r),e.on("dispose",function(){o.removeEventListener("removetrack",r),o.removeEventListener("addtrack",r)})})},t.prototype.addWebVttScript_=function(){var e=this;if(!_window2.default.WebVTT&&null!==this.el().parentNode&&void 0!==this.el().parentNode){var t=function(){var t=require("videojs-vtt.js");if(!e.options_["vtt.js"]&&(0,_obj.isPlain)(t)&&Object.keys(t).length>0)return Object.keys(t).forEach(function(e){_window2.default[e]=t[e]}),e.trigger("vttjsloaded"),{v:void 0};var r=_document2.default.createElement("script");r.src=e.options_["vtt.js"]||"https://cdn.rawgit.com/gkatsev/vtt.js/vjs-v0.12.1/dist/vtt.min.js",r.onload=function(){e.trigger("vttjsloaded")},r.onerror=function(){e.trigger("vttjserror")},e.on("dispose",function(){r.onload=null,r.onerror=null}),_window2.default.WebVTT=!0,e.el().parentNode.appendChild(r)}();if("object"===("undefined"==typeof t?"undefined":_typeof(t)))return t.v}},t.prototype.emulateTextTracks=function(){var e=this,t=this.textTracks();if(t){this.remoteTextTracks().on("addtrack",function(t){e.textTracks().addTrack_(t.track)}),this.remoteTextTracks().on("removetrack",function(t){e.textTracks().removeTrack_(t.track)}),this.on("ready",this.addWebVttScript_);var r=function(){return e.trigger("texttrackchange")},o=function(){r();for(var e=0;e<t.length;e++){var o=t[e];o.removeEventListener("cuechange",r),"showing"===o.mode&&o.addEventListener("cuechange",r)}};o(),t.addEventListener("change",o),this.on("dispose",function(){t.removeEventListener("change",o)})}},t.prototype.videoTracks=function(){return this.videoTracks_=this.videoTracks_||new _videoTrackList2.default,this.videoTracks_},t.prototype.audioTracks=function(){return this.audioTracks_=this.audioTracks_||new _audioTrackList2.default,this.audioTracks_},t.prototype.textTracks=function(){return this.textTracks_=this.textTracks_||new _textTrackList2.default,this.textTracks_},t.prototype.remoteTextTracks=function(){return this.remoteTextTracks_=this.remoteTextTracks_||new _textTrackList2.default,this.remoteTextTracks_},t.prototype.remoteTextTrackEls=function(){return this.remoteTextTrackEls_=this.remoteTextTrackEls_||new _htmlTrackElementList2.default,this.remoteTextTrackEls_},t.prototype.addTextTrack=function(e,t,r){if(!e)throw new Error("TextTrack kind is required but was not provided");return createTrackHelper(this,e,t,r)},t.prototype.createRemoteTextTrack=function(e){var t=(0,_mergeOptions2.default)(e,{tech:this});return new _htmlTrackElement2.default(t)},t.prototype.addRemoteTextTrack=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],r=this.createRemoteTextTrack(e);return t!==!0&&t!==!1&&(_log2.default.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),t=!0),this.remoteTextTrackEls().addTrackElement_(r),this.remoteTextTracks().addTrack_(r.track),t!==!0&&this.autoRemoteTextTracks_.addTrack_(r.track),r},t.prototype.removeRemoteTextTrack=function(e){var t=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(t),this.remoteTextTracks().removeTrack_(e),this.autoRemoteTextTracks_.removeTrack_(e)},t.prototype.setPoster=function(){},t.prototype.canPlayType=function(){return""},t.isTech=function(e){return e.prototype instanceof t||e instanceof t||e===t},t.registerTech=function(e,r){if(t.techs_||(t.techs_={}),!t.isTech(r))throw new Error("Tech "+e+" must be a Tech");return t.techs_[e]=r,r},t.getTech=function(e){return t.techs_&&t.techs_[e]?t.techs_[e]:_window2.default&&_window2.default.videojs&&_window2.default.videojs[e]?(_log2.default.warn("The "+e+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),_window2.default.videojs[e]):void 0},t}(_component2.default);Tech.prototype.textTracks_,Tech.prototype.audioTracks_,Tech.prototype.videoTracks_,Tech.prototype.featuresVolumeControl=!0,Tech.prototype.featuresFullscreenResize=!1,Tech.prototype.featuresPlaybackRate=!1,Tech.prototype.featuresProgressEvents=!1,Tech.prototype.featuresTimeupdateEvents=!1,Tech.prototype.featuresNativeTextTracks=!1,Tech.withSourceHandlers=function(e){e.registerSourceHandler=function(t,r){var o=e.sourceHandlers;o||(o=e.sourceHandlers=[]),void 0===r&&(r=o.length),o.splice(r,0,t)},e.canPlayType=function(t){for(var r=e.sourceHandlers||[],o=void 0,i=0;i<r.length;i++)if(o=r[i].canPlayType(t))return o;return""},e.selectSourceHandler=function(t,r){for(var o=e.sourceHandlers||[],i=void 0,n=0;n<o.length;n++)if(i=o[n].canHandleSource(t,r))return o[n];return null},e.canPlaySource=function(t,r){var o=e.selectSourceHandler(t,r);return o?o.canHandleSource(t,r):""};var t=["seekable","duration"];t.forEach(function(e){var t=this[e];"function"==typeof t&&(this[e]=function(){return this.sourceHandler_&&this.sourceHandler_[e]?this.sourceHandler_[e].apply(this.sourceHandler_,arguments):t.apply(this,arguments)})},e.prototype),e.prototype.setSource=function(t){var r=e.selectSourceHandler(t,this.options_);return r||(e.nativeSourceHandler?r=e.nativeSourceHandler:_log2.default.error("No source hander found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler),r!==e.nativeSourceHandler&&(this.currentSource_=t,this.off(this.el_,"loadstart",e.prototype.firstLoadStartListener_),this.off(this.el_,"loadstart",e.prototype.successiveLoadStartListener_),this.one(this.el_,"loadstart",e.prototype.firstLoadStartListener_)),this.sourceHandler_=r.handleSource(t,this,this.options_),this.on("dispose",this.disposeSourceHandler),this},e.prototype.firstLoadStartListener_=function(){this.one(this.el_,"loadstart",e.prototype.successiveLoadStartListener_)},e.prototype.successiveLoadStartListener_=function(){this.disposeSourceHandler(),this.one(this.el_,"loadstart",e.prototype.successiveLoadStartListener_)},e.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.off(this.el_,"loadstart",e.prototype.firstLoadStartListener_),this.off(this.el_,"loadstart",e.prototype.successiveLoadStartListener_),this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},_component2.default.registerComponent("Tech",Tech),_component2.default.registerComponent("MediaTechController",Tech),Tech.registerTech("Tech",Tech),exports.default=Tech;
},{"../component":224,"../media-error.js":265,"../tracks/audio-track-list":282,"../tracks/html-track-element":285,"../tracks/html-track-element-list":284,"../tracks/text-track":291,"../tracks/text-track-list":289,"../tracks/video-track-list":295,"../utils/buffer.js":298,"../utils/fn.js":302,"../utils/log.js":305,"../utils/merge-options.js":306,"../utils/obj":307,"../utils/time-ranges.js":309,"global/document":193,"global/window":194,"videojs-vtt.js":464}],282:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _trackList=require("./track-list"),_trackList2=_interopRequireDefault(_trackList),_browser=require("../utils/browser.js"),browser=_interopRequireWildcard(_browser),_document=require("global/document"),_document2=_interopRequireDefault(_document),disableOthers=function(e,t){for(var r=0;r<e.length;r++)t.id!==e[r].id&&(e[r].enabled=!1)},AudioTrackList=function(e){function t(){var r,o,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];_classCallCheck(this,t);for(var i=void 0,a=n.length-1;a>=0;a--)if(n[a].enabled){disableOthers(n,n[a]);break}if(browser.IS_IE8){i=_document2.default.createElement("custom");for(var c in _trackList2.default.prototype)"constructor"!==c&&(i[c]=_trackList2.default.prototype[c]);for(var s in t.prototype)"constructor"!==s&&(i[s]=t.prototype[s])}return i=r=_possibleConstructorReturn(this,e.call(this,n,i)),i.changing_=!1,o=i,_possibleConstructorReturn(r,o)}return _inherits(t,e),t.prototype.addTrack_=function(t){var r=this;t.enabled&&disableOthers(this,t),e.prototype.addTrack_.call(this,t),t.addEventListener&&t.addEventListener("enabledchange",function(){r.changing_||(r.changing_=!0,disableOthers(r,t),r.changing_=!1,r.trigger("change"))})},t.prototype.addTrack=function(e){this.addTrack_(e)},t.prototype.removeTrack=function(t){e.prototype.removeTrack_.call(this,t)},t}(_trackList2.default);exports.default=AudioTrackList;
},{"../utils/browser.js":297,"./track-list":293,"global/document":193}],283:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r}function _inherits(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}exports.__esModule=!0;var _trackEnums=require("./track-enums"),_track=require("./track"),_track2=_interopRequireDefault(_track),_mergeOptions=require("../utils/merge-options"),_mergeOptions2=_interopRequireDefault(_mergeOptions),_browser=require("../utils/browser.js"),browser=_interopRequireWildcard(_browser),AudioTrack=function(e){function r(){var t,o,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,r);var i=(0,_mergeOptions2.default)(n,{kind:_trackEnums.AudioTrackKind[n.kind]||""}),u=t=_possibleConstructorReturn(this,e.call(this,i)),s=!1;if(browser.IS_IE8)for(var a in r.prototype)"constructor"!==a&&(u[a]=r.prototype[a]);return Object.defineProperty(u,"enabled",{get:function(){return s},set:function(e){"boolean"==typeof e&&e!==s&&(s=e,this.trigger("enabledchange"))}}),i.enabled&&(u.enabled=i.enabled),u.loaded_=!0,o=u,_possibleConstructorReturn(t,o)}return _inherits(r,e),r}(_track2.default);exports.default=AudioTrack;
},{"../utils/browser.js":297,"../utils/merge-options":306,"./track":294,"./track-enums":292}],284:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _browser=require("../utils/browser.js"),browser=_interopRequireWildcard(_browser),_document=require("global/document"),_document2=_interopRequireDefault(_document),HtmlTrackElementList=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];_classCallCheck(this,e);var r=this;if(browser.IS_IE8){r=_document2.default.createElement("custom");for(var n in e.prototype)"constructor"!==n&&(r[n]=e.prototype[n])}r.trackElements_=[],Object.defineProperty(r,"length",{get:function(){return this.trackElements_.length}});for(var o=0,i=t.length;o<i;o++)r.addTrackElement_(t[o]);if(browser.IS_IE8)return r}return e.prototype.addTrackElement_=function(e){var t=this.trackElements_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.trackElements_[t]}}),this.trackElements_.indexOf(e)===-1&&this.trackElements_.push(e)},e.prototype.getTrackElementByTrack_=function(e){for(var t=void 0,r=0,n=this.trackElements_.length;r<n;r++)if(e===this.trackElements_[r].track){t=this.trackElements_[r];break}return t},e.prototype.removeTrackElement_=function(e){for(var t=0,r=this.trackElements_.length;t<r;t++)if(e===this.trackElements_[t]){this.trackElements_.splice(t,1);break}},e}();exports.default=HtmlTrackElementList;
},{"../utils/browser.js":297,"global/document":193}],285:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _browser=require("../utils/browser.js"),browser=_interopRequireWildcard(_browser),_document=require("global/document"),_document2=_interopRequireDefault(_document),_eventTarget=require("../event-target"),_eventTarget2=_interopRequireDefault(_eventTarget),_textTrack=require("../tracks/text-track"),_textTrack2=_interopRequireDefault(_textTrack),NONE=0,LOADING=1,LOADED=2,ERROR=3,HTMLTrackElement=function(e){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var n=_possibleConstructorReturn(this,e.call(this)),o=void 0,a=n;if(browser.IS_IE8){a=_document2.default.createElement("custom");for(var u in t.prototype)"constructor"!==u&&(a[u]=t.prototype[u])}var i=new _textTrack2.default(r);if(a.kind=i.kind,a.src=i.src,a.srclang=i.language,a.label=i.label,a.default=i.default,Object.defineProperty(a,"readyState",{get:function(){return o}}),Object.defineProperty(a,"track",{get:function(){return i}}),o=NONE,i.addEventListener("loadeddata",function(){o=LOADED,a.trigger({type:"load",target:a})}),browser.IS_IE8){var l;return l=a,_possibleConstructorReturn(n,l)}return n}return _inherits(t,e),t}(_eventTarget2.default);HTMLTrackElement.prototype.allowedEvents_={load:"load"},HTMLTrackElement.NONE=NONE,HTMLTrackElement.LOADING=LOADING,HTMLTrackElement.LOADED=LOADED,HTMLTrackElement.ERROR=ERROR,exports.default=HTMLTrackElement;
},{"../event-target":261,"../tracks/text-track":291,"../utils/browser.js":297,"global/document":193}],286:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _browser=require("../utils/browser.js"),browser=_interopRequireWildcard(_browser),_document=require("global/document"),_document2=_interopRequireDefault(_document),TextTrackCueList=function(){function e(t){_classCallCheck(this,e);var r=this;if(browser.IS_IE8){r=_document2.default.createElement("custom");for(var n in e.prototype)"constructor"!==n&&(r[n]=e.prototype[n])}if(e.prototype.setCues_.call(r,t),Object.defineProperty(r,"length",{get:function(){return this.length_}}),browser.IS_IE8)return r}return e.prototype.setCues_=function(e){var t=this.length||0,r=0,n=e.length;this.cues_=e,this.length_=e.length;var o=function(e){""+e in this||Object.defineProperty(this,""+e,{get:function(){return this.cues_[e]}})};if(t<n)for(r=t;r<n;r++)o.call(this,r)},e.prototype.getCueById=function(e){for(var t=null,r=0,n=this.length;r<n;r++){var o=this[r];if(o.id===e){t=o;break}}return t},e}();exports.default=TextTrackCueList;
},{"../utils/browser.js":297,"global/document":193}],287:[function(require,module,exports){
"use strict";function _interopRequireWildcard(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function constructColor(t,e){return"rgba("+parseInt(t[1]+t[1],16)+","+parseInt(t[2]+t[2],16)+","+parseInt(t[3]+t[3],16)+","+e+")"}function tryUpdateStyle(t,e,r){try{t.style[e]=r}catch(t){return}}exports.__esModule=!0;var _component=require("../component"),_component2=_interopRequireDefault(_component),_fn=require("../utils/fn.js"),Fn=_interopRequireWildcard(_fn),_window=require("global/window"),_window2=_interopRequireDefault(_window),darkGray="#222",lightGray="#ccc",fontMap={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'},TextTrackDisplay=function(t){function e(r,o,a){_classCallCheck(this,e);var i=_possibleConstructorReturn(this,t.call(this,r,o,a));return r.on("loadstart",Fn.bind(i,i.toggleDisplay)),r.on("texttrackchange",Fn.bind(i,i.updateDisplay)),r.ready(Fn.bind(i,function(){if(r.tech_&&r.tech_.featuresNativeTextTracks)return void this.hide();r.on("fullscreenchange",Fn.bind(this,this.updateDisplay));for(var t=this.options_.playerOptions.tracks||[],e=0;e<t.length;e++)this.player_.addRemoteTextTrack(t[e],!0);var o={captions:1,subtitles:1},a=this.player_.textTracks(),i=void 0,n=void 0;if(a){for(var s=0;s<a.length;s++){var l=a[s];l.default&&("descriptions"!==l.kind||i?l.kind in o&&!n&&(n=l):i=l)}n?n.mode="showing":i&&(i.mode="showing")}})),i}return _inherits(e,t),e.prototype.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},e.prototype.clearDisplay=function(){"function"==typeof _window2.default.WebVTT&&_window2.default.WebVTT.processCues(_window2.default,[],this.el_)},e.prototype.updateDisplay=function(){var t=this.player_.textTracks();if(this.clearDisplay(),t){for(var e=null,r=null,o=t.length;o--;){var a=t[o];"showing"===a.mode&&("descriptions"===a.kind?e=a:r=a)}r?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(r)):e&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(e))}},e.prototype.updateForTrack=function(t){if("function"==typeof _window2.default.WebVTT&&t.activeCues){for(var e=this.player_.textTrackSettings.getValues(),r=[],o=0;o<t.activeCues.length;o++)r.push(t.activeCues[o]);_window2.default.WebVTT.processCues(_window2.default,r,this.el_);for(var a=r.length;a--;){var i=r[a];if(i){var n=i.displayState;if(e.color&&(n.firstChild.style.color=e.color),e.textOpacity&&tryUpdateStyle(n.firstChild,"color",constructColor(e.color||"#fff",e.textOpacity)),e.backgroundColor&&(n.firstChild.style.backgroundColor=e.backgroundColor),e.backgroundOpacity&&tryUpdateStyle(n.firstChild,"backgroundColor",constructColor(e.backgroundColor||"#000",e.backgroundOpacity)),e.windowColor&&(e.windowOpacity?tryUpdateStyle(n,"backgroundColor",constructColor(e.windowColor,e.windowOpacity)):n.style.backgroundColor=e.windowColor),e.edgeStyle&&("dropshadow"===e.edgeStyle?n.firstChild.style.textShadow="2px 2px 3px "+darkGray+", 2px 2px 4px "+darkGray+", 2px 2px 5px "+darkGray:"raised"===e.edgeStyle?n.firstChild.style.textShadow="1px 1px "+darkGray+", 2px 2px "+darkGray+", 3px 3px "+darkGray:"depressed"===e.edgeStyle?n.firstChild.style.textShadow="1px 1px "+lightGray+", 0 1px "+lightGray+", -1px -1px "+darkGray+", 0 -1px "+darkGray:"uniform"===e.edgeStyle&&(n.firstChild.style.textShadow="0 0 4px "+darkGray+", 0 0 4px "+darkGray+", 0 0 4px "+darkGray+", 0 0 4px "+darkGray)),e.fontPercent&&1!==e.fontPercent){var s=_window2.default.parseFloat(n.style.fontSize);n.style.fontSize=s*e.fontPercent+"px",n.style.height="auto",n.style.top="auto",n.style.bottom="2px"}e.fontFamily&&"default"!==e.fontFamily&&("small-caps"===e.fontFamily?n.firstChild.style.fontVariant="small-caps":n.firstChild.style.fontFamily=fontMap[e.fontFamily])}}}},e}(_component2.default);_component2.default.registerComponent("TextTrackDisplay",TextTrackDisplay),exports.default=TextTrackDisplay;
},{"../component":224,"../utils/fn.js":302,"global/window":194}],288:[function(require,module,exports){
"use strict";exports.__esModule=!0;var trackToJson_=function(t){var r=["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(r,e,a){return t[e]&&(r[e]=t[e]),r},{cues:t.cues&&Array.prototype.map.call(t.cues,function(t){return{startTime:t.startTime,endTime:t.endTime,text:t.text,id:t.id}})});return r},textTracksToJson=function(t){var r=t.$$("track"),e=Array.prototype.map.call(r,function(t){return t.track}),a=Array.prototype.map.call(r,function(t){var r=trackToJson_(t.track);return t.src&&(r.src=t.src),r});return a.concat(Array.prototype.filter.call(t.textTracks(),function(t){return e.indexOf(t)===-1}).map(trackToJson_))},jsonToTextTracks=function(t,r){return t.forEach(function(t){var e=r.addRemoteTextTrack(t).track;!t.src&&t.cues&&t.cues.forEach(function(t){return e.addCue(t)})}),r.textTracks()};exports.default={textTracksToJson:textTracksToJson,jsonToTextTracks:jsonToTextTracks,trackToJson_:trackToJson_};
},{}],289:[function(require,module,exports){
"use strict";function _interopRequireWildcard(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}exports.__esModule=!0;var _trackList=require("./track-list"),_trackList2=_interopRequireDefault(_trackList),_fn=require("../utils/fn.js"),Fn=_interopRequireWildcard(_fn),_browser=require("../utils/browser.js"),browser=_interopRequireWildcard(_browser),_document=require("global/document"),_document2=_interopRequireDefault(_document),TextTrackList=function(t){function e(){var r,o,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];_classCallCheck(this,e);var i=void 0;if(browser.IS_IE8){i=_document2.default.createElement("custom");for(var u in _trackList2.default.prototype)"constructor"!==u&&(i[u]=_trackList2.default.prototype[u]);for(var s in e.prototype)"constructor"!==s&&(i[s]=e.prototype[s])}return i=r=_possibleConstructorReturn(this,t.call(this,n,i)),o=i,_possibleConstructorReturn(r,o)}return _inherits(e,t),e.prototype.addTrack_=function(e){t.prototype.addTrack_.call(this,e),e.addEventListener("modechange",Fn.bind(this,function(){this.trigger("change")}))},e}(_trackList2.default);exports.default=TextTrackList;
},{"../utils/browser.js":297,"../utils/fn.js":302,"./track-list":293,"global/document":193}],290:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function parseOptionValue(e,t){if(t&&(e=t(e)),e&&"none"!==e)return e}function getSelectedOptionValue(e,t){var o=e.options[e.options.selectedIndex].value;return parseOptionValue(o,t)}function setSelectedOption(e,t,o){if(t)for(var n=0;n<e.options.length;n++)if(parseOptionValue(e.options[n].value,o)===t){e.selectedIndex=n;break}}exports.__esModule=!0;var _window=require("global/window"),_window2=_interopRequireDefault(_window),_component=require("../component"),_component2=_interopRequireDefault(_component),_dom=require("../utils/dom"),_fn=require("../utils/fn"),Fn=_interopRequireWildcard(_fn),_obj=require("../utils/obj"),Obj=_interopRequireWildcard(_obj),_log=require("../utils/log"),_log2=_interopRequireDefault(_log),LOCAL_STORAGE_KEY="vjs-text-track-settings",COLOR_BLACK=["#000","Black"],COLOR_BLUE=["#00F","Blue"],COLOR_CYAN=["#0FF","Cyan"],COLOR_GREEN=["#0F0","Green"],COLOR_MAGENTA=["#F0F","Magenta"],COLOR_RED=["#F00","Red"],COLOR_WHITE=["#FFF","White"],COLOR_YELLOW=["#FF0","Yellow"],OPACITY_OPAQUE=["1","Opaque"],OPACITY_SEMI=["0.5","Semi-Transparent"],OPACITY_TRANS=["0","Transparent"],selectConfigs={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[COLOR_BLACK,COLOR_WHITE,COLOR_RED,COLOR_GREEN,COLOR_BLUE,COLOR_YELLOW,COLOR_MAGENTA,COLOR_CYAN]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[OPACITY_OPAQUE,OPACITY_SEMI,OPACITY_TRANS]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[COLOR_WHITE,COLOR_BLACK,COLOR_RED,COLOR_GREEN,COLOR_BLUE,COLOR_YELLOW,COLOR_MAGENTA,COLOR_CYAN]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(e){return"1.00"===e?null:Number(e)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[OPACITY_OPAQUE,OPACITY_SEMI]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[OPACITY_TRANS,OPACITY_SEMI,OPACITY_OPAQUE]}};selectConfigs.windowColor.options=selectConfigs.backgroundColor.options;var TextTrackSettings=function(e){function t(o,n){_classCallCheck(this,t);var r=_possibleConstructorReturn(this,e.call(this,o,n));return r.setDefaults(),r.hide(),r.updateDisplay=Fn.bind(r,r.updateDisplay),void 0===n.persistTextTrackSettings&&(r.options_.persistTextTrackSettings=r.options_.playerOptions.persistTextTrackSettings),r.on(r.$(".vjs-done-button"),"click",function(){r.saveSettings(),r.hide()}),r.on(r.$(".vjs-default-button"),"click",function(){r.setDefaults(),r.updateDisplay()}),Obj.each(selectConfigs,function(e){r.on(r.$(e.selector),"change",r.updateDisplay)}),r.options_.persistTextTrackSettings&&r.restoreSettings(),r}return _inherits(t,e),t.prototype.createElSelect_=function(e){var t=this,o=selectConfigs[e],n=o.id.replace("%s",this.id_);return[(0,_dom.createEl)("label",{className:"vjs-label",textContent:o.label},{for:n}),(0,_dom.createEl)("select",{id:n},void 0,o.options.map(function(e){return(0,_dom.createEl)("option",{textContent:t.localize(e[1]),value:e[0]})}))]},t.prototype.createElFgColor_=function(){var e=(0,_dom.createEl)("legend",{textContent:this.localize("Text")}),t=this.createElSelect_("color"),o=(0,_dom.createEl)("span",{className:"vjs-text-opacity vjs-opacity"},void 0,this.createElSelect_("textOpacity"));return(0,_dom.createEl)("fieldset",{className:"vjs-fg-color vjs-tracksetting"},void 0,[e].concat(t,o))},t.prototype.createElBgColor_=function(){var e=(0,_dom.createEl)("legend",{textContent:this.localize("Background")}),t=this.createElSelect_("backgroundColor"),o=(0,_dom.createEl)("span",{className:"vjs-bg-opacity vjs-opacity"},void 0,this.createElSelect_("backgroundOpacity"));return(0,_dom.createEl)("fieldset",{className:"vjs-bg-color vjs-tracksetting"},void 0,[e].concat(t,o))},t.prototype.createElWinColor_=function(){var e=(0,_dom.createEl)("legend",{textContent:this.localize("Window")}),t=this.createElSelect_("windowColor"),o=(0,_dom.createEl)("span",{className:"vjs-window-opacity vjs-opacity"},void 0,this.createElSelect_("windowOpacity"));return(0,_dom.createEl)("fieldset",{className:"vjs-window-color vjs-tracksetting"},void 0,[e].concat(t,o))},t.prototype.createElColors_=function(){return(0,_dom.createEl)("div",{className:"vjs-tracksettings-colors"},void 0,[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()])},t.prototype.createElFont_=function(){var e=(0,_dom.createEl)("div",{className:"vjs-font-percent vjs-tracksetting"},void 0,this.createElSelect_("fontPercent")),t=(0,_dom.createEl)("div",{className:"vjs-edge-style vjs-tracksetting"},void 0,this.createElSelect_("edgeStyle")),o=(0,_dom.createEl)("div",{className:"vjs-font-family vjs-tracksetting"},void 0,this.createElSelect_("fontFamily"));return(0,_dom.createEl)("div",{className:"vjs-tracksettings-font"},void 0,[e,t,o])},t.prototype.createElControls_=function(){var e=(0,_dom.createEl)("button",{className:"vjs-default-button",textContent:this.localize("Defaults")}),t=(0,_dom.createEl)("button",{className:"vjs-done-button",textContent:"Done"});return(0,_dom.createEl)("div",{className:"vjs-tracksettings-controls"},void 0,[e,t])},t.prototype.createEl=function(){var e=(0,_dom.createEl)("div",{className:"vjs-tracksettings"},void 0,[this.createElColors_(),this.createElFont_(),this.createElControls_()]),t=(0,_dom.createEl)("div",{className:"vjs-control-text",id:"TTsettingsDialogLabel-"+this.id_,textContent:"Caption Settings Dialog"},{"aria-level":"1",role:"heading"}),o=(0,_dom.createEl)("div",{className:"vjs-control-text",id:"TTsettingsDialogDescription-"+this.id_,textContent:"Beginning of dialog window. Escape will cancel and close the window."}),n=(0,_dom.createEl)("div",void 0,{role:"document"},[t,o,e]);return(0,_dom.createEl)("div",{className:"vjs-caption-settings vjs-modal-overlay",tabIndex:-1},{role:"dialog","aria-labelledby":t.id,"aria-describedby":o.id},n)},t.prototype.getValues=function(){var e=this;return Obj.reduce(selectConfigs,function(t,o,n){var r=getSelectedOptionValue(e.$(o.selector),o.parser);return void 0!==r&&(t[n]=r),t},{})},t.prototype.setValues=function(e){var t=this;Obj.each(selectConfigs,function(o,n){setSelectedOption(t.$(o.selector),e[n],o.parser)})},t.prototype.setDefaults=function(){var e=this;Obj.each(selectConfigs,function(t){var o=t.hasOwnProperty("default")?t.default:0;e.$(t.selector).selectedIndex=o})},t.prototype.restoreSettings=function(){var e=void 0;try{e=JSON.parse(_window2.default.localStorage.getItem(LOCAL_STORAGE_KEY))}catch(e){_log2.default.warn(e)}e&&this.setValues(e)},t.prototype.saveSettings=function(){if(this.options_.persistTextTrackSettings){var e=this.getValues();try{Object.keys(e).length?_window2.default.localStorage.setItem(LOCAL_STORAGE_KEY,JSON.stringify(e)):_window2.default.localStorage.removeItem(LOCAL_STORAGE_KEY)}catch(e){_log2.default.warn(e)}}},t.prototype.updateDisplay=function(){var e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()},t}(_component2.default);_component2.default.registerComponent("TextTrackSettings",TextTrackSettings),exports.default=TextTrackSettings;
},{"../component":224,"../utils/dom":300,"../utils/fn":302,"../utils/log":305,"../utils/obj":307,"global/window":194}],291:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _textTrackCueList=require("./text-track-cue-list"),_textTrackCueList2=_interopRequireDefault(_textTrackCueList),_fn=require("../utils/fn.js"),Fn=_interopRequireWildcard(_fn),_trackEnums=require("./track-enums"),_log=require("../utils/log.js"),_log2=_interopRequireDefault(_log),_window=require("global/window"),_window2=_interopRequireDefault(_window),_track=require("./track.js"),_track2=_interopRequireDefault(_track),_url=require("../utils/url.js"),_xhr=require("xhr"),_xhr2=_interopRequireDefault(_xhr),_mergeOptions=require("../utils/merge-options"),_mergeOptions2=_interopRequireDefault(_mergeOptions),_browser=require("../utils/browser.js"),browser=_interopRequireWildcard(_browser),parseCues=function(e,t){var r=new _window2.default.WebVTT.Parser(_window2.default,_window2.default.vttjs,_window2.default.WebVTT.StringDecoder()),n=[];r.oncue=function(e){t.addCue(e)},r.onparsingerror=function(e){n.push(e)},r.onflush=function(){t.trigger({type:"loadeddata",target:t})},r.parse(e),n.length>0&&(_window2.default.console&&_window2.default.console.groupCollapsed&&_window2.default.console.groupCollapsed("Text Track parsing errors for "+t.src),n.forEach(function(e){return _log2.default.error(e)}),_window2.default.console&&_window2.default.console.groupEnd&&_window2.default.console.groupEnd()),r.flush()},loadTrack=function(e,t){var r={uri:e},n=(0,_url.isCrossOrigin)(e);n&&(r.cors=n),(0,_xhr2.default)(r,Fn.bind(this,function(e,r,n){return e?_log2.default.error(e,r):(t.loaded_=!0,void("function"!=typeof _window2.default.WebVTT?t.tech_&&!function(){var e=function(){return parseCues(n,t)};t.tech_.on("vttjsloaded",e),t.tech_.on("vttjserror",function(){_log2.default.error("vttjs failed to load, stopping trying to process "+t.src),t.tech_.off("vttjsloaded",e)})}():parseCues(n,t)))}))},TextTrack=function(e){function t(){var r,n,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(_classCallCheck(this,t),!o.tech)throw new Error("A tech was not provided.");var i=(0,_mergeOptions2.default)(o,{kind:_trackEnums.TextTrackKind[o.kind]||"subtitles",language:o.language||o.srclang||""}),u=_trackEnums.TextTrackMode[i.mode]||"disabled",s=i.default;"metadata"!==i.kind&&"chapters"!==i.kind||(u="hidden");var a=r=_possibleConstructorReturn(this,e.call(this,i));if(a.tech_=i.tech,browser.IS_IE8)for(var c in t.prototype)"constructor"!==c&&(a[c]=t.prototype[c]);a.cues_=[],a.activeCues_=[];var l=new _textTrackCueList2.default(a.cues_),d=new _textTrackCueList2.default(a.activeCues_),f=!1,_=Fn.bind(a,function(){this.activeCues,f&&(this.trigger("cuechange"),f=!1)});return"disabled"!==u&&a.tech_.on("timeupdate",_),Object.defineProperty(a,"default",{get:function(){return s},set:function(){}}),Object.defineProperty(a,"mode",{get:function(){return u},set:function(e){_trackEnums.TextTrackMode[e]&&(u=e,"showing"===u&&this.tech_.on("timeupdate",_),this.trigger("modechange"))}}),Object.defineProperty(a,"cues",{get:function(){return this.loaded_?l:null},set:function(){}}),Object.defineProperty(a,"activeCues",{get:function(){if(!this.loaded_)return null;if(0===this.cues.length)return d;for(var e=this.tech_.currentTime(),t=[],r=0,n=this.cues.length;r<n;r++){var o=this.cues[r];o.startTime<=e&&o.endTime>=e?t.push(o):o.startTime===o.endTime&&o.startTime<=e&&o.startTime+.5>=e&&t.push(o)}if(f=!1,t.length!==this.activeCues_.length)f=!0;else for(var i=0;i<t.length;i++)this.activeCues_.indexOf(t[i])===-1&&(f=!0);return this.activeCues_=t,d.setCues_(this.activeCues_),d},set:function(){}}),i.src?(a.src=i.src,loadTrack(i.src,a)):a.loaded_=!0,n=a,_possibleConstructorReturn(r,n)}return _inherits(t,e),t.prototype.addCue=function(e){var t=this.tech_.textTracks();if(t)for(var r=0;r<t.length;r++)t[r]!==this&&t[r].removeCue(e);this.cues_.push(e),this.cues.setCues_(this.cues_)},t.prototype.removeCue=function(e){for(var t=!1,r=0,n=this.cues_.length;r<n;r++){var o=this.cues_[r];o===e&&(this.cues_.splice(r,1),t=!0)}t&&this.cues.setCues_(this.cues_)},t}(_track2.default);TextTrack.prototype.allowedEvents_={cuechange:"cuechange"},exports.default=TextTrack;
},{"../utils/browser.js":297,"../utils/fn.js":302,"../utils/log.js":305,"../utils/merge-options":306,"../utils/url.js":311,"./text-track-cue-list":286,"./track-enums":292,"./track.js":294,"global/window":194,"xhr":473}],292:[function(require,module,exports){
"use strict";exports.__esModule=!0;var VideoTrackKind=exports.VideoTrackKind={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},AudioTrackKind=exports.AudioTrackKind={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},TextTrackKind=exports.TextTrackKind={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},TextTrackMode=exports.TextTrackMode={disabled:"disabled",hidden:"hidden",showing:"showing"};
},{}],293:[function(require,module,exports){
"use strict";function _interopRequireWildcard(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}exports.__esModule=!0;var _eventTarget=require("../event-target"),_eventTarget2=_interopRequireDefault(_eventTarget),_browser=require("../utils/browser.js"),browser=_interopRequireWildcard(_browser),_document=require("global/document"),_document2=_interopRequireDefault(_document),TrackList=function(t){function e(){var r,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;_classCallCheck(this,e);var i=_possibleConstructorReturn(this,t.call(this));if(!n&&(n=i,browser.IS_IE8)){n=_document2.default.createElement("custom");for(var a in e.prototype)"constructor"!==a&&(n[a]=e.prototype[a])}n.tracks_=[],Object.defineProperty(n,"length",{get:function(){return this.tracks_.length}});for(var s=0;s<o.length;s++)n.addTrack_(o[s]);return r=n,_possibleConstructorReturn(i,r)}return _inherits(e,t),e.prototype.addTrack_=function(t){var e=this.tracks_.length;""+e in this||Object.defineProperty(this,e,{get:function(){return this.tracks_[e]}}),this.tracks_.indexOf(t)===-1&&(this.tracks_.push(t),this.trigger({track:t,type:"addtrack"}))},e.prototype.removeTrack_=function(t){for(var e=void 0,r=0,o=this.length;r<o;r++)if(this[r]===t){e=this[r],e.off&&e.off(),this.tracks_.splice(r,1);break}e&&this.trigger({track:e,type:"removetrack"})},e.prototype.getTrackById=function(t){for(var e=null,r=0,o=this.length;r<o;r++){var n=this[r];if(n.id===t){e=n;break}}return e},e}(_eventTarget2.default);TrackList.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"};for(var event in TrackList.prototype.allowedEvents_)TrackList.prototype["on"+event]=null;exports.default=TrackList;
},{"../event-target":261,"../utils/browser.js":297,"global/document":193}],294:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _browser=require("../utils/browser.js"),browser=_interopRequireWildcard(_browser),_document=require("global/document"),_document2=_interopRequireDefault(_document),_guid=require("../utils/guid.js"),Guid=_interopRequireWildcard(_guid),_eventTarget=require("../event-target"),_eventTarget2=_interopRequireDefault(_eventTarget),Track=function(e){function t(){var r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var o=_possibleConstructorReturn(this,e.call(this)),i=o;if(browser.IS_IE8){i=_document2.default.createElement("custom");for(var u in t.prototype)"constructor"!==u&&(i[u]=t.prototype[u])}var a={id:n.id||"vjs_track_"+Guid.newGUID(),kind:n.kind||"",label:n.label||"",language:n.language||""},l=function(e){Object.defineProperty(i,e,{get:function(){return a[e]},set:function(){}})};for(var c in a)l(c);return r=i,_possibleConstructorReturn(o,r)}return _inherits(t,e),t}(_eventTarget2.default);exports.default=Track;
},{"../event-target":261,"../utils/browser.js":297,"../utils/guid.js":304,"global/document":193}],295:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _trackList=require("./track-list"),_trackList2=_interopRequireDefault(_trackList),_browser=require("../utils/browser.js"),browser=_interopRequireWildcard(_browser),_document=require("global/document"),_document2=_interopRequireDefault(_document),disableOthers=function(e,t){for(var r=0;r<e.length;r++)t.id!==e[r].id&&(e[r].selected=!1)},VideoTrackList=function(e){function t(){var r,o,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];_classCallCheck(this,t);for(var i=void 0,c=n.length-1;c>=0;c--)if(n[c].selected){disableOthers(n,n[c]);break}if(browser.IS_IE8){i=_document2.default.createElement("custom");for(var s in _trackList2.default.prototype)"constructor"!==s&&(i[s]=_trackList2.default.prototype[s]);for(var a in t.prototype)"constructor"!==a&&(i[a]=t.prototype[a])}return i=r=_possibleConstructorReturn(this,e.call(this,n,i)),i.changing_=!1,Object.defineProperty(i,"selectedIndex",{get:function(){for(var e=0;e<this.length;e++)if(this[e].selected)return e;return-1},set:function(){}}),o=i,_possibleConstructorReturn(r,o)}return _inherits(t,e),t.prototype.addTrack_=function(t){var r=this;t.selected&&disableOthers(this,t),e.prototype.addTrack_.call(this,t),t.addEventListener&&t.addEventListener("selectedchange",function(){r.changing_||(r.changing_=!0,disableOthers(r,t),r.changing_=!1,r.trigger("change"))})},t.prototype.addTrack=function(e){this.addTrack_(e)},t.prototype.removeTrack=function(t){e.prototype.removeTrack_.call(this,t)},t}(_trackList2.default);exports.default=VideoTrackList;
},{"../utils/browser.js":297,"./track-list":293,"global/document":193}],296:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _trackEnums=require("./track-enums"),_track=require("./track"),_track2=_interopRequireDefault(_track),_mergeOptions=require("../utils/merge-options"),_mergeOptions2=_interopRequireDefault(_mergeOptions),_browser=require("../utils/browser.js"),browser=_interopRequireWildcard(_browser),VideoTrack=function(e){function t(){var r,o,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var i=(0,_mergeOptions2.default)(n,{kind:_trackEnums.VideoTrackKind[n.kind]||""}),s=r=_possibleConstructorReturn(this,e.call(this,i)),u=!1;if(browser.IS_IE8)for(var c in t.prototype)"constructor"!==c&&(s[c]=t.prototype[c]);return Object.defineProperty(s,"selected",{get:function(){return u},set:function(e){"boolean"==typeof e&&e!==u&&(u=e,this.trigger("selectedchange"))}}),i.selected&&(s.selected=i.selected),o=s,_possibleConstructorReturn(r,o)}return _inherits(t,e),t}(_track2.default);exports.default=VideoTrack;
},{"../utils/browser.js":297,"../utils/merge-options":306,"./track":294,"./track-enums":292}],297:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var I={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(I[t]=e[t]);return I.default=e,I}exports.__esModule=!0,exports.BACKGROUND_SIZE_SUPPORTED=exports.TOUCH_ENABLED=exports.IS_ANY_SAFARI=exports.IS_SAFARI=exports.IE_VERSION=exports.IS_IE8=exports.IS_CHROME=exports.IS_EDGE=exports.IS_FIREFOX=exports.IS_NATIVE_ANDROID=exports.IS_OLD_ANDROID=exports.ANDROID_VERSION=exports.IS_ANDROID=exports.IOS_VERSION=exports.IS_IOS=exports.IS_IPOD=exports.IS_IPHONE=exports.IS_IPAD=void 0;var _dom=require("./dom"),Dom=_interopRequireWildcard(_dom),_window=require("global/window"),_window2=_interopRequireDefault(_window),USER_AGENT=_window2.default.navigator&&_window2.default.navigator.userAgent||"",webkitVersionMap=/AppleWebKit\/([\d.]+)/i.exec(USER_AGENT),appleWebkitVersion=webkitVersionMap?parseFloat(webkitVersionMap.pop()):null,IS_IPAD=exports.IS_IPAD=/iPad/i.test(USER_AGENT),IS_IPHONE=exports.IS_IPHONE=/iPhone/i.test(USER_AGENT)&&!IS_IPAD,IS_IPOD=exports.IS_IPOD=/iPod/i.test(USER_AGENT),IS_IOS=exports.IS_IOS=IS_IPHONE||IS_IPAD||IS_IPOD,IOS_VERSION=exports.IOS_VERSION=function(){var e=USER_AGENT.match(/OS (\d+)_/i);return e&&e[1]?e[1]:null}(),IS_ANDROID=exports.IS_ANDROID=/Android/i.test(USER_AGENT),ANDROID_VERSION=exports.ANDROID_VERSION=function(){var e=USER_AGENT.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var I=e[1]&&parseFloat(e[1]),t=e[2]&&parseFloat(e[2]);return I&&t?parseFloat(e[1]+"."+e[2]):I?I:null}(),IS_OLD_ANDROID=exports.IS_OLD_ANDROID=IS_ANDROID&&/webkit/i.test(USER_AGENT)&&ANDROID_VERSION<2.3,IS_NATIVE_ANDROID=exports.IS_NATIVE_ANDROID=IS_ANDROID&&ANDROID_VERSION<5&&appleWebkitVersion<537,IS_FIREFOX=exports.IS_FIREFOX=/Firefox/i.test(USER_AGENT),IS_EDGE=exports.IS_EDGE=/Edge/i.test(USER_AGENT),IS_CHROME=exports.IS_CHROME=!IS_EDGE&&/Chrome/i.test(USER_AGENT),IS_IE8=exports.IS_IE8=/MSIE\s8\.0/.test(USER_AGENT),IE_VERSION=exports.IE_VERSION=function(e){return e&&parseFloat(e[1])}(/MSIE\s(\d+)\.\d/.exec(USER_AGENT)),IS_SAFARI=exports.IS_SAFARI=/Safari/i.test(USER_AGENT)&&!IS_CHROME&&!IS_ANDROID&&!IS_EDGE,IS_ANY_SAFARI=exports.IS_ANY_SAFARI=IS_SAFARI||IS_IOS,TOUCH_ENABLED=exports.TOUCH_ENABLED=Dom.isReal()&&("ontouchstart"in _window2.default||_window2.default.DocumentTouch&&_window2.default.document instanceof _window2.default.DocumentTouch),BACKGROUND_SIZE_SUPPORTED=exports.BACKGROUND_SIZE_SUPPORTED=Dom.isReal()&&"backgroundSize"in _window2.default.document.createElement("video").style;
},{"./dom":300,"global/window":194}],298:[function(require,module,exports){
"use strict";function bufferedPercent(e,r){var t=0,n=void 0,i=void 0;if(!r)return 0;e&&e.length||(e=(0,_timeRanges.createTimeRange)(0,0));for(var s=0;s<e.length;s++)n=e.start(s),i=e.end(s),i>r&&(i=r),t+=i-n;return t/r}exports.__esModule=!0,exports.bufferedPercent=bufferedPercent;var _timeRanges=require("./time-ranges.js");
},{"./time-ranges.js":309}],299:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function computedStyle(e,t){if(!e||!t)return"";if("function"==typeof _window2.default.getComputedStyle){var u=_window2.default.getComputedStyle(e);return u?u[t]:""}return e.currentStyle[t]||""}exports.__esModule=!0,exports.default=computedStyle;var _window=require("global/window"),_window2=_interopRequireDefault(_window);
},{"global/window":194}],300:[function(require,module,exports){
"use strict";function _interopRequireWildcard(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _taggedTemplateLiteralLoose(t,e){return t.raw=e,t}function isNonBlankString(t){return"string"==typeof t&&/\S/.test(t)}function throwIfWhitespace(t){if(/\s/.test(t))throw new Error("class has illegal whitespace characters")}function classRegExp(t){return new RegExp("(^|\\s)"+t+"($|\\s)")}function isReal(){return _document2.default===_window2.default.document&&"undefined"!=typeof _document2.default.createElement}function isEl(t){return(0,_obj.isObject)(t)&&1===t.nodeType}function createQuerier(t){return function(e,n){if(!isNonBlankString(e))return _document2.default[t](null);isNonBlankString(n)&&(n=_document2.default.querySelector(n));var r=isEl(n)?n:_document2.default;return r[t]&&r[t](e)}}function getEl(t){return 0===t.indexOf("#")&&(t=t.slice(1)),_document2.default.getElementById(t)}function createEl(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments[3],o=_document2.default.createElement(t);return Object.getOwnPropertyNames(e).forEach(function(t){var n=e[t];t.indexOf("aria-")!==-1||"role"===t||"type"===t?(_log2.default.warn((0,_tsml2.default)(_templateObject,t,n)),o.setAttribute(t,n)):"textContent"===t?textContent(o,n):o[t]=n}),Object.getOwnPropertyNames(n).forEach(function(t){o.setAttribute(t,n[t])}),r&&appendContent(o,r),o}function textContent(t,e){return"undefined"==typeof t.textContent?t.innerText=e:t.textContent=e,t}function insertElFirst(t,e){e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t)}function getElData(t){var e=t[elIdAttr];return e||(e=t[elIdAttr]=Guid.newGUID()),elData[e]||(elData[e]={}),elData[e]}function hasElData(t){var e=t[elIdAttr];return!!e&&!!Object.getOwnPropertyNames(elData[e]).length}function removeElData(t){var e=t[elIdAttr];if(e){delete elData[e];try{delete t[elIdAttr]}catch(e){t.removeAttribute?t.removeAttribute(elIdAttr):t[elIdAttr]=null}}}function hasElClass(t,e){return throwIfWhitespace(e),t.classList?t.classList.contains(e):classRegExp(e).test(t.className)}function addElClass(t,e){return t.classList?t.classList.add(e):hasElClass(t,e)||(t.className=(t.className+" "+e).trim()),t}function removeElClass(t,e){return t.classList?t.classList.remove(e):(throwIfWhitespace(e),t.className=t.className.split(/\s+/).filter(function(t){return t!==e}).join(" ")),t}function toggleElClass(t,e,n){var r=hasElClass(t,e);if("function"==typeof n&&(n=n(t,e)),"boolean"!=typeof n&&(n=!r),n!==r)return n?addElClass(t,e):removeElClass(t,e),t}function setElAttributes(t,e){Object.getOwnPropertyNames(e).forEach(function(n){var r=e[n];null===r||"undefined"==typeof r||r===!1?t.removeAttribute(n):t.setAttribute(n,r===!0?"":r)})}function getElAttributes(t){var e={},n=",autoplay,controls,loop,muted,default,";if(t&&t.attributes&&t.attributes.length>0)for(var r=t.attributes,o=r.length-1;o>=0;o--){var i=r[o].name,l=r[o].value;"boolean"!=typeof t[i]&&n.indexOf(","+i+",")===-1||(l=null!==l),e[i]=l}return e}function getAttribute(t,e){return t.getAttribute(e)}function setAttribute(t,e,n){t.setAttribute(e,n)}function removeAttribute(t,e){t.removeAttribute(e)}function blockTextSelection(){_document2.default.body.focus(),_document2.default.onselectstart=function(){return!1}}function unblockTextSelection(){_document2.default.onselectstart=function(){return!0}}function findElPosition(t){var e=void 0;if(t.getBoundingClientRect&&t.parentNode&&(e=t.getBoundingClientRect()),!e)return{left:0,top:0};var n=_document2.default.documentElement,r=_document2.default.body,o=n.clientLeft||r.clientLeft||0,i=_window2.default.pageXOffset||r.scrollLeft,l=e.left+i-o,a=n.clientTop||r.clientTop||0,s=_window2.default.pageYOffset||r.scrollTop,u=e.top+s-a;return{left:Math.round(l),top:Math.round(u)}}function getPointerPosition(t,e){var n={},r=findElPosition(t),o=t.offsetWidth,i=t.offsetHeight,l=r.top,a=r.left,s=e.pageY,u=e.pageX;return e.changedTouches&&(u=e.changedTouches[0].pageX,s=e.changedTouches[0].pageY),n.y=Math.max(0,Math.min(1,(l-s+i)/i)),n.x=Math.max(0,Math.min(1,(u-a)/o)),n}function isTextNode(t){return(0,_obj.isObject)(t)&&3===t.nodeType}function emptyEl(t){for(;t.firstChild;)t.removeChild(t.firstChild);return t}function normalizeContent(t){return"function"==typeof t&&(t=t()),(Array.isArray(t)?t:[t]).map(function(t){return"function"==typeof t&&(t=t()),isEl(t)||isTextNode(t)?t:"string"==typeof t&&/\S/.test(t)?_document2.default.createTextNode(t):void 0}).filter(function(t){return t})}function appendContent(t,e){return normalizeContent(e).forEach(function(e){return t.appendChild(e)}),t}function insertContent(t,e){return appendContent(emptyEl(t),e)}exports.__esModule=!0,exports.$$=exports.$=void 0;var _templateObject=_taggedTemplateLiteralLoose(["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."],["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."]);exports.isReal=isReal,exports.isEl=isEl,exports.getEl=getEl,exports.createEl=createEl,exports.textContent=textContent,exports.insertElFirst=insertElFirst,exports.getElData=getElData,exports.hasElData=hasElData,exports.removeElData=removeElData,exports.hasElClass=hasElClass,exports.addElClass=addElClass,exports.removeElClass=removeElClass,exports.toggleElClass=toggleElClass,exports.setElAttributes=setElAttributes,exports.getElAttributes=getElAttributes,exports.getAttribute=getAttribute,exports.setAttribute=setAttribute,exports.removeAttribute=removeAttribute,exports.blockTextSelection=blockTextSelection,exports.unblockTextSelection=unblockTextSelection,exports.findElPosition=findElPosition,exports.getPointerPosition=getPointerPosition,exports.isTextNode=isTextNode,exports.emptyEl=emptyEl,exports.normalizeContent=normalizeContent,exports.appendContent=appendContent,exports.insertContent=insertContent;var _document=require("global/document"),_document2=_interopRequireDefault(_document),_window=require("global/window"),_window2=_interopRequireDefault(_window),_guid=require("./guid.js"),Guid=_interopRequireWildcard(_guid),_log=require("./log.js"),_log2=_interopRequireDefault(_log),_tsml=require("tsml"),_tsml2=_interopRequireDefault(_tsml),_obj=require("./obj"),elData={},elIdAttr="vdata"+(new Date).getTime(),$=exports.$=createQuerier("querySelector"),$$=exports.$$=createQuerier("querySelectorAll");
},{"./guid.js":304,"./log.js":305,"./obj":307,"global/document":193,"global/window":194,"tsml":218}],301:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function _cleanUpEvents(e,t){var n=Dom.getElData(e);0===n.handlers[t].length&&(delete n.handlers[t],e.removeEventListener?e.removeEventListener(t,n.dispatcher,!1):e.detachEvent&&e.detachEvent("on"+t,n.dispatcher)),Object.getOwnPropertyNames(n.handlers).length<=0&&(delete n.handlers,delete n.dispatcher,delete n.disabled),0===Object.getOwnPropertyNames(n).length&&Dom.removeElData(e)}function _handleMultipleEvents(e,t,n,r){n.forEach(function(n){e(t,n,r)})}function fixEvent(e){function t(){return!0}function n(){return!1}return e&&e.isPropagationStopped||!function(){var r=e||_window2.default.event;e={};for(var a in r)"layerX"!==a&&"layerY"!==a&&"keyLocation"!==a&&"webkitMovementX"!==a&&"webkitMovementY"!==a&&("returnValue"===a&&r.preventDefault||(e[a]=r[a]));if(e.target||(e.target=e.srcElement||_document2.default),e.relatedTarget||(e.relatedTarget=e.fromElement===e.target?e.toElement:e.fromElement),e.preventDefault=function(){r.preventDefault&&r.preventDefault(),e.returnValue=!1,r.returnValue=!1,e.defaultPrevented=!0},e.defaultPrevented=!1,e.stopPropagation=function(){r.stopPropagation&&r.stopPropagation(),e.cancelBubble=!0,r.cancelBubble=!0,e.isPropagationStopped=t},e.isPropagationStopped=n,e.stopImmediatePropagation=function(){r.stopImmediatePropagation&&r.stopImmediatePropagation(),e.isImmediatePropagationStopped=t,e.stopPropagation()},e.isImmediatePropagationStopped=n,null!==e.clientX&&void 0!==e.clientX){var o=_document2.default.documentElement,i=_document2.default.body;e.pageX=e.clientX+(o&&o.scrollLeft||i&&i.scrollLeft||0)-(o&&o.clientLeft||i&&i.clientLeft||0),e.pageY=e.clientY+(o&&o.scrollTop||i&&i.scrollTop||0)-(o&&o.clientTop||i&&i.clientTop||0)}e.which=e.charCode||e.keyCode,null!==e.button&&void 0!==e.button&&(e.button=1&e.button?0:4&e.button?1:2&e.button?2:0)}(),e}function on(e,t,n){if(Array.isArray(t))return _handleMultipleEvents(on,e,t,n);var r=Dom.getElData(e);r.handlers||(r.handlers={}),r.handlers[t]||(r.handlers[t]=[]),n.guid||(n.guid=Guid.newGUID()),r.handlers[t].push(n),r.dispatcher||(r.disabled=!1,r.dispatcher=function(t,n){if(!r.disabled){t=fixEvent(t);var a=r.handlers[t.type];if(a)for(var o=a.slice(0),i=0,l=o.length;i<l&&!t.isImmediatePropagationStopped();i++)try{o[i].call(e,t,n)}catch(e){_log2.default.error(e)}}}),1===r.handlers[t].length&&(e.addEventListener?e.addEventListener(t,r.dispatcher,!1):e.attachEvent&&e.attachEvent("on"+t,r.dispatcher))}function off(e,t,n){if(Dom.hasElData(e)){var r=Dom.getElData(e);if(r.handlers){if(Array.isArray(t))return _handleMultipleEvents(off,e,t,n);var a=function(t){r.handlers[t]=[],_cleanUpEvents(e,t)};if(t){var o=r.handlers[t];if(o){if(!n)return void a(t);if(n.guid)for(var i=0;i<o.length;i++)o[i].guid===n.guid&&o.splice(i--,1);_cleanUpEvents(e,t)}}else for(var l in r.handlers)a(l)}}}function trigger(e,t,n){var r=Dom.hasElData(e)?Dom.getElData(e):{},a=e.parentNode||e.ownerDocument;if("string"==typeof t&&(t={type:t,target:e}),t=fixEvent(t),r.dispatcher&&r.dispatcher.call(e,t,n),a&&!t.isPropagationStopped()&&t.bubbles===!0)trigger.call(null,a,t,n);else if(!a&&!t.defaultPrevented){var o=Dom.getElData(t.target);t.target[t.type]&&(o.disabled=!0,"function"==typeof t.target[t.type]&&t.target[t.type](),o.disabled=!1)}return!t.defaultPrevented}function one(e,t,n){if(Array.isArray(t))return _handleMultipleEvents(one,e,t,n);var r=function r(){off(e,t,r),n.apply(this,arguments)};r.guid=n.guid=n.guid||Guid.newGUID(),on(e,t,r)}exports.__esModule=!0,exports.fixEvent=fixEvent,exports.on=on,exports.off=off,exports.trigger=trigger,exports.one=one;var _dom=require("./dom.js"),Dom=_interopRequireWildcard(_dom),_guid=require("./guid.js"),Guid=_interopRequireWildcard(_guid),_log=require("./log.js"),_log2=_interopRequireDefault(_log),_window=require("global/window"),_window2=_interopRequireDefault(_window),_document=require("global/document"),_document2=_interopRequireDefault(_document);
},{"./dom.js":300,"./guid.js":304,"./log.js":305,"global/document":193,"global/window":194}],302:[function(require,module,exports){
"use strict";exports.__esModule=!0,exports.throttle=exports.bind=void 0;var _guid=require("./guid.js"),bind=exports.bind=function(t,r,e){r.guid||(r.guid=(0,_guid.newGUID)());var i=function(){return r.apply(t,arguments)};return i.guid=e?e+"_"+r.guid:r.guid,i},throttle=exports.throttle=function(t,r){var e=Date.now(),i=function(){var i=Date.now();i-e>=r&&(t.apply(void 0,arguments),e=i)};return i};
},{"./guid.js":304}],303:[function(require,module,exports){
"use strict";function formatTime(o){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o;o=o<0?0:o;var r=Math.floor(o%60),a=Math.floor(o/60%60),e=Math.floor(o/3600),f=Math.floor(t/60%60),l=Math.floor(t/3600);return(isNaN(o)||o===1/0)&&(e=a=r="-"),e=e>0||l>0?e+":":"",a=((e||f>=10)&&a<10?"0"+a:a)+":",r=r<10?"0"+r:r,e+a+r}exports.__esModule=!0,exports.default=formatTime;
},{}],304:[function(require,module,exports){
"use strict";function newGUID(){return _guid++}exports.__esModule=!0,exports.newGUID=newGUID;var _guid=1;
},{}],305:[function(require,module,exports){
"use strict";function _interopRequireDefault(r){return r&&r.__esModule?r:{default:r}}exports.__esModule=!0,exports.logByType=void 0;var _window=require("global/window"),_window2=_interopRequireDefault(_window),_browser=require("./browser"),_obj=require("./obj"),log=void 0,logByType=exports.logByType=function(r,o){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!!_browser.IE_VERSION&&_browser.IE_VERSION<11;"log"!==r&&o.unshift(r.toUpperCase()+":"),log.history.push(o),o.unshift("VIDEOJS:");var n=_window2.default.console&&_window2.default.console[r];n&&(e&&(o=o.map(function(r){if((0,_obj.isObject)(r)||Array.isArray(r))try{return JSON.stringify(r)}catch(o){return String(r)}return String(r)}).join(" ")),n.apply?n[Array.isArray(o)?"apply":"call"](_window2.default.console,o):n(o))};log=function(){for(var r=arguments.length,o=Array(r),e=0;e<r;e++)o[e]=arguments[e];logByType("log",o)},log.history=[],log.error=function(){for(var r=arguments.length,o=Array(r),e=0;e<r;e++)o[e]=arguments[e];return logByType("error",o)},log.warn=function(){for(var r=arguments.length,o=Array(r),e=0;e<r;e++)o[e]=arguments[e];return logByType("warn",o)},exports.default=log;
},{"./browser":297,"./obj":307,"global/window":194}],306:[function(require,module,exports){
"use strict";function mergeOptions(){for(var e={},o=arguments.length,r=Array(o),i=0;i<o;i++)r[i]=arguments[i];return r.forEach(function(o){o&&(0,_obj.each)(o,function(o,r){return(0,_obj.isPlain)(o)?((0,_obj.isPlain)(e[r])||(e[r]={}),void(e[r]=mergeOptions(e[r],o))):void(e[r]=o)})}),e}exports.__esModule=!0,exports.default=mergeOptions;var _obj=require("./obj");
},{"./obj":307}],307:[function(require,module,exports){
"use strict";function each(t,e){Object.keys(t).forEach(function(n){return e(t[n],n)})}function reduce(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object.keys(t).reduce(function(n,o){return e(n,t[o],o)},n)}function assign(t){for(var e=arguments.length,n=Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return Object.assign?Object.assign.apply(Object,[t].concat(n)):(n.forEach(function(e){e&&each(e,function(e,n){t[n]=e})}),t)}function isObject(t){return!!t&&"object"===("undefined"==typeof t?"undefined":_typeof(t))}function isPlain(t){return isObject(t)&&"[object Object]"===toString.call(t)&&t.constructor===Object}exports.__esModule=!0;var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};exports.each=each,exports.reduce=reduce,exports.assign=assign,exports.isObject=isObject,exports.isPlain=isPlain;var toString=Object.prototype.toString;
},{}],308:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}exports.__esModule=!0,exports.setTextContent=exports.createStyleElement=void 0;var _document=require("global/document"),_document2=_interopRequireDefault(_document),createStyleElement=exports.createStyleElement=function(e){var t=_document2.default.createElement("style");return t.className=e,t},setTextContent=exports.setTextContent=function(e,t){e.styleSheet?e.styleSheet.cssText=t:e.textContent=t};
},{"global/document":193}],309:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function rangeCheck(e,n,t){if(n<0||n>t)throw new Error("Failed to execute '"+e+"' on 'TimeRanges': The index provided ("+n+") is greater than or equal to the maximum bound ("+t+").")}function getRange(e,n,t,r){return void 0===r&&(_log2.default.warn("DEPRECATED: Function '"+e+"' on 'TimeRanges' called without an index argument."),r=0),rangeCheck(e,r,t.length-1),t[r][n]}function createTimeRangesObj(e){return void 0===e||0===e.length?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:e.length,start:getRange.bind(null,"start",0,e),end:getRange.bind(null,"end",1,e)}}function createTimeRanges(e,n){return Array.isArray(e)?createTimeRangesObj(e):void 0===e||void 0===n?createTimeRangesObj():createTimeRangesObj([[e,n]])}exports.__esModule=!0,exports.createTimeRange=void 0,exports.createTimeRanges=createTimeRanges;var _log=require("./log.js"),_log2=_interopRequireDefault(_log);exports.createTimeRange=createTimeRanges;
},{"./log.js":305}],310:[function(require,module,exports){
"use strict";function toTitleCase(e){return"string"!=typeof e?e:e.charAt(0).toUpperCase()+e.slice(1)}exports.__esModule=!0,exports.default=toTitleCase;
},{}],311:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}exports.__esModule=!0,exports.isCrossOrigin=exports.getFileExtension=exports.getAbsoluteURL=exports.parseUrl=void 0;var _document=require("global/document"),_document2=_interopRequireDefault(_document),_window=require("global/window"),_window2=_interopRequireDefault(_window),parseUrl=exports.parseUrl=function(e){var t=["protocol","hostname","port","pathname","search","hash","host"],o=_document2.default.createElement("a");o.href=e;var r=""===o.host&&"file:"!==o.protocol,n=void 0;r&&(n=_document2.default.createElement("div"),n.innerHTML='<a href="'+e+'"></a>',o=n.firstChild,n.setAttribute("style","display:none; position:absolute;"),_document2.default.body.appendChild(n));for(var i={},s=0;s<t.length;s++)i[t[s]]=o[t[s]];return"http:"===i.protocol&&(i.host=i.host.replace(/:80$/,"")),"https:"===i.protocol&&(i.host=i.host.replace(/:443$/,"")),r&&_document2.default.body.removeChild(n),i},getAbsoluteURL=exports.getAbsoluteURL=function(e){if(!e.match(/^https?:\/\//)){var t=_document2.default.createElement("div");t.innerHTML='<a href="'+e+'">x</a>',e=t.firstChild.href}return e},getFileExtension=exports.getFileExtension=function(e){if("string"==typeof e){var t=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/i,o=t.exec(e);if(o)return o.pop().toLowerCase()}return""},isCrossOrigin=exports.isCrossOrigin=function(e){var t=_window2.default.location,o=parseUrl(e),r=":"===o.protocol?t.protocol:o.protocol,n=r+o.host!==t.protocol+t.host;return n};
},{"global/document":193,"global/window":194}],312:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function videojs(e,t,o){var r=void 0;if("string"==typeof e){if(0===e.indexOf("#")&&(e=e.slice(1)),videojs.getPlayers()[e])return t&&_log2.default.warn('Player "'+e+'" is already initialised. Options will not be applied.'),o&&videojs.getPlayers()[e].ready(o),videojs.getPlayers()[e];r=Dom.getEl(e)}else r=e;if(!r||!r.nodeName)throw new TypeError("The element or ID supplied is not valid. (videojs)");if(r.player||_player2.default.players[r.playerId])return r.player||_player2.default.players[r.playerId];t=t||{},videojs.hooks("beforesetup").forEach(function(e){var o=e(r,(0,_mergeOptions3.default)(t));return!(0,_obj.isObject)(o)||Array.isArray(o)?void _log2.default.error("please return an object in beforesetup hooks"):void(t=(0,_mergeOptions3.default)(t,o))});var i=_component2.default.getComponent("Player"),s=new i(r,t,o);return videojs.hooks("setup").forEach(function(e){return e(s)}),s}exports.__esModule=!0;var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_window=require("global/window"),_window2=_interopRequireDefault(_window),_document=require("global/document"),_document2=_interopRequireDefault(_document),_setup=require("./setup"),setup=_interopRequireWildcard(_setup),_stylesheet=require("./utils/stylesheet.js"),stylesheet=_interopRequireWildcard(_stylesheet),_component=require("./component"),_component2=_interopRequireDefault(_component),_eventTarget=require("./event-target"),_eventTarget2=_interopRequireDefault(_eventTarget),_events=require("./utils/events.js"),Events=_interopRequireWildcard(_events),_player=require("./player"),_player2=_interopRequireDefault(_player),_plugins=require("./plugins.js"),_plugins2=_interopRequireDefault(_plugins),_mergeOptions2=require("./utils/merge-options.js"),_mergeOptions3=_interopRequireDefault(_mergeOptions2),_fn=require("./utils/fn.js"),Fn=_interopRequireWildcard(_fn),_textTrack=require("./tracks/text-track.js"),_textTrack2=_interopRequireDefault(_textTrack),_audioTrack=require("./tracks/audio-track.js"),_audioTrack2=_interopRequireDefault(_audioTrack),_videoTrack=require("./tracks/video-track.js"),_videoTrack2=_interopRequireDefault(_videoTrack),_timeRanges=require("./utils/time-ranges.js"),_formatTime=require("./utils/format-time.js"),_formatTime2=_interopRequireDefault(_formatTime),_log=require("./utils/log.js"),_log2=_interopRequireDefault(_log),_dom=require("./utils/dom.js"),Dom=_interopRequireWildcard(_dom),_browser=require("./utils/browser.js"),browser=_interopRequireWildcard(_browser),_url=require("./utils/url.js"),Url=_interopRequireWildcard(_url),_obj=require("./utils/obj"),_computedStyle=require("./utils/computed-style.js"),_computedStyle2=_interopRequireDefault(_computedStyle),_extend=require("./extend.js"),_extend2=_interopRequireDefault(_extend),_xhr=require("xhr"),_xhr2=_interopRequireDefault(_xhr),_tech=require("./tech/tech.js"),_tech2=_interopRequireDefault(_tech);if("undefined"==typeof HTMLVideoElement&&Dom.isReal()&&(_document2.default.createElement("video"),_document2.default.createElement("audio"),_document2.default.createElement("track")),videojs.hooks_={},videojs.hooks=function(e,t){return videojs.hooks_[e]=videojs.hooks_[e]||[],t&&(videojs.hooks_[e]=videojs.hooks_[e].concat(t)),videojs.hooks_[e]},videojs.hook=function(e,t){videojs.hooks(e,t)},videojs.removeHook=function(e,t){var o=videojs.hooks(e).indexOf(t);return!(o<=-1)&&(videojs.hooks_[e]=videojs.hooks_[e].slice(),videojs.hooks_[e].splice(o,1),!0)},_window2.default.VIDEOJS_NO_DYNAMIC_STYLE!==!0&&Dom.isReal()){var style=Dom.$(".vjs-styles-defaults");if(!style){style=stylesheet.createStyleElement("vjs-styles-defaults");var head=Dom.$("head");head&&head.insertBefore(style,head.firstChild),stylesheet.setTextContent(style,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")}}setup.autoSetupTimeout(1,videojs),videojs.VERSION="5.16.0",videojs.options=_player2.default.prototype.options_,videojs.getPlayers=function(){return _player2.default.players},videojs.players=_player2.default.players,videojs.getComponent=_component2.default.getComponent,videojs.registerComponent=function(e,t){_tech2.default.isTech(t)&&_log2.default.warn("The "+e+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),_component2.default.registerComponent.call(_component2.default,e,t)},videojs.getTech=_tech2.default.getTech,videojs.registerTech=_tech2.default.registerTech,videojs.browser=browser,videojs.TOUCH_ENABLED=browser.TOUCH_ENABLED,videojs.extend=_extend2.default,videojs.mergeOptions=_mergeOptions3.default,videojs.bind=Fn.bind,videojs.plugin=_plugins2.default,videojs.addLanguage=function(e,t){var o;return e=(""+e).toLowerCase(),videojs.options.languages=(0,_mergeOptions3.default)(videojs.options.languages,(o={},o[e]=t,o)),videojs.options.languages[e]},videojs.log=_log2.default,videojs.createTimeRange=videojs.createTimeRanges=_timeRanges.createTimeRanges,videojs.formatTime=_formatTime2.default,videojs.parseUrl=Url.parseUrl,videojs.isCrossOrigin=Url.isCrossOrigin,videojs.EventTarget=_eventTarget2.default,videojs.on=Events.on,videojs.one=Events.one,videojs.off=Events.off,videojs.trigger=Events.trigger,videojs.xhr=_xhr2.default,videojs.TextTrack=_textTrack2.default,videojs.AudioTrack=_audioTrack2.default,videojs.VideoTrack=_videoTrack2.default,videojs.isEl=Dom.isEl,videojs.isTextNode=Dom.isTextNode,videojs.createEl=Dom.createEl,videojs.hasClass=Dom.hasElClass,videojs.addClass=Dom.addElClass,videojs.removeClass=Dom.removeElClass,videojs.toggleClass=Dom.toggleElClass,videojs.setAttributes=Dom.setElAttributes,videojs.getAttributes=Dom.getElAttributes,videojs.emptyEl=Dom.emptyEl,videojs.appendContent=Dom.appendContent,videojs.insertContent=Dom.insertContent,videojs.computedStyle=_computedStyle2.default,"function"==typeof define&&define.amd?define("videojs",[],function(){return videojs}):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"object"===("undefined"==typeof module?"undefined":_typeof(module))&&(module.exports=videojs),exports.default=videojs;
},{"./component":224,"./event-target":261,"./extend.js":262,"./player":270,"./plugins.js":271,"./setup":275,"./tech/tech.js":281,"./tracks/audio-track.js":283,"./tracks/text-track.js":291,"./tracks/video-track.js":296,"./utils/browser.js":297,"./utils/computed-style.js":299,"./utils/dom.js":300,"./utils/events.js":301,"./utils/fn.js":302,"./utils/format-time.js":303,"./utils/log.js":305,"./utils/merge-options.js":306,"./utils/obj":307,"./utils/stylesheet.js":308,"./utils/time-ranges.js":309,"./utils/url.js":311,"global/document":193,"global/window":194,"xhr":473}],313:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function handlePlaybackMetadataLoaded(e,a){function d(e){return"dash-audio-"+e}function r(e,a){return e.find(function(e){var r=e.index;return d(r)===a.id})}var n=e.dash.mediaPlayer,i=n.getTracksFor("audio"),t=e.audioTracks();t.length&&a.clearTracks(["audio"]);var u=n.getCurrentTrackFor("audio");i.forEach(function(e){t.addTrack(new _video2.default.AudioTrack({enabled:e===u,id:d(e.index),kind:e.kind||"main",label:e.lang,language:e.lang}))}),t.addEventListener("change",function(){for(var e=0;e<t.length;e++){var a=t[e];if(a.enabled){var d=r(i,a);n.setCurrentTrack(d)}else;}})}function setupAudioTracks(e,a){e.dash.mediaPlayer.on(_dashjs2.default.MediaPlayer.events.PLAYBACK_METADATA_LOADED,handlePlaybackMetadataLoaded.bind(null,e,a))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=setupAudioTracks;var _dashjs=require("dashjs"),_dashjs2=_interopRequireDefault(_dashjs),_video=require("video.js"),_video2=_interopRequireDefault(_video);
},{"dashjs":12,"video.js":312}],314:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _toConsumableArray(e){if(Array.isArray(e)){for(var a=0,t=Array(e.length);a<e.length;a++)t[a]=e[a];return t}return Array.from(e)}function _classCallCheck(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,a){for(var t=0;t<a.length;t++){var r=a[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(a,t,r){return t&&e(a.prototype,t),r&&e(a,r),a}}(),_window=require("global/window"),_window2=_interopRequireDefault(_window),_video=require("video.js"),_video2=_interopRequireDefault(_video),_dashjs=require("dashjs"),_dashjs2=_interopRequireDefault(_dashjs),_setupAudioTracks=require("./setup-audio-tracks"),_setupAudioTracks2=_interopRequireDefault(_setupAudioTracks),isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},Html5DashJS=function(){function e(a,t,r){var i=this;if(_classCallCheck(this,e),r=r||t.options_,this.player=(0,_video2.default)(r.playerId),this.player.dash=this.player.dash||{},this.tech_=t,this.el_=t.el(),this.elParent_=this.el_.parentNode,a.src){t.isReady_=!1,e.updateSourceData&&(_video2.default.log.warn('updateSourceData has been deprecated. Please switch to using hook("updatesource", callback).'),a=e.updateSourceData(a)),e.hooks("updatesource").forEach(function(e){a=e(a)});var o=a.src;this.keySystemOptions_=e.buildDashJSProtData(a.keySystemOptions),this.player.dash.mediaPlayer=_dashjs2.default.MediaPlayer().create(),this.mediaPlayer_=this.player.dash.mediaPlayer,e.useVideoJSDebug&&(_video2.default.log.warn('useVideoJSDebug has been deprecated. Please switch to using hook("beforeinitialize", callback).'),e.useVideoJSDebug(this.mediaPlayer_)),e.beforeInitialize&&(_video2.default.log.warn('beforeInitialize has been deprecated. Please switch to using hook("beforeinitialize", callback).'),e.beforeInitialize(this.player,this.mediaPlayer_)),e.hooks("beforeinitialize").forEach(function(e){e(i.player,i.mediaPlayer_)}),this.mediaPlayer_.initialize(),r.dash&&Object.keys(r.dash).forEach(function(e){var a,t="set"+e.charAt(0).toUpperCase()+e.slice(1),o=r.dash[e];return i.mediaPlayer_.hasOwnProperty(t)&&(_video2.default.log.warn("Using dash options in videojs-contrib-dash without the set prefix "+("has been deprecated. Change '"+e+"' to '"+t+"'")),e=t),i.mediaPlayer_.hasOwnProperty(e)?(isArray(o)||(o=[o]),void(a=i.mediaPlayer_)[e].apply(a,_toConsumableArray(o))):void _video2.default.log.warn("Warning: dash configuration option unrecognized: "+e)}),this.mediaPlayer_.attachView(this.el_),this.mediaPlayer_.setAutoPlay(!1),_setupAudioTracks2.default.call(null,this.player,t),this.mediaPlayer_.setProtectionData(this.keySystemOptions_),this.mediaPlayer_.attachSource(o),this.tech_.triggerReady()}}return _createClass(e,[{key:"dispose",value:function(){this.mediaPlayer_&&this.mediaPlayer_.reset(),this.player.dash&&delete this.player.dash}},{key:"duration",value:function e(){var e=this.el_.duration;return e===Number.MAX_VALUE?1/0:e}}],[{key:"buildDashJSProtData",value:function(e){var a={};if(!e||!isArray(e))return null;for(var t=0;t<e.length;t++){var r=e[t],i=_video2.default.mergeOptions({},r.options);i.licenseUrl&&(i.serverURL=i.licenseUrl,delete i.licenseUrl),a[r.name]=i}return a}},{key:"hooks",value:function(a,t){return e.hooks_[a]=e.hooks_[a]||[],t&&(e.hooks_[a]=e.hooks_[a].concat(t)),e.hooks_[a]}},{key:"hook",value:function(a,t){e.hooks(a,t)}},{key:"removeHook",value:function(a,t){var r=e.hooks(a).indexOf(t);return r!==-1&&(e.hooks_[a]=e.hooks_[a].slice(),e.hooks_[a].splice(r,1),!0)}}]),e}();Html5DashJS.hooks_={};var canHandleKeySystems=function(e){e=JSON.parse(JSON.stringify(e)),Html5DashJS.updateSourceData&&(_video2.default.log.warn('updateSourceData has been deprecated. Please switch to using hook("updatesource", callback).'),e=Html5DashJS.updateSourceData(e)),Html5DashJS.hooks("updatesource").forEach(function(a){e=a(e)});var a=document.createElement("video");return!(e.keySystemOptions&&!navigator.requestMediaKeySystemAccess&&!a.msSetMediaKeys)};_video2.default.DashSourceHandler=function(){return{canHandleSource:function(e){var a=/\.mpd/i;return canHandleKeySystems(e)?_video2.default.DashSourceHandler.canPlayType(e.type)?"probably":a.test(e.src)?"maybe":"":""},handleSource:function(e,a,t){return new Html5DashJS(e,a,t)},canPlayType:function(e){return _video2.default.DashSourceHandler.canPlayType(e)}}},_video2.default.DashSourceHandler.canPlayType=function(e){var a=/^application\/dash\+xml/i;return a.test(e)?"probably":""},_window2.default.MediaSource&&_video2.default.getTech("Html5").registerSourceHandler(_video2.default.DashSourceHandler(),0),_video2.default.Html5DashJS=Html5DashJS,exports.default=Html5DashJS;
},{"./setup-audio-tracks":313,"dashjs":12,"global/window":194,"video.js":312}],315:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _slicedToArray=function(){function e(e,t){var n=[],r=!0,i=!1,u=void 0;try{for(var a,d=e[Symbol.iterator]();!(r=(a=d.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,u=e}finally{try{!r&&d.return&&d.return()}finally{if(i)throw u}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_globalWindow=require("global/window"),_globalWindow2=_interopRequireDefault(_globalWindow),findAdCue=function(e,t){for(var n=e.cues,r=0;r<n.length;r++){var i=n[r];if(t>=i.adStartTime&&t<=i.adEndTime)return i}return null},updateAdCues=function(e,t){var n=arguments.length<=2||void 0===arguments[2]?0:arguments[2];if(e.segments)for(var r=n,i=void 0,u=0;u<e.segments.length;u++){var a=e.segments[u];if(i||(i=findAdCue(t,r+a.duration/2)),i){if("cueIn"in a){i.endTime=r,i.adEndTime=r,r+=a.duration,i=null;continue}if(r<i.endTime){r+=a.duration;continue}i.endTime+=a.duration}else if("cueOut"in a&&(i=new _globalWindow2.default.VTTCue(r,r+a.duration,a.cueOut),i.adStartTime=r,i.adEndTime=r+parseFloat(a.cueOut),t.addCue(i)),"cueOutCont"in a){var d=void 0,o=void 0,l=a.cueOutCont.split("/").map(parseFloat),f=_slicedToArray(l,2);d=f[0],o=f[1],i=new _globalWindow2.default.VTTCue(r,r+a.duration,""),i.adStartTime=r-d,i.adEndTime=i.adStartTime+o,t.addCue(i)}r+=a.duration}};exports.default={updateAdCues:updateAdCues,findAdCue:findAdCue},module.exports=exports.default;
},{"global/window":194}],316:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var textRange=function(t,r){return t.start(r)+"-"+t.end(r)},formatHexString=function(t,r){var e=t.toString(16);return"00".substring(0,2-e.length)+e+(r%2?" ":"")},formatAsciiString=function(t){return t>=32&&t<126?String.fromCharCode(t):"."},utils={hexDump:function(t){for(var r=Array.prototype.slice.call(t),e=16,n="",i=void 0,o=void 0,u=0;u<r.length/e;u++)i=r.slice(u*e,u*e+e).map(formatHexString).join(""),o=r.slice(u*e,u*e+e).map(formatAsciiString).join(""),n+=i+" "+o+"\n";return n},tagDump:function(t){return utils.hexDump(t.bytes)},textRanges:function(t){var r="",e=void 0;for(e=0;e<t.length;e++)r+=textRange(t,e)+" ";return r}};exports.default=utils,module.exports=exports.default;
},{}],317:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={GOAL_BUFFER_LENGTH:30},module.exports=exports.default;
},{}],318:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),_get=function(e,t,i){for(var a=!0;a;){var r=e,o=t,s=i;a=!1,null===r&&(r=Function.prototype);var n=Object.getOwnPropertyDescriptor(r,o);if(void 0!==n){if("value"in n)return n.value;var d=n.get;if(void 0===d)return;return d.call(s)}var u=Object.getPrototypeOf(r);if(null===u)return;e=u,t=o,i=s,a=!0,n=u=void 0}},_playlistLoader=require("./playlist-loader"),_playlistLoader2=_interopRequireDefault(_playlistLoader),_segmentLoader=require("./segment-loader"),_segmentLoader2=_interopRequireDefault(_segmentLoader),_ranges=require("./ranges"),_ranges2=_interopRequireDefault(_ranges),_videoJs=require("video.js"),_videoJs2=_interopRequireDefault(_videoJs),_adCueTags=require("./ad-cue-tags"),_adCueTags2=_interopRequireDefault(_adCueTags),_syncController=require("./sync-controller"),_syncController2=_interopRequireDefault(_syncController),_videojsContribMediaSourcesEs5CodecUtils=require("videojs-contrib-media-sources/es5/codec-utils"),BLACKLIST_DURATION=3e5,Hls=void 0,objectChanged=function(e,t){if(typeof e!=typeof t)return!0;if(Object.keys(e).length!==Object.keys(t).length)return!0;for(var i in e)if(e[i]!==t[i])return!0;return!1},parseCodecs=function(e){var t={codecCount:0,videoCodec:null,videoObjectTypeIndicator:null,audioProfile:null},i=void 0;return t.codecCount=e.split(",").length,t.codecCount=t.codecCount||2,i=/(^|\s|,)+(avc1)([^ ,]*)/i.exec(e),i&&(t.videoCodec=i[2],t.videoObjectTypeIndicator=i[3]),t.audioProfile=/(^|\s|,)+mp4a.[0-9A-Fa-f]+\.([0-9A-Fa-f]+)/i.exec(e),t.audioProfile=t.audioProfile&&t.audioProfile[2],t},mapLegacyAvcCodecs_=function(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,function(e){return(0,_videojsContribMediaSourcesEs5CodecUtils.translateLegacyCodecs)([e])[0]})};exports.mapLegacyAvcCodecs_=mapLegacyAvcCodecs_;var mimeTypesForPlaylist_=function(e,t){var i="mp2t",a={videoCodec:"avc1",videoObjectTypeIndicator:".4d400d",audioProfile:"2"},r=[],o=void 0,s=null;if(!t)return[];t.segments&&t.segments.length&&t.segments[0].map&&(i="mp4"),o=t.attributes||{},o.CODECS&&!function(){var e=parseCodecs(o.CODECS);Object.keys(e).forEach(function(t){a[t]=e[t]||a[t]})}(),e.mediaGroups.AUDIO&&(r=e.mediaGroups.AUDIO[o.AUDIO]);for(var n in r){if(s&&!!r[n].uri!=!!s.uri)return["video/"+i+'; codecs="'+a.videoCodec+a.videoObjectTypeIndicator+", mp4a.40."+a.audioProfile+'"',"audio/"+i+'; codecs="mp4a.40.'+a.audioProfile+'"'];s=r[n]}return s&&s.uri?["video/"+i+'; codecs="'+a.videoCodec+a.videoObjectTypeIndicator+'"',"audio/"+i+'; codecs="mp4a.40.'+a.audioProfile+'"']:["video/"+i+'; codecs="'+a.videoCodec+a.videoObjectTypeIndicator+", mp4a.40."+a.audioProfile+'"']};exports.mimeTypesForPlaylist_=mimeTypesForPlaylist_;var MasterPlaylistController=function(e){function t(e){var i=this;_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this);var a=e.url,r=e.withCredentials,o=e.mode,s=e.tech,n=e.bandwidth,d=e.externHls,u=e.useCueTags;if(!a)throw new Error("A non-empty playlist URL is required");Hls=d,this.withCredentials=r,this.tech_=s,this.hls_=s.hls,this.mode_=o,this.useCueTags_=u,this.useCueTags_&&(this.cueTagsTrack_=this.tech_.addTextTrack("metadata","ad-cues"),this.cueTagsTrack_.inBandMetadataTrackDispatchType="",this.tech_.textTracks().addTrack_(this.cueTagsTrack_)),this.audioTracks_=[],this.requestOptions_={withCredentials:this.withCredentials,timeout:null},this.audioGroups_={},this.mediaSource=new _videoJs2.default.MediaSource({mode:o}),this.audioinfo_=null,this.mediaSource.on("audioinfo",this.handleAudioinfoUpdate_.bind(this)),this.mediaSource.addEventListener("sourceopen",this.handleSourceOpen_.bind(this)),this.seekable_=_videoJs2.default.createTimeRanges(),this.hasPlayed_=function(){return!1},this.syncController_=new _syncController2.default;var l={hls:this.hls_,mediaSource:this.mediaSource,currentTime:this.tech_.currentTime.bind(this.tech_),seekable:function(){return i.seekable()},seeking:function(){return i.tech_.seeking()},setCurrentTime:function(e){return i.tech_.setCurrentTime(e)},hasPlayed:function(){return i.hasPlayed_()},bandwidth:n,syncController:this.syncController_};this.masterPlaylistLoader_=new _playlistLoader2.default(a,this.hls_,this.withCredentials),this.setupMasterPlaylistLoaderListeners_(),this.audioPlaylistLoader_=null,this.mainSegmentLoader_=new _segmentLoader2.default(l),this.audioSegmentLoader_=new _segmentLoader2.default(l),this.setupSegmentLoaderListeners_(),this.masterPlaylistLoader_.start()}return _inherits(t,e),_createClass(t,[{key:"setupMasterPlaylistLoaderListeners_",value:function(){var e=this;this.masterPlaylistLoader_.on("loadedmetadata",function(){var t=e.masterPlaylistLoader_.media(),i=1.5*e.masterPlaylistLoader_.targetDuration*1e3;e.requestOptions_.timeout=i,t.endList&&"none"!==e.tech_.preload()&&(e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.mainSegmentLoader_.load()),e.fillAudioTracks_(),e.setupAudio();try{e.setupSourceBuffers_()}catch(t){return _videoJs2.default.log.warn("Failed to create SourceBuffers",t),e.mediaSource.endOfStream("decode")}e.setupFirstPlay(),e.trigger("audioupdate"),e.trigger("selectedinitialmedia")}),this.masterPlaylistLoader_.on("loadedplaylist",function(){var t=e.masterPlaylistLoader_.media();return t?(e.useCueTags_&&e.updateAdCues_(t),e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.updateDuration(),void(t.endList||!function(){var t=function(){var t=e.seekable();0!==t.length&&e.mediaSource.addSeekableRange_(t.start(0),t.end(0))};e.duration()!==1/0?!function(){var i=function i(){e.duration()===1/0?t():e.tech_.one("durationchange",i)};e.tech_.one("durationchange",i)}():t()}())):(e.initialMedia_=e.selectPlaylist(),void e.masterPlaylistLoader_.media(e.initialMedia_))}),this.masterPlaylistLoader_.on("error",function(){e.blacklistCurrentPlaylist(e.masterPlaylistLoader_.error)}),this.masterPlaylistLoader_.on("mediachanging",function(){e.mainSegmentLoader_.abort(),e.mainSegmentLoader_.pause()}),this.masterPlaylistLoader_.on("mediachange",function(){var t=e.masterPlaylistLoader_.media(),i=1.5*e.masterPlaylistLoader_.targetDuration*1e3,a=void 0,r=void 0;e.masterPlaylistLoader_.isLowestEnabledRendition_()?e.requestOptions_.timeout=0:e.requestOptions_.timeout=i,e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.mainSegmentLoader_.load(),a=e.activeAudioGroup(),r=a.filter(function(e){return e.enabled})[0],r||(e.setupAudio(),e.trigger("audioupdate")),e.tech_.trigger({type:"mediachange",bubbles:!0})})}},{key:"setupSegmentLoaderListeners_",value:function(){var e=this;this.mainSegmentLoader_.on("progress",function(){e.masterPlaylistLoader_.media(e.selectPlaylist()),e.trigger("progress")}),this.mainSegmentLoader_.on("error",function(){e.blacklistCurrentPlaylist(e.mainSegmentLoader_.error())}),this.mainSegmentLoader_.on("syncinfoupdate",function(){e.onSyncInfoUpdate_()}),this.audioSegmentLoader_.on("syncinfoupdate",function(){e.onSyncInfoUpdate_()}),this.audioSegmentLoader_.on("error",function(){_videoJs2.default.log.warn("Problem encountered with the current alternate audio track. Switching back to default."),e.audioSegmentLoader_.abort(),e.audioPlaylistLoader_=null,e.setupAudio()})}},{key:"handleAudioinfoUpdate_",value:function(e){if(Hls.supportsAudioInfoChange_()||!this.audioInfo_||!objectChanged(this.audioInfo_,e.info))return void(this.audioInfo_=e.info);var t="had different audio properties (channels, sample rate, etc.) or changed in some other way.  This behavior is currently unsupported in Firefox 48 and below due to an issue: \n\nhttps://bugzilla.mozilla.org/show_bug.cgi?id=1247138\n\n",i=this.activeAudioGroup().map(function(e){return e.enabled}).indexOf(!0),a=this.activeAudioGroup()[i],r=this.activeAudioGroup().filter(function(e){return e.properties_&&e.properties_.default})[0];this.audioPlaylistLoader_?(t="The audio track '"+a.label+"' that we tried to "+("switch to "+t+" Unfortunately this means we will have to ")+("return you to the main track '"+r.label+"'. Sorry!"),r.enabled=!0,this.activeAudioGroup().splice(i,1),this.trigger("audioupdate")):(t="The rendition that we tried to switch to "+t+"Unfortunately that means we will have to blacklist the current playlist and switch to another. Sorry!",this.blacklistCurrentPlaylist()),_videoJs2.default.log.warn(t),this.setupAudio()}},{key:"mediaRequests_",value:function(){return this.audioSegmentLoader_.mediaRequests+this.mainSegmentLoader_.mediaRequests}},{key:"mediaTransferDuration_",value:function(){return this.audioSegmentLoader_.mediaTransferDuration+this.mainSegmentLoader_.mediaTransferDuration}},{key:"mediaBytesTransferred_",value:function(){return this.audioSegmentLoader_.mediaBytesTransferred+this.mainSegmentLoader_.mediaBytesTransferred}},{key:"mediaSecondsLoaded_",value:function(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}},{key:"fillAudioTracks_",value:function(){var e=this.master(),t=e.mediaGroups||{};t&&t.AUDIO&&0!==Object.keys(t.AUDIO).length&&"html5"===this.mode_||(t.AUDIO={main:{default:{default:!0}}});for(var i in t.AUDIO){this.audioGroups_[i]||(this.audioGroups_[i]=[]);for(var a in t.AUDIO[i]){var r=t.AUDIO[i][a],o=new _videoJs2.default.AudioTrack({id:a,kind:r.default?"main":"alternative",enabled:!1,language:r.language,label:a});o.properties_=r,this.audioGroups_[i].push(o)}}(this.activeAudioGroup().filter(function(e){return e.properties_.default})[0]||this.activeAudioGroup()[0]).enabled=!0}},{key:"load",value:function(){this.mainSegmentLoader_.load(),this.audioPlaylistLoader_&&this.audioSegmentLoader_.load()}},{key:"activeAudioGroup",value:function(){var e=this.masterPlaylistLoader_.media(),t=void 0;return e.attributes&&e.attributes.AUDIO&&(t=this.audioGroups_[e.attributes.AUDIO]),t||this.audioGroups_.main}},{key:"setupAudio",value:function(){var e=this,t=this.activeAudioGroup(),i=t.filter(function(e){return e.enabled})[0];return i||(i=t.filter(function(e){return e.properties_.default})[0]||t[0],i.enabled=!0),this.audioPlaylistLoader_&&(this.audioPlaylistLoader_.dispose(),this.audioPlaylistLoader_=null),this.audioSegmentLoader_.pause(),i.properties_.resolvedUri?(this.audioSegmentLoader_.resetEverything(),this.audioPlaylistLoader_=new _playlistLoader2.default(i.properties_.resolvedUri,this.hls_,this.withCredentials),this.audioPlaylistLoader_.start(),this.audioPlaylistLoader_.on("loadedmetadata",function(){var t=e.audioPlaylistLoader_.media();e.audioSegmentLoader_.playlist(t,e.requestOptions_),(!e.tech_.paused()||t.endList&&"none"!==e.tech_.preload())&&e.audioSegmentLoader_.load(),t.endList||e.audioPlaylistLoader_.trigger("firstplay")}),this.audioPlaylistLoader_.on("loadedplaylist",function(){var t=void 0;return e.audioPlaylistLoader_&&(t=e.audioPlaylistLoader_.media()),t?void e.audioSegmentLoader_.playlist(t,e.requestOptions_):void e.audioPlaylistLoader_.media(e.audioPlaylistLoader_.playlists.master.playlists[0])}),void this.audioPlaylistLoader_.on("error",function(){_videoJs2.default.log.warn("Problem encountered loading the alternate audio track. Switching back to default."),e.audioSegmentLoader_.abort(),e.setupAudio()})):void this.mainSegmentLoader_.resetEverything()}},{key:"fastQualityChange_",value:function(){var e=this.selectPlaylist();e!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(e),this.mainSegmentLoader_.resetLoader(),this.audiosegmentloader_&&this.audioSegmentLoader_.resetLoader())}},{key:"play",value:function(){if(!this.setupFirstPlay())return this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_()&&this.load(),this.tech_.duration()===1/0&&this.tech_.currentTime()<this.tech_.seekable().start(0)?this.tech_.setCurrentTime(this.tech_.seekable().start(0)):void 0}},{key:"setupFirstPlay",value:function(){var e=void 0,t=this.masterPlaylistLoader_.media();return!(!t||this.tech_.paused()||this.hasPlayed_())&&(t.endList||(this.trigger("firstplay"),e=this.seekable(),e.length&&this.tech_.setCurrentTime(e.end(0))),this.hasPlayed_=function(){return!0},this.load(),!0)}},{key:"handleSourceOpen_",value:function(){try{this.setupSourceBuffers_()}catch(e){return _videoJs2.default.log.warn("Failed to create Source Buffers",e),this.mediaSource.endOfStream("decode")}this.tech_.autoplay()&&this.tech_.play(),this.trigger("sourceopen")}},{key:"blacklistCurrentPlaylist",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=void 0,i=void 0;return(t=e.playlist||this.masterPlaylistLoader_.media())?(t.excludeUntil=Date.now()+BLACKLIST_DURATION,(i=this.selectPlaylist())?(_videoJs2.default.log.warn("Problem encountered with the current HLS playlist. Switching to another playlist."),this.masterPlaylistLoader_.media(i)):(_videoJs2.default.log.warn("Problem encountered with the current HLS playlist. No suitable alternatives found."),this.error=e,this.mediaSource.endOfStream("network"))):(this.error=e,this.mediaSource.endOfStream("network"))}},{key:"pauseLoading",value:function(){this.mainSegmentLoader_.pause(),this.audioPlaylistLoader_&&this.audioSegmentLoader_.pause()}},{key:"setCurrentTime",value:function(e){var t=_ranges2.default.findRange(this.tech_.buffered(),e);return this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media()&&this.masterPlaylistLoader_.media().segments?t&&t.length?e:(this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.audioPlaylistLoader_&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),void(this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioPlaylistLoader_&&this.audioSegmentLoader_.load()))):0}},{key:"duration",value:function(){return this.masterPlaylistLoader_?this.mediaSource?this.mediaSource.duration:Hls.Playlist.duration(this.masterPlaylistLoader_.media()):0}},{key:"seekable",value:function(){return this.seekable_}},{key:"onSyncInfoUpdate_",value:function(){var e=void 0,t=void 0,i=void 0;if(this.masterPlaylistLoader_&&(e=this.masterPlaylistLoader_.media(),e&&(t=Hls.Playlist.seekable(e),0!==t.length&&(!this.audioPlaylistLoader_||(i=Hls.Playlist.seekable(this.audioPlaylistLoader_.media()),0!==i.length)))))return i?void(this.seekable_=_videoJs2.default.createTimeRanges([[i.start(0)>t.start(0)?i.start(0):t.start(0),i.end(0)<t.end(0)?i.end(0):t.end(0)]])):void(this.seekable_=t)}},{key:"updateDuration",value:function(){var e=this,t=this.mediaSource.duration,i=Hls.Playlist.duration(this.masterPlaylistLoader_.media()),a=this.tech_.buffered(),r=function t(){e.mediaSource.duration=i,e.tech_.trigger("durationchange"),e.mediaSource.removeEventListener("sourceopen",t)};a.length>0&&(i=Math.max(i,a.end(a.length-1))),t!==i&&("open"!==this.mediaSource.readyState?this.mediaSource.addEventListener("sourceopen",r):r())}},{key:"dispose",value:function(){this.masterPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),this.audioPlaylistLoader_&&this.audioPlaylistLoader_.dispose(),this.audioSegmentLoader_.dispose()}},{key:"master",value:function(){return this.masterPlaylistLoader_.master}},{key:"media",value:function(){return this.masterPlaylistLoader_.media()||this.initialMedia_}},{key:"setupSourceBuffers_",value:function(){var e=this.masterPlaylistLoader_.media(),t=void 0;if(e&&"open"===this.mediaSource.readyState){if(t=mimeTypesForPlaylist_(this.masterPlaylistLoader_.master,e),t.length<1)return this.error="No compatible SourceBuffer configuration for the variant stream:"+e.resolvedUri,this.mediaSource.endOfStream("decode");this.mainSegmentLoader_.mimeType(t[0]),t[1]&&this.audioSegmentLoader_.mimeType(t[1]),this.excludeIncompatibleVariants_(e)}}},{key:"excludeIncompatibleVariants_",value:function(e){var t=this.masterPlaylistLoader_.master,i=2,a=null,r=null,o=void 0;e.attributes&&e.attributes.CODECS&&(o=parseCodecs(e.attributes.CODECS),a=o.videoCodec,r=o.audioProfile,i=o.codecCount),t.playlists.forEach(function(e){var t={codecCount:2,videoCodec:null,audioProfile:null};if(e.attributes&&e.attributes.CODECS){var o=e.attributes.CODECS;t=parseCodecs(o),window.MediaSource&&window.MediaSource.isTypeSupported&&!window.MediaSource.isTypeSupported('video/mp4; codecs="'+mapLegacyAvcCodecs_(o)+'"')&&(e.excludeUntil=1/0)}t.codecCount!==i&&(e.excludeUntil=1/0),t.videoCodec!==a&&(e.excludeUntil=1/0),("5"===t.audioProfile&&"5"!==r||"5"===r&&"5"!==t.audioProfile)&&(e.excludeUntil=1/0)})}},{key:"updateAdCues_",value:function(e){var t=0,i=this.seekable();i.length&&(t=i.start(0)),_adCueTags2.default.updateAdCues(e,this.cueTagsTrack_,t)}}]),t}(_videoJs2.default.EventTarget);exports.MasterPlaylistController=MasterPlaylistController;
},{"./ad-cue-tags":315,"./playlist-loader":320,"./ranges":322,"./segment-loader":326,"./sync-controller":329,"video.js":312,"videojs-contrib-media-sources/es5/codec-utils":334}],319:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_ranges=require("./ranges"),_ranges2=_interopRequireDefault(_ranges),_videoJs=require("video.js"),_videoJs2=_interopRequireDefault(_videoJs),timerCancelEvents=["seeking","seeked","pause","playing","error"],PlaybackWatcher=function(){function e(t){var i=this;_classCallCheck(this,e),this.tech_=t.tech,this.seekable=t.seekable,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.timer_=null,this.checkCurrentTimeTimeout_=null,t.debug&&(this.logger_=_videoJs2.default.log.bind(_videoJs2.default,"playback-watcher ->")),this.logger_("initialize");var r=function(){return i.waiting_()},n=function(){return i.cancelTimer_()};this.tech_.on("waiting",r),this.tech_.on(timerCancelEvents,n),this.monitorCurrentTime_(),this.dispose=function(){i.logger_("dispose"),i.tech_.off("waiting",r),i.tech_.off(timerCancelEvents,n),i.checkCurrentTimeTimeout_&&clearTimeout(i.checkCurrentTimeTimeout_),i.cancelTimer_()}}return _createClass(e,[{key:"monitorCurrentTime_",value:function(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=setTimeout(this.monitorCurrentTime_.bind(this),250)}},{key:"checkCurrentTime_",value:function(){if(!this.tech_.paused()&&!this.tech_.seeking()){var e=this.tech_.currentTime();this.consecutiveUpdates>=5&&e===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):e===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=e)}}},{key:"cancelTimer_",value:function(){this.consecutiveUpdates=0,this.timer_&&(this.logger_("cancelTimer_"),clearTimeout(this.timer_)),this.timer_=null}},{key:"waiting_",value:function(){var e=this.seekable(),t=this.tech_.currentTime();if(!this.tech_.seeking()&&null===this.timer_){if(this.fellOutOfLiveWindow_(e,t)){var i=e.end(e.length-1);return this.logger_("Fell out of live window at time "+t+". Seeking to live point (seekable end) "+i),this.cancelTimer_(),void this.tech_.setCurrentTime(i)}var r=this.tech_.buffered(),n=_ranges2.default.findNextRange(r,t);if(this.videoUnderflow_(n,r,t))return this.cancelTimer_(),void this.tech_.setCurrentTime(t);if(n.length>0){var s=n.start(0)-t;this.logger_("Stopped at "+t+", setting timer for "+s+", seeking to "+n.start(0)),this.timer_=setTimeout(this.skipTheGap_.bind(this),1e3*s,t)}}}},{key:"fellOutOfLiveWindow_",value:function(e,t){return!!(e.length&&e.start(0)>0&&t<e.start(0))}},{key:"videoUnderflow_",value:function(e,t,i){if(0===e.length){var r=this.gapFromVideoUnderflow_(t,i);if(r)return this.logger_("Encountered a gap in video from "+r.start+" to "+r.end+". Seeking to current time "+i),!0}return!1}},{key:"skipTheGap_",value:function(e){var t=this.tech_.buffered(),i=this.tech_.currentTime(),r=_ranges2.default.findNextRange(t,i);this.cancelTimer_(),0!==r.length&&i===e&&(this.logger_("skipTheGap_:","currentTime:",i,"scheduled currentTime:",e,"nextRange start:",r.start(0)),this.tech_.setCurrentTime(r.start(0)+_ranges2.default.TIME_FUDGE_FACTOR))}},{key:"gapFromVideoUnderflow_",value:function(e,t){for(var i=_ranges2.default.findGaps(e),r=0;r<i.length;r++){var n=i.start(r),s=i.end(r);if(t-n<4&&t-n>2)return{start:n,end:s}}return null}},{key:"logger_",value:function(){}}]),e}();exports.default=PlaybackWatcher,module.exports=exports.default;
},{"./ranges":322,"video.js":312}],320:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _resolveUrl=require("./resolve-url"),_resolveUrl2=_interopRequireDefault(_resolveUrl),_videoJs=require("video.js"),_playlistJs=require("./playlist.js"),_stream=require("./stream"),_stream2=_interopRequireDefault(_stream),_m3u8Parser=require("m3u8-parser"),_m3u8Parser2=_interopRequireDefault(_m3u8Parser),_globalWindow=require("global/window"),_globalWindow2=_interopRequireDefault(_globalWindow),updateSegments=function(e,t,r){var i=t.slice(),s=void 0,a=void 0;for(r=r||0,s=Math.min(e.length,t.length+r),a=r;a<s;a++)i[a-r]=(0,_videoJs.mergeOptions)(e[a],i[a-r]);return i},updateMaster=function(e,t){for(var r=!1,i=(0,_videoJs.mergeOptions)(e,{}),s=e.playlists.length,a=void 0,l=void 0,n=void 0;s--;)if(a=i.playlists[s],a.uri===t.uri){if(a.segments&&t.segments&&a.segments.length===t.segments.length&&a.mediaSequence===t.mediaSequence)continue;for(i.playlists[s]=(0,_videoJs.mergeOptions)(a,t),i.playlists[t.uri]=i.playlists[s],a.segments&&(i.playlists[s].segments=updateSegments(a.segments,t.segments,t.mediaSequence-a.mediaSequence)),n=0,i.playlists[s].segments&&(n=i.playlists[s].segments.length);n--;)l=i.playlists[s].segments[n],l.resolvedUri||(l.resolvedUri=(0,_resolveUrl2.default)(a.resolvedUri,l.uri)),l.key&&!l.key.resolvedUri&&(l.key.resolvedUri=(0,_resolveUrl2.default)(a.resolvedUri,l.key.uri)),l.map&&!l.map.resolvedUri&&(l.map.resolvedUri=(0,_resolveUrl2.default)(a.resolvedUri,l.map.uri));r=!0}return r?i:null},PlaylistLoader=function e(t,r,i){var s=this,a=this,l=void 0,n=void 0,o=void 0,u=void 0,d=void 0;if(e.prototype.constructor.call(this),this.hls_=r,!t)throw new Error("A non-empty playlist URL is required");u=function(e,t,r){a.setBandwidth(o||e),o=null,r&&(a.state=r),a.error={playlist:a.master.playlists[t],status:e.status,message:"HLS playlist request error at URL: "+t,responseText:e.responseText,code:e.status>=500?4:2},a.trigger("error")},d=function(e,t){var r=void 0,i=void 0,s=void 0;a.setBandwidth(o||e),o=null,a.state="HAVE_METADATA",r=new _m3u8Parser2.default.Parser,r.push(e.responseText),r.end(),r.manifest.uri=t,s=updateMaster(a.master,r.manifest),i=1e3*(r.manifest.targetDuration||10),a.targetDuration=r.manifest.targetDuration,s?(a.master=s,a.media_=a.master.playlists[r.manifest.uri]):i/=2,a.media().endList||(_globalWindow2.default.clearTimeout(n),n=_globalWindow2.default.setTimeout(function(){a.trigger("mediaupdatetimeout")},i)),a.trigger("loadedplaylist")},a.state="HAVE_NOTHING",l=this.dispose,a.dispose=function(){a.stopRequest(),_globalWindow2.default.clearTimeout(n),l.call(this)},a.stopRequest=function(){if(o){var e=o;o=null,e.onreadystatechange=null,e.abort()}},a.enabledPlaylists_=function(){return a.master.playlists.filter(_playlistJs.isEnabled).length},a.isLowestEnabledRendition_=function(){var e=a.media();if(!e||!e.attributes)return!1;var t=a.media().attributes.BANDWIDTH||0;return!(a.master.playlists.filter(function(e){var r=(0,_playlistJs.isEnabled)(e);if(!r)return!1;var i=0;return e&&e.attributes&&(i=e.attributes.BANDWIDTH),i<=t}).length>1)},a.media=function(e){var t=a.state,r=void 0;if(!e)return a.media_;if("HAVE_NOTHING"===a.state)throw new Error("Cannot switch media playlist from "+a.state);if("string"==typeof e){if(!a.master.playlists[e])throw new Error("Unknown playlist URI: "+e);e=a.master.playlists[e]}if(r=!a.media_||e.uri!==a.media_.uri,a.master.playlists[e.uri].endList)return o&&(o.onreadystatechange=null,o.abort(),o=null),a.state="HAVE_METADATA",a.media_=e,void(r&&(a.trigger("mediachanging"),a.trigger("mediachange")));if(r){if(a.state="SWITCHING_MEDIA",o){if((0,_resolveUrl2.default)(a.master.uri,e.uri)===o.url)return;o.onreadystatechange=null,o.abort(),o=null}this.media_&&this.trigger("mediachanging"),o=this.hls_.xhr({uri:(0,_resolveUrl2.default)(a.master.uri,e.uri),withCredentials:i},function(r,i){if(o){if(r)return u(o,e.uri,t);d(i,e.uri),"HAVE_MASTER"===t?a.trigger("loadedmetadata"):a.trigger("mediachange")}})}},a.setBandwidth=function(e){a.bandwidth=e.bandwidth},a.on("mediaupdatetimeout",function(){"HAVE_METADATA"===a.state&&(a.state="HAVE_CURRENT_METADATA",o=this.hls_.xhr({uri:(0,_resolveUrl2.default)(a.master.uri,a.media().uri),withCredentials:i},function(e,t){if(o)return e?u(o,a.media().uri):void d(o,a.media().uri)}))}),a.on("firstplay",function(){var e=a.media();e&&(e.syncInfo={mediaSequence:e.mediaSequence,time:0})}),a.pause=function(){a.stopRequest(),_globalWindow2.default.clearTimeout(n)},a.load=function(){a.started?a.media().endList?a.trigger("loadedplaylist"):a.trigger("mediaupdatetimeout"):a.start()},a.start=function(){a.started=!0,o=s.hls_.xhr({uri:t,withCredentials:i},function(e,r){var i=void 0,s=void 0,l=void 0;if(o){if(o=null,e)return a.error={status:r.status,message:"HLS playlist request error at URL: "+t,responseText:r.responseText,code:2},a.trigger("error");if(i=new _m3u8Parser2.default.Parser,i.push(r.responseText),i.end(),a.state="HAVE_MASTER",i.manifest.uri=t,i.manifest.playlists){for(a.master=i.manifest,l=a.master.playlists.length;l--;)s=a.master.playlists[l],a.master.playlists[s.uri]=s,s.resolvedUri=(0,_resolveUrl2.default)(a.master.uri,s.uri);for(var n in a.master.mediaGroups.AUDIO)for(var u in a.master.mediaGroups.AUDIO[n]){var m=a.master.mediaGroups.AUDIO[n][u];m.uri&&(m.resolvedUri=(0,_resolveUrl2.default)(a.master.uri,m.uri))}return a.trigger("loadedplaylist"),void(o||a.media(i.manifest.playlists[0]))}return a.master={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:_globalWindow2.default.location.href,playlists:[{uri:t}]},a.master.playlists[t]=a.master.playlists[0],a.master.playlists[0].resolvedUri=t,d(r,t),a.trigger("loadedmetadata")}})}};PlaylistLoader.prototype=new _stream2.default,exports.default=PlaylistLoader,module.exports=exports.default;
},{"./playlist.js":321,"./resolve-url":325,"./stream":328,"global/window":194,"m3u8-parser":196,"video.js":312}],321:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _videoJs=require("video.js"),_globalWindow=require("global/window"),_globalWindow2=_interopRequireDefault(_globalWindow),Playlist={UNSAFE_LIVE_SEGMENTS:3},backwardDuration=function(e,i){var t=0,n=i-e.mediaSequence,r=e.segments[n];if(r){if("undefined"!=typeof r.start)return{result:r.start,precise:!0};if("undefined"!=typeof r.end)return{result:r.end-r.duration,precise:!0}}for(;n--;){if(r=e.segments[n],"undefined"!=typeof r.end)return{result:t+r.end,precise:!0};if(t+=r.duration,"undefined"!=typeof r.start)return{result:t+r.start,precise:!0}}return{result:t,precise:!1}},forwardDuration=function(e,i){for(var t=0,n=void 0,r=i-e.mediaSequence;r<e.segments.length;r++){if(n=e.segments[r],"undefined"!=typeof n.start)return{result:n.start-t,precise:!0};if(t+=n.duration,"undefined"!=typeof n.end)return{result:n.end-t,precise:!0}}return{result:-1,precise:!1}},intervalDuration=function(e,i,t){var n=void 0,r=void 0;return"undefined"==typeof i&&(i=e.mediaSequence+e.segments.length),i<e.mediaSequence?0:(n=backwardDuration(e,i),n.precise?n.result:(r=forwardDuration(e,i),r.precise?r.result:n.result+t))},duration=function(e,i,t){if(!e)return 0;if("number"!=typeof t&&(t=0),"undefined"==typeof i){if(e.totalDuration)return e.totalDuration;if(!e.endList)return _globalWindow2.default.Infinity}return intervalDuration(e,i,t)};exports.duration=duration;var sumDurations=function(e,i,t){var n=0;if(i>t){var r=[t,i];i=r[0],t=r[1]}if(i<0){for(var a=i;a<Math.min(0,t);a++)n+=e.targetDuration;i=0}for(var a=i;a<t;a++)n+=e.segments[a].duration;return n};exports.sumDurations=sumDurations;var getPlaylistSyncPoints=function(e){if(!e||!e.segments)return[null,null];for(var i=e.syncInfo||null,t=null,n=0,r=e.segments.length;n<r;n++){var a=e.segments[n];if("undefined"!=typeof a.start){t={mediaSequence:e.mediaSequence+n,time:a.start};break}}return{expiredSync:i,segmentSync:t}},calculateExpiredTime=function(e,i,t){if(i&&t){var n=i.mediaSequence-e.mediaSequence,r=t.mediaSequence-e.mediaSequence,a=void 0,u=void 0;return Math.abs(n)>Math.abs(r)?(a=r,u=-t.time):(a=n,u=i.time),Math.abs(u+sumDurations(e,a,0))}if(i){var a=i.mediaSequence-e.mediaSequence;return i.time+sumDurations(e,a,0)}if(t){var a=t.mediaSequence-e.mediaSequence;return t.time-sumDurations(e,a,0)}},seekable=function(e){if(!e||!e.segments)return(0,_videoJs.createTimeRange)();if(e.endList)return(0,_videoJs.createTimeRange)(0,duration(e));var i=getPlaylistSyncPoints(e),t=i.expiredSync,n=i.segmentSync;if(!t&&!n)return(0,_videoJs.createTimeRange)();var r=calculateExpiredTime(e,t,n),a=r,u=Math.max(0,e.segments.length-Playlist.UNSAFE_LIVE_SEGMENTS),s=intervalDuration(e,e.mediaSequence+u,r);return(0,_videoJs.createTimeRange)(a,s)};exports.seekable=seekable;var isWholeNumber=function(e){return e-Math.floor(e)===0},roundSignificantDigit=function(e,i){if(isWholeNumber(i))return i+.1*e;for(var t=i.toString().split(".")[1].length,n=1;n<=t;n++){var r=Math.pow(10,n),a=i*r;if(isWholeNumber(a)||n===t)return(a+e)/r}},ceilLeastSignificantDigit=roundSignificantDigit.bind(null,1),floorLeastSignificantDigit=roundSignificantDigit.bind(null,-1),getMediaInfoForTime_=function(e,i,t,n){var r=void 0,a=void 0,u=e.segments.length,s=i-n;if(s<0){if(t>0)for(r=t-1;r>=0;r--)if(a=e.segments[r],s+=floorLeastSignificantDigit(a.duration),s>0)return{mediaIndex:r,startTime:n-sumDurations(e,t,r)};return{mediaIndex:0,startTime:i}}if(t<0){for(r=t;r<0;r++)if(s-=e.targetDuration,s<0)return{mediaIndex:0,startTime:i};t=0}for(r=t;r<u;r++)if(a=e.segments[r],s-=ceilLeastSignificantDigit(a.duration),s<0)return{mediaIndex:r,startTime:n+sumDurations(e,t,r)};return{mediaIndex:u-1,startTime:i}};exports.getMediaInfoForTime_=getMediaInfoForTime_;var isBlacklisted=function(e){return e.excludeUntil&&e.excludeUntil>Date.now()};exports.isBlacklisted=isBlacklisted;var isEnabled=function(e){var i=isBlacklisted(e);return!e.disabled&&!i};exports.isEnabled=isEnabled,Playlist.duration=duration,Playlist.seekable=seekable,Playlist.getMediaInfoForTime_=getMediaInfoForTime_,Playlist.isEnabled=isEnabled,Playlist.isBlacklisted=isBlacklisted,exports.default=Playlist;
},{"global/window":194,"video.js":312}],322:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _slicedToArray=function(){function e(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var u,f=e[Symbol.iterator]();!(r=(u=f.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&f.return&&f.return()}finally{if(i)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_videoJs=require("video.js"),_videoJs2=_interopRequireDefault(_videoJs),TIME_FUDGE_FACTOR=1/30,clamp=function(e,t){var n=_slicedToArray(t,2),r=n[0],i=n[1];return Math.min(Math.max(r,e),i)},filterRanges=function(e,t){var n=[],r=void 0;if(e&&e.length)for(r=0;r<e.length;r++)t(e.start(r),e.end(r))&&n.push([e.start(r),e.end(r)]);return _videoJs2.default.createTimeRanges(n)},findRange=function(e,t){return filterRanges(e,function(e,n){return e-TIME_FUDGE_FACTOR<=t&&n+TIME_FUDGE_FACTOR>=t})},findNextRange=function(e,t){return filterRanges(e,function(e){return e-TIME_FUDGE_FACTOR>=t})},findGaps=function(e){if(e.length<2)return _videoJs2.default.createTimeRanges();for(var t=[],n=1;n<e.length;n++){var r=e.end(n-1),i=e.start(n);t.push([r,i])}return _videoJs2.default.createTimeRanges(t)},findSoleUncommonTimeRangesEnd=function(e,t){var n=void 0,r=void 0,i=void 0,a=[],u=[],f=function(e){return e[0]<=i&&e[1]>=i};if(e)for(n=0;n<e.length;n++)r=e.start(n),i=e.end(n),u.push([r,i]);if(t)for(n=0;n<t.length;n++)r=t.start(n),i=t.end(n),u.some(f)||a.push(i);return 1!==a.length?null:a[0]},bufferIntersection=function(e,t){var n=null,r=null,i=0,a=[],u=[];if(!(e&&e.length&&t&&t.length))return _videoJs2.default.createTimeRange();for(var f=e.length;f--;)a.push({time:e.start(f),type:"start"}),a.push({time:e.end(f),type:"end"});for(f=t.length;f--;)a.push({time:t.start(f),type:"start"}),a.push({time:t.end(f),type:"end"});for(a.sort(function(e,t){return e.time-t.time}),f=0;f<a.length;f++)"start"===a[f].type?(i++,2===i&&(n=a[f].time)):"end"===a[f].type&&(i--,1===i&&(r=a[f].time)),null!==n&&null!==r&&(u.push([n,r]),n=null,r=null);return _videoJs2.default.createTimeRanges(u)},calculateBufferedPercent=function(e,t,n,r){for(var i=t.end(0)-t.start(0),a=e.end(0)-e.start(0),u=i-a,f=bufferIntersection(e,r),o=bufferIntersection(t,r),s=0,d=0,l=f.length;l--;)s+=f.end(l)-f.start(l),f.start(l)===n&&(s+=u);for(l=o.length;l--;)d+=o.end(l)-o.start(l);return Math.max(s,d)/i*100},getSegmentBufferedPercent=function(e,t,n,r){var i=e+t,a=_videoJs2.default.createTimeRanges([[e,i]]),u=_videoJs2.default.createTimeRanges([[clamp(e,[n,i]),i]]);if(u.start(0)===u.end(0))return 0;var f=calculateBufferedPercent(u,a,n,r);return isNaN(f)||f===1/0||f===-(1/0)?0:f};exports.default={findRange:findRange,findNextRange:findNextRange,findGaps:findGaps,findSoleUncommonTimeRangesEnd:findSoleUncommonTimeRangesEnd,getSegmentBufferedPercent:getSegmentBufferedPercent,TIME_FUDGE_FACTOR:TIME_FUDGE_FACTOR},module.exports=exports.default;
},{"video.js":312}],323:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _videoJs=require("video.js"),_videoJs2=_interopRequireDefault(_videoJs),defaultOptions={errorInterval:30,getSource:function(e){var r=this.tech({IWillNotUseThisInPlugins:!0}),o=r.currentSource_;return e(o)}},initPlugin=function e(r,o){var t=0,n=0,u=_videoJs2.default.mergeOptions(defaultOptions,o),i=function(){n&&r.currentTime(n)},a=function(e){null!==e&&void 0!==e&&(n=r.duration()!==1/0&&r.currentTime()||0,r.one("loadedmetadata",i),r.src(e),r.play())},d=function(){if(!(Date.now()-t<1e3*u.errorInterval))return u.getSource&&"function"==typeof u.getSource?(t=Date.now(),u.getSource.call(r,a)):void _videoJs2.default.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!")},l=function e(){r.off("loadedmetadata",i),r.off("error",d),r.off("dispose",e)},c=function(o){l(),e(r,o)};r.on("error",d),r.on("dispose",l),r.reloadSourceOnError=c},reloadSourceOnError=function(e){initPlugin(this,e)};exports.default=reloadSourceOnError,module.exports=exports.default;
},{"video.js":312}],324:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _playlistJs=require("./playlist.js"),enableFunction=function(t,e,i,s){var n=t.master.playlists[e],l=(0,_playlistJs.isBlacklisted)(n),a=(0,_playlistJs.isEnabled)(n);return"undefined"==typeof s?a:(s?delete n.disabled:n.disabled=!0,s===a||l||i(),s)},Representation=function t(e,i,s){_classCallCheck(this,t);var n=e.masterPlaylistController_.fastQualityChange_.bind(e.masterPlaylistController_);if(i.attributes){var l=i.attributes;if(l.RESOLUTION){var a=l.RESOLUTION;this.width=a.width,this.height=a.height}this.bandwidth=l.BANDWIDTH}this.id=s,this.enabled=enableFunction.bind(this,e.playlists,i.uri,n)},renditionSelectionMixin=function(t){var e=t.playlists;t.representations=function(){return e.master.playlists.filter(function(t){return!(0,_playlistJs.isBlacklisted)(t)}).map(function(e,i){return new Representation(t,e,e.uri)})}};exports.default=renditionSelectionMixin,module.exports=exports.default;
},{"./playlist.js":321}],325:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _urlToolkit=require("url-toolkit"),_urlToolkit2=_interopRequireDefault(_urlToolkit),_globalWindow=require("global/window"),_globalWindow2=_interopRequireDefault(_globalWindow),resolveUrl=function(e,l){return/^[a-z]+:/i.test(l)?l:(/\/\//i.test(e)||(e=_urlToolkit2.default.buildAbsoluteURL(_globalWindow2.default.location.href,e)),_urlToolkit2.default.buildAbsoluteURL(e,l))};exports.default=resolveUrl,module.exports=exports.default;
},{"global/window":194,"url-toolkit":219}],326:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),_get=function(e,t,i){for(var n=!0;n;){var r=e,s=t,a=i;n=!1,null===r&&(r=Function.prototype);var h=Object.getOwnPropertyDescriptor(r,s);if(void 0!==h){if("value"in h)return h.value;var o=h.get;if(void 0===o)return;return o.call(a)}var u=Object.getPrototypeOf(r);if(null===u)return;e=u,t=s,i=a,n=!0,h=u=void 0}},_playlist=require("./playlist"),_videoJs=require("video.js"),_videoJs2=_interopRequireDefault(_videoJs),_sourceUpdater=require("./source-updater"),_sourceUpdater2=_interopRequireDefault(_sourceUpdater),_aesDecrypter=require("aes-decrypter"),_config=require("./config"),_config2=_interopRequireDefault(_config),_globalWindow=require("global/window"),_globalWindow2=_interopRequireDefault(_globalWindow),CHECK_BUFFER_DELAY=500,c="console",log=function(){_globalWindow2.default.logit&&_globalWindow2.default[c].log.apply(_globalWindow2.default[c],arguments)},detectEndOfStream=function(e,t,i){if(!e)return!1;var n=e.segments,r=i===n.length;return e.endList&&"open"===t.readyState&&r},byterangeStr=function(e){var t=void 0,i=void 0;return i=e.offset+e.length-1,t=e.offset,"bytes="+t+"-"+i},segmentXhrHeaders=function(e){var t={};return"byterange"in e&&(t.Range=byterangeStr(e.byterange)),t},initSegmentId=function(e){var t=e.byterange||{length:1/0,offset:0};return[t.length,t.offset,e.resolvedUri].join(",")},SegmentLoader=function(e){function t(e){var i=this;_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this);var n=void 0;if(!e)throw new TypeError("Initialization options are required");if("function"!=typeof e.currentTime)throw new TypeError("No currentTime getter specified");if(!e.mediaSource)throw new TypeError("No MediaSource specified");n=_videoJs2.default.mergeOptions(_videoJs2.default.options.hls,e),this.state="INIT",this.bandwidth=n.bandwidth,this.throughput={rate:0,count:0},this.roundTrip=NaN,this.resetStats_(),this.mediaIndex=null,this.hasPlayed_=n.hasPlayed,this.currentTime_=n.currentTime,this.seekable_=n.seekable,this.seeking_=n.seeking,this.setCurrentTime_=n.setCurrentTime,this.mediaSource_=n.mediaSource,this.hls_=n.hls,this.checkBufferTimeout_=null,this.error_=void 0,this.currentTimeline_=-1,this.xhr_=null,this.pendingSegment_=null,this.mimeType_=null,this.sourceUpdater_=null,this.xhrOptions_=null,this.activeInitSegmentId_=null,this.initSegments_={},this.syncController_=n.syncController,this.syncPoint_={segmentIndex:0,time:0},this.syncController_.on("syncinfoupdate",function(){return i.trigger("syncinfoupdate")}),this.fetchAtBuffer_=!1}return _inherits(t,e),_createClass(t,[{key:"resetStats_",value:function(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0}},{key:"dispose",value:function(){this.state="DISPOSED",this.abort_(),this.sourceUpdater_&&this.sourceUpdater_.dispose(),this.resetStats_()}},{key:"abort",value:function(){return"WAITING"!==this.state?void(this.pendingSegment_&&(this.pendingSegment_=null)):(this.abort_(),void(this.paused()||(this.state="READY",this.fillBuffer_())))}},{key:"error",value:function(e){return"undefined"!=typeof e&&(this.error_=e),this.pendingSegment_=null,this.error_}},{key:"load",value:function(){if(this.monitorBuffer_(),this.playlist_)return this.syncController_.setDateTimeMapping(this.playlist_),"INIT"===this.state&&this.mimeType_?this.init_():void(!this.sourceUpdater_||"READY"!==this.state&&"INIT"!==this.state||(this.state="READY",this.fillBuffer_()))}},{key:"playlist",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(e){var i=this.playlist_,n=this.pendingSegment_;if(null!==this.mediaIndex)if(i&&i.uri===e.uri){var r=e.mediaSequence-i.mediaSequence;this.mediaIndex-=r,n&&!n.isSyncRequest&&(n.mediaIndex-=r),this.syncController_.saveExpiredSegmentInfo(i,e)}else this.resyncLoader();else this.hasPlayed_()||(e.syncInfo={mediaSequence:e.mediaSequence,time:0},this.trigger("syncinfoupdate"));return this.playlist_=e,this.xhrOptions_=t,this.mimeType_&&"INIT"===this.state&&!this.paused()?this.init_():void 0}}},{key:"pause",value:function(){this.checkBufferTimeout_&&(_globalWindow2.default.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}},{key:"paused",value:function(){return null===this.checkBufferTimeout_}},{key:"mimeType",value:function(e){this.mimeType_||(this.mimeType_=e,this.playlist_&&"INIT"===this.state&&!this.paused()&&this.init_())}},{key:"monitorBuffer_",value:function(){"READY"===this.state&&this.fillBuffer_(),this.checkBufferTimeout_&&_globalWindow2.default.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=_globalWindow2.default.setTimeout(this.monitorBuffer_.bind(this),CHECK_BUFFER_DELAY)}},{key:"getSyncSegmentCandidate_",value:function(e){var t=this;if(this.currentTimeline_===-1)return 0;var i=e.segments.map(function(e,t){return{timeline:e.timeline,segmentIndex:t}}).filter(function(e){return e.timeline===t.currentTimeline_});return i.length?i[Math.min(i.length-1,1)].segmentIndex:Math.max(e.segments.length-1,0)}},{key:"checkBuffer_",value:function(e,t,i,n,r,s){var a=0,h=void 0;e.length&&(a=e.end(e.length-1));var o=Math.max(0,a-r);if(!t.segments.length)return null;if(log("cB_","mediaIndex:",i,"hasPlayed:",n,"currentTime:",r,"syncPoint:",s,"fetchAtBuffer:",this.fetchAtBuffer_),log("cB_ 2","bufferedTime:",o),o>=_config2.default.GOAL_BUFFER_LENGTH)return null;if(!n&&o>=1)return null;if(null===s)return i=this.getSyncSegmentCandidate_(t),log("getSync",i),this.generateSegmentInfo_(t,i,null,!0);if(null!==i){log("++",i+1);var u=t.segments[i];return h=u&&u.end?u.end:a,this.generateSegmentInfo_(t,i+1,h,!1)}if(this.fetchAtBuffer_){var l=(0,_playlist.getMediaInfoForTime_)(t,a,s.segmentIndex,s.time);i=l.mediaIndex,h=l.startTime}else{var l=(0,_playlist.getMediaInfoForTime_)(t,r,s.segmentIndex,s.time);i=l.mediaIndex,h=l.startTime}return log("gMIFT",i,"sos",h),this.generateSegmentInfo_(t,i,h,!1)}},{key:"generateSegmentInfo_",value:function(e,t,i,n){if(t<0||t>=e.segments.length)return null;var r=e.segments[t];return{uri:r.resolvedUri,mediaIndex:t,isSyncRequest:n,startOfSegment:i,playlist:e,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:r.timeline,duration:r.duration}}},{key:"abort_",value:function(){this.xhr_&&this.xhr_.abort(),this.pendingSegment_=null}},{key:"init_",value:function(){return this.state="READY",this.sourceUpdater_=new _sourceUpdater2.default(this.mediaSource_,this.mimeType_),this.resetEverything(),this.fillBuffer_()}},{key:"fillBuffer_",value:function(){if(!this.sourceUpdater_.updating()){this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.mediaSource_.duration,this.currentTimeline_));var e=this.checkBuffer_(this.sourceUpdater_.buffered(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);if(e){var t=detectEndOfStream(this.playlist_,this.mediaSource_,e.mediaIndex);return t?void this.mediaSource_.endOfStream():void((e.mediaIndex!==this.playlist_.segments.length-1||"ended"!==this.mediaSource_.readyState||this.seeking_())&&((e.timeline!==this.currentTimeline_||null!==e.startOfSegment&&e.startOfSegment<this.sourceUpdater_.timestampOffset())&&(this.syncController_.reset(),e.timestampOffset=e.startOfSegment),this.currentTimeline_=e.timeline,this.loadSegment_(e)))}}}},{key:"trimBuffer_",value:function(e){var t=this.seekable_(),i=this.currentTime_(),n=void 0;return t.length&&t.start(0)>0&&t.start(0)<i?t.start(0):n=i-60}},{key:"loadSegment_",value:function(e){var t=void 0,i=void 0,n=void 0,r=void 0,s=0;if(s=this.trimBuffer_(e),s>0&&this.sourceUpdater_.remove(0,s),t=e.playlist.segments[e.mediaIndex],t.key){var a=_videoJs2.default.mergeOptions(this.xhrOptions_,{uri:t.key.resolvedUri,responseType:"arraybuffer"});i=this.hls_.xhr(a,this.handleResponse_.bind(this))}if(t.map&&!this.initSegments_[initSegmentId(t.map)]){var h=_videoJs2.default.mergeOptions(this.xhrOptions_,{uri:t.map.resolvedUri,responseType:"arraybuffer",headers:segmentXhrHeaders(t.map)});n=this.hls_.xhr(h,this.handleResponse_.bind(this))}this.pendingSegment_=e;var o=_videoJs2.default.mergeOptions(this.xhrOptions_,{uri:e.uri,responseType:"arraybuffer",headers:segmentXhrHeaders(t)});r=this.hls_.xhr(o,this.handleResponse_.bind(this)),this.xhr_={keyXhr:i,initSegmentXhr:n,segmentXhr:r,abort:function(){this.segmentXhr&&(this.segmentXhr.onreadystatechange=null,this.segmentXhr.abort(),this.segmentXhr=null),this.initSegmentXhr&&(this.initSegmentXhr.onreadystatechange=null,this.initSegmentXhr.abort(),this.initSegmentXhr=null),this.keyXhr&&(this.keyXhr.onreadystatechange=null,this.keyXhr.abort(),this.keyXhr=null)}},this.state="WAITING"}},{key:"handleResponse_",value:function(e,t){var i=void 0,n=void 0,r=void 0;if(this.xhr_&&(t===this.xhr_.segmentXhr||t===this.xhr_.keyXhr||t===this.xhr_.initSegmentXhr)){if(i=this.pendingSegment_,n=i.playlist.segments[i.mediaIndex],t.timedout)return this.abort_(),this.bandwidth=1,this.roundTrip=NaN,this.state="READY",this.trigger("progress");if(!t.aborted&&e){var s=this.xhr_.keyXhr;return this.abort_(),this.error({status:t.status,message:t===s?"HLS key request error at URL: "+n.key.uri:"HLS segment request error at URL: "+i.uri,code:2,xhr:t}),this.state="READY",this.pause(),this.trigger("error")}if(!t.response)return void this.abort_();if(t===this.xhr_.segmentXhr&&(this.xhr_.segmentXhr=null,i.startOfAppend=Date.now(),this.roundTrip=t.roundTripTime,this.bandwidth=t.bandwidth,this.mediaBytesTransferred+=t.bytesReceived||0,this.mediaRequests+=1,this.mediaTransferDuration+=t.roundTripTime||0,n.key?i.encryptedBytes=new Uint8Array(t.response):i.bytes=new Uint8Array(t.response)),t===this.xhr_.keyXhr){if(this.xhr_.keyXhr=null,16!==t.response.byteLength)return this.abort_(),this.error({status:t.status,message:"Invalid HLS key at URL: "+n.key.uri,code:2,xhr:t}),this.state="READY",this.pause(),this.trigger("error");r=new DataView(t.response),n.key.bytes=new Uint32Array([r.getUint32(0),r.getUint32(4),r.getUint32(8),r.getUint32(12)]),n.key.iv=n.key.iv||new Uint32Array([0,0,0,i.mediaIndex+i.playlist.mediaSequence])}t===this.xhr_.initSegmentXhr&&(this.xhr_.initSegmentXhr=null,n.map.bytes=new Uint8Array(t.response),this.initSegments_[initSegmentId(n.map)]=n.map),this.xhr_.segmentXhr||this.xhr_.keyXhr||this.xhr_.initSegmentXhr||(this.xhr_=null,this.processResponse_())}}},{key:"resetEverything",value:function(){this.resetLoader(),this.remove(0,1/0)}},{key:"resetLoader",value:function(){this.fetchAtBuffer_=!1,this.resyncLoader()}},{key:"resyncLoader",value:function(){this.mediaIndex=null,this.syncPoint_=null}},{key:"remove",value:function(e,t){this.sourceUpdater_&&this.sourceUpdater_.remove(e,t)}},{key:"processResponse_",value:function(){if(!this.pendingSegment_)return void(this.state="READY");this.state="DECRYPTING";var e=this.pendingSegment_,t=e.playlist.segments[e.mediaIndex];t.key?new _aesDecrypter.Decrypter(e.encryptedBytes,t.key.bytes,t.key.iv,function(t,i){e.bytes=i,this.handleSegment_()}.bind(this)):this.handleSegment_()}},{key:"handleSegment_",value:function(){var e=this;if(!this.pendingSegment_)return void(this.state="READY");this.state="APPENDING";var t=this.pendingSegment_,i=t.playlist.segments[t.mediaIndex];return this.syncController_.probeSegmentInfo(t),t.isSyncRequest?(this.pendingSegment_=null,void(this.state="READY")):(null!==t.timestampOffset&&t.timestampOffset!==this.sourceUpdater_.timestampOffset()&&this.sourceUpdater_.timestampOffset(t.timestampOffset),i.map&&!function(){var t=initSegmentId(i.map);if(!e.activeInitSegmentId_||e.activeInitSegmentId_!==t){var n=e.initSegments_[t];e.sourceUpdater_.appendBuffer(n.bytes,function(){e.activeInitSegmentId_=t})}}(),t.byteLength=t.bytes.byteLength,"number"==typeof i.start&&"number"==typeof i.end?this.mediaSecondsLoaded+=i.end-i.start:this.mediaSecondsLoaded+=i.duration,void this.sourceUpdater_.appendBuffer(t.bytes,this.handleUpdateEnd_.bind(this)))}},{key:"handleUpdateEnd_",value:function(){if(!this.pendingSegment_)return this.state="READY",void(this.paused()||this.fillBuffer_());var e=this.pendingSegment_;this.pendingSegment_=null,this.recordThroughput_(e),log("handleUpdateEnd_");var t=e.mediaIndex;t+=e.playlist.mediaSequence-this.playlist_.mediaSequence,this.mediaIndex=t,this.fetchAtBuffer_=!0;var i=detectEndOfStream(e.playlist,this.mediaSource_,t+1);i&&this.mediaSource_.endOfStream(),this.state="READY",this.trigger("progress"),this.paused()||this.fillBuffer_()}},{key:"recordThroughput_",value:function(e){var t=this.throughput.rate,i=Date.now()-e.startOfAppend+1,n=Math.floor(e.byteLength/i*8*1e3);this.throughput.rate+=(n-t)/++this.throughput.count}}]),t}(_videoJs2.default.EventTarget);exports.default=SegmentLoader,module.exports=exports.default;
},{"./config":317,"./playlist":321,"./source-updater":327,"aes-decrypter":4,"global/window":194,"video.js":312}],327:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var u=0;u<t.length;u++){var a=t[u];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,u,a){return u&&e(t.prototype,u),a&&e(t,a),t}}(),_videoJs=require("video.js"),_videoJs2=_interopRequireDefault(_videoJs),SourceUpdater=function(){function e(t,u){var a=this;_classCallCheck(this,e);var r=function(){a.sourceBuffer_=t.addSourceBuffer(u),a.onUpdateendCallback_=function(){var e=a.pendingCallback_;a.pendingCallback_=null,e&&e(),a.runCallback_()},a.sourceBuffer_.addEventListener("updateend",a.onUpdateendCallback_),a.runCallback_()};this.callbacks_=[],this.pendingCallback_=null,this.timestampOffset_=0,this.mediaSource=t,"closed"===t.readyState?t.addEventListener("sourceopen",r):r()}return _createClass(e,[{key:"abort",value:function(e){var t=this;this.queueCallback_(function(){t.sourceBuffer_.abort()},e)}},{key:"appendBuffer",value:function(e,t){var u=this;this.queueCallback_(function(){u.sourceBuffer_.appendBuffer(e)},t)}},{key:"buffered",value:function(){return this.sourceBuffer_?this.sourceBuffer_.buffered:_videoJs2.default.createTimeRanges()}},{key:"duration",value:function(e){var t=this;this.queueCallback_(function(){t.sourceBuffer_.duration=e})}},{key:"remove",value:function(e,t){var u=this;this.queueCallback_(function(){u.sourceBuffer_.remove(e,t)})}},{key:"updating",value:function(){return!this.sourceBuffer_||this.sourceBuffer_.updating}},{key:"timestampOffset",value:function(e){var t=this;return"undefined"!=typeof e&&(this.queueCallback_(function(){t.sourceBuffer_.timestampOffset=e}),this.timestampOffset_=e),this.timestampOffset_}},{key:"queueCallback_",value:function(e,t){this.callbacks_.push([e.bind(this),t]),this.runCallback_()}},{key:"runCallback_",value:function(){var e=void 0;this.sourceBuffer_&&!this.sourceBuffer_.updating&&this.callbacks_.length&&(e=this.callbacks_.shift(),this.pendingCallback_=e[1],e[0]())}},{key:"dispose",value:function(){this.sourceBuffer_.removeEventListener("updateend",this.onUpdateendCallback_),this.sourceBuffer_&&"open"===this.mediaSource.readyState&&this.sourceBuffer_.abort()}}]),e}();exports.default=SourceUpdater,module.exports=exports.default;
},{"video.js":312}],328:[function(require,module,exports){
arguments[4][5][0].apply(exports,arguments)
},{"dup":5}],329:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),_get=function(e,t,i){for(var n=!0;n;){var s=e,r=t,a=i;n=!1,null===s&&(s=Function.prototype);var o=Object.getOwnPropertyDescriptor(s,r);if(void 0!==o){if("value"in o)return o.value;var u=o.get;if(void 0===u)return;return u.call(a)}var c=Object.getPrototypeOf(s);if(null===c)return;e=c,t=r,i=a,n=!0,o=c=void 0}},_muxJsLibMp4Probe=require("mux.js/lib/mp4/probe"),_muxJsLibMp4Probe2=_interopRequireDefault(_muxJsLibMp4Probe),_muxJsLibToolsTsInspectorJs=require("mux.js/lib/tools/ts-inspector.js"),_playlist=require("./playlist"),_videoJs=require("video.js"),_videoJs2=_interopRequireDefault(_videoJs),c="console",log=function(){window.logit&&window[c].log.apply(window[c],arguments)},syncPointStrategies=[{name:"VOD",run:function(e,t,i,n){if(i!==1/0){var s={time:0,segmentIndex:0};return s}return null}},{name:"ProgramDateTime",run:function(e,t,i,n){if(e.datetimeToDisplayTime&&t.dateTimeObject){var s=t.dateTimeObject.getTime()/1e3,r=s+e.datetimeToDisplayTime,a={time:r,segmentIndex:0};return a}return null}},{name:"Segment",run:function(e,t,i,n){for(var s=t.segments,r=s.length-1;r>=0;r--){var a=s[r];if(a.timeline===n&&"undefined"!=typeof a.start){var o={time:a.start,segmentIndex:r};return o}}return null}},{name:"Discontinuity",run:function(e,t,i,n){if(t.discontinuityStarts.length)for(var s=0;s<t.discontinuityStarts.length;s++){var r=t.discontinuityStarts[s],a=t.discontinuitySequence+s+1;if(e.discontinuities[a]){var o={time:e.discontinuities[a].time,segmentIndex:r};return o}}return null}},{name:"Playlist",run:function(e,t,i,n){if(t.syncInfo){var s={time:t.syncInfo.time,segmentIndex:t.syncInfo.mediaSequence-t.mediaSequence};return s}return null}}];exports.syncPointStrategies=syncPointStrategies;var SyncController=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.inspectCache_=void 0,this.timelines=[],this.discontinuities=[],this.datetimeToDisplayTime=null}return _inherits(t,e),_createClass(t,[{key:"getSyncPoint",value:function(e,t,i){for(var n=0;n<syncPointStrategies.length;n++){var s=syncPointStrategies[n],r=s.run(this,e,t,i);if(r)return log("syncPoint found via <"+s.name+">:",r),r}return null}},{key:"saveExpiredSegmentInfo",value:function(e,t){for(var i=t.mediaSequence-e.mediaSequence,n=i-1;n>=0;n--){var s=e.segments[n];if("undefined"!=typeof s.start){t.syncInfo={mediaSequence:e.mediaSequence+n,time:s.start},log("playlist sync:",t.syncInfo),this.trigger("syncinfoupdate");break}}}},{key:"setDateTimeMapping",value:function(e){if(!this.datetimeToDisplayTime&&e.dateTimeObject){var t=e.dateTimeObject.getTime()/1e3;this.datetimeToDisplayTime=-t}}},{key:"reset",value:function(){this.inspectCache_=void 0}},{key:"probeSegmentInfo",value:function(e){var t=e.playlist.segments[e.mediaIndex],i=void 0;i=t.map?this.probeMp4Segment_(e):this.probeTsSegment_(e),i&&this.calculateSegmentTimeMapping_(e,i)&&this.saveDiscontinuitySyncInfo_(e)}},{key:"probeMp4Segment_",value:function(e){var t=e.playlist.segments[e.mediaIndex],i=_muxJsLibMp4Probe2.default.timescale(t.map.bytes),n=_muxJsLibMp4Probe2.default.startTime(i,e.bytes);return null!==e.timestampOffset&&(e.timestampOffset-=n),{start:n,end:n+t.duration}}},{key:"probeTsSegment_",value:function(e){var t=(0,_muxJsLibToolsTsInspectorJs.inspect)(e.bytes,this.inspectCache_),i=void 0,n=void 0;return t?(t.video&&2===t.video.length?(this.inspectCache_=t.video[1].dts,i=t.video[0].dtsTime,n=t.video[1].dtsTime):t.audio&&2===t.audio.length&&(this.inspectCache_=t.audio[1].dts,i=t.audio[0].dtsTime,n=t.audio[1].dtsTime),{start:i,end:n}):null}},{key:"calculateSegmentTimeMapping_",value:function(e,t){var i=e.playlist.segments[e.mediaIndex],n=this.timelines[e.timeline];if(null!==e.timestampOffset)log("tsO:",e.timestampOffset),n={time:e.timestampOffset,mapping:e.timestampOffset-t.start},this.timelines[e.timeline]=n,i.start=e.timestampOffset,i.end=t.end+n.mapping;else{if(!n)return!1;i.start=t.start+n.mapping,i.end=t.end+n.mapping}return this.trigger("syncinfoupdate"),!0}},{key:"saveDiscontinuitySyncInfo_",value:function(e){var t=e.playlist,i=t.segments[e.mediaIndex];if(i.discontinuity)this.discontinuities[i.timeline]={time:i.start,accuracy:0};else if(t.discontinuityStarts.length)for(var n=0;n<t.discontinuityStarts.length;n++){var s=t.discontinuityStarts[n],r=t.discontinuitySequence+n+1,a=s-e.mediaIndex;a>0&&(!this.discontinuities[r]||this.discontinuities[r].accuracy>a)&&(this.discontinuities[r]={time:i.end+(0,_playlist.sumDurations)(t,e.mediaIndex+1,s),accuracy:a})}}}]),t}(_videoJs2.default.EventTarget);exports.default=SyncController;
},{"./playlist":321,"mux.js/lib/mp4/probe":205,"mux.js/lib/tools/ts-inspector.js":206,"video.js":312}],330:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),_get=function(e,t,r){for(var i=!0;i;){var l=e,a=t,o=r;i=!1,null===l&&(l=Function.prototype);var s=Object.getOwnPropertyDescriptor(l,a);if(void 0!==s){if("value"in s)return s.value;var n=s.get;if(void 0===n)return;return n.call(o)}var u=Object.getPrototypeOf(l);if(null===u)return;e=u,t=a,r=o,i=!0,s=u=void 0}},_globalDocument=require("global/document"),_globalDocument2=_interopRequireDefault(_globalDocument),_playlistLoader=require("./playlist-loader"),_playlistLoader2=_interopRequireDefault(_playlistLoader),_playlist=require("./playlist"),_playlist2=_interopRequireDefault(_playlist),_xhr=require("./xhr"),_xhr2=_interopRequireDefault(_xhr),_aesDecrypter=require("aes-decrypter"),_binUtils=require("./bin-utils"),_binUtils2=_interopRequireDefault(_binUtils),_videojsContribMediaSources=require("videojs-contrib-media-sources"),_m3u8Parser=require("m3u8-parser"),_m3u8Parser2=_interopRequireDefault(_m3u8Parser),_videoJs=require("video.js"),_videoJs2=_interopRequireDefault(_videoJs),_masterPlaylistController=require("./master-playlist-controller"),_config=require("./config"),_config2=_interopRequireDefault(_config),_renditionMixin=require("./rendition-mixin"),_renditionMixin2=_interopRequireDefault(_renditionMixin),_globalWindow=require("global/window"),_globalWindow2=_interopRequireDefault(_globalWindow),_playbackWatcher=require("./playback-watcher"),_playbackWatcher2=_interopRequireDefault(_playbackWatcher),_reloadSourceOnError=require("./reload-source-on-error"),_reloadSourceOnError2=_interopRequireDefault(_reloadSourceOnError),Hls={PlaylistLoader:_playlistLoader2.default,Playlist:_playlist2.default,Decrypter:_aesDecrypter.Decrypter,AsyncStream:_aesDecrypter.AsyncStream,decrypt:_aesDecrypter.decrypt,utils:_binUtils2.default,xhr:(0,_xhr2.default)()};Object.defineProperty(Hls,"GOAL_BUFFER_LENGTH",{get:function(){return _videoJs2.default.log.warn("using Hls.GOAL_BUFFER_LENGTH is UNSAFE be sure you know what you are doing"),_config2.default.GOAL_BUFFER_LENGTH},set:function(e){return _videoJs2.default.log.warn("using Hls.GOAL_BUFFER_LENGTH is UNSAFE be sure you know what you are doing"),"number"!=typeof e||e<=0?void _videoJs2.default.log.warn("value passed to Hls.GOAL_BUFFER_LENGTH must be a number and greater than 0"):void(_config2.default.GOAL_BUFFER_LENGTH=e)}});var BANDWIDTH_VARIANCE=1.2,safeGetComputedStyle=function(e,t){var r=void 0;return e?(r=_globalWindow2.default.getComputedStyle(e),r?r[t]:""):""},handleHlsMediaChange=function(e,t){for(var r=t.media(),i=-1,l=0;l<e.length;l++)if(e[l].id===r.uri){i=l;break}e.selectedIndex_=i,e.trigger({selectedIndex:i,type:"change"})},handleHlsLoadedMetadata=function(e,t){t.representations().forEach(function(t){e.addQualityLevel(t)}),handleHlsMediaChange(e,t.playlists)};Hls.STANDARD_PLAYLIST_SELECTOR=function(){var e=void 0,t=this.playlists.master.playlists.slice(),r=[],i=void 0,l=void 0,a=void 0,o=void 0,s=void 0,n=void 0,u=void 0,d=void 0;for(t.sort(Hls.comparePlaylistBandwidth),t=t.filter(_playlist2.default.isEnabled),i=t.length;i--;)l=t[i],l.attributes&&l.attributes.BANDWIDTH&&(e=l.attributes.BANDWIDTH*BANDWIDTH_VARIANCE,e<this.systemBandwidth&&(r.push(l),a||(a=l)));for(i=r.length,r.sort(Hls.comparePlaylistResolution),l=null,u=parseInt(safeGetComputedStyle(this.tech_.el(),"width"),10),d=parseInt(safeGetComputedStyle(this.tech_.el(),"height"),10);i--;)if(l=r[i],l.attributes&&l.attributes.RESOLUTION&&l.attributes.RESOLUTION.width&&l.attributes.RESOLUTION.height){var c=l.attributes.RESOLUTION;if(c.width===u&&c.height===d){o=null,n=l;break}if(c.width<u&&c.height<d)break;(!o||c.width<s.width&&c.height<s.height)&&(o=l,s=o.attributes.RESOLUTION)}return o||n||a||t[0]},Hls.canPlaySource=function(){return _videoJs2.default.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")},Hls.supportsNativeHls=function(){var e=_globalDocument2.default.createElement("video");if(!_videoJs2.default.getComponent("Html5").isSupported())return!1;var t=["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"];return t.some(function(t){return/maybe|probably/i.test(e.canPlayType(t))})}(),Hls.isSupported=function(){return _videoJs2.default.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var USER_AGENT=_globalWindow2.default.navigator&&_globalWindow2.default.navigator.userAgent||"";Hls.supportsAudioInfoChange_=function(){if(_videoJs2.default.browser.IS_FIREFOX){var e=/Firefox\/([\d.]+)/i.exec(USER_AGENT),t=parseInt(e[1],10);return t>=49}return!0};var Component=_videoJs2.default.getComponent("Component"),HlsHandler=function(e){function t(e,r,i){var l=this;if(_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,r),r.options_&&r.options_.playerId){var a=(0,_videoJs2.default)(r.options_.playerId);a.hasOwnProperty("hls")||Object.defineProperty(a,"hls",{get:function(){return _videoJs2.default.log.warn("player.hls is deprecated. Use player.tech_.hls instead."),l}})}this.tech_=r,this.source_=e,this.stats={},this.ignoreNextSeekingEvent_=!1,this.options_=_videoJs2.default.mergeOptions(_videoJs2.default.options.hls||{},i.hls),this.setOptions_(),this.on(_globalDocument2.default,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],function(e){var t=_globalDocument2.default.fullscreenElement||_globalDocument2.default.webkitFullscreenElement||_globalDocument2.default.mozFullScreenElement||_globalDocument2.default.msFullscreenElement;t&&t.contains(l.tech_.el())&&l.masterPlaylistController_.fastQualityChange_()}),this.on(this.tech_,"seeking",function(){return this.ignoreNextSeekingEvent_?void(this.ignoreNextSeekingEvent_=!1):void this.setCurrentTime(this.tech_.currentTime())}),this.on(this.tech_,"error",function(){this.masterPlaylistController_&&this.masterPlaylistController_.pauseLoading()}),this.audioTrackChange_=function(){l.masterPlaylistController_.setupAudio()},this.on(this.tech_,"play",this.play)}return _inherits(t,e),_createClass(t,[{key:"setOptions_",value:function(){var e=this;this.options_.withCredentials=this.options_.withCredentials||!1,"number"!=typeof this.options_.bandwidth&&(this.options_.bandwidth=4194304),["withCredentials","bandwidth"].forEach(function(t){"undefined"!=typeof e.source_[t]&&(e.options_[t]=e.source_[t])}),this.bandwidth=this.options_.bandwidth}},{key:"src",value:function(e){var t=this;e&&(this.setOptions_(),this.options_.url=this.source_.src,this.options_.tech=this.tech_,this.options_.externHls=Hls,this.masterPlaylistController_=new _masterPlaylistController.MasterPlaylistController(this.options_),this.playbackWatcher_=new _playbackWatcher2.default(_videoJs2.default.mergeOptions(this.options_,{seekable:function(){return t.seekable()}})),this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):Hls.STANDARD_PLAYLIST_SELECTOR.bind(this),this.playlists=this.masterPlaylistController_.masterPlaylistLoader_,this.mediaSource=this.masterPlaylistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(e){this.masterPlaylistController_.selectPlaylist=e.bind(this)}},throughput:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=e,this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.bandwidth},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=e,this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function(){var e=1/(this.bandwidth||1),t=void 0;t=this.throughput>0?1/this.throughput:0;var r=Math.floor(1/(e+t));return r},set:function(){_videoJs2.default.log.error('The "systemBandwidth" property is read-only')}}}),Object.defineProperties(this.stats,{bandwidth:{get:function(){return t.bandwidth||0},enumerable:!0},mediaRequests:{get:function(){return t.masterPlaylistController_.mediaRequests_()||0},enumerable:!0},mediaTransferDuration:{get:function(){return t.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:!0},mediaBytesTransferred:{get:function(){return t.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:!0},mediaSecondsLoaded:{get:function(){return t.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:!0}}),this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)),this.masterPlaylistController_.on("sourceopen",function(){t.tech_.audioTracks().addEventListener("change",t.audioTrackChange_)}),this.masterPlaylistController_.on("selectedinitialmedia",function(){(0,_renditionMixin2.default)(t)}),this.masterPlaylistController_.on("audioupdate",function(){t.tech_.clearTracks("audio"),t.masterPlaylistController_.activeAudioGroup().forEach(function(e){t.tech_.audioTracks().addTrack(e)})}),this.on(this.masterPlaylistController_,"progress",function(){this.tech_.trigger("progress")}),this.on(this.masterPlaylistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.setupQualityLevels_(),this.tech_.el()&&this.tech_.src(_videoJs2.default.URL.createObjectURL(this.masterPlaylistController_.mediaSource)))}},{key:"setupQualityLevels_",value:function(){var e=this,t=_videoJs2.default.players[this.tech_.options_.playerId];t&&t.qualityLevels&&(this.qualityLevels_=t.qualityLevels(),this.masterPlaylistController_.on("selectedinitialmedia",function(){handleHlsLoadedMetadata(e.qualityLevels_,e)}),this.playlists.on("mediachange",function(){handleHlsMediaChange(e.qualityLevels_,e.playlists)}))}},{key:"activeAudioGroup_",value:function(){return this.masterPlaylistController_.activeAudioGroup()}},{key:"play",value:function(){this.masterPlaylistController_.play()}},{key:"setCurrentTime",value:function(e){this.masterPlaylistController_.setCurrentTime(e)}},{key:"duration",value:function(){return this.masterPlaylistController_.duration()}},{key:"seekable",value:function(){return this.masterPlaylistController_.seekable()}},{key:"dispose",value:function(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.masterPlaylistController_&&this.masterPlaylistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.tech_.audioTracks().removeEventListener("change",this.audioTrackChange_),_get(Object.getPrototypeOf(t.prototype),"dispose",this).call(this)}}]),t}(Component),HlsSourceHandler=function e(t){return{canHandleSource:function(r){return(!_videoJs2.default.options.hls||!_videoJs2.default.options.hls.mode||_videoJs2.default.options.hls.mode===t)&&e.canPlayType(r.type)},handleSource:function(e,r,i){"flash"===t&&r.setTimeout(function(){r.trigger("loadstart")},1);var l=_videoJs2.default.mergeOptions(i,{hls:{mode:t}});return r.hls=new HlsHandler(e,r,l),r.hls.xhr=(0,_xhr2.default)(),_videoJs2.default.Hls.xhr.beforeRequest&&(r.hls.xhr.beforeRequest=_videoJs2.default.Hls.xhr.beforeRequest),r.hls.src(e.src),r.hls},canPlayType:function(t){return e.canPlayType(t)?"maybe":""}}};Hls.comparePlaylistBandwidth=function(e,t){var r=void 0,i=void 0;return e.attributes&&e.attributes.BANDWIDTH&&(r=e.attributes.BANDWIDTH),r=r||_globalWindow2.default.Number.MAX_VALUE,t.attributes&&t.attributes.BANDWIDTH&&(i=t.attributes.BANDWIDTH),i=i||_globalWindow2.default.Number.MAX_VALUE,r-i},Hls.comparePlaylistResolution=function(e,t){var r=void 0,i=void 0;return e.attributes&&e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width&&(r=e.attributes.RESOLUTION.width),r=r||_globalWindow2.default.Number.MAX_VALUE,t.attributes&&t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width&&(i=t.attributes.RESOLUTION.width),i=i||_globalWindow2.default.Number.MAX_VALUE,r===i&&e.attributes.BANDWIDTH&&t.attributes.BANDWIDTH?e.attributes.BANDWIDTH-t.attributes.BANDWIDTH:r-i},HlsSourceHandler.canPlayType=function(e){var t=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i;return!(!_videoJs2.default.options.hls.overrideNative&&Hls.supportsNativeHls)&&t.test(e)},"undefined"!=typeof _videoJs2.default.MediaSource&&"undefined"!=typeof _videoJs2.default.URL||(_videoJs2.default.MediaSource=_videojsContribMediaSources.MediaSource,_videoJs2.default.URL=_videojsContribMediaSources.URL),_videojsContribMediaSources.MediaSource.supportsNativeMediaSources()&&_videoJs2.default.getComponent("Html5").registerSourceHandler(HlsSourceHandler("html5"),0),_globalWindow2.default.Uint8Array&&_videoJs2.default.getComponent("Flash").registerSourceHandler(HlsSourceHandler("flash")),_videoJs2.default.HlsHandler=HlsHandler,_videoJs2.default.HlsSourceHandler=HlsSourceHandler,_videoJs2.default.Hls=Hls,_videoJs2.default.m3u8=_m3u8Parser2.default,_videoJs2.default.registerComponent("Hls",Hls),_videoJs2.default.options.hls=_videoJs2.default.options.hls||{},_videoJs2.default.plugin("reloadSourceOnError",_reloadSourceOnError2.default),module.exports={Hls:Hls,HlsHandler:HlsHandler,HlsSourceHandler:HlsSourceHandler};
},{"./bin-utils":316,"./config":317,"./master-playlist-controller":318,"./playback-watcher":319,"./playlist":321,"./playlist-loader":320,"./reload-source-on-error":323,"./rendition-mixin":324,"./xhr":331,"aes-decrypter":4,"global/document":193,"global/window":194,"m3u8-parser":196,"video.js":312,"videojs-contrib-media-sources":342}],331:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _videoJs=require("video.js"),xhrFactory=function(){var e=function e(t,o){if(t=(0,_videoJs.mergeOptions)({timeout:45e3},t),e.beforeRequest&&"function"==typeof e.beforeRequest){var r=e.beforeRequest(t);r&&(t=r)}var s=(0,_videoJs.xhr)(t,function(e,t){!e&&s.response&&(s.responseTime=Date.now(),s.roundTripTime=s.responseTime-s.requestTime,s.bytesReceived=s.response.byteLength||s.response.length,s.bandwidth||(s.bandwidth=Math.floor(s.bytesReceived/s.roundTripTime*8*1e3))),e||s.timedout?s.timedout=s.timedout||"ETIMEDOUT"===e.code:s.timedout=!1,e||200===t.statusCode||206===t.statusCode||0===t.statusCode||(e=new Error("XHR Failed with a response of: "+(s&&(s.response||s.responseText)))),o(e,s)});return s.requestTime=Date.now(),s};return e};exports.default=xhrFactory,module.exports=exports.default;
},{"video.js":312}],332:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _globalWindow=require("global/window"),_globalWindow2=_interopRequireDefault(_globalWindow),_videoJs=require("video.js"),_videoJs2=_interopRequireDefault(_videoJs),deprecateOldCue=function(e){Object.defineProperties(e.frame,{id:{get:function(){return _videoJs2.default.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),e.value.key}},value:{get:function(){return _videoJs2.default.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),e.value.data}},privateData:{get:function(){return _videoJs2.default.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),e.value.data}}})},durationOfVideo=function(e){var a=void 0;return a=isNaN(e)||Math.abs(e)===1/0?Number.MAX_VALUE:e},addTextTrackData=function(e,a,t){var r=_globalWindow2.default.WebKitDataCue||_globalWindow2.default.VTTCue;if(a&&a.forEach(function(e){this.inbandTextTrack_.addCue(new r(e.startTime+this.timestampOffset,e.endTime+this.timestampOffset,e.text))},e),t){var i=durationOfVideo(e.mediaSource_.duration);if(t.forEach(function(e){var a=e.cueTime+this.timestampOffset;e.frames.forEach(function(e){var t=new r(a,a,e.value||e.url||e.data||"");t.frame=e,t.value=e,deprecateOldCue(t),this.metadataTrack_.addCue(t)},this)},e),e.metadataTrack_&&e.metadataTrack_.cues&&e.metadataTrack_.cues.length){for(var d=e.metadataTrack_.cues,u=[],n=0;n<d.length;n++)u.push(d[n]);u.sort(function(e,a){return e.startTime-a.startTime});for(var o=0;o<u.length-1;o++)u[o].endTime!==u[o+1].startTime&&(u[o].endTime=u[o+1].startTime);u[u.length-1].endTime=i}}};exports.default={addTextTrackData:addTextTrackData,durationOfVideo:durationOfVideo},module.exports=exports.default;
},{"global/window":194,"video.js":457}],333:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var removeExistingTrack=function(e,r,t){for(var a=e.remoteTextTracks()||[],c=0;c<a.length;c++){var i=a[c];i.kind===r&&i.label===t&&e.removeRemoteTextTrack(i)}};exports.removeExistingTrack=removeExistingTrack;var cleanupTextTracks=function(e){removeExistingTrack(e,"captions","cc1"),removeExistingTrack(e,"metadata","Timed Metadata")};exports.cleanupTextTracks=cleanupTextTracks;
},{}],334:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var isAudioCodec=function(e){return/mp4a\.\d+.\d+/i.test(e)},isVideoCodec=function(e){return/avc1\.[\da-f]+/i.test(e)},parseContentType=function(e){var t={type:"",parameters:{}},r=e.trim().split(";");return t.type=r.shift().trim(),r.forEach(function(e){var r=e.trim().split("=");if(r.length>1){var i=r[0].replace(/"/g,"").trim(),o=r[1].replace(/"/g,"").trim();t.parameters[i]=o}}),t},translateLegacyCodecs=function(e){return e.map(function(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,function(e,t,r){var i=("00"+Number(t).toString(16)).slice(-2),o=("00"+Number(r).toString(16)).slice(-2);return"avc1."+i+"00"+o})})};exports.default={isAudioCodec:isAudioCodec,parseContentType:parseContentType,isVideoCodec:isVideoCodec,translateLegacyCodecs:translateLegacyCodecs},module.exports=exports.default;
},{}],335:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _cleanupTextTracks=require("./cleanup-text-tracks"),createTextTracksIfNecessary=function(a,e,t){var c=e.player_;t.captions&&t.captions.length&&!a.inbandTextTrack_&&((0,_cleanupTextTracks.removeExistingTrack)(c,"captions","cc1"),a.inbandTextTrack_=c.addRemoteTextTrack({kind:"captions",label:"cc1"},!1).track),t.metadata&&t.metadata.length&&!a.metadataTrack_&&((0,_cleanupTextTracks.removeExistingTrack)(c,"metadata","Timed Metadata",!0),a.metadataTrack_=c.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,a.metadataTrack_.inBandMetadataTrackDispatchType=t.metadata.dispatchType)};exports.default=createTextTracksIfNecessary,module.exports=exports.default;
},{"./cleanup-text-tracks":333}],336:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var flashConstants={TIME_BETWEEN_CHUNKS:1,BYTES_PER_CHUNK:32768};exports.default=flashConstants,module.exports=exports.default;
},{}],337:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),_get=function(e,t,r){for(var o=!0;o;){var n=e,s=t,a=r;o=!1,null===n&&(n=Function.prototype);var u=Object.getOwnPropertyDescriptor(n,s);if(void 0!==u){if("value"in u)return u.value;var i=u.get;if(void 0===i)return;return i.call(a)}var f=Object.getPrototypeOf(n);if(null===f)return;e=f,t=s,r=a,o=!0,u=f=void 0}},_globalDocument=require("global/document"),_globalDocument2=_interopRequireDefault(_globalDocument),_videoJs=require("video.js"),_videoJs2=_interopRequireDefault(_videoJs),_flashSourceBuffer=require("./flash-source-buffer"),_flashSourceBuffer2=_interopRequireDefault(_flashSourceBuffer),_flashConstants=require("./flash-constants"),_flashConstants2=_interopRequireDefault(_flashConstants),_codecUtils=require("./codec-utils"),_cleanupTextTracks=require("./cleanup-text-tracks"),FlashMediaSource=function(e){function t(){var e=this;_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.sourceBuffers=[],this.readyState="closed",this.on(["sourceopen","webkitsourceopen"],function(t){e.swfObj=_globalDocument2.default.getElementById(t.swfId),e.player_=(0,_videoJs2.default)(e.swfObj.parentNode),e.tech_=e.swfObj.tech,e.readyState="open",e.tech_.on("seeking",function(){for(var t=e.sourceBuffers.length;t--;)e.sourceBuffers[t].abort()}),e.tech_.hls&&e.tech_.hls.on("dispose",function(){(0,_cleanupTextTracks.cleanupTextTracks)(e.player_)}),e.swfObj&&e.swfObj.vjs_load()})}return _inherits(t,e),_createClass(t,[{key:"addSeekableRange_",value:function(){}},{key:"addSourceBuffer",value:function(e){var t=(0,_codecUtils.parseContentType)(e),r=void 0;if("video/mp2t"!==t.type)throw new Error("NotSupportedError (Video.js)");return r=new _flashSourceBuffer2.default(this),this.sourceBuffers.push(r),r}},{key:"endOfStream",value:function(e){"network"===e?this.tech_.error(2):"decode"===e&&this.tech_.error(3),"ended"!==this.readyState&&(this.readyState="ended",this.swfObj.vjs_endOfStream())}}]),t}(_videoJs2.default.EventTarget);exports.default=FlashMediaSource;try{Object.defineProperty(FlashMediaSource.prototype,"duration",{get:function(){return this.swfObj?this.swfObj.vjs_getProperty("duration"):NaN},set:function(e){var t=void 0,r=this.swfObj.vjs_getProperty("duration");if(this.swfObj.vjs_setProperty("duration",e),e<r)for(t=0;t<this.sourceBuffers.length;t++)this.sourceBuffers[t].remove(e,r);return e}})}catch(e){FlashMediaSource.prototype.duration=NaN}for(var property in _flashConstants2.default)FlashMediaSource[property]=_flashConstants2.default[property];module.exports=exports.default;
},{"./cleanup-text-tracks":333,"./codec-utils":334,"./flash-constants":336,"./flash-source-buffer":338,"global/document":193,"video.js":457}],338:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),_get=function(e,t,a){for(var r=!0;r;){var s=e,i=t,n=a;r=!1,null===s&&(s=Function.prototype);var o=Object.getOwnPropertyDescriptor(s,i);if(void 0!==o){if("value"in o)return o.value;var u=o.get;if(void 0===u)return;return u.call(n)}var f=Object.getPrototypeOf(s);if(null===f)return;e=f,t=i,a=n,r=!0,o=f=void 0}},_globalWindow=require("global/window"),_globalWindow2=_interopRequireDefault(_globalWindow),_videoJs=require("video.js"),_videoJs2=_interopRequireDefault(_videoJs),_muxJsLibFlv=require("mux.js/lib/flv"),_muxJsLibFlv2=_interopRequireDefault(_muxJsLibFlv),_removeCuesFromTrack=require("./remove-cues-from-track"),_removeCuesFromTrack2=_interopRequireDefault(_removeCuesFromTrack),_createTextTracksIfNecessary=require("./create-text-tracks-if-necessary"),_createTextTracksIfNecessary2=_interopRequireDefault(_createTextTracksIfNecessary),_addTextTrackData=require("./add-text-track-data"),_flashConstants=require("./flash-constants"),_flashConstants2=_interopRequireDefault(_flashConstants),scheduleTick=function(e){_globalWindow2.default.setTimeout(e,_flashConstants2.default.TIME_BETWEEN_CHUNKS)},generateRandomString=function(){return Math.random().toString(36).slice(2,8)},toDecimalPlaces=function(e,t){("number"!=typeof t||t<0)&&(t=0);var a=Math.pow(10,t);return Math.round(e*a)/a},FlashSourceBuffer=function(e){function t(e){var a=this;_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this);var r=void 0;this.chunkSize_=_flashConstants2.default.BYTES_PER_CHUNK,this.buffer_=[],this.bufferSize_=0,this.basePtsOffset_=NaN,this.mediaSource_=e,this.updating=!1,this.timestampOffset_=0,r=_globalWindow2.default.btoa(String.fromCharCode.apply(null,Array.prototype.slice.call(_muxJsLibFlv2.default.getFlvHeader())));var s=this.mediaSource_.player_.id().replace(/[^a-zA-Z0-9]/g,"_");this.flashEncodedHeaderName_="vjs_flashEncodedHeader_"+s+generateRandomString(),this.flashEncodedDataName_="vjs_flashEncodedData_"+s+generateRandomString(),_globalWindow2.default[this.flashEncodedHeaderName_]=function(){return delete _globalWindow2.default[a.flashEncodedHeaderName_],r},this.mediaSource_.swfObj.vjs_appendChunkReady(this.flashEncodedHeaderName_),this.transmuxer_=new _muxJsLibFlv2.default.Transmuxer,this.transmuxer_.on("data",this.receiveBuffer_.bind(this)),this.one("updateend",function(){a.mediaSource_.tech_.trigger("loadedmetadata")}),Object.defineProperty(this,"timestampOffset",{get:function(){return this.timestampOffset_},set:function(e){"number"==typeof e&&e>=0&&(this.timestampOffset_=e,this.transmuxer_=new _muxJsLibFlv2.default.Transmuxer,this.transmuxer_.on("data",this.receiveBuffer_.bind(this)),this.mediaSource_.swfObj.vjs_discontinuity(),this.basePtsOffset_=NaN)}}),Object.defineProperty(this,"buffered",{get:function(){if(!(this.mediaSource_&&this.mediaSource_.swfObj&&"vjs_getProperty"in this.mediaSource_.swfObj))return _videoJs2.default.createTimeRange();var e=this.mediaSource_.swfObj.vjs_getProperty("buffered");return e&&e.length&&(e[0][0]=toDecimalPlaces(e[0][0],3),e[0][1]=toDecimalPlaces(e[0][1],3)),_videoJs2.default.createTimeRanges(e)}}),this.mediaSource_.player_.on("seeked",function(){(0,_removeCuesFromTrack2.default)(0,1/0,a.metadataTrack_),(0,_removeCuesFromTrack2.default)(0,1/0,a.inbandTextTrack_)})}return _inherits(t,e),_createClass(t,[{key:"appendBuffer",value:function(e){var t=this,a=void 0;if(this.updating)throw a=new Error("SourceBuffer.append() cannot be called while an update is in progress"),a.name="InvalidStateError",a.code=11,a;this.updating=!0,this.mediaSource_.readyState="open",this.trigger({type:"update"});var r=524288,s=0,i=function a(){t.transmuxer_.push(e.subarray(s,s+r)),s+=r,scheduleTick(s<e.byteLength?a:t.transmuxer_.flush.bind(t.transmuxer_))};i()}},{key:"abort",value:function(){this.buffer_=[],this.bufferSize_=0,this.mediaSource_.swfObj.vjs_abort(),this.updating&&(this.updating=!1,this.trigger({type:"updateend"}))}},{key:"remove",value:function(e,t){(0,_removeCuesFromTrack2.default)(e,t,this.metadataTrack_),(0,_removeCuesFromTrack2.default)(e,t,this.inbandTextTrack_),this.trigger({type:"update"}),this.trigger({type:"updateend"})}},{key:"receiveBuffer_",value:function(e){var t=this;(0,_createTextTracksIfNecessary2.default)(this,this.mediaSource_,e),(0,_addTextTrackData.addTextTrackData)(this,e.captions,e.metadata),scheduleTick(function(){var a=t.convertTagsToData_(e);0===t.buffer_.length&&scheduleTick(t.processBuffer_.bind(t)),a&&(t.buffer_.push(a),t.bufferSize_+=a.byteLength)})}},{key:"processBuffer_",value:function(){var e=this,t=_flashConstants2.default.BYTES_PER_CHUNK;if(!this.buffer_.length)return void(this.updating!==!1&&(this.updating=!1,this.trigger({type:"updateend"})));var a=this.buffer_[0].subarray(0,t);a.byteLength<t||this.buffer_[0].byteLength===t?this.buffer_.shift():this.buffer_[0]=this.buffer_[0].subarray(t),this.bufferSize_-=a.byteLength;for(var r=[],s=a.byteLength,i=0;i<s;i++)r.push(String.fromCharCode(a[i]));var n=_globalWindow2.default.btoa(r.join(""));_globalWindow2.default[this.flashEncodedDataName_]=function(){return scheduleTick(e.processBuffer_.bind(e)),delete _globalWindow2.default[e.flashEncodedDataName_],n},this.mediaSource_.swfObj.vjs_appendChunkReady(this.flashEncodedDataName_)}},{key:"convertTagsToData_",value:function(e){var t=0,a=this.mediaSource_.tech_,r=0,s=void 0,i=e.tags.videoTags,n=e.tags.audioTags;if(isNaN(this.basePtsOffset_)&&(i.length||n.length)){var o=i[0]||{pts:1/0},u=n[0]||{pts:1/0};this.basePtsOffset_=Math.min(u.pts,o.pts)}a.buffered().length&&(r=a.buffered().end(0)-this.timestampOffset),a.seeking()&&(r=Math.max(r,a.currentTime()-this.timestampOffset)),r*=1e3,r+=this.basePtsOffset_;var f=i.length;if(f&&i[f-1].pts>=r){for(;--f;){var d=i[f];if(!(d.pts>r)&&(d.keyFrame||d.metaDataTag))break}for(;f;){var l=i[f-1];if(!l.metaDataTag)break;f--}}var c=i.slice(f),h=r;for(c.length&&(h=Math.min(r,c[0].pts)),f=0;f<n.length&&!(n[f].pts>=h);)f++;var _=n.slice(f),p=this.getOrderedTags_(c,_);if(0!==p.length){if(p[0].pts<r&&a.seeking()){var m=1/30,b=a.currentTime(),g=(r-p[0].pts)/1e3,v=b-g;v<m&&(v=0);try{this.mediaSource_.swfObj.vjs_adjustCurrentTime(v)}catch(e){}}for(var y=0;y<p.length;y++)t+=p[y].bytes.byteLength;s=new Uint8Array(t);for(var y=0,T=0;y<p.length;y++)s.set(p[y].bytes,T),T+=p[y].bytes.byteLength;return s}}},{key:"getOrderedTags_",value:function(e,t){for(var a=void 0,r=[];e.length||t.length;)a=e.length?t.length&&t[0].dts<e[0].dts?t.shift():e.shift():t.shift(),r.push(a);return r}}]),t}(_videoJs2.default.EventTarget);exports.default=FlashSourceBuffer,module.exports=exports.default;
},{"./add-text-track-data":332,"./create-text-tracks-if-necessary":335,"./flash-constants":336,"./remove-cues-from-track":340,"global/window":194,"mux.js/lib/flv":351,"video.js":457}],339:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),_get=function(e,t,r){for(var a=!0;a;){var i=e,o=t,u=r;a=!1,null===i&&(i=Function.prototype);var n=Object.getOwnPropertyDescriptor(i,o);if(void 0!==n){if("value"in n)return n.value;var c=n.get;if(void 0===c)return;return c.call(u)}var s=Object.getPrototypeOf(i);if(null===s)return;e=s,t=o,r=u,a=!0,n=s=void 0}},_globalWindow=require("global/window"),_globalWindow2=_interopRequireDefault(_globalWindow),_globalDocument=require("global/document"),_globalDocument2=_interopRequireDefault(_globalDocument),_videoJs=require("video.js"),_videoJs2=_interopRequireDefault(_videoJs),_virtualSourceBuffer=require("./virtual-source-buffer"),_virtualSourceBuffer2=_interopRequireDefault(_virtualSourceBuffer),_addTextTrackData=require("./add-text-track-data"),_codecUtils=require("./codec-utils"),_cleanupTextTracks=require("./cleanup-text-tracks"),HtmlMediaSource=function(e){function t(){var e=this;_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this);var r=void 0;this.nativeMediaSource_=new _globalWindow2.default.MediaSource;for(r in this.nativeMediaSource_)r in t.prototype||"function"!=typeof this.nativeMediaSource_[r]||(this[r]=this.nativeMediaSource_[r].bind(this.nativeMediaSource_));this.duration_=NaN,Object.defineProperty(this,"duration",{get:function(){return this.duration_===1/0?this.duration_:this.nativeMediaSource_.duration},set:function(e){if(this.duration_=e,e!==1/0)return void(this.nativeMediaSource_.duration=e)}}),Object.defineProperty(this,"seekable",{get:function(){return this.duration_===1/0?_videoJs2.default.createTimeRanges([[0,this.nativeMediaSource_.duration]]):this.nativeMediaSource_.seekable}}),Object.defineProperty(this,"readyState",{get:function(){return this.nativeMediaSource_.readyState}}),Object.defineProperty(this,"activeSourceBuffers",{get:function(){return this.activeSourceBuffers_}}),this.sourceBuffers=[],this.activeSourceBuffers_=[],this.updateActiveSourceBuffers_=function(){e.activeSourceBuffers_.length=0;for(var t=!1,r=!0,a=0;a<e.player_.audioTracks().length;a++){var i=e.player_.audioTracks()[a];if(i.enabled&&"main"!==i.kind){t=!0,r=!1;break}}e.sourceBuffers.forEach(function(a){if(a.appendAudioInitSegment_=!0,a.videoCodec_&&a.audioCodec_)a.audioDisabled_=t;else if(a.videoCodec_&&!a.audioCodec_)a.audioDisabled_=!0,r=!1;else if(!a.videoCodec_&&a.audioCodec_&&(a.audioDisabled_=r,r))return;e.activeSourceBuffers_.push(a)})},this.onPlayerMediachange_=function(){e.sourceBuffers.forEach(function(e){e.appendAudioInitSegment_=!0})},["sourceopen","sourceclose","sourceended"].forEach(function(e){this.nativeMediaSource_.addEventListener(e,this.trigger.bind(this))},this),this.on("sourceopen",function(t){var r=_globalDocument2.default.querySelector('[src="'+e.url_+'"]');r&&(e.player_=(0,_videoJs2.default)(r.parentNode),e.player_.audioTracks&&e.player_.audioTracks()&&(e.player_.audioTracks().on("change",e.updateActiveSourceBuffers_),e.player_.audioTracks().on("addtrack",e.updateActiveSourceBuffers_),e.player_.audioTracks().on("removetrack",e.updateActiveSourceBuffers_)),e.player_.on("mediachange",e.onPlayerMediachange_))}),this.on("sourceended",function(t){for(var r=(0,_addTextTrackData.durationOfVideo)(e.duration),a=0;a<e.sourceBuffers.length;a++){var i=e.sourceBuffers[a],o=i.metadataTrack_&&i.metadataTrack_.cues;o&&o.length&&(o[o.length-1].endTime=r)}}),this.on("sourceclose",function(e){this.sourceBuffers.forEach(function(e){e.transmuxer_&&e.transmuxer_.terminate()}),this.sourceBuffers.length=0,this.player_&&((0,_cleanupTextTracks.cleanupTextTracks)(this.player_),this.player_.audioTracks&&this.player_.audioTracks()&&(this.player_.audioTracks().off("change",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("addtrack",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("removetrack",this.updateActiveSourceBuffers_)),this.player_.el_&&this.player_.off("mediachange",this.onPlayerMediachange_))})}return _inherits(t,e),_createClass(t,[{key:"addSeekableRange_",value:function(e,t){var r=void 0;if(this.duration!==1/0)throw r=new Error("MediaSource.addSeekableRange() can only be invoked when the duration is Infinity"),r.name="InvalidStateError",r.code=11,r;(t>this.nativeMediaSource_.duration||isNaN(this.nativeMediaSource_.duration))&&(this.nativeMediaSource_.duration=t)}},{key:"addSourceBuffer",value:function(e){var t=void 0,r=(0,_codecUtils.parseContentType)(e);if(/^(video|audio)\/mp2t$/i.test(r.type)){var a=[];r.parameters&&r.parameters.codecs&&(a=r.parameters.codecs.split(","),a=(0,_codecUtils.translateLegacyCodecs)(a),a=a.filter(function(e){return(0,_codecUtils.isAudioCodec)(e)||(0,_codecUtils.isVideoCodec)(e)})),0===a.length&&(a=["avc1.4d400d","mp4a.40.2"]),t=new _virtualSourceBuffer2.default(this,a),0!==this.sourceBuffers.length&&(this.sourceBuffers[0].createRealSourceBuffers_(),t.createRealSourceBuffers_(),this.sourceBuffers[0].audioDisabled_=!0)}else t=this.nativeMediaSource_.addSourceBuffer(e);return this.sourceBuffers.push(t),t}}]),t}(_videoJs2.default.EventTarget);exports.default=HtmlMediaSource,module.exports=exports.default;
},{"./add-text-track-data":332,"./cleanup-text-tracks":333,"./codec-utils":334,"./virtual-source-buffer":343,"global/document":193,"global/window":194,"video.js":457}],340:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var removeCuesFromTrack=function(e,r,o){var t=void 0,s=void 0;if(o&&o.cues)for(t=o.cues.length;t--;)s=o.cues[t],s.startTime<=r&&s.endTime>=e&&o.removeCue(s)};exports.default=removeCuesFromTrack,module.exports=exports.default;
},{}],341:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),_globalWindow=require("global/window"),_globalWindow2=_interopRequireDefault(_globalWindow),_muxJsLibMp4=require("mux.js/lib/mp4"),_muxJsLibMp42=_interopRequireDefault(_muxJsLibMp4),wireTransmuxerEvents=function(e){e.on("data",function(e){var t=e.initSegment;e.initSegment={data:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength};var a=e.data;e.data=a.buffer,_globalWindow2.default.postMessage({action:"data",segment:e,byteOffset:a.byteOffset,byteLength:a.byteLength},[e.data])}),e.captionStream&&e.captionStream.on("data",function(e){_globalWindow2.default.postMessage({action:"caption",data:e})}),e.on("done",function(e){_globalWindow2.default.postMessage({action:"done"})})},MessageHandlers=function(){function e(t){_classCallCheck(this,e),this.options=t||{},this.init()}return _createClass(e,[{key:"init",value:function(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new _muxJsLibMp42.default.Transmuxer(this.options),wireTransmuxerEvents(this.transmuxer)}},{key:"push",value:function(e){var t=new Uint8Array(e.data,e.byteOffset,e.byteLength);this.transmuxer.push(t)}},{key:"reset",value:function(){this.init()}},{key:"setTimestampOffset",value:function(e){var t=e.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(9e4*t))}},{key:"setAudioAppendStart",value:function(e){this.transmuxer.setAudioAppendStart(Math.ceil(9e4*e.appendStart))}},{key:"flush",value:function(e){this.transmuxer.flush()}}]),e}(),TransmuxerWorker=function(e){e.onmessage=function(e){return"init"===e.data.action&&e.data.options?void(this.messageHandlers=new MessageHandlers(e.data.options)):(this.messageHandlers||(this.messageHandlers=new MessageHandlers),void(e.data&&e.data.action&&"init"!==e.data.action&&this.messageHandlers[e.data.action]&&this.messageHandlers[e.data.action](e.data)))}};exports.default=function(e){return new TransmuxerWorker(e)},module.exports=exports.default;
},{"global/window":194,"mux.js/lib/mp4":359}],342:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _globalWindow=require("global/window"),_globalWindow2=_interopRequireDefault(_globalWindow),_flashMediaSource=require("./flash-media-source"),_flashMediaSource2=_interopRequireDefault(_flashMediaSource),_htmlMediaSource=require("./html-media-source"),_htmlMediaSource2=_interopRequireDefault(_htmlMediaSource),_videoJs=require("video.js"),_videoJs2=_interopRequireDefault(_videoJs),urlCount=0,defaults={mode:"auto"};_videoJs2.default.mediaSources={};var open=function(e,o){var u=_videoJs2.default.mediaSources[e];if(!u)throw new Error("Media Source not found (Video.js)");u.trigger({type:"sourceopen",swfId:o})},supportsNativeMediaSources=function(){return!!_globalWindow2.default.MediaSource&&!!_globalWindow2.default.MediaSource.isTypeSupported&&_globalWindow2.default.MediaSource.isTypeSupported('video/mp4;codecs="avc1.4d400d,mp4a.40.2"')},MediaSource=function(e){var o=_videoJs2.default.mergeOptions(defaults,e);return this.MediaSource={open:open,supportsNativeMediaSources:supportsNativeMediaSources},"html5"===o.mode||"auto"===o.mode&&supportsNativeMediaSources()?new _htmlMediaSource2.default:new _flashMediaSource2.default};exports.MediaSource=MediaSource,MediaSource.open=open,MediaSource.supportsNativeMediaSources=supportsNativeMediaSources;var URL={createObjectURL:function(e){var o="blob:vjs-media-source/",u=void 0;return e instanceof _htmlMediaSource2.default?(u=_globalWindow2.default.URL.createObjectURL(e.nativeMediaSource_),e.url_=u,u):e instanceof _flashMediaSource2.default?(u=o+urlCount,urlCount++,_videoJs2.default.mediaSources[u]=e,u):(u=_globalWindow2.default.URL.createObjectURL(e),e.url_=u,u)}};exports.URL=URL,_videoJs2.default.MediaSource=MediaSource,_videoJs2.default.URL=URL;
},{"./flash-media-source":337,"./html-media-source":339,"global/window":194,"video.js":457}],343:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_get=function(e,t,i){for(var r=!0;r;){var a=e,n=t,o=i;r=!1,null===a&&(a=Function.prototype);var u=Object.getOwnPropertyDescriptor(a,n);if(void 0!==u){if("value"in u)return u.value;var s=u.get;if(void 0===s)return;return s.call(o)}var f=Object.getPrototypeOf(a);if(null===f)return;e=f,t=n,i=o,r=!0,u=f=void 0}},_videoJs=require("video.js"),_videoJs2=_interopRequireDefault(_videoJs),_createTextTracksIfNecessary=require("./create-text-tracks-if-necessary"),_createTextTracksIfNecessary2=_interopRequireDefault(_createTextTracksIfNecessary),_removeCuesFromTrack=require("./remove-cues-from-track"),_removeCuesFromTrack2=_interopRequireDefault(_removeCuesFromTrack),_addTextTrackData=require("./add-text-track-data"),_webworkify=require("webworkify"),_webworkify2=_interopRequireDefault(_webworkify),_transmuxerWorker=require("./transmuxer-worker"),_transmuxerWorker2=_interopRequireDefault(_transmuxerWorker),_codecUtils=require("./codec-utils"),VirtualSourceBuffer=function(e){function t(e,i){var r=this;_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,_videoJs2.default.EventTarget),this.timestampOffset_=0,this.pendingBuffers_=[],this.bufferUpdating_=!1,this.mediaSource_=e,this.codecs_=i,this.audioCodec_=null,this.videoCodec_=null,this.audioDisabled_=!1,this.appendAudioInitSegment_=!0;var a={remux:!1};this.codecs_.forEach(function(e){(0,_codecUtils.isAudioCodec)(e)?r.audioCodec_=e:(0,_codecUtils.isVideoCodec)(e)&&(r.videoCodec_=e)}),this.transmuxer_=(0,_webworkify2.default)(_transmuxerWorker2.default),this.transmuxer_.postMessage({action:"init",options:a}),this.transmuxer_.onmessage=function(e){return"data"===e.data.action?r.data_(e):"done"===e.data.action?r.done_(e):void 0},Object.defineProperty(this,"timestampOffset",{get:function(){return this.timestampOffset_},set:function(e){"number"==typeof e&&e>=0&&(this.timestampOffset_=e,this.appendAudioInitSegment_=!0,this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e}))}}),Object.defineProperty(this,"appendWindowStart",{get:function(){return(this.videoBuffer_||this.audioBuffer_).appendWindowStart},set:function(e){this.videoBuffer_&&(this.videoBuffer_.appendWindowStart=e),this.audioBuffer_&&(this.audioBuffer_.appendWindowStart=e)}}),Object.defineProperty(this,"updating",{get:function(){return!!(this.bufferUpdating_||!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.updating||this.videoBuffer_&&this.videoBuffer_.updating)}}),Object.defineProperty(this,"buffered",{get:function(){var e=null,t=null,i=0,r=[],a=[];if(!this.videoBuffer_&&!this.audioBuffer_)return _videoJs2.default.createTimeRange();if(!this.videoBuffer_)return this.audioBuffer_.buffered;if(!this.audioBuffer_)return this.videoBuffer_.buffered;if(this.audioDisabled_)return this.videoBuffer_.buffered;if(0===this.videoBuffer_.buffered.length&&0===this.audioBuffer_.buffered.length)return _videoJs2.default.createTimeRange();for(var n=this.videoBuffer_.buffered,o=this.audioBuffer_.buffered,u=n.length;u--;)r.push({time:n.start(u),type:"start"}),r.push({time:n.end(u),type:"end"});for(u=o.length;u--;)r.push({time:o.start(u),type:"start"}),r.push({time:o.end(u),type:"end"});for(r.sort(function(e,t){return e.time-t.time}),u=0;u<r.length;u++)"start"===r[u].type?(i++,2===i&&(e=r[u].time)):"end"===r[u].type&&(i--,1===i&&(t=r[u].time)),null!==e&&null!==t&&(a.push([e,t]),e=null,t=null);return _videoJs2.default.createTimeRanges(a)}})}return _inherits(t,e),_createClass(t,[{key:"data_",value:function(e){var t=e.data.segment;t.data=new Uint8Array(t.data,e.data.byteOffset,e.data.byteLength),t.initSegment=new Uint8Array(t.initSegment.data,t.initSegment.byteOffset,t.initSegment.byteLength),(0,_createTextTracksIfNecessary2.default)(this,this.mediaSource_,t),this.pendingBuffers_.push(t)}},{key:"done_",value:function(e){this.processPendingSegments_()}},{key:"createRealSourceBuffers_",value:function(){var e=this,t=["audio","video"];t.forEach(function(i){if(e[i+"Codec_"]&&!e[i+"Buffer_"]){var r=null;e.mediaSource_[i+"Buffer_"]?r=e.mediaSource_[i+"Buffer_"]:(r=e.mediaSource_.nativeMediaSource_.addSourceBuffer(i+'/mp4;codecs="'+e[i+"Codec_"]+'"'),e.mediaSource_[i+"Buffer_"]=r),e[i+"Buffer_"]=r,["update","updatestart","updateend"].forEach(function(a){r.addEventListener(a,function(){if("audio"!==i||!e.audioDisabled_){var r=t.every(function(t){return!("audio"!==t||!e.audioDisabled_)||(i===t||!e[t+"Buffer_"]||!e[t+"Buffer_"].updating)});return r?e.trigger(a):void 0}})})}})}},{key:"appendBuffer",value:function(e){if(this.bufferUpdating_=!0,this.audioBuffer_&&this.audioBuffer_.buffered.length){var t=this.audioBuffer_.buffered;this.transmuxer_.postMessage({action:"setAudioAppendStart",appendStart:t.end(t.length-1)})}this.transmuxer_.postMessage({action:"push",data:e.buffer,byteOffset:e.byteOffset,byteLength:e.byteLength},[e.buffer]),this.transmuxer_.postMessage({action:"flush"})}},{key:"remove",value:function(e,t){this.videoBuffer_&&this.videoBuffer_.remove(e,t),this.audioBuffer_&&this.audioBuffer_.remove(e,t),(0,_removeCuesFromTrack2.default)(e,t,this.metadataTrack_),(0,_removeCuesFromTrack2.default)(e,t,this.inbandTextTrack_)}},{key:"processPendingSegments_",value:function(){var e={video:{segments:[],bytes:0},audio:{segments:[],bytes:0},captions:[],metadata:[]};e=this.pendingBuffers_.reduce(function(e,t){var i=t.type,r=t.data,a=t.initSegment;return e[i].segments.push(r),e[i].bytes+=r.byteLength,e[i].initSegment=a,t.captions&&(e.captions=e.captions.concat(t.captions)),t.info&&(e[i].info=t.info),t.metadata&&(e.metadata=e.metadata.concat(t.metadata)),e},e),this.videoBuffer_||this.audioBuffer_||(0===e.video.bytes&&(this.videoCodec_=null),0===e.audio.bytes&&(this.audioCodec_=null),this.createRealSourceBuffers_()),e.audio.info&&this.mediaSource_.trigger({type:"audioinfo",info:e.audio.info}),e.video.info&&this.mediaSource_.trigger({type:"videoinfo",info:e.video.info}),this.appendAudioInitSegment_&&(!this.audioDisabled_&&this.audioBuffer_&&(e.audio.segments.unshift(e.audio.initSegment),e.audio.bytes+=e.audio.initSegment.byteLength),this.appendAudioInitSegment_=!1),this.videoBuffer_&&(e.video.segments.unshift(e.video.initSegment),e.video.bytes+=e.video.initSegment.byteLength,this.concatAndAppendSegments_(e.video,this.videoBuffer_),(0,_addTextTrackData.addTextTrackData)(this,e.captions,e.metadata)),!this.audioDisabled_&&this.audioBuffer_&&this.concatAndAppendSegments_(e.audio,this.audioBuffer_),this.pendingBuffers_.length=0,this.bufferUpdating_=!1}},{key:"concatAndAppendSegments_",value:function(e,t){var i=0,r=void 0;if(e.bytes){r=new Uint8Array(e.bytes),e.segments.forEach(function(e){r.set(e,i),i+=e.byteLength});try{t.appendBuffer(r)}catch(e){this.mediaSource_.player_&&this.mediaSource_.player_.error({code:-3,type:"APPEND_BUFFER_ERR",message:e.message,originalError:e})}}}},{key:"abort",value:function(){this.videoBuffer_&&this.videoBuffer_.abort(),this.audioBuffer_&&this.audioBuffer_.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"reset"}),this.pendingBuffers_.length=0,this.bufferUpdating_=!1}}]),t}(_videoJs2.default.EventTarget);exports.default=VirtualSourceBuffer,module.exports=exports.default;
},{"./add-text-track-data":332,"./codec-utils":334,"./create-text-tracks-if-necessary":335,"./remove-cues-from-track":340,"./transmuxer-worker":341,"video.js":457,"webworkify":472}],344:[function(require,module,exports){
"use strict";var Stream=require("../utils/stream.js"),AacStream;AacStream=function(){var t=new Uint8Array,e=0;AacStream.prototype.init.call(this),this.setTimestamp=function(t){e=t},this.parseId3TagSize=function(t,e){var a=t[e+6]<<21|t[e+7]<<14|t[e+8]<<7|t[e+9],r=t[e+5],i=(16&r)>>4;return i?a+20:a+10},this.parseAdtsSize=function(t,e){var a=(224&t[e+5])>>5,r=t[e+4]<<3,i=6144&t[e+3];return i|r|a},this.push=function(a){var r,i,s,n,h=0,u=0;for(t.length?(n=t.length,t=new Uint8Array(a.byteLength+n),t.set(t.subarray(0,n)),t.set(a,n)):t=a;t.length-u>=3;)if(t[u]!=="I".charCodeAt(0)||t[u+1]!=="D".charCodeAt(0)||t[u+2]!=="3".charCodeAt(0))if(t[u]&!0&&240===(240&t[u+1])){if(t.length-u<7)break;if(h=this.parseAdtsSize(t,u),h>t.length)break;s={type:"audio",data:t.subarray(u,u+h),pts:e,dts:e},this.trigger("data",s),u+=h}else u++;else{if(t.length-u<10)break;if(h=this.parseId3TagSize(t,u),h>t.length)break;i={type:"timed-metadata",data:t.subarray(u,u+h)},this.trigger("data",i),u+=h}r=t.length-u,t=r>0?t.subarray(u):new Uint8Array}},AacStream.prototype=new Stream,module.exports=AacStream;
},{"../utils/stream.js":364}],345:[function(require,module,exports){
"use strict";var Stream=require("../utils/stream.js"),AdtsStream,ADTS_SAMPLING_FREQUENCIES=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];AdtsStream=function(){var t;AdtsStream.prototype.init.call(this),this.push=function(e){var a,r,s,i,n,d,o=0,u=0;if("audio"===e.type)for(t?(i=t,t=new Uint8Array(i.byteLength+e.data.byteLength),t.set(i),t.set(e.data,i.byteLength)):t=e.data;o+5<t.length;)if(255===t[o]&&240===(246&t[o+1])){if(r=2*(1&~t[o+1]),a=(3&t[o+3])<<11|t[o+4]<<3|(224&t[o+5])>>5,n=1024*((3&t[o+6])+1),d=9e4*n/ADTS_SAMPLING_FREQUENCIES[(60&t[o+2])>>>2],s=o+a,t.byteLength<s)return;if(this.trigger("data",{pts:e.pts+u*d,dts:e.dts+u*d,sampleCount:n,audioobjecttype:(t[o+2]>>>6&3)+1,channelcount:(1&t[o+2])<<2|(192&t[o+3])>>>6,samplerate:ADTS_SAMPLING_FREQUENCIES[(60&t[o+2])>>>2],samplingfrequencyindex:(60&t[o+2])>>>2,samplesize:16,data:t.subarray(o+7+r,s)}),t.byteLength===s)return void(t=void 0);u++,t=t.subarray(s)}else o++},this.flush=function(){this.trigger("done")}},AdtsStream.prototype=new Stream,module.exports=AdtsStream;
},{"../utils/stream.js":364}],346:[function(require,module,exports){
"use strict";var Stream=require("../utils/stream.js"),ExpGolomb=require("../utils/exp-golomb.js"),H264Stream,NalByteStream,PROFILES_WITH_OPTIONAL_SPS_DATA;NalByteStream=function(){var e,a,t=0;NalByteStream.prototype.init.call(this),this.push=function(r){var s;for(a?(s=new Uint8Array(a.byteLength+r.data.byteLength),s.set(a),s.set(r.data,a.byteLength),a=s):a=r.data;t<a.byteLength-3;t++)if(1===a[t+2]){e=t+5;break}for(;e<a.byteLength;)switch(a[e]){case 0:if(0!==a[e-1]){e+=2;break}if(0!==a[e-2]){e++;break}t+3!==e-2&&this.trigger("data",a.subarray(t+3,e-2));do e++;while(1!==a[e]&&e<a.length);t=e-2,e+=3;break;case 1:if(0!==a[e-1]||0!==a[e-2]){e+=3;break}this.trigger("data",a.subarray(t+3,e-2)),t=e-2,e+=3;break;default:e+=3}a=a.subarray(t),e-=t,t=0},this.flush=function(){a&&a.byteLength>3&&this.trigger("data",a.subarray(t+3)),a=null,t=0,this.trigger("done")}},NalByteStream.prototype=new Stream,PROFILES_WITH_OPTIONAL_SPS_DATA={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},H264Stream=function(){var e,a,t,r,s,i,n,o=new NalByteStream;H264Stream.prototype.init.call(this),e=this,this.push=function(e){"video"===e.type&&(a=e.trackId,t=e.pts,r=e.dts,o.push(e))},o.on("data",function(n){var o={trackId:a,pts:t,dts:r,data:n};switch(31&n[0]){case 5:o.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:o.nalUnitType="sei_rbsp",o.escapedRBSP=s(n.subarray(1));break;case 7:o.nalUnitType="seq_parameter_set_rbsp",o.escapedRBSP=s(n.subarray(1)),o.config=i(o.escapedRBSP);break;case 8:o.nalUnitType="pic_parameter_set_rbsp";break;case 9:o.nalUnitType="access_unit_delimiter_rbsp"}e.trigger("data",o)}),o.on("done",function(){e.trigger("done")}),this.flush=function(){o.flush()},n=function(e,a){var t,r,s=8,i=8;for(t=0;t<e;t++)0!==i&&(r=a.readExpGolomb(),i=(s+r+256)%256),s=0===i?s:i},s=function(e){for(var a,t,r=e.byteLength,s=[],i=1;i<r-2;)0===e[i]&&0===e[i+1]&&3===e[i+2]?(s.push(i+2),i+=2):i++;if(0===s.length)return e;a=r-s.length,t=new Uint8Array(a);var n=0;for(i=0;i<a;n++,i++)n===s[0]&&(n++,s.shift()),t[i]=e[n];return t},i=function(e){var a,t,r,s,i,o,d,p,b,l,c,g,m,k,y=0,h=0,u=0,f=0,B=1;if(a=new ExpGolomb(e),t=a.readUnsignedByte(),s=a.readUnsignedByte(),r=a.readUnsignedByte(),a.skipUnsignedExpGolomb(),PROFILES_WITH_OPTIONAL_SPS_DATA[t]&&(i=a.readUnsignedExpGolomb(),3===i&&a.skipBits(1),a.skipUnsignedExpGolomb(),a.skipUnsignedExpGolomb(),a.skipBits(1),a.readBoolean()))for(c=3!==i?8:12,k=0;k<c;k++)a.readBoolean()&&(k<6?n(16,a):n(64,a));if(a.skipUnsignedExpGolomb(),o=a.readUnsignedExpGolomb(),0===o)a.readUnsignedExpGolomb();else if(1===o)for(a.skipBits(1),a.skipExpGolomb(),a.skipExpGolomb(),d=a.readUnsignedExpGolomb(),k=0;k<d;k++)a.skipExpGolomb();if(a.skipUnsignedExpGolomb(),a.skipBits(1),p=a.readUnsignedExpGolomb(),b=a.readUnsignedExpGolomb(),l=a.readBits(1),0===l&&a.skipBits(1),a.skipBits(1),a.readBoolean()&&(y=a.readUnsignedExpGolomb(),h=a.readUnsignedExpGolomb(),u=a.readUnsignedExpGolomb(),f=a.readUnsignedExpGolomb()),a.readBoolean()&&a.readBoolean()){switch(m=a.readUnsignedByte()){case 1:g=[1,1];break;case 2:g=[12,11];break;case 3:g=[10,11];break;case 4:g=[16,11];break;case 5:g=[40,33];break;case 6:g=[24,11];break;case 7:g=[20,11];break;case 8:g=[32,11];break;case 9:g=[80,33];break;case 10:g=[18,11];break;case 11:g=[15,11];break;case 12:g=[64,33];break;case 13:g=[160,99];break;case 14:g=[4,3];break;case 15:g=[3,2];break;case 16:g=[2,1];break;case 255:g=[a.readUnsignedByte()<<8|a.readUnsignedByte(),a.readUnsignedByte()<<8|a.readUnsignedByte()]}g&&(B=g[0]/g[1])}return{profileIdc:t,levelIdc:r,profileCompatibility:s,width:Math.ceil((16*(p+1)-2*y-2*h)*B),height:(2-l)*(b+1)*16-2*u-2*f}}},H264Stream.prototype=new Stream,module.exports={H264Stream:H264Stream,NalByteStream:NalByteStream};
},{"../utils/exp-golomb.js":363,"../utils/stream.js":364}],347:[function(require,module,exports){
var highPrefix=[33,16,5,32,164,27],lowPrefix=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],zeroFill=function(l){for(var e=[];l--;)e.push(0);return e},makeTable=function(l){return Object.keys(l).reduce(function(e,i){return e[i]=new Uint8Array(l[i].reduce(function(l,e){return l.concat(e)},[])),e},{})},coneOfSilence={96e3:[highPrefix,[227,64],zeroFill(154),[56]],88200:[highPrefix,[231],zeroFill(170),[56]],64e3:[highPrefix,[248,192],zeroFill(240),[56]],48e3:[highPrefix,[255,192],zeroFill(268),[55,148,128],zeroFill(54),[112]],44100:[highPrefix,[255,192],zeroFill(268),[55,163,128],zeroFill(84),[112]],32e3:[highPrefix,[255,192],zeroFill(268),[55,234],zeroFill(226),[112]],24e3:[highPrefix,[255,192],zeroFill(268),[55,255,128],zeroFill(268),[111,112],zeroFill(126),[224]],16e3:[highPrefix,[255,192],zeroFill(268),[55,255,128],zeroFill(268),[111,255],zeroFill(269),[223,108],zeroFill(195),[1,192]],12e3:[lowPrefix,zeroFill(268),[3,127,248],zeroFill(268),[6,255,240],zeroFill(268),[13,255,224],zeroFill(268),[27,253,128],zeroFill(259),[56]],11025:[lowPrefix,zeroFill(268),[3,127,248],zeroFill(268),[6,255,240],zeroFill(268),[13,255,224],zeroFill(268),[27,255,192],zeroFill(268),[55,175,128],zeroFill(108),[112]],8e3:[lowPrefix,zeroFill(268),[3,121,16],zeroFill(47),[7]]};module.exports=makeTable(coneOfSilence);
},{}],348:[function(require,module,exports){
"use strict";var Stream=require("../utils/stream.js"),CoalesceStream=function(t){this.numberOfTracks=0,this.metadataStream=t.metadataStream,this.videoTags=[],this.audioTags=[],this.videoTrack=null,this.audioTrack=null,this.pendingCaptions=[],this.pendingMetadata=[],this.pendingTracks=0,this.processedTracks=0,CoalesceStream.prototype.init.call(this),this.push=function(t){return t.text?this.pendingCaptions.push(t):t.frames?this.pendingMetadata.push(t):("video"===t.track.type&&(this.videoTrack=t.track,this.videoTags=t.tags,this.pendingTracks++),void("audio"===t.track.type&&(this.audioTrack=t.track,this.audioTags=t.tags,this.pendingTracks++)))}};CoalesceStream.prototype=new Stream,CoalesceStream.prototype.flush=function(t){var s,a,i,e,r={tags:{},captions:[],metadata:[]};if(this.pendingTracks<this.numberOfTracks){if("VideoSegmentStream"!==t&&"AudioSegmentStream"!==t)return;if(0===this.pendingTracks&&(this.processedTracks++,this.processedTracks<this.numberOfTracks))return}if(this.processedTracks+=this.pendingTracks,this.pendingTracks=0,!(this.processedTracks<this.numberOfTracks)){for(this.videoTrack?e=this.videoTrack.timelineStartInfo.pts:this.audioTrack&&(e=this.audioTrack.timelineStartInfo.pts),r.tags.videoTags=this.videoTags,r.tags.audioTags=this.audioTags,i=0;i<this.pendingCaptions.length;i++)a=this.pendingCaptions[i],a.startTime=a.startPts-e,a.startTime/=9e4,a.endTime=a.endPts-e,a.endTime/=9e4,r.captions.push(a);for(i=0;i<this.pendingMetadata.length;i++)s=this.pendingMetadata[i],s.cueTime=s.pts-e,s.cueTime/=9e4,r.metadata.push(s);r.metadata.dispatchType=this.metadataStream.dispatchType,this.videoTrack=null,this.audioTrack=null,this.videoTags=[],this.audioTags=[],this.pendingCaptions.length=0,this.pendingMetadata.length=0,this.pendingTracks=0,this.processedTracks=0,this.trigger("data",r),this.trigger("done")}},module.exports=CoalesceStream;
},{"../utils/stream.js":364}],349:[function(require,module,exports){
"use strict";var FlvTag=require("./flv-tag.js"),getFlvHeader=function(t,e,n){var i,r,a,s=new Uint8Array(9),g=new DataView(s.buffer);return t=t||0,e=void 0===e||e,n=void 0===n||n,g.setUint8(0,70),g.setUint8(1,76),g.setUint8(2,86),g.setUint8(3,1),g.setUint8(4,(e?4:0)|(n?1:0)),g.setUint32(5,s.byteLength),t<=0?(r=new Uint8Array(s.byteLength+4),r.set(s),r.set([0,0,0,0],s.byteLength),r):(i=new FlvTag(FlvTag.METADATA_TAG),i.pts=i.dts=0,i.writeMetaDataDouble("duration",t),a=i.finalize().length,r=new Uint8Array(s.byteLength+a),r.set(s),r.set(g.byteLength,a),r)};module.exports=getFlvHeader;
},{"./flv-tag.js":350}],350:[function(require,module,exports){
"use strict";var FlvTag;FlvTag=function(t,i){var s,h=0,e=16384,n=function(t,i){var s,h=t.position+i;h<t.bytes.byteLength||(s=new Uint8Array(2*h),s.set(t.bytes.subarray(0,t.position),0),t.bytes=s,t.view=new DataView(t.bytes.buffer))},o=FlvTag.widthBytes||new Uint8Array("width".length),a=FlvTag.heightBytes||new Uint8Array("height".length),r=FlvTag.videocodecidBytes||new Uint8Array("videocodecid".length);if(!FlvTag.widthBytes){for(s=0;s<"width".length;s++)o[s]="width".charCodeAt(s);for(s=0;s<"height".length;s++)a[s]="height".charCodeAt(s);for(s=0;s<"videocodecid".length;s++)r[s]="videocodecid".charCodeAt(s);FlvTag.widthBytes=o,FlvTag.heightBytes=a,FlvTag.videocodecidBytes=r}switch(this.keyFrame=!1,t){case FlvTag.VIDEO_TAG:this.length=16,e*=6;break;case FlvTag.AUDIO_TAG:this.length=13,this.keyFrame=!0;break;case FlvTag.METADATA_TAG:this.length=29,this.keyFrame=!0;break;default:throw new Error("Unknown FLV tag type")}this.bytes=new Uint8Array(e),this.view=new DataView(this.bytes.buffer),this.bytes[0]=t,this.position=this.length,this.keyFrame=i,this.pts=0,this.dts=0,this.writeBytes=function(t,i,s){var h,e=i||0;s=s||t.byteLength,h=e+s,n(this,s),this.bytes.set(t.subarray(e,h),this.position),this.position+=s,this.length=Math.max(this.length,this.position)},this.writeByte=function(t){n(this,1),this.bytes[this.position]=t,this.position++,this.length=Math.max(this.length,this.position)},this.writeShort=function(t){n(this,2),this.view.setUint16(this.position,t),this.position+=2,this.length=Math.max(this.length,this.position)},this.negIndex=function(t){return this.bytes[this.length-t]},this.nalUnitSize=function(){return 0===h?0:this.length-(h+4)},this.startNalUnit=function(){if(h>0)throw new Error("Attempted to create new NAL wihout closing the old one");h=this.length,this.length+=4,this.position=this.length},this.endNalUnit=function(t){var i,s;this.length===h+4?this.length-=4:h>0&&(i=h+4,s=this.length-i,this.position=h,this.view.setUint32(this.position,s),this.position=this.length,t&&t.push(this.bytes.subarray(i,i+s))),h=0},this.writeMetaDataDouble=function(t,i){var s;if(n(this,2+t.length+9),this.view.setUint16(this.position,t.length),this.position+=2,"width"===t)this.bytes.set(o,this.position),this.position+=5;else if("height"===t)this.bytes.set(a,this.position),this.position+=6;else if("videocodecid"===t)this.bytes.set(r,this.position),this.position+=12;else for(s=0;s<t.length;s++)this.bytes[this.position]=t.charCodeAt(s),this.position++;this.position++,this.view.setFloat64(this.position,i),this.position+=8,this.length=Math.max(this.length,this.position),++h},this.writeMetaDataBoolean=function(t,i){var s;for(n(this,2),this.view.setUint16(this.position,t.length),this.position+=2,s=0;s<t.length;s++)n(this,1),this.bytes[this.position]=t.charCodeAt(s),this.position++;n(this,2),this.view.setUint8(this.position,1),this.position++,this.view.setUint8(this.position,i?1:0),this.position++,this.length=Math.max(this.length,this.position),++h},this.finalize=function(){var t,s;switch(this.bytes[0]){case FlvTag.VIDEO_TAG:this.bytes[11]=7|(this.keyFrame||i?16:32),this.bytes[12]=i?0:1,t=this.pts-this.dts,this.bytes[13]=(16711680&t)>>>16,this.bytes[14]=(65280&t)>>>8,this.bytes[15]=(255&t)>>>0;break;case FlvTag.AUDIO_TAG:this.bytes[11]=175,this.bytes[12]=i?0:1;break;case FlvTag.METADATA_TAG:this.position=11,this.view.setUint8(this.position,2),this.position++,this.view.setUint16(this.position,10),this.position+=2,this.bytes.set([111,110,77,101,116,97,68,97,116,97],this.position),this.position+=10,this.bytes[this.position]=8,this.position++,this.view.setUint32(this.position,h),this.position=this.length,this.bytes.set([0,0,9],this.position),this.position+=3,this.length=this.position}return s=this.length-11,this.bytes[1]=(16711680&s)>>>16,this.bytes[2]=(65280&s)>>>8,this.bytes[3]=(255&s)>>>0,this.bytes[4]=(16711680&this.dts)>>>16,this.bytes[5]=(65280&this.dts)>>>8,this.bytes[6]=(255&this.dts)>>>0,this.bytes[7]=(4278190080&this.dts)>>>24,this.bytes[8]=0,this.bytes[9]=0,this.bytes[10]=0,n(this,4),this.view.setUint32(this.length,this.length),this.length+=4,this.position+=4,this.bytes=this.bytes.subarray(0,this.length),this.frameTime=FlvTag.frameTime(this.bytes),this}},FlvTag.AUDIO_TAG=8,FlvTag.VIDEO_TAG=9,FlvTag.METADATA_TAG=18,FlvTag.isAudioFrame=function(t){return FlvTag.AUDIO_TAG===t[0]},FlvTag.isVideoFrame=function(t){return FlvTag.VIDEO_TAG===t[0]},FlvTag.isMetaData=function(t){return FlvTag.METADATA_TAG===t[0]},FlvTag.isKeyFrame=function(t){return FlvTag.isVideoFrame(t)?23===t[11]:!!FlvTag.isAudioFrame(t)||!!FlvTag.isMetaData(t)},FlvTag.frameTime=function(t){var i=t[4]<<16;return i|=t[5]<<8,i|=t[6]<<0,i|=t[7]<<24},module.exports=FlvTag;
},{}],351:[function(require,module,exports){
module.exports={tag:require("./flv-tag"),Transmuxer:require("./transmuxer"),getFlvHeader:require("./flv-header")};
},{"./flv-header":349,"./flv-tag":350,"./transmuxer":353}],352:[function(require,module,exports){
"use strict";var TagList=function(){var t=this;this.list=[],this.push=function(t){this.list.push({bytes:t.bytes,dts:t.dts,pts:t.pts,keyFrame:t.keyFrame,metaDataTag:t.metaDataTag})},Object.defineProperty(this,"length",{get:function(){return t.list.length}})};module.exports=TagList;
},{}],353:[function(require,module,exports){
"use strict";var Stream=require("../utils/stream.js"),FlvTag=require("./flv-tag.js"),m2ts=require("../m2ts/m2ts.js"),AdtsStream=require("../codecs/adts.js"),H264Stream=require("../codecs/h264").H264Stream,CoalesceStream=require("./coalesce-stream.js"),TagList=require("./tag-list.js"),Transmuxer,VideoSegmentStream,AudioSegmentStream,collectTimelineInfo,metaDataTag,extraDataTag;collectTimelineInfo=function(t,e){"number"==typeof e.pts&&(void 0===t.timelineStartInfo.pts?t.timelineStartInfo.pts=e.pts:t.timelineStartInfo.pts=Math.min(t.timelineStartInfo.pts,e.pts)),"number"==typeof e.dts&&(void 0===t.timelineStartInfo.dts?t.timelineStartInfo.dts=e.dts:t.timelineStartInfo.dts=Math.min(t.timelineStartInfo.dts,e.dts))},metaDataTag=function(t,e){var a=new FlvTag(FlvTag.METADATA_TAG);return a.dts=e,a.pts=e,a.writeMetaDataDouble("videocodecid",7),a.writeMetaDataDouble("width",t.width),a.writeMetaDataDouble("height",t.height),a},extraDataTag=function(t,e){var a,i=new FlvTag(FlvTag.VIDEO_TAG,!0);for(i.dts=e,i.pts=e,i.writeByte(1),i.writeByte(t.profileIdc),i.writeByte(t.profileCompatibility),i.writeByte(t.levelIdc),i.writeByte(255),i.writeByte(225),i.writeShort(t.sps[0].length),i.writeBytes(t.sps[0]),i.writeByte(t.pps.length),a=0;a<t.pps.length;++a)i.writeShort(t.pps[a].length),i.writeBytes(t.pps[a]);return i},AudioSegmentStream=function(t){var e,a=[];AudioSegmentStream.prototype.init.call(this),this.push=function(e){collectTimelineInfo(t,e),t&&void 0===t.channelcount&&(t.audioobjecttype=e.audioobjecttype,t.channelcount=e.channelcount,t.samplerate=e.samplerate,t.samplingfrequencyindex=e.samplingfrequencyindex,t.samplesize=e.samplesize,t.extraData=t.audioobjecttype<<11|t.samplingfrequencyindex<<7|t.channelcount<<3),e.pts=Math.round(e.pts/90),e.dts=Math.round(e.dts/90),a.push(e)},this.flush=function(){var i,n,r,s=new TagList;if(0===a.length)return void this.trigger("done","AudioSegmentStream");for(r=-(1/0);a.length;)i=a.shift(),(t.extraData!==e||i.pts-r>=1e3)&&(n=new FlvTag(FlvTag.METADATA_TAG),n.pts=i.pts,n.dts=i.dts,n.writeMetaDataDouble("audiocodecid",10),n.writeMetaDataBoolean("stereo",2===t.channelcount),n.writeMetaDataDouble("audiosamplerate",t.samplerate),n.writeMetaDataDouble("audiosamplesize",16),s.push(n.finalize()),e=t.extraData,n=new FlvTag(FlvTag.AUDIO_TAG,!0),n.pts=i.pts,n.dts=i.dts,n.view.setUint16(n.position,t.extraData),n.position+=2,n.length=Math.max(n.length,n.position),s.push(n.finalize()),r=i.pts),n=new FlvTag(FlvTag.AUDIO_TAG),n.pts=i.pts,n.dts=i.dts,n.writeBytes(i.data),s.push(n.finalize());e=null,this.trigger("data",{track:t,tags:s.list}),this.trigger("done","AudioSegmentStream")}},AudioSegmentStream.prototype=new Stream,VideoSegmentStream=function(t){var e,a,i=[];VideoSegmentStream.prototype.init.call(this),this.finishFrame=function(i,n){if(n){if(e&&t&&t.newMetadata&&(n.keyFrame||0===i.length)){var r=metaDataTag(e,n.dts).finalize(),s=extraDataTag(t,n.dts).finalize();r.metaDataTag=s.metaDataTag=!0,i.push(r),i.push(s),t.newMetadata=!1}n.endNalUnit(),i.push(n.finalize()),a=null}},this.push=function(e){collectTimelineInfo(t,e),e.pts=Math.round(e.pts/90),e.dts=Math.round(e.dts/90),i.push(e)},this.flush=function(){for(var n,r=new TagList;i.length&&"access_unit_delimiter_rbsp"!==i[0].nalUnitType;)i.shift();if(0===i.length)return void this.trigger("done","VideoSegmentStream");for(;i.length;)n=i.shift(),"seq_parameter_set_rbsp"===n.nalUnitType?(t.newMetadata=!0,e=n.config,t.width=e.width,t.height=e.height,t.sps=[n.data],t.profileIdc=e.profileIdc,t.levelIdc=e.levelIdc,t.profileCompatibility=e.profileCompatibility,a.endNalUnit()):"pic_parameter_set_rbsp"===n.nalUnitType?(t.newMetadata=!0,t.pps=[n.data],a.endNalUnit()):"access_unit_delimiter_rbsp"===n.nalUnitType?(a&&this.finishFrame(r,a),a=new FlvTag(FlvTag.VIDEO_TAG),a.pts=n.pts,a.dts=n.dts):("slice_layer_without_partitioning_rbsp_idr"===n.nalUnitType&&(a.keyFrame=!0),a.endNalUnit()),a.startNalUnit(),a.writeBytes(n.data);a&&this.finishFrame(r,a),this.trigger("data",{track:t,tags:r.list}),this.trigger("done","VideoSegmentStream")}},VideoSegmentStream.prototype=new Stream,Transmuxer=function(t){var e,a,i,n,r,s,o,p,l,m,d,u,h=this;Transmuxer.prototype.init.call(this),t=t||{},this.metadataStream=new m2ts.MetadataStream,t.metadataStream=this.metadataStream,e=new m2ts.TransportPacketStream,a=new m2ts.TransportParseStream,i=new m2ts.ElementaryStream,n=new m2ts.TimestampRolloverStream("video"),r=new m2ts.TimestampRolloverStream("audio"),s=new m2ts.TimestampRolloverStream("timed-metadata"),o=new AdtsStream,p=new H264Stream,u=new CoalesceStream(t),e.pipe(a).pipe(i),i.pipe(n).pipe(p),i.pipe(r).pipe(o),i.pipe(s).pipe(this.metadataStream).pipe(u),d=new m2ts.CaptionStream,p.pipe(d).pipe(u),i.on("data",function(t){var e,a,i;if("metadata"===t.type){for(e=t.tracks.length;e--;)"video"===t.tracks[e].type?a=t.tracks[e]:"audio"===t.tracks[e].type&&(i=t.tracks[e]);a&&!l&&(u.numberOfTracks++,l=new VideoSegmentStream(a),p.pipe(l).pipe(u)),i&&!m&&(u.numberOfTracks++,m=new AudioSegmentStream(i),o.pipe(m).pipe(u))}}),this.push=function(t){e.push(t)},this.flush=function(){e.flush()},u.on("data",function(t){h.trigger("data",t)}),u.on("done",function(){h.trigger("done")})},Transmuxer.prototype=new Stream,module.exports=Transmuxer;
},{"../codecs/adts.js":345,"../codecs/h264":346,"../m2ts/m2ts.js":355,"../utils/stream.js":364,"./coalesce-stream.js":348,"./flv-tag.js":350,"./tag-list.js":352}],354:[function(require,module,exports){
"use strict";var USER_DATA_REGISTERED_ITU_T_T35=4,RBSP_TRAILING_BITS=128,Stream=require("../utils/stream"),parseSei=function(t){for(var a=0,e={payloadType:-1,payloadSize:0},s=0,i=0;a<t.byteLength&&t[a]!==RBSP_TRAILING_BITS;){for(;255===t[a];)s+=255,a++;for(s+=t[a++];255===t[a];)i+=255,a++;if(i+=t[a++],!e.payload&&s===USER_DATA_REGISTERED_ITU_T_T35){e.payloadType=s,e.payloadSize=i,e.payload=t.subarray(a,a+i);break}a+=i,s=0,i=0}return e},parseUserData=function(t){return 181!==t.payload[0]?null:49!==(t.payload[1]<<8|t.payload[2])?null:"GA94"!==String.fromCharCode(t.payload[3],t.payload[4],t.payload[5],t.payload[6])?null:3!==t.payload[7]?null:t.payload.subarray(8,t.payload.length-1)},parseCaptionPackets=function(t,a){var e,s,i,o,r=[];if(!(64&a[0]))return r;for(s=31&a[0],e=0;e<s;e++)i=3*e,o={type:3&a[i+2],pts:t},4&a[i+2]&&(o.ccData=a[i+3]<<8|a[i+4],r.push(o));return r},CaptionStream=function(){CaptionStream.prototype.init.call(this),this.captionPackets_=[],this.field1_=new Cea608Stream,this.field1_.on("data",this.trigger.bind(this,"data")),this.field1_.on("done",this.trigger.bind(this,"done"))};CaptionStream.prototype=new Stream,CaptionStream.prototype.push=function(t){var a,e;"sei_rbsp"===t.nalUnitType&&(a=parseSei(t.escapedRBSP),a.payloadType===USER_DATA_REGISTERED_ITU_T_T35&&(e=parseUserData(a),e&&(this.captionPackets_=this.captionPackets_.concat(parseCaptionPackets(t.pts,e)))))},CaptionStream.prototype.flush=function(){return this.captionPackets_.length?(this.captionPackets_.forEach(function(t,a){t.presortIndex=a}),this.captionPackets_.sort(function(t,a){return t.pts===a.pts?t.presortIndex-a.presortIndex:t.pts-a.pts}),this.captionPackets_.forEach(this.field1_.push,this.field1_),this.captionPackets_.length=0,void this.field1_.flush()):void this.field1_.flush()};var BASIC_CHARACTER_TRANSLATION={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608},getCharFromCode=function(t){return null===t?"":(t=BASIC_CHARACTER_TRANSLATION[t]||t,String.fromCharCode(t))},PADDING=0,RESUME_CAPTION_LOADING=5152,END_OF_CAPTION=5167,ROLL_UP_2_ROWS=5157,ROLL_UP_3_ROWS=5158,ROLL_UP_4_ROWS=5159,CARRIAGE_RETURN=5165,BACKSPACE=5153,ERASE_DISPLAYED_MEMORY=5164,ERASE_NON_DISPLAYED_MEMORY=5166,BOTTOM_ROW=14,createDisplayBuffer=function(){for(var t=[],a=BOTTOM_ROW+1;a--;)t.push("");return t},Cea608Stream=function(){Cea608Stream.prototype.init.call(this),this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=createDisplayBuffer(),this.nonDisplayed_=createDisplayBuffer(),this.lastControlCode_=null,this.push=function(t){if(0===t.type){var a,e,s,i;if(a=32639&t.ccData,a===this.lastControlCode_)return void(this.lastControlCode_=null);switch(4096===(61440&a)?this.lastControlCode_=a:this.lastControlCode_=null,a){case PADDING:break;case RESUME_CAPTION_LOADING:this.mode_="popOn";break;case END_OF_CAPTION:this.flushDisplayed(t.pts),e=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=e,this.startPts_=t.pts;break;case ROLL_UP_2_ROWS:this.topRow_=BOTTOM_ROW-1,this.mode_="rollUp";break;case ROLL_UP_3_ROWS:this.topRow_=BOTTOM_ROW-2,this.mode_="rollUp";break;case ROLL_UP_4_ROWS:this.topRow_=BOTTOM_ROW-3,this.mode_="rollUp";break;case CARRIAGE_RETURN:this.flushDisplayed(t.pts),this.shiftRowsUp_(),this.startPts_=t.pts;break;case BACKSPACE:"popOn"===this.mode_?this.nonDisplayed_[BOTTOM_ROW]=this.nonDisplayed_[BOTTOM_ROW].slice(0,-1):this.displayed_[BOTTOM_ROW]=this.displayed_[BOTTOM_ROW].slice(0,-1);break;case ERASE_DISPLAYED_MEMORY:this.flushDisplayed(t.pts),this.displayed_=createDisplayBuffer();break;case ERASE_NON_DISPLAYED_MEMORY:this.nonDisplayed_=createDisplayBuffer();break;default:if(s=a>>>8,i=255&a,s>=16&&s<=23&&i>=64&&i<=127&&(16!==s||i<96)&&(s=32,i=null),(17===s||25===s)&&i>=48&&i<=63&&(s=9834,i=""),16===(240&s))return;0===s&&(s=null),0===i&&(i=null),this[this.mode_](t.pts,s,i)}}}};Cea608Stream.prototype=new Stream,Cea608Stream.prototype.flushDisplayed=function(t){var a=this.displayed_.map(function(t){return t.trim()}).filter(function(t){return t.length}).join("\n");a.length&&this.trigger("data",{startPts:this.startPts_,endPts:t,text:a})},Cea608Stream.prototype.popOn=function(t,a,e){var s=this.nonDisplayed_[BOTTOM_ROW];s+=getCharFromCode(a),s+=getCharFromCode(e),this.nonDisplayed_[BOTTOM_ROW]=s},Cea608Stream.prototype.rollUp=function(t,a,e){var s=this.displayed_[BOTTOM_ROW];""===s&&(this.flushDisplayed(t),this.startPts_=t),s+=getCharFromCode(a),s+=getCharFromCode(e),this.displayed_[BOTTOM_ROW]=s},Cea608Stream.prototype.shiftRowsUp_=function(){var t;for(t=0;t<this.topRow_;t++)this.displayed_[t]="";for(t=this.topRow_;t<BOTTOM_ROW;t++)this.displayed_[t]=this.displayed_[t+1];this.displayed_[BOTTOM_ROW]=""},module.exports={CaptionStream:CaptionStream,Cea608Stream:Cea608Stream};
},{"../utils/stream":364}],355:[function(require,module,exports){
"use strict";var Stream=require("../utils/stream.js"),CaptionStream=require("./caption-stream"),StreamTypes=require("./stream-types"),TimestampRolloverStream=require("./timestamp-rollover-stream").TimestampRolloverStream,m2tsStreamTypes=require("./stream-types.js"),TransportPacketStream,TransportParseStream,ElementaryStream,MP2T_PACKET_LENGTH=188,SYNC_BYTE=71;TransportPacketStream=function(){var t=new Uint8Array(MP2T_PACKET_LENGTH),a=0;TransportPacketStream.prototype.init.call(this),this.push=function(e){var r,s=0,i=MP2T_PACKET_LENGTH;for(a?(r=new Uint8Array(e.byteLength+a),r.set(t.subarray(0,a)),r.set(e,a),a=0):r=e;i<r.byteLength;)r[s]!==SYNC_BYTE||r[i]!==SYNC_BYTE?(s++,i++):(this.trigger("data",r.subarray(s,i)),s+=MP2T_PACKET_LENGTH,i+=MP2T_PACKET_LENGTH);s<r.byteLength&&(t.set(r.subarray(s),0),a=r.byteLength-s)},this.flush=function(){a===MP2T_PACKET_LENGTH&&t[0]===SYNC_BYTE&&(this.trigger("data",t),a=0),this.trigger("done")}},TransportPacketStream.prototype=new Stream,TransportParseStream=function(){var t,a,e,r;TransportParseStream.prototype.init.call(this),r=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,t=function(t,r){var s=0;r.payloadUnitStartIndicator&&(s+=t[s]+1),"pat"===r.type?a(t.subarray(s),r):e(t.subarray(s),r)},a=function(t,a){a.section_number=t[7],a.last_section_number=t[8],r.pmtPid=(31&t[10])<<8|t[11],a.pmtPid=r.pmtPid},e=function(t,a){var e,s,i,p;if(1&t[5]){for(r.programMapTable={},e=(15&t[1])<<8|t[2],s=3+e-4,i=(15&t[10])<<8|t[11],p=12+i;p<s;)r.programMapTable[(31&t[p+1])<<8|t[p+2]]=t[p],p+=((15&t[p+3])<<8|t[p+4])+5;for(a.programMapTable=r.programMapTable;r.packetsWaitingForPmt.length;)r.processPes_.apply(r,r.packetsWaitingForPmt.shift())}},this.push=function(a){var e={},r=4;e.payloadUnitStartIndicator=!!(64&a[1]),e.pid=31&a[1],e.pid<<=8,e.pid|=a[2],(48&a[3])>>>4>1&&(r+=a[r]+1),0===e.pid?(e.type="pat",t(a.subarray(r),e),this.trigger("data",e)):e.pid===this.pmtPid?(e.type="pmt",t(a.subarray(r),e),this.trigger("data",e)):void 0===this.programMapTable?this.packetsWaitingForPmt.push([a,r,e]):this.processPes_(a,r,e)},this.processPes_=function(t,a,e){e.streamType=this.programMapTable[e.pid],e.type="pes",e.data=t.subarray(a),this.trigger("data",e)}},TransportParseStream.prototype=new Stream,TransportParseStream.STREAM_TYPES={h264:27,adts:15},ElementaryStream=function(){var t=this,a={data:[],size:0},e={data:[],size:0},r={data:[],size:0},s=function(t,a){var e;a.dataAlignmentIndicator=0!==(4&t[6]),e=t[7],192&e&&(a.pts=(14&t[9])<<27|(255&t[10])<<20|(254&t[11])<<12|(255&t[12])<<5|(254&t[13])>>>3,a.pts*=4,a.pts+=(6&t[13])>>>1,a.dts=a.pts,64&e&&(a.dts=(14&t[14])<<27|(255&t[15])<<20|(254&t[16])<<12|(255&t[17])<<5|(254&t[18])>>>3,a.dts*=4,a.dts+=(6&t[18])>>>1)),a.data=t.subarray(9+t[8])},i=function(a,e){var r,i=new Uint8Array(a.size),p={type:e},m=0;if(a.data.length){for(p.trackId=a.data[0].pid;a.data.length;)r=a.data.shift(),i.set(r.data,m),m+=r.data.byteLength;s(i,p),a.size=0,t.trigger("data",p)}};ElementaryStream.prototype.init.call(this),this.push=function(s){({pat:function(){},pes:function(){var t,p;switch(s.streamType){case StreamTypes.H264_STREAM_TYPE:case m2tsStreamTypes.H264_STREAM_TYPE:t=a,p="video";break;case StreamTypes.ADTS_STREAM_TYPE:t=e,p="audio";break;case StreamTypes.METADATA_STREAM_TYPE:t=r,p="timed-metadata";break;default:return}s.payloadUnitStartIndicator&&i(t,p),t.data.push(s),t.size+=s.data.byteLength},pmt:function(){var a,e,r={type:"metadata",tracks:[]},i=s.programMapTable;for(a in i)i.hasOwnProperty(a)&&(e={timelineStartInfo:{baseMediaDecodeTime:0}},e.id=+a,i[a]===m2tsStreamTypes.H264_STREAM_TYPE?(e.codec="avc",e.type="video"):i[a]===m2tsStreamTypes.ADTS_STREAM_TYPE&&(e.codec="adts",e.type="audio"),r.tracks.push(e));t.trigger("data",r)}})[s.type]()},this.flush=function(){i(a,"video"),i(e,"audio"),i(r,"timed-metadata"),this.trigger("done")}},ElementaryStream.prototype=new Stream;var m2ts={PAT_PID:0,MP2T_PACKET_LENGTH:MP2T_PACKET_LENGTH,TransportPacketStream:TransportPacketStream,TransportParseStream:TransportParseStream,ElementaryStream:ElementaryStream,TimestampRolloverStream:TimestampRolloverStream,CaptionStream:CaptionStream.CaptionStream,Cea608Stream:CaptionStream.Cea608Stream,MetadataStream:require("./metadata-stream")};for(var type in StreamTypes)StreamTypes.hasOwnProperty(type)&&(m2ts[type]=StreamTypes[type]);module.exports=m2ts;
},{"../utils/stream.js":364,"./caption-stream":354,"./metadata-stream":356,"./stream-types":357,"./stream-types.js":357,"./timestamp-rollover-stream":358}],356:[function(require,module,exports){
"use strict";var Stream=require("../utils/stream"),StreamTypes=require("./stream-types"),percentEncode=function(a,t,e){var r,d="";for(r=t;r<e;r++)d+="%"+("00"+a[r].toString(16)).slice(-2);return d},parseUtf8=function(a,t,e){return decodeURIComponent(percentEncode(a,t,e))},parseIso88591=function(a,t,e){return unescape(percentEncode(a,t,e))},parseSyncSafeInteger=function(a){return a[0]<<21|a[1]<<14|a[2]<<7|a[3]},tagParsers={TXXX:function(a){var t;if(3===a.data[0]){for(t=1;t<a.data.length;t++)if(0===a.data[t]){a.description=parseUtf8(a.data,1,t),a.value=parseUtf8(a.data,t+1,a.data.length-1);break}a.data=a.value}},WXXX:function(a){var t;if(3===a.data[0])for(t=1;t<a.data.length;t++)if(0===a.data[t]){a.description=parseUtf8(a.data,1,t),a.url=parseUtf8(a.data,t+1,a.data.length);break}},PRIV:function(a){var t;for(t=0;t<a.data.length;t++)if(0===a.data[t]){a.owner=parseIso88591(a.data,0,t);break}a.privateData=a.data.subarray(t+1),a.data=a.privateData}},MetadataStream;MetadataStream=function(a){var t,e={debug:!(!a||!a.debug),descriptor:a&&a.descriptor},r=0,d=[],n=0;if(MetadataStream.prototype.init.call(this),this.dispatchType=StreamTypes.METADATA_STREAM_TYPE.toString(16),e.descriptor)for(t=0;t<e.descriptor.length;t++)this.dispatchType+=("00"+e.descriptor[t].toString(16)).slice(-2);this.push=function(a){var t,i,s,o,p,c;if("timed-metadata"===a.type){if(a.dataAlignmentIndicator&&(n=0,d.length=0),0===d.length&&(a.data.length<10||a.data[0]!=="I".charCodeAt(0)||a.data[1]!=="D".charCodeAt(0)||a.data[2]!=="3".charCodeAt(0)))return void(e.debug&&console.log("Skipping unrecognized metadata packet"));if(d.push(a),n+=a.data.byteLength,1===d.length&&(r=parseSyncSafeInteger(a.data.subarray(6,10)),r+=10),!(n<r)){for(t={data:new Uint8Array(r),frames:[],pts:d[0].pts,dts:d[0].dts},p=0;p<r;)t.data.set(d[0].data.subarray(0,r-p),p),p+=d[0].data.byteLength,n-=d[0].data.byteLength,d.shift();i=10,64&t.data[5]&&(i+=4,i+=parseSyncSafeInteger(t.data.subarray(10,14)),r-=parseSyncSafeInteger(t.data.subarray(16,20)));do{if(s=parseSyncSafeInteger(t.data.subarray(i+4,i+8)),s<1)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");if(c=String.fromCharCode(t.data[i],t.data[i+1],t.data[i+2],t.data[i+3]),o={id:c,data:t.data.subarray(i+10,i+s+10)},o.key=o.id,tagParsers[o.id]&&(tagParsers[o.id](o),"com.apple.streaming.transportStreamTimestamp"===o.owner)){var f=o.data,g=(1&f[3])<<30|f[4]<<22|f[5]<<14|f[6]<<6|f[7]>>>2;g*=4,g+=3&f[7],o.timeStamp=g,void 0===t.pts&&void 0===t.dts&&(t.pts=o.timeStamp,t.dts=o.timeStamp),this.trigger("timestamp",o)}t.frames.push(o),i+=10,i+=s}while(i<r);this.trigger("data",t)}}}},MetadataStream.prototype=new Stream,module.exports=MetadataStream;
},{"../utils/stream":364,"./stream-types":357}],357:[function(require,module,exports){
arguments[4][203][0].apply(exports,arguments)
},{"dup":203}],358:[function(require,module,exports){
arguments[4][204][0].apply(exports,arguments)
},{"../utils/stream":364,"dup":204}],359:[function(require,module,exports){
module.exports={generator:require("./mp4-generator"),Transmuxer:require("./transmuxer").Transmuxer,AudioSegmentStream:require("./transmuxer").AudioSegmentStream,VideoSegmentStream:require("./transmuxer").VideoSegmentStream};
},{"./mp4-generator":360,"./transmuxer":361}],360:[function(require,module,exports){
"use strict";var UINT32_MAX=Math.pow(2,32)-1,box,dinf,esds,ftyp,mdat,mfhd,minf,moof,moov,mvex,mvhd,trak,tkhd,mdia,mdhd,hdlr,sdtp,stbl,stsd,traf,trex,trun,types,MAJOR_BRAND,MINOR_VERSION,AVC1_BRAND,VIDEO_HDLR,AUDIO_HDLR,HDLR_TYPES,VMHD,SMHD,DREF,STCO,STSC,STSZ,STTS;!function(){var t;if(types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!=typeof Uint8Array){for(t in types)types.hasOwnProperty(t)&&(types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);MAJOR_BRAND=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),AVC1_BRAND=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),MINOR_VERSION=new Uint8Array([0,0,0,1]),VIDEO_HDLR=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),AUDIO_HDLR=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),HDLR_TYPES={video:VIDEO_HDLR,audio:AUDIO_HDLR},DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),STCO=new Uint8Array([0,0,0,0,0,0,0,0]),STSC=STCO,STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),STTS=STCO,VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}}(),box=function(t){var e,n,r,o=[],a=0;for(e=1;e<arguments.length;e++)o.push(arguments[e]);for(e=o.length;e--;)a+=o[e].byteLength;for(n=new Uint8Array(a+8),r=new DataView(n.buffer,n.byteOffset,n.byteLength),r.setUint32(0,n.byteLength),n.set(t,4),e=0,a=8;e<o.length;e++)n.set(o[e],a),a+=o[e].byteLength;return n},dinf=function(){return box(types.dinf,box(types.dref,DREF))},esds=function(t){return box(types.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,t.audioobjecttype<<3|t.samplingfrequencyindex>>>1,t.samplingfrequencyindex<<7|t.channelcount<<3,6,1,2]))},ftyp=function(){return box(types.ftyp,MAJOR_BRAND,MINOR_VERSION,MAJOR_BRAND,AVC1_BRAND)},hdlr=function(t){return box(types.hdlr,HDLR_TYPES[t])},mdat=function(t){return box(types.mdat,t)},mdhd=function(t){var e=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,t.duration>>>24&255,t.duration>>>16&255,t.duration>>>8&255,255&t.duration,85,196,0,0]);return t.samplerate&&(e[12]=t.samplerate>>>24&255,e[13]=t.samplerate>>>16&255,e[14]=t.samplerate>>>8&255,e[15]=255&t.samplerate),box(types.mdhd,e)},mdia=function(t){return box(types.mdia,mdhd(t),hdlr(t.type),minf(t))},mfhd=function(t){return box(types.mfhd,new Uint8Array([0,0,0,0,(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t]))},minf=function(t){return box(types.minf,"video"===t.type?box(types.vmhd,VMHD):box(types.smhd,SMHD),dinf(),stbl(t))},moof=function(t,e){for(var n=[],r=e.length;r--;)n[r]=traf(e[r]);return box.apply(null,[types.moof,mfhd(t)].concat(n))},moov=function(t){for(var e=t.length,n=[];e--;)n[e]=trak(t[e]);return box.apply(null,[types.moov,mvhd(4294967295)].concat(n).concat(mvex(t)))},mvex=function(t){for(var e=t.length,n=[];e--;)n[e]=trex(t[e]);return box.apply(null,[types.mvex].concat(n))},mvhd=function(t){var e=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return box(types.mvhd,e)},sdtp=function(t){var e,n,r=t.samples||[],o=new Uint8Array(4+r.length);for(n=0;n<r.length;n++)e=r[n].flags,o[n+4]=e.dependsOn<<4|e.isDependedOn<<2|e.hasRedundancy;return box(types.sdtp,o)},stbl=function(t){return box(types.stbl,stsd(t),box(types.stts,STTS),box(types.stsc,STSC),box(types.stsz,STSZ),box(types.stco,STCO))},function(){var t,e;stsd=function(n){return box(types.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===n.type?t(n):e(n))},t=function(t){var e,n=t.sps||[],r=t.pps||[],o=[],a=[];for(e=0;e<n.length;e++)o.push((65280&n[e].byteLength)>>>8),o.push(255&n[e].byteLength),o=o.concat(Array.prototype.slice.call(n[e]));for(e=0;e<r.length;e++)a.push((65280&r[e].byteLength)>>>8),a.push(255&r[e].byteLength),a=a.concat(Array.prototype.slice.call(r[e]));return box(types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&t.width)>>8,255&t.width,(65280&t.height)>>8,255&t.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),box(types.avcC,new Uint8Array([1,t.profileIdc,t.profileCompatibility,t.levelIdc,255].concat([n.length]).concat(o).concat([r.length]).concat(a))),box(types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))},e=function(t){return box(types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&t.channelcount)>>8,255&t.channelcount,(65280&t.samplesize)>>8,255&t.samplesize,0,0,0,0,(65280&t.samplerate)>>8,255&t.samplerate,0,0]),esds(t))}}(),tkhd=function(t){var e=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,0,(4278190080&t.duration)>>24,(16711680&t.duration)>>16,(65280&t.duration)>>8,255&t.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&t.width)>>8,255&t.width,0,0,(65280&t.height)>>8,255&t.height,0,0]);return box(types.tkhd,e)},traf=function(t){var e,n,r,o,a,i,s;return e=box(types.tfhd,new Uint8Array([0,0,0,58,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),i=Math.floor(t.baseMediaDecodeTime/(UINT32_MAX+1)),s=Math.floor(t.baseMediaDecodeTime%(UINT32_MAX+1)),n=box(types.tfdt,new Uint8Array([1,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i,s>>>24&255,s>>>16&255,s>>>8&255,255&s])),a=92,"audio"===t.type?(r=trun(t,a),box(types.traf,e,n,r)):(o=sdtp(t),r=trun(t,o.length+a),box(types.traf,e,n,r,o))},trak=function(t){return t.duration=t.duration||4294967295,box(types.trak,tkhd(t),mdia(t))},trex=function(t){var e=new Uint8Array([0,0,0,0,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==t.type&&(e[e.length-1]=0),box(types.trex,e)},function(){var t,e,n;n=function(t,e){var n=0,r=0,o=0,a=0;return t.length&&(void 0!==t[0].duration&&(n=1),void 0!==t[0].size&&(r=2),void 0!==t[0].flags&&(o=4),void 0!==t[0].compositionTimeOffset&&(a=8)),[0,0,n|r|o|a,1,(4278190080&t.length)>>>24,(16711680&t.length)>>>16,(65280&t.length)>>>8,255&t.length,(4278190080&e)>>>24,(16711680&e)>>>16,(65280&e)>>>8,255&e]},e=function(t,e){var r,o,a,i;for(o=t.samples||[],e+=20+16*o.length,r=n(o,e),i=0;i<o.length;i++)a=o[i],r=r.concat([(4278190080&a.duration)>>>24,(16711680&a.duration)>>>16,(65280&a.duration)>>>8,255&a.duration,(4278190080&a.size)>>>24,(16711680&a.size)>>>16,(65280&a.size)>>>8,255&a.size,a.flags.isLeading<<2|a.flags.dependsOn,a.flags.isDependedOn<<6|a.flags.hasRedundancy<<4|a.flags.paddingValue<<1|a.flags.isNonSyncSample,61440&a.flags.degradationPriority,15&a.flags.degradationPriority,(4278190080&a.compositionTimeOffset)>>>24,(16711680&a.compositionTimeOffset)>>>16,(65280&a.compositionTimeOffset)>>>8,255&a.compositionTimeOffset]);return box(types.trun,new Uint8Array(r))},t=function(t,e){var r,o,a,i;for(o=t.samples||[],e+=20+8*o.length,r=n(o,e),i=0;i<o.length;i++)a=o[i],r=r.concat([(4278190080&a.duration)>>>24,(16711680&a.duration)>>>16,(65280&a.duration)>>>8,255&a.duration,(4278190080&a.size)>>>24,(16711680&a.size)>>>16,(65280&a.size)>>>8,255&a.size]);return box(types.trun,new Uint8Array(r))},trun=function(n,r){return"audio"===n.type?t(n,r):e(n,r)}}(),module.exports={ftyp:ftyp,mdat:mdat,moof:moof,moov:moov,initSegment:function(t){var e,n=ftyp(),r=moov(t);return e=new Uint8Array(n.byteLength+r.byteLength),e.set(n),e.set(r,n.byteLength),e}};
},{}],361:[function(require,module,exports){
"use strict";var Stream=require("../utils/stream.js"),mp4=require("./mp4-generator.js"),m2ts=require("../m2ts/m2ts.js"),AdtsStream=require("../codecs/adts.js"),H264Stream=require("../codecs/h264").H264Stream,AacStream=require("../aac"),coneOfSilence=require("../data/silence"),clock=require("../utils/clock"),AUDIO_PROPERTIES=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],VIDEO_PROPERTIES=["width","height","profileIdc","levelIdc","profileCompatibility"],ONE_SECOND_IN_TS=9e4,VideoSegmentStream,AudioSegmentStream,Transmuxer,CoalesceStream,createDefaultSample,isLikelyAacData,collectDtsInfo,clearDtsInfo,calculateTrackBaseMediaDecodeTime,arrayEquals,sumFrameByteLengths;createDefaultSample=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0}}},isLikelyAacData=function(e){return e[0]==="I".charCodeAt(0)&&e[1]==="D".charCodeAt(0)&&e[2]==="3".charCodeAt(0)},arrayEquals=function(e,t){var a;if(e.length!==t.length)return!1;for(a=0;a<e.length;a++)if(e[a]!==t[a])return!1;return!0},sumFrameByteLengths=function(e){var t,a,i=0;for(t=0;t<e.length;t++)a=e[t],i+=a.data.byteLength;return i},AudioSegmentStream=function(e){var t=[],a=0,i=0,n=0,s=1/0;AudioSegmentStream.prototype.init.call(this),this.push=function(a){collectDtsInfo(e,a),e&&AUDIO_PROPERTIES.forEach(function(t){e[t]=a[t]}),t.push(a)},this.setEarliestDts=function(t){i=t-e.timelineStartInfo.baseMediaDecodeTime},this.setVideoBaseMediaDecodeTime=function(e){s=e},this.setAudioAppendStart=function(e){n=e},this.flush=function(){var i,n,s,r;return 0===t.length?void this.trigger("done","AudioSegmentStream"):(i=this.trimAdtsFramesByEarliestDts_(t),e.baseMediaDecodeTime=calculateTrackBaseMediaDecodeTime(e),this.prefixWithSilence_(e,i),e.samples=this.generateSampleTable_(i),s=mp4.mdat(this.concatenateFrameData_(i)),t=[],n=mp4.moof(a,[e]),r=new Uint8Array(n.byteLength+s.byteLength),a++,r.set(n),r.set(s,n.byteLength),clearDtsInfo(e),this.trigger("data",{track:e,boxes:r}),void this.trigger("done","AudioSegmentStream"))},this.prefixWithSilence_=function(e,t){var a,i,r,m=0,o=0,d=0,p=0;if(t.length&&(a=clock.audioTsToVideoTs(e.baseMediaDecodeTime,e.samplerate),n&&s&&n<a&&(o=a-s,m=Math.ceil(ONE_SECOND_IN_TS/(e.samplerate/1024)),d=Math.floor(o/m),p=d*m),!(d<1||p>ONE_SECOND_IN_TS/2))){for(i=coneOfSilence[e.samplerate],i||(i=t[0].data),r=0;r<d;r++)t.splice(r,0,{data:i});e.baseMediaDecodeTime-=Math.floor(clock.videoTsToAudioTs(p,e.samplerate))}},this.trimAdtsFramesByEarliestDts_=function(t){return e.minSegmentDts>=i?t:(e.minSegmentDts=1/0,t.filter(function(t){return t.dts>=i&&(e.minSegmentDts=Math.min(e.minSegmentDts,t.dts),e.minSegmentPts=e.minSegmentDts,!0)}))},this.generateSampleTable_=function(e){var t,a,i=[];for(t=0;t<e.length;t++)a=e[t],i.push({size:a.data.byteLength,duration:1024});return i},this.concatenateFrameData_=function(e){var t,a,i=0,n=new Uint8Array(sumFrameByteLengths(e));for(t=0;t<e.length;t++)a=e[t],n.set(a.data,i),i+=a.data.byteLength;return n}},AudioSegmentStream.prototype=new Stream,VideoSegmentStream=function(e){var t,a,i=0,n=[];VideoSegmentStream.prototype.init.call(this),delete e.minPTS,this.gopCache_=[],this.push=function(i){collectDtsInfo(e,i),"seq_parameter_set_rbsp"!==i.nalUnitType||t||(t=i.config,e.sps=[i.data],VIDEO_PROPERTIES.forEach(function(a){e[a]=t[a]},this)),"pic_parameter_set_rbsp"!==i.nalUnitType||a||(a=i.data,e.pps=[i.data]),n.push(i)},this.flush=function(){for(var t,a,s,r,m,o;n.length&&"access_unit_delimiter_rbsp"!==n[0].nalUnitType;)n.shift();return 0===n.length?(this.resetStream_(),void this.trigger("done","VideoSegmentStream")):(t=this.groupNalsIntoFrames_(n),s=this.groupFramesIntoGops_(t),s[0][0].keyFrame||(a=this.getGopForFusion_(n[0],e),a?(s.unshift(a),s.byteLength+=a.byteLength,s.nalCount+=a.nalCount,s.pts=a.pts,s.dts=a.dts,s.duration+=a.duration):s=this.extendFirstKeyFrame_(s)),collectDtsInfo(e,s),e.samples=this.generateSampleTable_(s),m=mp4.mdat(this.concatenateNalData_(s)),this.gopCache_.unshift({gop:s.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),n=[],e.baseMediaDecodeTime=calculateTrackBaseMediaDecodeTime(e),this.trigger("baseMediaDecodeTime",e.baseMediaDecodeTime),this.trigger("timelineStartInfo",e.timelineStartInfo),r=mp4.moof(i,[e]),o=new Uint8Array(r.byteLength+m.byteLength),i++,o.set(r),o.set(m,r.byteLength),this.trigger("data",{track:e,boxes:o}),this.resetStream_(),void this.trigger("done","VideoSegmentStream"))},this.resetStream_=function(){clearDtsInfo(e),t=void 0,a=void 0},this.getGopForFusion_=function(t){var a,i,n,s,r,m=45e3,o=1e4,d=1/0;for(r=0;r<this.gopCache_.length;r++)s=this.gopCache_[r],n=s.gop,e.pps&&arrayEquals(e.pps[0],s.pps[0])&&e.sps&&arrayEquals(e.sps[0],s.sps[0])&&(n.dts<e.timelineStartInfo.dts||(a=t.dts-n.dts-n.duration,a>=-o&&a<=m&&(!i||d>a)&&(i=s,d=a)));return i?i.gop:null},this.extendFirstKeyFrame_=function(e){var t;return!e[0][0].keyFrame&&e.length>1&&(t=e.shift(),e.byteLength-=t.byteLength,e.nalCount-=t.nalCount,e[0][0].dts=t.dts,e[0][0].pts=t.pts,e[0][0].duration+=t.duration),e},this.groupNalsIntoFrames_=function(e){var t,a,i=[],n=[];for(i.byteLength=0,t=0;t<e.length;t++)a=e[t],"access_unit_delimiter_rbsp"===a.nalUnitType?(i.length&&(i.duration=a.dts-i.dts,n.push(i)),i=[a],i.byteLength=a.data.byteLength,i.pts=a.pts,i.dts=a.dts):("slice_layer_without_partitioning_rbsp_idr"===a.nalUnitType&&(i.keyFrame=!0),i.duration=a.dts-i.dts,i.byteLength+=a.data.byteLength,i.push(a));return n.length&&(!i.duration||i.duration<=0)&&(i.duration=n[n.length-1].duration),n.push(i),n},this.groupFramesIntoGops_=function(e){var t,a,i=[],n=[];for(i.byteLength=0,i.nalCount=0,i.duration=0,i.pts=e[0].pts,i.dts=e[0].dts,n.byteLength=0,n.nalCount=0,n.duration=0,n.pts=e[0].pts,n.dts=e[0].dts,t=0;t<e.length;t++)a=e[t],a.keyFrame?(i.length&&(n.push(i),n.byteLength+=i.byteLength,n.nalCount+=i.nalCount,n.duration+=i.duration),i=[a],i.nalCount=a.length,i.byteLength=a.byteLength,i.pts=a.pts,i.dts=a.dts,i.duration=a.duration):(i.duration+=a.duration,i.nalCount+=a.length,i.byteLength+=a.byteLength,i.push(a));return n.length&&i.duration<=0&&(i.duration=n[n.length-1].duration),n.byteLength+=i.byteLength,n.nalCount+=i.nalCount,n.duration+=i.duration,n.push(i),n},this.generateSampleTable_=function(e,t){var a,i,n,s,r,m=t||0,o=[];for(a=0;a<e.length;a++)for(s=e[a],i=0;i<s.length;i++)r=s[i],n=createDefaultSample(),n.dataOffset=m,n.compositionTimeOffset=r.pts-r.dts,n.duration=r.duration,n.size=4*r.length,n.size+=r.byteLength,r.keyFrame&&(n.flags.dependsOn=2),m+=n.size,o.push(n);return o},this.concatenateNalData_=function(e){var t,a,i,n,s,r,m=0,o=e.byteLength,d=e.nalCount,p=o+4*d,h=new Uint8Array(p),c=new DataView(h.buffer);for(t=0;t<e.length;t++)for(n=e[t],a=0;a<n.length;a++)for(s=n[a],i=0;i<s.length;i++)r=s[i],c.setUint32(m,r.data.byteLength),m+=4,h.set(r.data,m),m+=r.data.byteLength;return h}},VideoSegmentStream.prototype=new Stream,collectDtsInfo=function(e,t){"number"==typeof t.pts&&(void 0===e.timelineStartInfo.pts&&(e.timelineStartInfo.pts=t.pts),void 0===e.minSegmentPts?e.minSegmentPts=t.pts:e.minSegmentPts=Math.min(e.minSegmentPts,t.pts),void 0===e.maxSegmentPts?e.maxSegmentPts=t.pts:e.maxSegmentPts=Math.max(e.maxSegmentPts,t.pts)),"number"==typeof t.dts&&(void 0===e.timelineStartInfo.dts&&(e.timelineStartInfo.dts=t.dts),void 0===e.minSegmentDts?e.minSegmentDts=t.dts:e.minSegmentDts=Math.min(e.minSegmentDts,t.dts),void 0===e.maxSegmentDts?e.maxSegmentDts=t.dts:e.maxSegmentDts=Math.max(e.maxSegmentDts,t.dts))},clearDtsInfo=function(e){delete e.minSegmentDts,delete e.maxSegmentDts,delete e.minSegmentPts,delete e.maxSegmentPts},calculateTrackBaseMediaDecodeTime=function(e){var t,a,i=e.minSegmentDts-e.timelineStartInfo.dts;return t=e.timelineStartInfo.baseMediaDecodeTime,t+=i,t=Math.max(0,t),"audio"===e.type&&(a=e.samplerate/ONE_SECOND_IN_TS,t*=a,t=Math.floor(t)),t},CoalesceStream=function(e,t){this.numberOfTracks=0,this.metadataStream=t,"undefined"!=typeof e.remux?this.remuxTracks=!!e.remux:this.remuxTracks=!0,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,CoalesceStream.prototype.init.call(this),this.push=function(e){return e.text?this.pendingCaptions.push(e):e.frames?this.pendingMetadata.push(e):(this.pendingTracks.push(e.track),this.pendingBoxes.push(e.boxes),this.pendingBytes+=e.boxes.byteLength,"video"===e.track.type&&(this.videoTrack=e.track),void("audio"===e.track.type&&(this.audioTrack=e.track)))}},CoalesceStream.prototype=new Stream,CoalesceStream.prototype.flush=function(e){var t,a,i,n,s=0,r={captions:[],metadata:[],info:{}},m=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==e&&"AudioSegmentStream"!==e)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}for(this.videoTrack?(m=this.videoTrack.timelineStartInfo.pts,VIDEO_PROPERTIES.forEach(function(e){r.info[e]=this.videoTrack[e]},this)):this.audioTrack&&(m=this.audioTrack.timelineStartInfo.pts,AUDIO_PROPERTIES.forEach(function(e){r.info[e]=this.audioTrack[e]},this)),1===this.pendingTracks.length?r.type=this.pendingTracks[0].type:r.type="combined",this.emittedTracks+=this.pendingTracks.length,i=mp4.initSegment(this.pendingTracks),r.initSegment=new Uint8Array(i.byteLength),r.initSegment.set(i),r.data=new Uint8Array(this.pendingBytes),n=0;n<this.pendingBoxes.length;n++)r.data.set(this.pendingBoxes[n],s),s+=this.pendingBoxes[n].byteLength;for(n=0;n<this.pendingCaptions.length;n++)t=this.pendingCaptions[n],t.startTime=t.startPts-m,t.startTime/=9e4,t.endTime=t.endPts-m,t.endTime/=9e4,r.captions.push(t);for(n=0;n<this.pendingMetadata.length;n++)a=this.pendingMetadata[n],a.cueTime=a.pts-m,a.cueTime/=9e4,r.metadata.push(a);r.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",r),this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},Transmuxer=function(e){var t,a,i=this,n=!0;Transmuxer.prototype.init.call(this),e=e||{},this.baseMediaDecodeTime=e.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var t={};this.transmuxPipeline_=t,t.type="aac",t.metadataStream=new m2ts.MetadataStream,t.aacStream=new AacStream,t.audioTimestampRolloverStream=new m2ts.TimestampRolloverStream("audio"),t.timedMetadataTimestampRolloverStream=new m2ts.TimestampRolloverStream("timed-metadata"),t.adtsStream=new AdtsStream,t.coalesceStream=new CoalesceStream(e,t.metadataStream),t.headOfPipeline=t.aacStream,t.aacStream.pipe(t.audioTimestampRolloverStream).pipe(t.adtsStream),t.aacStream.pipe(t.timedMetadataTimestampRolloverStream).pipe(t.metadataStream).pipe(t.coalesceStream),t.metadataStream.on("timestamp",function(e){t.aacStream.setTimestamp(e.timeStamp)}),t.aacStream.on("data",function(e){"timed-metadata"!==e.type||t.audioSegmentStream||(a=a||{timelineStartInfo:{baseMediaDecodeTime:i.baseMediaDecodeTime},codec:"adts",type:"audio"},t.coalesceStream.numberOfTracks++,t.audioSegmentStream=new AudioSegmentStream(a),t.adtsStream.pipe(t.audioSegmentStream).pipe(t.coalesceStream))}),t.coalesceStream.on("data",this.trigger.bind(this,"data")),t.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var n={};this.transmuxPipeline_=n,n.type="ts",n.metadataStream=new m2ts.MetadataStream,n.packetStream=new m2ts.TransportPacketStream,n.parseStream=new m2ts.TransportParseStream,n.elementaryStream=new m2ts.ElementaryStream,n.videoTimestampRolloverStream=new m2ts.TimestampRolloverStream("video"),n.audioTimestampRolloverStream=new m2ts.TimestampRolloverStream("audio"),n.timedMetadataTimestampRolloverStream=new m2ts.TimestampRolloverStream("timed-metadata"),n.adtsStream=new AdtsStream,n.h264Stream=new H264Stream,n.captionStream=new m2ts.CaptionStream,n.coalesceStream=new CoalesceStream(e,n.metadataStream),n.headOfPipeline=n.packetStream,n.packetStream.pipe(n.parseStream).pipe(n.elementaryStream),n.elementaryStream.pipe(n.videoTimestampRolloverStream).pipe(n.h264Stream),n.elementaryStream.pipe(n.audioTimestampRolloverStream).pipe(n.adtsStream),n.elementaryStream.pipe(n.timedMetadataTimestampRolloverStream).pipe(n.metadataStream).pipe(n.coalesceStream),n.h264Stream.pipe(n.captionStream).pipe(n.coalesceStream),n.elementaryStream.on("data",function(e){var s;if("metadata"===e.type){for(s=e.tracks.length;s--;)t||"video"!==e.tracks[s].type?a||"audio"!==e.tracks[s].type||(a=e.tracks[s],a.timelineStartInfo.baseMediaDecodeTime=i.baseMediaDecodeTime):(t=e.tracks[s],t.timelineStartInfo.baseMediaDecodeTime=i.baseMediaDecodeTime);t&&!n.videoSegmentStream&&(n.coalesceStream.numberOfTracks++,n.videoSegmentStream=new VideoSegmentStream(t),n.videoSegmentStream.on("timelineStartInfo",function(e){a&&(a.timelineStartInfo=e,n.audioSegmentStream.setEarliestDts(e.dts))}),n.videoSegmentStream.on("baseMediaDecodeTime",function(e){a&&n.audioSegmentStream.setVideoBaseMediaDecodeTime(e)}),n.h264Stream.pipe(n.videoSegmentStream).pipe(n.coalesceStream)),a&&!n.audioSegmentStream&&(n.coalesceStream.numberOfTracks++,n.audioSegmentStream=new AudioSegmentStream(a),n.adtsStream.pipe(n.audioSegmentStream).pipe(n.coalesceStream))}}),n.coalesceStream.on("data",this.trigger.bind(this,"data")),n.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(e){var i=this.transmuxPipeline_;this.baseMediaDecodeTime=e,a&&(a.timelineStartInfo.dts=void 0,a.timelineStartInfo.pts=void 0,clearDtsInfo(a),a.timelineStartInfo.baseMediaDecodeTime=e),t&&(i.videoSegmentStream&&(i.videoSegmentStream.gopCache_=[]),t.timelineStartInfo.dts=void 0,t.timelineStartInfo.pts=void 0,clearDtsInfo(t),t.timelineStartInfo.baseMediaDecodeTime=e)},this.setAudioAppendStart=function(e){a&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)},this.push=function(e){if(n){var t=isLikelyAacData(e);t&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():t||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),n=!1}this.transmuxPipeline_.headOfPipeline.push(e)},this.flush=function(){n=!0,this.transmuxPipeline_.headOfPipeline.flush()}},Transmuxer.prototype=new Stream,module.exports={Transmuxer:Transmuxer,VideoSegmentStream:VideoSegmentStream,AudioSegmentStream:AudioSegmentStream,AUDIO_PROPERTIES:AUDIO_PROPERTIES,VIDEO_PROPERTIES:VIDEO_PROPERTIES};
},{"../aac":344,"../codecs/adts.js":345,"../codecs/h264":346,"../data/silence":347,"../m2ts/m2ts.js":355,"../utils/clock":362,"../utils/stream.js":364,"./mp4-generator.js":360}],362:[function(require,module,exports){
var ONE_SECOND_IN_TS=9e4,secondsToVideoTs,secondsToAudioTs,videoTsToSeconds,audioTsToSeconds,audioTsToVideoTs,videoTsToAudioTs;secondsToVideoTs=function(o){return o*ONE_SECOND_IN_TS},secondsToAudioTs=function(o,s){return o*s},videoTsToSeconds=function(o){return o/ONE_SECOND_IN_TS},audioTsToSeconds=function(o,s){return o/s},audioTsToVideoTs=function(o,s){return secondsToVideoTs(audioTsToSeconds(o,s))},videoTsToAudioTs=function(o,s){return secondsToAudioTs(videoTsToSeconds(o),s)},module.exports={secondsToVideoTs:secondsToVideoTs,secondsToAudioTs:secondsToAudioTs,videoTsToSeconds:videoTsToSeconds,audioTsToSeconds:audioTsToSeconds,audioTsToVideoTs:audioTsToVideoTs,videoTsToAudioTs:videoTsToAudioTs};
},{}],363:[function(require,module,exports){
"use strict";var ExpGolomb;ExpGolomb=function(i){var t=i.byteLength,s=0,n=0;this.length=function(){return 8*t},this.bitsAvailable=function(){return 8*t+n},this.loadWord=function(){var r=i.byteLength-t,o=new Uint8Array(4),e=Math.min(4,t);if(0===e)throw new Error("no bytes available");o.set(i.subarray(r,r+e)),s=new DataView(o.buffer).getUint32(0),n=8*e,t-=e},this.skipBits=function(i){var r;n>i?(s<<=i,n-=i):(i-=n,r=Math.floor(i/8),i-=8*r,t-=r,this.loadWord(),s<<=i,n-=i)},this.readBits=function(i){var r=Math.min(n,i),o=s>>>32-r;return n-=r,n>0?s<<=r:t>0&&this.loadWord(),r=i-r,r>0?o<<r|this.readBits(r):o},this.skipLeadingZeros=function(){var i;for(i=0;i<n;++i)if(0!==(s&2147483648>>>i))return s<<=i,n-=i,i;return this.loadWord(),i+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var i=this.skipLeadingZeros();return this.readBits(i+1)-1},this.readExpGolomb=function(){var i=this.readUnsignedExpGolomb();return 1&i?1+i>>>1:-1*(i>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()},module.exports=ExpGolomb;
},{}],364:[function(require,module,exports){
arguments[4][207][0].apply(exports,arguments)
},{"dup":207}],365:[function(require,module,exports){
"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}exports.__esModule=!0;var _button=require("./button.js"),_button2=_interopRequireDefault(_button),_component=require("./component.js"),_component2=_interopRequireDefault(_component),BigPlayButton=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,t.apply(this,arguments))}return _inherits(e,t),e.prototype.buildCSSClass=function(){return"vjs-big-play-button"},e.prototype.handleClick=function(t){this.player_.play();var e=this.player_.getChild("controlBar"),o=e&&e.getChild("playToggle");return o?void this.setTimeout(function(){o.focus()},1):void this.player_.focus()},e}(_button2.default);BigPlayButton.prototype.controlText_="Play Video",_component2.default.registerComponent("BigPlayButton",BigPlayButton),exports.default=BigPlayButton;
},{"./button.js":366,"./component.js":369}],366:[function(require,module,exports){
arguments[4][221][0].apply(exports,arguments)
},{"./clickable-component.js":367,"./component":369,"./utils/log.js":450,"./utils/obj":452,"dup":221}],367:[function(require,module,exports){
"use strict";function _interopRequireWildcard(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}exports.__esModule=!0;var _component=require("./component"),_component2=_interopRequireDefault(_component),_dom=require("./utils/dom.js"),Dom=_interopRequireWildcard(_dom),_events=require("./utils/events.js"),Events=_interopRequireWildcard(_events),_fn=require("./utils/fn.js"),Fn=_interopRequireWildcard(_fn),_log=require("./utils/log.js"),_log2=_interopRequireDefault(_log),_document=require("global/document"),_document2=_interopRequireDefault(_document),_obj=require("./utils/obj"),ClickableComponent=function(t){function e(n,o){_classCallCheck(this,e);var i=_possibleConstructorReturn(this,t.call(this,n,o));return i.emitTapEvents(),i.enable(),i}return _inherits(e,t),e.prototype.createEl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n=(0,_obj.assign)({className:this.buildCSSClass(),tabIndex:0},n),"button"===e&&_log2.default.error("Creating a ClickableComponent with an HTML element of "+e+" is not supported; use a Button instead."),o=(0,_obj.assign)({role:"button","aria-live":"polite"},o),this.tabIndex_=n.tabIndex;var i=t.prototype.createEl.call(this,e,n,o);return this.createControlTextEl(i),i},e.prototype.createControlTextEl=function(t){return this.controlTextEl_=Dom.createEl("span",{className:"vjs-control-text"}),t&&t.appendChild(this.controlTextEl_),this.controlText(this.controlText_,t),this.controlTextEl_},e.prototype.controlText=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.el();if(!t)return this.controlText_||"Need Text";var n=this.localize(t);return this.controlText_=t,this.controlTextEl_.innerHTML=n,this.nonIconControl||e.setAttribute("title",n),this},e.prototype.buildCSSClass=function(){return"vjs-control vjs-button "+t.prototype.buildCSSClass.call(this)},e.prototype.enable=function(){return this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),"undefined"!=typeof this.tabIndex_&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on("tap",this.handleClick),this.on("click",this.handleClick),this.on("focus",this.handleFocus),this.on("blur",this.handleBlur),this},e.prototype.disable=function(){return this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),"undefined"!=typeof this.tabIndex_&&this.el_.removeAttribute("tabIndex"),this.off("tap",this.handleClick),this.off("click",this.handleClick),this.off("focus",this.handleFocus),this.off("blur",this.handleBlur),this},e.prototype.handleClick=function(t){},e.prototype.handleFocus=function(t){Events.on(_document2.default,"keydown",Fn.bind(this,this.handleKeyPress))},e.prototype.handleKeyPress=function(e){32===e.which||13===e.which?(e.preventDefault(),this.handleClick(e)):t.prototype.handleKeyPress&&t.prototype.handleKeyPress.call(this,e)},e.prototype.handleBlur=function(t){Events.off(_document2.default,"keydown",Fn.bind(this,this.handleKeyPress))},e}(_component2.default);_component2.default.registerComponent("ClickableComponent",ClickableComponent),exports.default=ClickableComponent;
},{"./component":369,"./utils/dom.js":445,"./utils/events.js":446,"./utils/fn.js":447,"./utils/log.js":450,"./utils/obj":452,"global/document":193}],368:[function(require,module,exports){
arguments[4][223][0].apply(exports,arguments)
},{"./button":366,"./component":369,"dup":223}],369:[function(require,module,exports){
"use strict";function _interopRequireWildcard(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _window=require("global/window"),_window2=_interopRequireDefault(_window),_dom=require("./utils/dom.js"),Dom=_interopRequireWildcard(_dom),_fn=require("./utils/fn.js"),Fn=_interopRequireWildcard(_fn),_guid=require("./utils/guid.js"),Guid=_interopRequireWildcard(_guid),_events=require("./utils/events.js"),Events=_interopRequireWildcard(_events),_log=require("./utils/log.js"),_log2=_interopRequireDefault(_log),_toTitleCase=require("./utils/to-title-case.js"),_toTitleCase2=_interopRequireDefault(_toTitleCase),_mergeOptions=require("./utils/merge-options.js"),_mergeOptions2=_interopRequireDefault(_mergeOptions),Component=function(){function t(e,i,n){if(_classCallCheck(this,t),!e&&this.play?this.player_=e=this:this.player_=e,this.options_=(0,_mergeOptions2.default)({},this.options_),i=this.options_=(0,_mergeOptions2.default)(this.options_,i),this.id_=i.id||i.el&&i.el.id,!this.id_){var o=e&&e.id&&e.id()||"no_player";this.id_=o+"_component_"+Guid.newGUID()}this.name_=i.name||null,i.el?this.el_=i.el:i.createEl!==!1&&(this.el_=this.createEl()),this.children_=[],this.childIndex_={},this.childNameIndex_={},i.initChildren!==!1&&this.initChildren(),this.ready(n),i.reportTouchActivity!==!1&&this.enableTouchActivity()}return t.prototype.dispose=function(){if(this.trigger({type:"dispose",bubbles:!1}),this.children_)for(var t=this.children_.length-1;t>=0;t--)this.children_[t].dispose&&this.children_[t].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.off(),this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),Dom.removeElData(this.el_),this.el_=null},t.prototype.player=function(){return this.player_},t.prototype.options=function(t){return _log2.default.warn("this.options() has been deprecated and will be moved to the constructor in 6.0"),t?(this.options_=(0,_mergeOptions2.default)(this.options_,t),this.options_):this.options_},t.prototype.el=function(){return this.el_},t.prototype.createEl=function(t,e,i){return Dom.createEl(t,e,i)},t.prototype.localize=function(t){var e=this.player_.language&&this.player_.language(),i=this.player_.languages&&this.player_.languages();if(!e||!i)return t;var n=i[e];if(n&&n[t])return n[t];var o=e.split("-")[0],r=i[o];return r&&r[t]?r[t]:t},t.prototype.contentEl=function(){return this.contentEl_||this.el_},t.prototype.id=function(){return this.id_},t.prototype.name=function(){return this.name_},t.prototype.children=function(){return this.children_},t.prototype.getChildById=function(t){return this.childIndex_[t]},t.prototype.getChild=function(t){if(t)return t=(0,_toTitleCase2.default)(t),this.childNameIndex_[t]},t.prototype.addChild=function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.children_.length,o=void 0,r=void 0;if("string"==typeof e){r=(0,_toTitleCase2.default)(e),i||(i={}),i===!0&&(_log2.default.warn("Initializing a child component with `true` is deprecated.Children should be defined in an array when possible, but if necessary use an object instead of `true`."),i={});var s=i.componentClass||r;i.name=r;var l=t.getComponent(s);if(!l)throw new Error("Component "+s+" does not exist");if("function"!=typeof l)return null;o=new l(this.player_||this,i)}else o=e;if(this.children_.splice(n,0,o),"function"==typeof o.id&&(this.childIndex_[o.id()]=o),r=r||o.name&&(0,_toTitleCase2.default)(o.name()),r&&(this.childNameIndex_[r]=o),"function"==typeof o.el&&o.el()){var u=this.contentEl().children,a=u[n]||null;this.contentEl().insertBefore(o.el(),a)}return o},t.prototype.removeChild=function(t){if("string"==typeof t&&(t=this.getChild(t)),t&&this.children_){for(var e=!1,i=this.children_.length-1;i>=0;i--)if(this.children_[i]===t){e=!0,this.children_.splice(i,1);break}if(e){this.childIndex_[t.id()]=null,this.childNameIndex_[t.name()]=null;var n=t.el();n&&n.parentNode===this.contentEl()&&this.contentEl().removeChild(t.el())}}},t.prototype.initChildren=function(){var e=this,i=this.options_.children;i&&!function(){var n=e.options_,o=function(t){var i=t.name,o=t.opts;if(void 0!==n[i]&&(o=n[i]),o!==!1){o===!0&&(o={}),o.playerOptions=e.options_.playerOptions;var r=e.addChild(i,o);r&&(e[i]=r)}},r=void 0,s=t.getComponent("Tech");r=Array.isArray(i)?i:Object.keys(i),r.concat(Object.keys(e.options_).filter(function(t){return!r.some(function(e){return"string"==typeof e?t===e:t===e.name})})).map(function(t){var n=void 0,o=void 0;return"string"==typeof t?(n=t,o=i[n]||e.options_[n]||{}):(n=t.name,o=t),{name:n,opts:o}}).filter(function(e){var i=t.getComponent(e.opts.componentClass||(0,_toTitleCase2.default)(e.name));return i&&!s.isTech(i)}).forEach(o)}()},t.prototype.buildCSSClass=function(){return""},t.prototype.on=function(t,e,i){var n=this;return"string"==typeof t||Array.isArray(t)?Events.on(this.el_,t,Fn.bind(this,e)):!function(){var o=t,r=e,s=Fn.bind(n,i),l=function(){return n.off(o,r,s)};l.guid=s.guid,n.on("dispose",l);var u=function(){return n.off("dispose",l)};u.guid=s.guid,t.nodeName?(Events.on(o,r,s),Events.on(o,"dispose",u)):"function"==typeof t.on&&(o.on(r,s),o.on("dispose",u))}(),this},t.prototype.off=function(t,e,i){if(!t||"string"==typeof t||Array.isArray(t))Events.off(this.el_,t,e);else{var n=t,o=e,r=Fn.bind(this,i);this.off("dispose",r),t.nodeName?(Events.off(n,o,r),Events.off(n,"dispose",r)):(n.off(o,r),n.off("dispose",r))}return this},t.prototype.one=function(t,e,i){var n=this,o=arguments;return"string"==typeof t||Array.isArray(t)?Events.one(this.el_,t,Fn.bind(this,e)):!function(){var r=t,s=e,l=Fn.bind(n,i),u=function t(){n.off(r,s,t),l.apply(null,o)};u.guid=l.guid,n.on(r,s,u)}(),this},t.prototype.trigger=function(t,e){return Events.trigger(this.el_,t,e),this},t.prototype.ready=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t&&(this.isReady_?e?t.call(this):this.setTimeout(t,1):(this.readyQueue_=this.readyQueue_||[],this.readyQueue_.push(t))),this},t.prototype.triggerReady=function(){this.isReady_=!0,this.setTimeout(function(){var t=this.readyQueue_;this.readyQueue_=[],t&&t.length>0&&t.forEach(function(t){t.call(this)},this),this.trigger("ready")},1)},t.prototype.$=function(t,e){return Dom.$(t,e||this.contentEl())},t.prototype.$$=function(t,e){return Dom.$$(t,e||this.contentEl())},t.prototype.hasClass=function(t){return Dom.hasElClass(this.el_,t)},t.prototype.addClass=function(t){return Dom.addElClass(this.el_,t),this},t.prototype.removeClass=function(t){return Dom.removeElClass(this.el_,t),this},t.prototype.toggleClass=function(t,e){return Dom.toggleElClass(this.el_,t,e),this},t.prototype.show=function(){return this.removeClass("vjs-hidden"),this},t.prototype.hide=function(){return this.addClass("vjs-hidden"),this},t.prototype.lockShowing=function(){return this.addClass("vjs-lock-showing"),this},t.prototype.unlockShowing=function(){return this.removeClass("vjs-lock-showing"),this},t.prototype.getAttribute=function(t){return Dom.getAttribute(this.el_,t)},t.prototype.setAttribute=function(t,e){return Dom.setAttribute(this.el_,t,e),this},t.prototype.removeAttribute=function(t){return Dom.removeAttribute(this.el_,t),this},t.prototype.width=function(t,e){return this.dimension("width",t,e)},t.prototype.height=function(t,e){return this.dimension("height",t,e)},t.prototype.dimensions=function(t,e){return this.width(t,!0).height(e)},t.prototype.dimension=function(t,e,i){if(void 0!==e)return null!==e&&e===e||(e=0),(""+e).indexOf("%")!==-1||(""+e).indexOf("px")!==-1?this.el_.style[t]=e:"auto"===e?this.el_.style[t]="":this.el_.style[t]=e+"px",i||this.trigger("resize"),this;if(!this.el_)return 0;var n=this.el_.style[t],o=n.indexOf("px");return o!==-1?parseInt(n.slice(0,o),10):parseInt(this.el_["offset"+(0,_toTitleCase2.default)(t)],10)},t.prototype.currentDimension=function(t){var e=0;if("width"!==t&&"height"!==t)throw new Error("currentDimension only accepts width or height value");if("function"==typeof _window2.default.getComputedStyle){var i=_window2.default.getComputedStyle(this.el_);e=i.getPropertyValue(t)||i[t]}if(e=parseFloat(e),0===e){var n="offset"+(0,_toTitleCase2.default)(t);e=this.el_[n]}return e},t.prototype.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},t.prototype.currentWidth=function(){return this.currentDimension("width")},t.prototype.currentHeight=function(){return this.currentDimension("height")},t.prototype.focus=function(){this.el_.focus()},t.prototype.blur=function(){this.el_.blur()},t.prototype.emitTapEvents=function(){var t=0,e=null,i=10,n=200,o=void 0;this.on("touchstart",function(i){1===i.touches.length&&(e={pageX:i.touches[0].pageX,pageY:i.touches[0].pageY},t=(new Date).getTime(),o=!0)}),this.on("touchmove",function(t){if(t.touches.length>1)o=!1;else if(e){var n=t.touches[0].pageX-e.pageX,r=t.touches[0].pageY-e.pageY,s=Math.sqrt(n*n+r*r);s>i&&(o=!1)}});var r=function(){o=!1};this.on("touchleave",r),this.on("touchcancel",r),this.on("touchend",function(i){if(e=null,o===!0){var r=(new Date).getTime()-t;r<n&&(i.preventDefault(),this.trigger("tap"))}})},t.prototype.enableTouchActivity=function(){if(this.player()&&this.player().reportUserActivity){var t=Fn.bind(this.player(),this.player().reportUserActivity),e=void 0;this.on("touchstart",function(){t(),this.clearInterval(e),e=this.setInterval(t,250)});var i=function(i){t(),this.clearInterval(e)};this.on("touchmove",t),this.on("touchend",i),this.on("touchcancel",i)}},t.prototype.setTimeout=function(t,e){t=Fn.bind(this,t);var i=_window2.default.setTimeout(t,e),n=function(){this.clearTimeout(i)};return n.guid="vjs-timeout-"+i,this.on("dispose",n),i},t.prototype.clearTimeout=function(t){_window2.default.clearTimeout(t);var e=function(){};return e.guid="vjs-timeout-"+t,this.off("dispose",e),t},t.prototype.setInterval=function(t,e){t=Fn.bind(this,t);var i=_window2.default.setInterval(t,e),n=function(){this.clearInterval(i)};return n.guid="vjs-interval-"+i,this.on("dispose",n),i},t.prototype.clearInterval=function(t){_window2.default.clearInterval(t);var e=function(){};return e.guid="vjs-interval-"+t,this.off("dispose",e),t},t.registerComponent=function(e,i){if(e)return e=(0,_toTitleCase2.default)(e),t.components_||(t.components_={}),"Player"===e&&t.components_[e]&&!function(){var i=t.components_[e];if(i.players&&Object.keys(i.players).length>0&&Object.keys(i.players).map(function(t){return i.players[t]}).every(Boolean))throw new Error("Can not register Player component after player has been created")}(),t.components_[e]=i,i},t.getComponent=function(e){if(e)return e=(0,_toTitleCase2.default)(e),t.components_&&t.components_[e]?t.components_[e]:_window2.default&&_window2.default.videojs&&_window2.default.videojs[e]?(_log2.default.warn("The "+e+" component was added to the videojs object when it should be registered using videojs.registerComponent(name, component)"),_window2.default.videojs[e]):void 0},t.extend=function(e){e=e||{},_log2.default.warn("Component.extend({}) has been deprecated,  use videojs.extend(Component, {}) instead");var i=e.init||e.init||this.prototype.init||this.prototype.init||function(){},n=function(){i.apply(this,arguments)};n.prototype=Object.create(this.prototype),n.prototype.constructor=n,n.extend=t.extend;for(var o in e)e.hasOwnProperty(o)&&(n.prototype[o]=e[o]);return n},t}();Component.registerComponent("Component",Component),exports.default=Component;
},{"./utils/dom.js":445,"./utils/events.js":446,"./utils/fn.js":447,"./utils/guid.js":449,"./utils/log.js":450,"./utils/merge-options.js":451,"./utils/to-title-case.js":455,"global/window":194}],370:[function(require,module,exports){
arguments[4][225][0].apply(exports,arguments)
},{"../../component.js":369,"../track-button.js":400,"./audio-track-menu-item.js":371,"dup":225}],371:[function(require,module,exports){
arguments[4][226][0].apply(exports,arguments)
},{"../../component.js":369,"../../menu/menu-item.js":412,"../../utils/fn.js":447,"dup":226}],372:[function(require,module,exports){
arguments[4][227][0].apply(exports,arguments)
},{"../component.js":369,"./audio-track-controls/audio-track-button.js":370,"./fullscreen-toggle.js":373,"./live-display.js":374,"./mute-toggle.js":375,"./play-toggle.js":376,"./playback-rate-menu/playback-rate-menu-button.js":377,"./progress-control/progress-control.js":382,"./spacer-controls/custom-control-spacer.js":385,"./text-track-controls/captions-button.js":388,"./text-track-controls/chapters-button.js":389,"./text-track-controls/descriptions-button.js":391,"./text-track-controls/subtitles-button.js":393,"./time-controls/current-time-display.js":396,"./time-controls/duration-display.js":397,"./time-controls/remaining-time-display.js":398,"./time-controls/time-divider.js":399,"./volume-control/volume-control.js":402,"./volume-menu-button.js":404,"dup":227}],373:[function(require,module,exports){
arguments[4][228][0].apply(exports,arguments)
},{"../button.js":366,"../component.js":369,"dup":228}],374:[function(require,module,exports){
arguments[4][229][0].apply(exports,arguments)
},{"../component":369,"../utils/dom.js":445,"dup":229}],375:[function(require,module,exports){
arguments[4][230][0].apply(exports,arguments)
},{"../button":366,"../component":369,"../utils/dom.js":445,"dup":230}],376:[function(require,module,exports){
arguments[4][231][0].apply(exports,arguments)
},{"../button.js":366,"../component.js":369,"dup":231}],377:[function(require,module,exports){
arguments[4][232][0].apply(exports,arguments)
},{"../../component.js":369,"../../menu/menu-button.js":411,"../../menu/menu.js":413,"../../utils/dom.js":445,"./playback-rate-menu-item.js":378,"dup":232}],378:[function(require,module,exports){
arguments[4][233][0].apply(exports,arguments)
},{"../../component.js":369,"../../menu/menu-item.js":412,"dup":233}],379:[function(require,module,exports){
arguments[4][234][0].apply(exports,arguments)
},{"../../component.js":369,"../../utils/dom.js":445,"dup":234}],380:[function(require,module,exports){
arguments[4][235][0].apply(exports,arguments)
},{"../../component.js":369,"../../utils/computed-style.js":444,"../../utils/dom.js":445,"../../utils/fn.js":447,"../../utils/format-time.js":448,"dup":235}],381:[function(require,module,exports){
arguments[4][236][0].apply(exports,arguments)
},{"../../component.js":369,"../../utils/fn.js":447,"../../utils/format-time.js":448,"dup":236}],382:[function(require,module,exports){
arguments[4][237][0].apply(exports,arguments)
},{"../../component.js":369,"./mouse-time-display.js":380,"./seek-bar.js":383,"dup":237}],383:[function(require,module,exports){
arguments[4][238][0].apply(exports,arguments)
},{"../../component.js":369,"../../slider/slider.js":421,"../../utils/computed-style.js":444,"../../utils/fn.js":447,"../../utils/format-time.js":448,"./load-progress-bar.js":379,"./play-progress-bar.js":381,"./tooltip-progress-bar.js":384,"dup":238}],384:[function(require,module,exports){
arguments[4][239][0].apply(exports,arguments)
},{"../../component.js":369,"../../utils/fn.js":447,"../../utils/format-time.js":448,"dup":239}],385:[function(require,module,exports){
arguments[4][240][0].apply(exports,arguments)
},{"../../component.js":369,"./spacer.js":386,"dup":240}],386:[function(require,module,exports){
arguments[4][241][0].apply(exports,arguments)
},{"../../component.js":369,"dup":241}],387:[function(require,module,exports){
arguments[4][242][0].apply(exports,arguments)
},{"../../component.js":369,"./text-track-menu-item.js":395,"dup":242}],388:[function(require,module,exports){
arguments[4][243][0].apply(exports,arguments)
},{"../../component.js":369,"./caption-settings-menu-item.js":387,"./text-track-button.js":394,"dup":243}],389:[function(require,module,exports){
arguments[4][244][0].apply(exports,arguments)
},{"../../component.js":369,"../../utils/to-title-case.js":455,"./chapters-track-menu-item.js":390,"./text-track-button.js":394,"dup":244}],390:[function(require,module,exports){
arguments[4][245][0].apply(exports,arguments)
},{"../../component.js":369,"../../menu/menu-item.js":412,"../../utils/fn.js":447,"dup":245}],391:[function(require,module,exports){
arguments[4][246][0].apply(exports,arguments)
},{"../../component.js":369,"../../utils/fn.js":447,"./text-track-button.js":394,"dup":246}],392:[function(require,module,exports){
arguments[4][247][0].apply(exports,arguments)
},{"../../component.js":369,"./text-track-menu-item.js":395,"dup":247}],393:[function(require,module,exports){
arguments[4][248][0].apply(exports,arguments)
},{"../../component.js":369,"./text-track-button.js":394,"dup":248}],394:[function(require,module,exports){
arguments[4][249][0].apply(exports,arguments)
},{"../../component.js":369,"../track-button.js":400,"./off-text-track-menu-item.js":392,"./text-track-menu-item.js":395,"dup":249}],395:[function(require,module,exports){
arguments[4][250][0].apply(exports,arguments)
},{"../../component.js":369,"../../menu/menu-item.js":412,"../../utils/fn.js":447,"dup":250,"global/document":193,"global/window":194}],396:[function(require,module,exports){
arguments[4][251][0].apply(exports,arguments)
},{"../../component.js":369,"../../utils/dom.js":445,"../../utils/format-time.js":448,"dup":251}],397:[function(require,module,exports){
arguments[4][252][0].apply(exports,arguments)
},{"../../component.js":369,"../../utils/dom.js":445,"../../utils/format-time.js":448,"dup":252}],398:[function(require,module,exports){
arguments[4][253][0].apply(exports,arguments)
},{"../../component.js":369,"../../utils/dom.js":445,"../../utils/format-time.js":448,"dup":253}],399:[function(require,module,exports){
arguments[4][254][0].apply(exports,arguments)
},{"../../component.js":369,"dup":254}],400:[function(require,module,exports){
arguments[4][255][0].apply(exports,arguments)
},{"../component.js":369,"../menu/menu-button.js":411,"../utils/fn.js":447,"dup":255}],401:[function(require,module,exports){
arguments[4][256][0].apply(exports,arguments)
},{"../../component.js":369,"../../slider/slider.js":421,"../../utils/fn.js":447,"./volume-level.js":403,"dup":256}],402:[function(require,module,exports){
arguments[4][257][0].apply(exports,arguments)
},{"../../component.js":369,"./volume-bar.js":401,"dup":257}],403:[function(require,module,exports){
arguments[4][258][0].apply(exports,arguments)
},{"../../component.js":369,"dup":258}],404:[function(require,module,exports){
arguments[4][259][0].apply(exports,arguments)
},{"../component.js":369,"../popup/popup-button.js":417,"../popup/popup.js":418,"../utils/fn.js":447,"./mute-toggle.js":375,"./volume-control/volume-bar.js":401,"dup":259}],405:[function(require,module,exports){
arguments[4][260][0].apply(exports,arguments)
},{"./component":369,"./modal-dialog":414,"./utils/merge-options":451,"dup":260}],406:[function(require,module,exports){
arguments[4][261][0].apply(exports,arguments)
},{"./utils/events.js":446,"dup":261}],407:[function(require,module,exports){
arguments[4][262][0].apply(exports,arguments)
},{"./utils/log":450,"./utils/obj":452,"dup":262}],408:[function(require,module,exports){
arguments[4][263][0].apply(exports,arguments)
},{"dup":263,"global/document":193}],409:[function(require,module,exports){
arguments[4][264][0].apply(exports,arguments)
},{"./component":369,"dup":264}],410:[function(require,module,exports){
arguments[4][265][0].apply(exports,arguments)
},{"./utils/obj":452,"dup":265}],411:[function(require,module,exports){
arguments[4][266][0].apply(exports,arguments)
},{"../clickable-component.js":367,"../component.js":369,"../utils/dom.js":445,"../utils/fn.js":447,"../utils/to-title-case.js":455,"./menu.js":413,"dup":266}],412:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _clickableComponent=require("../clickable-component.js"),_clickableComponent2=_interopRequireDefault(_clickableComponent),_component=require("../component.js"),_component2=_interopRequireDefault(_component),_obj=require("../utils/obj"),MenuItem=function(e){function t(o,n){_classCallCheck(this,t);var r=_possibleConstructorReturn(this,e.call(this,o,n));return r.selectable=n.selectable,r.selected(n.selected),r.selectable?r.el_.setAttribute("role","menuitemcheckbox"):r.el_.setAttribute("role","menuitem"),r}return _inherits(t,e),t.prototype.createEl=function(t,o,n){return this.nonIconControl=!0,e.prototype.createEl.call(this,"li",(0,_obj.assign)({className:"vjs-menu-item",innerHTML:this.localize(this.options_.label),tabIndex:-1},o),n)},t.prototype.handleClick=function(e){this.selected(!0)},t.prototype.selected=function(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected")):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(" ")))},t}(_clickableComponent2.default);_component2.default.registerComponent("MenuItem",MenuItem),exports.default=MenuItem;
},{"../clickable-component.js":367,"../component.js":369,"../utils/obj":452}],413:[function(require,module,exports){
arguments[4][268][0].apply(exports,arguments)
},{"../component.js":369,"../utils/dom.js":445,"../utils/events.js":446,"../utils/fn.js":447,"dup":268}],414:[function(require,module,exports){
arguments[4][269][0].apply(exports,arguments)
},{"./component":369,"./utils/dom":445,"./utils/fn":447,"dup":269}],415:[function(require,module,exports){
"use strict";function _interopRequireWildcard(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}exports.__esModule=!0;var _component=require("./component.js"),_component2=_interopRequireDefault(_component),_document=require("global/document"),_document2=_interopRequireDefault(_document),_window=require("global/window"),_window2=_interopRequireDefault(_window),_events=require("./utils/events.js"),Events=_interopRequireWildcard(_events),_dom=require("./utils/dom.js"),Dom=_interopRequireWildcard(_dom),_fn=require("./utils/fn.js"),Fn=_interopRequireWildcard(_fn),_guid=require("./utils/guid.js"),Guid=_interopRequireWildcard(_guid),_browser=require("./utils/browser.js"),browser=_interopRequireWildcard(_browser),_log=require("./utils/log.js"),_log2=_interopRequireDefault(_log),_toTitleCase=require("./utils/to-title-case.js"),_toTitleCase2=_interopRequireDefault(_toTitleCase),_timeRanges=require("./utils/time-ranges.js"),_buffer=require("./utils/buffer.js"),_stylesheet=require("./utils/stylesheet.js"),stylesheet=_interopRequireWildcard(_stylesheet),_fullscreenApi=require("./fullscreen-api.js"),_fullscreenApi2=_interopRequireDefault(_fullscreenApi),_mediaError=require("./media-error.js"),_mediaError2=_interopRequireDefault(_mediaError),_tuple=require("safe-json-parse/tuple"),_tuple2=_interopRequireDefault(_tuple),_obj=require("./utils/obj"),_mergeOptions=require("./utils/merge-options.js"),_mergeOptions2=_interopRequireDefault(_mergeOptions),_textTrackListConverter=require("./tracks/text-track-list-converter.js"),_textTrackListConverter2=_interopRequireDefault(_textTrackListConverter),_modalDialog=require("./modal-dialog"),_modalDialog2=_interopRequireDefault(_modalDialog),_tech=require("./tech/tech.js"),_tech2=_interopRequireDefault(_tech),_audioTrackList=require("./tracks/audio-track-list.js"),_audioTrackList2=_interopRequireDefault(_audioTrackList),_videoTrackList=require("./tracks/video-track-list.js"),_videoTrackList2=_interopRequireDefault(_videoTrackList);require("./tech/loader.js"),require("./tech/flash.js"),require("./poster-image.js"),require("./tracks/text-track-display.js"),require("./loading-spinner.js"),require("./big-play-button.js"),require("./close-button.js"),require("./control-bar/control-bar.js"),require("./error-display.js"),require("./tracks/text-track-settings.js"),require("./tech/html5.js");var TECH_EVENTS_RETRIGGER=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","ratechange","volumechange","texttrackchange"],Player=function(t){function e(i,s,r){if(_classCallCheck(this,e),i.id=i.id||"vjs_video_"+Guid.newGUID(),s=(0,_obj.assign)(e.getTagSettings(i),s),s.initChildren=!1,s.createEl=!1,s.reportTouchActivity=!1,!s.language)if("function"==typeof i.closest){var o=i.closest("[lang]");o&&(s.language=o.getAttribute("lang"))}else for(var n=i;n&&1===n.nodeType;){if(Dom.getElAttributes(n).hasOwnProperty("lang")){s.language=n.getAttribute("lang");break}n=n.parentNode}var h=_possibleConstructorReturn(this,t.call(this,null,s,r));if(!h.options_||!h.options_.techOrder||!h.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");h.tag=i,h.tagAttributes=i&&Dom.getElAttributes(i),h.language(h.options_.language),s.languages?!function(){var t={};Object.getOwnPropertyNames(s.languages).forEach(function(e){t[e.toLowerCase()]=s.languages[e]}),h.languages_=t}():h.languages_=e.prototype.options_.languages,h.cache_={},h.poster_=s.poster||"",h.controls_=!!s.controls,i.controls=!1,h.scrubbing_=!1,h.el_=h.createEl();var a=(0,_mergeOptions2.default)(h.options_);return s.plugins&&!function(){var t=s.plugins;Object.getOwnPropertyNames(t).forEach(function(e){"function"==typeof this[e]?this[e](t[e]):_log2.default.error("Unable to find plugin:",e)},h)}(),h.options_.playerOptions=a,h.initChildren(),h.isAudio("audio"===i.nodeName.toLowerCase()),h.controls()?h.addClass("vjs-controls-enabled"):h.addClass("vjs-controls-disabled"),h.el_.setAttribute("role","region"),h.isAudio()?h.el_.setAttribute("aria-label","audio player"):h.el_.setAttribute("aria-label","video player"),h.isAudio()&&h.addClass("vjs-audio"),h.flexNotSupported_()&&h.addClass("vjs-no-flex"),browser.IS_IOS||h.addClass("vjs-workinghover"),e.players[h.id_]=h,h.userActive(!0),h.reportUserActivity(),h.listenForUserActivity_(),h.on("fullscreenchange",h.handleFullscreenChange_),h.on("stageclick",h.handleStageClick_),h}return _inherits(e,t),e.prototype.dispose=function(){this.trigger("dispose"),this.off("dispose"),this.styleEl_&&this.styleEl_.parentNode&&this.styleEl_.parentNode.removeChild(this.styleEl_),e.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&this.tech_.dispose(),t.prototype.dispose.call(this)},e.prototype.createEl=function(){var e=this.tag,i=void 0,s=this.playerElIngest_=e.parentNode&&e.parentNode.hasAttribute&&e.parentNode.hasAttribute("data-vjs-player");i=s?this.el_=e.parentNode:this.el_=t.prototype.createEl.call(this,"div"),e.setAttribute("tabindex","-1"),e.removeAttribute("width"),e.removeAttribute("height");var r=Dom.getElAttributes(e);if(Object.getOwnPropertyNames(r).forEach(function(t){"class"===t?i.className+=" "+r[t]:i.setAttribute(t,r[t])}),e.playerId=e.id,e.id+="_html5_api",e.className="vjs-tech",e.player=i.player=this,this.addClass("vjs-paused"),_window2.default.VIDEOJS_NO_DYNAMIC_STYLE!==!0){this.styleEl_=stylesheet.createStyleElement("vjs-styles-dimensions");var o=Dom.$(".vjs-styles-defaults"),n=Dom.$("head");n.insertBefore(this.styleEl_,o?o.nextSibling:n.firstChild)}this.width(this.options_.width),this.height(this.options_.height),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio);for(var h=e.getElementsByTagName("a"),a=0;a<h.length;a++){var l=h.item(a);Dom.addElClass(l,"vjs-hidden"),l.setAttribute("hidden","hidden")}return e.initNetworkState_=e.networkState,e.parentNode&&!s&&e.parentNode.insertBefore(i,e),Dom.insertElFirst(e,i),this.children_.unshift(e),this.el_=i,i},e.prototype.width=function(t){return this.dimension("width",t)},e.prototype.height=function(t){return this.dimension("height",t)},e.prototype.dimension=function(t,e){var i=t+"_";if(void 0===e)return this[i]||0;if(""===e)this[i]=void 0;else{var s=parseFloat(e);if(isNaN(s))return _log2.default.error('Improper value "'+e+'" supplied for for '+t),this;this[i]=s}return this.updateStyleEl_(),this},e.prototype.fluid=function(t){return void 0===t?!!this.fluid_:(this.fluid_=!!t,t?this.addClass("vjs-fluid"):this.removeClass("vjs-fluid"),void this.updateStyleEl_())},e.prototype.aspectRatio=function(t){if(void 0===t)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(t))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=t,this.fluid(!0),this.updateStyleEl_()},e.prototype.updateStyleEl_=function(){if(_window2.default.VIDEOJS_NO_DYNAMIC_STYLE===!0){var t="number"==typeof this.width_?this.width_:this.options_.width,e="number"==typeof this.height_?this.height_:this.options_.height,i=this.tech_&&this.tech_.el();return void(i&&(t>=0&&(i.width=t),e>=0&&(i.height=e)))}var s=void 0,r=void 0,o=void 0,n=void 0;o=void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:this.videoWidth()>0?this.videoWidth()+":"+this.videoHeight():"16:9";var h=o.split(":"),a=h[1]/h[0];s=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/a:this.videoWidth()||300,r=void 0!==this.height_?this.height_:s*a,n=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(n),stylesheet.setTextContent(this.styleEl_,"\n      ."+n+" {\n        width: "+s+"px;\n        height: "+r+"px;\n      }\n\n      ."+n+".vjs-fluid {\n        padding-top: "+100*a+"%;\n      }\n    ")},e.prototype.loadTech_=function(t,e){var i=this;this.tech_&&this.unloadTech_(),"Html5"!==t&&this.tag&&(_tech2.default.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=t,this.isReady_=!1;var s=(0,_obj.assign)({source:e,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+t+"_api",videoTracks:this.videoTracks_,textTracks:this.textTracks_,audioTracks:this.audioTracks_,autoplay:this.options_.autoplay,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"]},this.options_[t.toLowerCase()]);this.tag&&(s.tag=this.tag),e&&(this.currentType_=e.type,e.src===this.cache_.src&&this.cache_.currentTime>0&&(s.startTime=this.cache_.currentTime),this.cache_.sources=null,this.cache_.source=e,this.cache_.src=e.src);var r=_tech2.default.getTech(t);r||(r=_component2.default.getComponent(t)),this.tech_=new r(s),this.tech_.ready(Fn.bind(this,this.handleTechReady_),!0),_textTrackListConverter2.default.jsonToTextTracks(this.textTracksJson_||[],this.tech_),TECH_EVENTS_RETRIGGER.forEach(function(t){i.on(i.tech_,t,i["handleTech"+(0,_toTitleCase2.default)(t)+"_"])}),this.on(this.tech_,"loadstart",this.handleTechLoadStart_),this.on(this.tech_,"waiting",this.handleTechWaiting_),this.on(this.tech_,"canplay",this.handleTechCanPlay_),this.on(this.tech_,"canplaythrough",this.handleTechCanPlayThrough_),this.on(this.tech_,"playing",this.handleTechPlaying_),this.on(this.tech_,"ended",this.handleTechEnded_),this.on(this.tech_,"seeking",this.handleTechSeeking_),this.on(this.tech_,"seeked",this.handleTechSeeked_),this.on(this.tech_,"play",this.handleTechPlay_),this.on(this.tech_,"firstplay",this.handleTechFirstPlay_),this.on(this.tech_,"pause",this.handleTechPause_),this.on(this.tech_,"durationchange",this.handleTechDurationChange_),this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_),this.on(this.tech_,"error",this.handleTechError_),this.on(this.tech_,"loadedmetadata",this.updateStyleEl_),this.on(this.tech_,"posterchange",this.handleTechPosterChange_),this.on(this.tech_,"textdata",this.handleTechTextData_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||"Html5"===t&&this.tag||Dom.insertElFirst(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},e.prototype.unloadTech_=function(){this.videoTracks_=this.videoTracks(),this.textTracks_=this.textTracks(),this.audioTracks_=this.audioTracks(),this.textTracksJson_=_textTrackListConverter2.default.textTracksToJson(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1},e.prototype.tech=function(t){if(t&&t.IWillNotUseThisInPlugins)return this.tech_;var e="\n      Please make sure that you are not using this inside of a plugin.\n      To disable this alert and error, please pass in an object with\n      `IWillNotUseThisInPlugins` to the `tech` method. See\n      https://github.com/videojs/video.js/issues/2617 for more info.\n    ";throw _window2.default.alert(e),new Error(e)},e.prototype.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"mousedown",this.handleTechClick_),this.on(this.tech_,"touchstart",this.handleTechTouchStart_),this.on(this.tech_,"touchmove",this.handleTechTouchMove_),this.on(this.tech_,"touchend",this.handleTechTouchEnd_),this.on(this.tech_,"tap",this.handleTechTap_)},e.prototype.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.handleTechTap_),this.off(this.tech_,"touchstart",this.handleTechTouchStart_),this.off(this.tech_,"touchmove",this.handleTechTouchMove_),this.off(this.tech_,"touchend",this.handleTechTouchEnd_),this.off(this.tech_,"mousedown",this.handleTechClick_)},e.prototype.handleTechReady_=function(){if(this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_(),(this.src()||this.currentSrc())&&this.tag&&this.options_.autoplay&&this.paused()){try{delete this.tag.poster}catch(t){(0,_log2.default)("deleting tag.poster throws in some browsers",t)}this.play()}},e.prototype.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-seeking"),this.error(null),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay"))},e.prototype.hasStarted=function(t){return void 0!==t?(this.hasStarted_!==t&&(this.hasStarted_=t,t?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started")),this):!!this.hasStarted_},e.prototype.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},e.prototype.handleTechWaiting_=function(){var t=this;this.addClass("vjs-waiting"),this.trigger("waiting"),this.one("timeupdate",function(){return t.removeClass("vjs-waiting")})},e.prototype.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},e.prototype.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},e.prototype.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},e.prototype.handleTechSeeking_=function(){this.addClass("vjs-seeking"),this.trigger("seeking")},e.prototype.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.trigger("seeked")},e.prototype.handleTechFirstPlay_=function(){this.options_.starttime&&(_log2.default.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},e.prototype.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},e.prototype.handleTechEnded_=function(){this.addClass("vjs-ended"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},e.prototype.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},e.prototype.handleTechClick_=function(t){0===t.button&&this.controls()&&(this.paused()?this.play():this.pause())},e.prototype.handleTechTap_=function(){this.userActive(!this.userActive())},e.prototype.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},e.prototype.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},e.prototype.handleTechTouchEnd_=function(t){t.preventDefault()},e.prototype.handleFullscreenChange_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},e.prototype.handleStageClick_=function(){this.reportUserActivity()},e.prototype.handleTechFullscreenChange_=function(t,e){e&&this.isFullscreen(e.isFullscreen),this.trigger("fullscreenchange")},e.prototype.handleTechError_=function(){var t=this.tech_.error();this.error(t)},e.prototype.handleTechTextData_=function(){var t=null;arguments.length>1&&(t=arguments[1]),this.trigger("textdata",t)},e.prototype.getCache=function(){return this.cache_},e.prototype.techCall_=function(t,e){if(this.tech_&&!this.tech_.isReady_)this.tech_.ready(function(){this[t](e)},!0);else try{this.tech_&&this.tech_[t](e)}catch(t){throw(0,_log2.default)(t),t}},e.prototype.techGet_=function(t){if(this.tech_&&this.tech_.isReady_)try{return this.tech_[t]()}catch(e){throw void 0===this.tech_[t]?(0,_log2.default)("Video.js: "+t+" method not defined for "+this.techName_+" playback technology.",e):"TypeError"===e.name?((0,_log2.default)("Video.js: "+t+" unavailable on "+this.techName_+" playback technology element.",e),this.tech_.isReady_=!1):(0,_log2.default)(e),e}},e.prototype.play=function(){return this.src()||this.currentSrc()?this.techCall_("play"):this.tech_.one("loadstart",function(){this.play()}),this},e.prototype.pause=function(){return this.techCall_("pause"),this},e.prototype.paused=function(){return this.techGet_("paused")!==!1},e.prototype.scrubbing=function(t){return void 0!==t?(this.scrubbing_=!!t,t?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing"),this):this.scrubbing_},e.prototype.currentTime=function(t){return void 0!==t?(this.techCall_("setCurrentTime",t),this):(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime)},e.prototype.duration=function(t){return void 0===t?this.cache_.duration||0:(t=parseFloat(t)||0,t<0&&(t=1/0),t!==this.cache_.duration&&(this.cache_.duration=t,t===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),this.trigger("durationchange")),this)},e.prototype.remainingTime=function(){return this.duration()-this.currentTime()},e.prototype.buffered=function t(){var t=this.techGet_("buffered");return t&&t.length||(t=(0,_timeRanges.createTimeRange)(0,0)),t},e.prototype.bufferedPercent=function(){return(0,_buffer.bufferedPercent)(this.buffered(),this.duration())},e.prototype.bufferedEnd=function(){var t=this.buffered(),e=this.duration(),i=t.end(t.length-1);return i>e&&(i=e),i},e.prototype.volume=function(t){var e=void 0;return void 0!==t?(e=Math.max(0,Math.min(1,parseFloat(t))),this.cache_.volume=e,this.techCall_("setVolume",e),this):(e=parseFloat(this.techGet_("volume")),isNaN(e)?1:e)},e.prototype.muted=function(t){return void 0!==t?(this.techCall_("setMuted",t),this):this.techGet_("muted")||!1},e.prototype.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},e.prototype.isFullscreen=function(t){return void 0!==t?(this.isFullscreen_=!!t,this):!!this.isFullscreen_},e.prototype.requestFullscreen=function(){var t=_fullscreenApi2.default;return this.isFullscreen(!0),t.requestFullscreen?(Events.on(_document2.default,t.fullscreenchange,Fn.bind(this,function e(i){this.isFullscreen(_document2.default[t.fullscreenElement]),this.isFullscreen()===!1&&Events.off(_document2.default,t.fullscreenchange,e),this.trigger("fullscreenchange")})),this.el_[t.requestFullscreen]()):this.tech_.supportsFullScreen()?this.techCall_("enterFullScreen"):(this.enterFullWindow(),this.trigger("fullscreenchange")),this},e.prototype.exitFullscreen=function(){var t=_fullscreenApi2.default;return this.isFullscreen(!1),t.requestFullscreen?_document2.default[t.exitFullscreen]():this.tech_.supportsFullScreen()?this.techCall_("exitFullScreen"):(this.exitFullWindow(),this.trigger("fullscreenchange")),this},e.prototype.enterFullWindow=function(){this.isFullWindow=!0,this.docOrigOverflow=_document2.default.documentElement.style.overflow,Events.on(_document2.default,"keydown",Fn.bind(this,this.fullWindowOnEscKey)),_document2.default.documentElement.style.overflow="hidden",Dom.addElClass(_document2.default.body,"vjs-full-window"),this.trigger("enterFullWindow")},e.prototype.fullWindowOnEscKey=function(t){27===t.keyCode&&(this.isFullscreen()===!0?this.exitFullscreen():this.exitFullWindow())},e.prototype.exitFullWindow=function(){this.isFullWindow=!1,Events.off(_document2.default,"keydown",this.fullWindowOnEscKey),_document2.default.documentElement.style.overflow=this.docOrigOverflow,Dom.removeElClass(_document2.default.body,"vjs-full-window"),this.trigger("exitFullWindow")},e.prototype.canPlayType=function(t){for(var e=void 0,i=0,s=this.options_.techOrder;i<s.length;i++){var r=(0,_toTitleCase2.default)(s[i]),o=_tech2.default.getTech(r);if(o||(o=_component2.default.getComponent(r)),o){if(o.isSupported()&&(e=o.canPlayType(t)))return e}else _log2.default.error('The "'+r+'" tech is undefined. Skipped browser support check for that tech.')}return""},e.prototype.selectSource=function(t){var e=this,i=this.options_.techOrder.map(_toTitleCase2.default).map(function(t){return[t,_tech2.default.getTech(t)||_component2.default.getComponent(t)]}).filter(function(t){var e=t[0],i=t[1];return i?i.isSupported():(_log2.default.error('The "'+e+'" tech is undefined. Skipped browser support check for that tech.'),!1)}),s=function(t,e,i){var s=void 0;return t.some(function(t){return e.some(function(e){if(s=i(t,e))return!0})}),s},r=void 0,o=function(t){return function(e,i){return t(i,e)}},n=function(t,i){var s=t[0],r=t[1];if(r.canPlaySource(i,e.options_[s.toLowerCase()]))return{source:i,tech:s}};return r=this.options_.sourceOrder?s(t,i,o(n)):s(i,t,n),r||!1},e.prototype.src=function(t){if(void 0===t)return this.techGet_("src");var e=_tech2.default.getTech(this.techName_);return e||(e=_component2.default.getComponent(this.techName_)),Array.isArray(t)?this.sourceList_(t):"string"==typeof t?this.src({src:t}):t instanceof Object&&(t.type&&!e.canPlaySource(t,this.options_[this.techName_.toLowerCase()])?this.sourceList_([t]):(this.cache_.sources=null,this.cache_.source=t,this.cache_.src=t.src,this.currentType_=t.type||"",this.ready(function(){e.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",t):this.techCall_("src",t.src),"auto"===this.options_.preload&&this.load(),this.options_.autoplay&&this.play()},!0))),this},e.prototype.sourceList_=function(t){var e=this.selectSource(t);e?(e.tech===this.techName_?this.src(e.source):this.loadTech_(e.tech,e.source),this.cache_.sources=t):(this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0),this.triggerReady())},e.prototype.load=function(){return this.techCall_("load"),this},e.prototype.reset=function(){return this.loadTech_((0,_toTitleCase2.default)(this.options_.techOrder[0]),null),this.techCall_("reset"),this},e.prototype.currentSources=function(){var t=this.currentSource(),e=[];return 0!==Object.keys(t).length&&e.push(t),this.cache_.sources||e},e.prototype.currentSource=function(){var t={},e=this.currentSrc();return e&&(t.src=e),this.cache_.source||t},e.prototype.currentSrc=function(){return this.techGet_("currentSrc")||this.cache_.src||""},e.prototype.currentType=function(){return this.currentType_||""},e.prototype.preload=function(t){return void 0!==t?(this.techCall_("setPreload",t),this.options_.preload=t,this):this.techGet_("preload")},e.prototype.autoplay=function(t){return void 0!==t?(this.techCall_("setAutoplay",t),this.options_.autoplay=t,this):this.techGet_("autoplay",t)},e.prototype.loop=function(t){return void 0!==t?(this.techCall_("setLoop",t),this.options_.loop=t,this):this.techGet_("loop")},e.prototype.poster=function(t){return void 0===t?this.poster_:(t||(t=""),this.poster_=t,this.techCall_("setPoster",t),this.trigger("posterchange"),this)},e.prototype.handleTechPosterChange_=function(){!this.poster_&&this.tech_&&this.tech_.poster&&(this.poster_=this.tech_.poster()||"",this.trigger("posterchange"))},e.prototype.controls=function(t){return void 0!==t?(t=!!t,this.controls_!==t&&(this.controls_=t,this.usingNativeControls()&&this.techCall_("setControls",t),t?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_())),this):!!this.controls_},e.prototype.usingNativeControls=function(t){return void 0!==t?(t=!!t,this.usingNativeControls_!==t&&(this.usingNativeControls_=t,t?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols"))),this):!!this.usingNativeControls_},e.prototype.error=function(t){return void 0===t?this.error_||null:null===t?(this.error_=t,this.removeClass("vjs-error"),this.errorDisplay&&this.errorDisplay.close(),this):(this.error_=new _mediaError2.default(t),this.addClass("vjs-error"),_log2.default.error("(CODE:"+this.error_.code+" "+_mediaError2.default.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this.trigger("error"),this)},e.prototype.reportUserActivity=function(t){this.userActivity_=!0},e.prototype.userActive=function(t){return void 0!==t?(t=!!t,t!==this.userActive_&&(this.userActive_=t,t?(this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive")):(this.userActivity_=!1,this.tech_&&this.tech_.one("mousemove",function(t){t.stopPropagation(),t.preventDefault()}),this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive"))),this):this.userActive_},e.prototype.listenForUserActivity_=function(){var t=void 0,e=void 0,i=void 0,s=Fn.bind(this,this.reportUserActivity),r=function(t){t.screenX===e&&t.screenY===i||(e=t.screenX,i=t.screenY,s())},o=function(){s(),this.clearInterval(t),t=this.setInterval(s,250)},n=function(e){s(),this.clearInterval(t)};this.on("mousedown",o),this.on("mousemove",r),this.on("mouseup",n),this.on("keydown",s),this.on("keyup",s);var h=void 0;this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(h);var t=this.options_.inactivityTimeout;t>0&&(h=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},t))}},250)},e.prototype.playbackRate=function(t){return void 0!==t?(this.techCall_("setPlaybackRate",t),this):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("playbackRate"):1},e.prototype.isAudio=function(t){return void 0!==t?(this.isAudio_=!!t,this):!!this.isAudio_},e.prototype.videoTracks=function(){return this.tech_?this.tech_.videoTracks():(this.videoTracks_=this.videoTracks_||new _videoTrackList2.default,this.videoTracks_)},e.prototype.audioTracks=function(){return this.tech_?this.tech_.audioTracks():(this.audioTracks_=this.audioTracks_||new _audioTrackList2.default,this.audioTracks_)},e.prototype.textTracks=function(){if(this.tech_)return this.tech_.textTracks()},e.prototype.remoteTextTracks=function(){if(this.tech_)return this.tech_.remoteTextTracks()},e.prototype.remoteTextTrackEls=function(){if(this.tech_)return this.tech_.remoteTextTrackEls()},e.prototype.addTextTrack=function(t,e,i){if(this.tech_)return this.tech_.addTextTrack(t,e,i)},e.prototype.addRemoteTextTrack=function(t,e){if(this.tech_)return this.tech_.addRemoteTextTrack(t,e)},e.prototype.removeRemoteTextTrack=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.track,i=void 0===e?arguments[0]:e;if(this.tech_)return this.tech_.removeRemoteTextTrack(i)},e.prototype.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},e.prototype.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},e.prototype.language=function(t){return void 0===t?this.language_:(this.language_=String(t).toLowerCase(),this)},e.prototype.languages=function(){return(0,_mergeOptions2.default)(e.prototype.options_.languages,this.languages_)},e.prototype.toJSON=function(){var t=(0,_mergeOptions2.default)(this.options_),e=t.tracks;t.tracks=[];for(var i=0;i<e.length;i++){var s=e[i];s=(0,_mergeOptions2.default)(s),s.player=void 0,t.tracks[i]=s}return t},e.prototype.createModal=function(t,e){var i=this;e=e||{},e.content=t||"";var s=new _modalDialog2.default(this,e);return this.addChild(s),s.on("dispose",function(){i.removeChild(s)}),s.open()},e.getTagSettings=function(t){var e={sources:[],tracks:[]},i=Dom.getElAttributes(t),s=i["data-setup"];if(Dom.hasElClass(t,"vjs-fluid")&&(i.fluid=!0),null!==s){var r=(0,_tuple2.default)(s||"{}"),o=r[0],n=r[1];o&&_log2.default.error(o),(0,_obj.assign)(i,n)}if((0,_obj.assign)(e,i),t.hasChildNodes())for(var h=t.childNodes,a=0,l=h.length;a<l;a++){var c=h[a],u=c.nodeName.toLowerCase();"source"===u?e.sources.push(Dom.getElAttributes(c)):"track"===u&&e.tracks.push(Dom.getElAttributes(c))}return e},e.prototype.flexNotSupported_=function(){var t=_document2.default.createElement("i");return!("flexBasis"in t.style||"webkitFlexBasis"in t.style||"mozFlexBasis"in t.style||"msFlexBasis"in t.style||"msFlexOrder"in t.style)},e}(_component2.default);Player.players={};var navigator=_window2.default.navigator;Player.prototype.options_={techOrder:["html5","flash"],html5:{},flash:{},defaultVolume:0,inactivityTimeout:2e3,playbackRates:[],children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","controlBar","errorDisplay","textTrackSettings"],language:navigator&&(navigator.languages&&navigator.languages[0]||navigator.userLanguage||navigator.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media."},["ended","seeking","seekable","networkState","readyState"].forEach(function(t){Player.prototype[t]=function(){return this.techGet_(t)}}),TECH_EVENTS_RETRIGGER.forEach(function(t){Player.prototype["handleTech"+(0,_toTitleCase2.default)(t)+"_"]=function(){return this.trigger(t)}}),_component2.default.registerComponent("Player",Player),exports.default=Player;
},{"./big-play-button.js":365,"./close-button.js":368,"./component.js":369,"./control-bar/control-bar.js":372,"./error-display.js":405,"./fullscreen-api.js":408,"./loading-spinner.js":409,"./media-error.js":410,"./modal-dialog":414,"./poster-image.js":419,"./tech/flash.js":423,"./tech/html5.js":424,"./tech/loader.js":425,"./tech/tech.js":426,"./tracks/audio-track-list.js":427,"./tracks/text-track-display.js":432,"./tracks/text-track-list-converter.js":433,"./tracks/text-track-settings.js":435,"./tracks/video-track-list.js":440,"./utils/browser.js":442,"./utils/buffer.js":443,"./utils/dom.js":445,"./utils/events.js":446,"./utils/fn.js":447,"./utils/guid.js":449,"./utils/log.js":450,"./utils/merge-options.js":451,"./utils/obj":452,"./utils/stylesheet.js":453,"./utils/time-ranges.js":454,"./utils/to-title-case.js":455,"global/document":193,"global/window":194,"safe-json-parse/tuple":213}],416:[function(require,module,exports){
arguments[4][271][0].apply(exports,arguments)
},{"./player.js":415,"dup":271}],417:[function(require,module,exports){
arguments[4][272][0].apply(exports,arguments)
},{"../clickable-component.js":367,"../component.js":369,"dup":272}],418:[function(require,module,exports){
arguments[4][273][0].apply(exports,arguments)
},{"../component.js":369,"../utils/dom.js":445,"../utils/events.js":446,"../utils/fn.js":447,"dup":273}],419:[function(require,module,exports){
arguments[4][274][0].apply(exports,arguments)
},{"./clickable-component.js":367,"./component.js":369,"./utils/browser.js":442,"./utils/dom.js":445,"./utils/fn.js":447,"dup":274}],420:[function(require,module,exports){
arguments[4][275][0].apply(exports,arguments)
},{"./utils/dom":445,"./utils/events.js":446,"dup":275,"global/document":193,"global/window":194}],421:[function(require,module,exports){
arguments[4][276][0].apply(exports,arguments)
},{"../component.js":369,"../utils/dom.js":445,"../utils/obj":452,"dup":276}],422:[function(require,module,exports){
arguments[4][277][0].apply(exports,arguments)
},{"dup":277}],423:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _createSetter(e){var t=e.charAt(0).toUpperCase()+e.slice(1);_api["set"+t]=function(t){return this.el_.vjs_setProperty(e,t)}}function _createGetter(e){_api[e]=function(){return this.el_.vjs_getProperty(e)}}exports.__esModule=!0;for(var _tech=require("./tech"),_tech2=_interopRequireDefault(_tech),_dom=require("../utils/dom.js"),Dom=_interopRequireWildcard(_dom),_url=require("../utils/url.js"),Url=_interopRequireWildcard(_url),_timeRanges=require("../utils/time-ranges.js"),_flashRtmp=require("./flash-rtmp"),_flashRtmp2=_interopRequireDefault(_flashRtmp),_component=require("../component"),_component2=_interopRequireDefault(_component),_window=require("global/window"),_window2=_interopRequireDefault(_window),_obj=require("../utils/obj"),navigator=_window2.default.navigator,Flash=function(e){function t(r,o){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,e.call(this,r,o));return r.source&&n.ready(function(){this.setSource(r.source)},!0),r.startTime&&n.ready(function(){this.load(),this.play(),this.currentTime(r.startTime)},!0),_window2.default.videojs=_window2.default.videojs||{},_window2.default.videojs.Flash=_window2.default.videojs.Flash||{},_window2.default.videojs.Flash.onReady=t.onReady,_window2.default.videojs.Flash.onEvent=t.onEvent,_window2.default.videojs.Flash.onError=t.onError,n.on("seeked",function(){this.lastSeekTarget_=void 0}),n}return _inherits(t,e),t.prototype.createEl=function(){var e=this.options_;if(!e.swf){var r="5.2.0";e.swf="//vjs.zencdn.net/swf/"+r+"/video-js.swf"}var o=e.techId,n=(0,_obj.assign)({readyFunction:"videojs.Flash.onReady",eventProxyFunction:"videojs.Flash.onEvent",errorEventProxyFunction:"videojs.Flash.onError",autoplay:e.autoplay,preload:e.preload,loop:e.loop,muted:e.muted},e.flashVars),a=(0,_obj.assign)({wmode:"opaque",bgcolor:"#000000"},e.params),i=(0,_obj.assign)({id:o,name:o,class:"vjs-tech"},e.attributes);return this.el_=t.embed(e.swf,n,a,i),this.el_.tech=this,this.el_},t.prototype.play=function(){this.ended()&&this.setCurrentTime(0),this.el_.vjs_play()},t.prototype.pause=function(){this.el_.vjs_pause()},t.prototype.src=function(e){return void 0===e?this.currentSrc():this.setSrc(e)},t.prototype.setSrc=function(e){var t=this;e=Url.getAbsoluteURL(e),this.el_.vjs_src(e),this.autoplay()&&this.setTimeout(function(){return t.play()},0)},t.prototype.seeking=function(){return void 0!==this.lastSeekTarget_},t.prototype.setCurrentTime=function(t){var r=this.seekable();r.length&&(t=t>r.start(0)?t:r.start(0),t=t<r.end(r.length-1)?t:r.end(r.length-1),this.lastSeekTarget_=t,this.trigger("seeking"),this.el_.vjs_setProperty("currentTime",t),e.prototype.setCurrentTime.call(this))},t.prototype.currentTime=function(){return this.seeking()?this.lastSeekTarget_||0:this.el_.vjs_getProperty("currentTime")},t.prototype.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.vjs_getProperty("currentSrc")},t.prototype.duration=function e(){if(0===this.readyState())return NaN;var e=this.el_.vjs_getProperty("duration");return e>=0?e:1/0},t.prototype.load=function(){this.el_.vjs_load()},t.prototype.poster=function(){this.el_.vjs_getProperty("poster")},t.prototype.setPoster=function(){},t.prototype.seekable=function(){var e=this.duration();return 0===e?(0,_timeRanges.createTimeRange)():(0,_timeRanges.createTimeRange)(0,e)},t.prototype.buffered=function(){var e=this.el_.vjs_getProperty("buffered");return 0===e.length?(0,_timeRanges.createTimeRange)():(0,_timeRanges.createTimeRange)(e[0][0],e[0][1])},t.prototype.supportsFullScreen=function(){return!1},t.prototype.enterFullScreen=function(){return!1},t}(_tech2.default),_api=Flash.prototype,_readWrite="rtmpConnection,rtmpStream,preload,defaultPlaybackRate,playbackRate,autoplay,loop,mediaGroup,controller,controls,volume,muted,defaultMuted".split(","),_readOnly="networkState,readyState,initialTime,startOffsetTime,paused,ended,videoWidth,videoHeight".split(","),i=0;i<_readWrite.length;i++)_createGetter(_readWrite[i]),_createSetter(_readWrite[i]);for(var _i=0;_i<_readOnly.length;_i++)_createGetter(_readOnly[_i]);Flash.isSupported=function(){return Flash.version()[0]>=10},_tech2.default.withSourceHandlers(Flash),Flash.nativeSourceHandler={},Flash.nativeSourceHandler.canPlayType=function(e){return e in Flash.formats?"maybe":""},Flash.nativeSourceHandler.canHandleSource=function(e,t){function r(e){var t=Url.getFileExtension(e);return t?"video/"+t:""}var o=void 0;return o=e.type?e.type.replace(/;.*/,"").toLowerCase():r(e.src),Flash.nativeSourceHandler.canPlayType(o)},Flash.nativeSourceHandler.handleSource=function(e,t,r){t.setSrc(e.src)},Flash.nativeSourceHandler.dispose=function(){},Flash.registerSourceHandler(Flash.nativeSourceHandler),Flash.formats={"video/flv":"FLV","video/x-flv":"FLV","video/mp4":"MP4","video/m4v":"MP4"},Flash.onReady=function(e){var t=Dom.getEl(e),r=t&&t.tech;r&&r.el()&&Flash.checkReady(r)},Flash.checkReady=function(e){e.el()&&(e.el().vjs_getProperty?e.triggerReady():this.setTimeout(function(){Flash.checkReady(e)},50))},Flash.onEvent=function(e,t){var r=Dom.getEl(e).tech,o=Array.prototype.slice.call(arguments,2);r.setTimeout(function(){r.trigger(t,o)},1)},Flash.onError=function(e,t){var r=Dom.getEl(e).tech;return"srcnotfound"===t?r.error(4):void r.error("FLASH: "+t)},Flash.version=function(){var e="0,0,0";try{e=new _window2.default.ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(t){try{navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin&&(e=(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1])}catch(e){}}return e.split(",")},Flash.embed=function(e,t,r,o){var n=Flash.getEmbedCode(e,t,r,o),a=Dom.createEl("div",{innerHTML:n}).childNodes[0];return a},Flash.getEmbedCode=function(e,t,r,o){var n='<object type="application/x-shockwave-flash" ',a="",i="",s="";return t&&Object.getOwnPropertyNames(t).forEach(function(e){a+=e+"="+t[e]+"&amp;"}),r=(0,_obj.assign)({movie:e,flashvars:a,allowScriptAccess:"always",allowNetworking:"all"},r),Object.getOwnPropertyNames(r).forEach(function(e){i+='<param name="'+e+'" value="'+r[e]+'" />'}),o=(0,_obj.assign)({data:e,width:"100%",height:"100%"},o),Object.getOwnPropertyNames(o).forEach(function(e){s+=e+'="'+o[e]+'" '}),""+n+s+">"+i+"</object>"},(0,_flashRtmp2.default)(Flash),_component2.default.registerComponent("Flash",Flash),_tech2.default.registerTech("Flash",Flash),exports.default=Flash;
},{"../component":369,"../utils/dom.js":445,"../utils/obj":452,"../utils/time-ranges.js":454,"../utils/url.js":456,"./flash-rtmp":422,"./tech":426,"global/window":194}],424:[function(require,module,exports){
arguments[4][279][0].apply(exports,arguments)
},{"../component":369,"../utils/browser.js":442,"../utils/dom.js":445,"../utils/fn.js":447,"../utils/log.js":450,"../utils/merge-options.js":451,"../utils/obj":452,"../utils/to-title-case.js":455,"../utils/url.js":456,"./tech.js":426,"dup":279,"global/document":193,"global/window":194,"tsml":218}],425:[function(require,module,exports){
arguments[4][280][0].apply(exports,arguments)
},{"../component.js":369,"../utils/to-title-case.js":455,"./tech.js":426,"dup":280}],426:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function createTrackHelper(e,t,r,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},n=e.textTracks();i.kind=t,r&&(i.label=r),o&&(i.language=o),i.tech=e;var a=new _textTrack2.default(i);return n.addTrack_(a),a}exports.__esModule=!0;var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_component=require("../component"),_component2=_interopRequireDefault(_component),_htmlTrackElement=require("../tracks/html-track-element"),_htmlTrackElement2=_interopRequireDefault(_htmlTrackElement),_htmlTrackElementList=require("../tracks/html-track-element-list"),_htmlTrackElementList2=_interopRequireDefault(_htmlTrackElementList),_mergeOptions=require("../utils/merge-options.js"),_mergeOptions2=_interopRequireDefault(_mergeOptions),_textTrack=require("../tracks/text-track"),_textTrack2=_interopRequireDefault(_textTrack),_textTrackList=require("../tracks/text-track-list"),_textTrackList2=_interopRequireDefault(_textTrackList),_videoTrackList=require("../tracks/video-track-list"),_videoTrackList2=_interopRequireDefault(_videoTrackList),_audioTrackList=require("../tracks/audio-track-list"),_audioTrackList2=_interopRequireDefault(_audioTrackList),_fn=require("../utils/fn.js"),Fn=_interopRequireWildcard(_fn),_log=require("../utils/log.js"),_log2=_interopRequireDefault(_log),_timeRanges=require("../utils/time-ranges.js"),_buffer=require("../utils/buffer.js"),_mediaError=require("../media-error.js"),_mediaError2=_interopRequireDefault(_mediaError),_window=require("global/window"),_window2=_interopRequireDefault(_window),_document=require("global/document"),_document2=_interopRequireDefault(_document),_obj=require("../utils/obj"),Tech=function(e){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};_classCallCheck(this,t),r.reportTouchActivity=!1;var i=_possibleConstructorReturn(this,e.call(this,null,r,o));return i.hasStarted_=!1,i.on("playing",function(){this.hasStarted_=!0}),i.on("loadstart",function(){this.hasStarted_=!1}),i.textTracks_=r.textTracks,i.videoTracks_=r.videoTracks,i.audioTracks_=r.audioTracks,i.featuresProgressEvents||i.manualProgressOn(),i.featuresTimeupdateEvents||i.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(function(e){r["native"+e+"Tracks"]===!1&&(i["featuresNative"+e+"Tracks"]=!1)}),r.nativeCaptions===!1&&(i.featuresNativeTextTracks=!1),i.featuresNativeTextTracks||i.emulateTextTracks(),i.autoRemoteTextTracks_=new _textTrackList2.default,i.initTextTrackListeners(),i.initTrackListeners(),r.nativeControlsForTouch||i.emitTapEvents(),i.constructor&&(i.name_=i.constructor.name||"Unknown Tech"),i}return _inherits(t,e),t.prototype.manualProgressOn=function(){this.on("durationchange",this.onDurationChange),this.manualProgress=!0,this.one("ready",this.trackProgress)},t.prototype.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange)},t.prototype.trackProgress=function(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(Fn.bind(this,function(){var e=this.bufferedPercent();this.bufferedPercent_!==e&&this.trigger("progress"),this.bufferedPercent_=e,1===e&&this.stopTrackingProgress()}),500)},t.prototype.onDurationChange=function(e){this.duration_=this.duration()},t.prototype.buffered=function(){return(0,_timeRanges.createTimeRange)(0,0)},t.prototype.bufferedPercent=function(){return(0,_buffer.bufferedPercent)(this.buffered(),this.duration_)},t.prototype.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},t.prototype.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime),this.on("pause",this.stopTrackingCurrentTime)},t.prototype.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime),this.off("pause",this.stopTrackingCurrentTime)},t.prototype.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)},t.prototype.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},t.prototype.dispose=function(){this.clearTracks(["audio","video","text"]),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),e.prototype.dispose.call(this)},t.prototype.clearTracks=function(e){var t=this;e=[].concat(e),e.forEach(function(e){for(var r=t[e+"Tracks"]()||[],o=r.length;o--;){var i=r[o];"text"===e&&t.removeRemoteTextTrack(i),r.removeTrack_(i)}})},t.prototype.cleanupAutoTextTracks=function(){for(var e=this.autoRemoteTextTracks_||[],t=e.length;t--;){var r=e[t];this.removeRemoteTextTrack(r)}},t.prototype.reset=function(){},t.prototype.error=function(e){return void 0!==e&&(this.error_=new _mediaError2.default(e),this.trigger("error")),this.error_},t.prototype.played=function(){return this.hasStarted_?(0,_timeRanges.createTimeRange)(0,0):(0,_timeRanges.createTimeRange)()},t.prototype.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},t.prototype.initTextTrackListeners=function(){var e=Fn.bind(this,function(){this.trigger("texttrackchange")}),t=this.textTracks();t&&(t.addEventListener("removetrack",e),t.addEventListener("addtrack",e),this.on("dispose",Fn.bind(this,function(){t.removeEventListener("removetrack",e),t.removeEventListener("addtrack",e)})))},t.prototype.initTrackListeners=function(){var e=this,t=["video","audio"];t.forEach(function(t){var r=function(){e.trigger(t+"trackchange")},o=e[t+"Tracks"]();o.addEventListener("removetrack",r),o.addEventListener("addtrack",r),e.on("dispose",function(){o.removeEventListener("removetrack",r),o.removeEventListener("addtrack",r)})})},t.prototype.addWebVttScript_=function(){var e=this;if(!_window2.default.WebVTT)if(null!==this.el().parentNode&&void 0!==this.el().parentNode){var t=function(){var t=require("videojs-vtt.js");if(!e.options_["vtt.js"]&&(0,_obj.isPlain)(t)&&Object.keys(t).length>0)return e.trigger("vttjsloaded"),{v:void 0};var r=_document2.default.createElement("script");r.src=e.options_["vtt.js"]||"https://cdn.rawgit.com/gkatsev/vtt.js/vjs-v0.12.1/dist/vtt.min.js",r.onload=function(){e.trigger("vttjsloaded")},r.onerror=function(){e.trigger("vttjserror")},e.on("dispose",function(){r.onload=null,r.onerror=null}),_window2.default.WebVTT=!0,e.el().parentNode.appendChild(r)}();if("object"===("undefined"==typeof t?"undefined":_typeof(t)))return t.v}else this.ready(this.addWebVttScript_)},t.prototype.emulateTextTracks=function(){var e=this,t=this.textTracks();if(t){var r=this.remoteTextTracks(),o=function(e){return t.addTrack_(e.track)},i=function(e){return t.removeTrack_(e.track)};r.on("addtrack",o),r.on("removetrack",i),this.addWebVttScript_();var n=function(){return e.trigger("texttrackchange")},a=function(){n();for(var e=0;e<t.length;e++){var r=t[e];r.removeEventListener("cuechange",n),"showing"===r.mode&&r.addEventListener("cuechange",n)}};a(),t.addEventListener("change",a),this.on("dispose",function(){r.off("addtrack",o),r.off("removetrack",i),t.removeEventListener("change",a);for(var e=0;e<t.length;e++){var s=t[e];s.removeEventListener("cuechange",n)}})}},t.prototype.videoTracks=function(){return this.videoTracks_=this.videoTracks_||new _videoTrackList2.default,this.videoTracks_},t.prototype.audioTracks=function(){return this.audioTracks_=this.audioTracks_||new _audioTrackList2.default,this.audioTracks_},t.prototype.textTracks=function(){return this.textTracks_=this.textTracks_||new _textTrackList2.default,this.textTracks_},t.prototype.remoteTextTracks=function(){return this.remoteTextTracks_=this.remoteTextTracks_||new _textTrackList2.default,this.remoteTextTracks_},t.prototype.remoteTextTrackEls=function(){return this.remoteTextTrackEls_=this.remoteTextTrackEls_||new _htmlTrackElementList2.default,this.remoteTextTrackEls_},t.prototype.addTextTrack=function(e,t,r){if(!e)throw new Error("TextTrack kind is required but was not provided");return createTrackHelper(this,e,t,r)},t.prototype.createRemoteTextTrack=function(e){var t=(0,_mergeOptions2.default)(e,{tech:this});return new _htmlTrackElement2.default(t)},t.prototype.addRemoteTextTrack=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],r=this.createRemoteTextTrack(e);return t!==!0&&t!==!1&&(_log2.default.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),t=!0),this.remoteTextTrackEls().addTrackElement_(r),this.remoteTextTracks().addTrack_(r.track),t!==!0&&this.autoRemoteTextTracks_.addTrack_(r.track),r},t.prototype.removeRemoteTextTrack=function(e){var t=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(t),this.remoteTextTracks().removeTrack_(e),this.autoRemoteTextTracks_.removeTrack_(e)},t.prototype.setPoster=function(){},t.prototype.canPlayType=function(){return""},t.isTech=function(e){return e.prototype instanceof t||e instanceof t||e===t},t.registerTech=function(e,r){if(t.techs_||(t.techs_={}),!t.isTech(r))throw new Error("Tech "+e+" must be a Tech");return t.techs_[e]=r,r},t.getTech=function(e){return t.techs_&&t.techs_[e]?t.techs_[e]:_window2.default&&_window2.default.videojs&&_window2.default.videojs[e]?(_log2.default.warn("The "+e+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),_window2.default.videojs[e]):void 0},t}(_component2.default);Tech.prototype.textTracks_,Tech.prototype.audioTracks_,Tech.prototype.videoTracks_,Tech.prototype.featuresVolumeControl=!0,Tech.prototype.featuresFullscreenResize=!1,Tech.prototype.featuresPlaybackRate=!1,Tech.prototype.featuresProgressEvents=!1,Tech.prototype.featuresTimeupdateEvents=!1,Tech.prototype.featuresNativeTextTracks=!1,Tech.withSourceHandlers=function(e){e.registerSourceHandler=function(t,r){var o=e.sourceHandlers;o||(o=e.sourceHandlers=[]),void 0===r&&(r=o.length),o.splice(r,0,t)},e.canPlayType=function(t){for(var r=e.sourceHandlers||[],o=void 0,i=0;i<r.length;i++)if(o=r[i].canPlayType(t))return o;return""},e.selectSourceHandler=function(t,r){for(var o=e.sourceHandlers||[],i=void 0,n=0;n<o.length;n++)if(i=o[n].canHandleSource(t,r))return o[n];return null},e.canPlaySource=function(t,r){var o=e.selectSourceHandler(t,r);return o?o.canHandleSource(t,r):""};var t=["seekable","duration"];t.forEach(function(e){var t=this[e];"function"==typeof t&&(this[e]=function(){return this.sourceHandler_&&this.sourceHandler_[e]?this.sourceHandler_[e].apply(this.sourceHandler_,arguments):t.apply(this,arguments)})},e.prototype),e.prototype.setSource=function(t){var r=e.selectSourceHandler(t,this.options_);return r||(e.nativeSourceHandler?r=e.nativeSourceHandler:_log2.default.error("No source hander found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler),r!==e.nativeSourceHandler&&(this.currentSource_=t,this.off(this.el_,"loadstart",e.prototype.firstLoadStartListener_),this.off(this.el_,"loadstart",e.prototype.successiveLoadStartListener_),this.one(this.el_,"loadstart",e.prototype.firstLoadStartListener_)),this.sourceHandler_=r.handleSource(t,this,this.options_),this.on("dispose",this.disposeSourceHandler),this},e.prototype.firstLoadStartListener_=function(){this.one(this.el_,"loadstart",e.prototype.successiveLoadStartListener_)},e.prototype.successiveLoadStartListener_=function(){this.disposeSourceHandler(),this.one(this.el_,"loadstart",e.prototype.successiveLoadStartListener_)},e.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.off(this.el_,"loadstart",e.prototype.firstLoadStartListener_),this.off(this.el_,"loadstart",e.prototype.successiveLoadStartListener_),this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},_component2.default.registerComponent("Tech",Tech),_component2.default.registerComponent("MediaTechController",Tech),Tech.registerTech("Tech",Tech),exports.default=Tech;
},{"../component":369,"../media-error.js":410,"../tracks/audio-track-list":427,"../tracks/html-track-element":430,"../tracks/html-track-element-list":429,"../tracks/text-track":436,"../tracks/text-track-list":434,"../tracks/video-track-list":440,"../utils/buffer.js":443,"../utils/fn.js":447,"../utils/log.js":450,"../utils/merge-options.js":451,"../utils/obj":452,"../utils/time-ranges.js":454,"global/document":193,"global/window":194,"videojs-vtt.js":458}],427:[function(require,module,exports){
arguments[4][282][0].apply(exports,arguments)
},{"../utils/browser.js":442,"./track-list":438,"dup":282,"global/document":193}],428:[function(require,module,exports){
arguments[4][283][0].apply(exports,arguments)
},{"../utils/browser.js":442,"../utils/merge-options":451,"./track":439,"./track-enums":437,"dup":283}],429:[function(require,module,exports){
arguments[4][284][0].apply(exports,arguments)
},{"../utils/browser.js":442,"dup":284,"global/document":193}],430:[function(require,module,exports){
arguments[4][285][0].apply(exports,arguments)
},{"../event-target":406,"../tracks/text-track":436,"../utils/browser.js":442,"dup":285,"global/document":193}],431:[function(require,module,exports){
arguments[4][286][0].apply(exports,arguments)
},{"../utils/browser.js":442,"dup":286,"global/document":193}],432:[function(require,module,exports){
arguments[4][287][0].apply(exports,arguments)
},{"../component":369,"../utils/fn.js":447,"dup":287,"global/window":194}],433:[function(require,module,exports){
arguments[4][288][0].apply(exports,arguments)
},{"dup":288}],434:[function(require,module,exports){
arguments[4][289][0].apply(exports,arguments)
},{"../utils/browser.js":442,"../utils/fn.js":447,"./track-list":438,"dup":289,"global/document":193}],435:[function(require,module,exports){
arguments[4][290][0].apply(exports,arguments)
},{"../component":369,"../utils/dom":445,"../utils/fn":447,"../utils/log":450,"../utils/obj":452,"dup":290,"global/window":194}],436:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0;var _textTrackCueList=require("./text-track-cue-list"),_textTrackCueList2=_interopRequireDefault(_textTrackCueList),_fn=require("../utils/fn.js"),Fn=_interopRequireWildcard(_fn),_trackEnums=require("./track-enums"),_log=require("../utils/log.js"),_log2=_interopRequireDefault(_log),_window=require("global/window"),_window2=_interopRequireDefault(_window),_track=require("./track.js"),_track2=_interopRequireDefault(_track),_url=require("../utils/url.js"),_xhr=require("xhr"),_xhr2=_interopRequireDefault(_xhr),_mergeOptions=require("../utils/merge-options"),_mergeOptions2=_interopRequireDefault(_mergeOptions),_browser=require("../utils/browser.js"),browser=_interopRequireWildcard(_browser),parseCues=function(e,t){var r=new _window2.default.WebVTT.Parser(_window2.default,_window2.default.vttjs,_window2.default.WebVTT.StringDecoder()),n=[];r.oncue=function(e){t.addCue(e)},r.onparsingerror=function(e){n.push(e)},r.onflush=function(){t.trigger({type:"loadeddata",target:t})},r.parse(e),n.length>0&&(_window2.default.console&&_window2.default.console.groupCollapsed&&_window2.default.console.groupCollapsed("Text Track parsing errors for "+t.src),n.forEach(function(e){return _log2.default.error(e)}),_window2.default.console&&_window2.default.console.groupEnd&&_window2.default.console.groupEnd()),r.flush()},loadTrack=function(e,t){var r={uri:e},n=(0,_url.isCrossOrigin)(e);n&&(r.cors=n),(0,_xhr2.default)(r,Fn.bind(this,function(e,r,n){return e?_log2.default.error(e,r):(t.loaded_=!0,void("function"!=typeof _window2.default.WebVTT?t.tech_&&!function(){var e=function(){return parseCues(n,t)};t.tech_.on("vttjsloaded",e),t.tech_.on("vttjserror",function(){_log2.default.error("vttjs failed to load, stopping trying to process "+t.src),t.tech_.off("vttjsloaded",e)})}():parseCues(n,t)))}))},TextTrack=function(e){function t(){var r,n,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(_classCallCheck(this,t),!o.tech)throw new Error("A tech was not provided.");var i=(0,_mergeOptions2.default)(o,{kind:_trackEnums.TextTrackKind[o.kind]||"subtitles",language:o.language||o.srclang||""}),u=_trackEnums.TextTrackMode[i.mode]||"disabled",s=i.default;"metadata"!==i.kind&&"chapters"!==i.kind||(u="hidden");var a=r=_possibleConstructorReturn(this,e.call(this,i));if(a.tech_=i.tech,browser.IS_IE8)for(var c in t.prototype)"constructor"!==c&&(a[c]=t.prototype[c]);a.cues_=[],a.activeCues_=[];var l=new _textTrackCueList2.default(a.cues_),d=new _textTrackCueList2.default(a.activeCues_),f=!1,_=Fn.bind(a,function(){this.activeCues,f&&(this.trigger("cuechange"),f=!1)});return"disabled"!==u&&a.tech_.on("timeupdate",_),Object.defineProperty(a,"default",{get:function(){return s},set:function(){}}),Object.defineProperty(a,"mode",{get:function(){return u},set:function(e){_trackEnums.TextTrackMode[e]&&(u=e,"showing"===u&&this.tech_.on("timeupdate",_),this.trigger("modechange"))}}),Object.defineProperty(a,"cues",{get:function(){return this.loaded_?l:null},set:function(){}}),Object.defineProperty(a,"activeCues",{get:function(){if(!this.loaded_)return null;if(0===this.cues.length)return d;for(var e=this.tech_.currentTime(),t=[],r=0,n=this.cues.length;r<n;r++){var o=this.cues[r];o.startTime<=e&&o.endTime>=e?t.push(o):o.startTime===o.endTime&&o.startTime<=e&&o.startTime+.5>=e&&t.push(o)}if(f=!1,t.length!==this.activeCues_.length)f=!0;else for(var i=0;i<t.length;i++)this.activeCues_.indexOf(t[i])===-1&&(f=!0);return this.activeCues_=t,d.setCues_(this.activeCues_),d},set:function(){}}),i.src?(a.src=i.src,loadTrack(i.src,a)):a.loaded_=!0,n=a,_possibleConstructorReturn(r,n)}return _inherits(t,e),t.prototype.addCue=function(e){var t=e;if(!(e instanceof _window2.default.vttjs.VTTCue)){t=new _window2.default.vttjs.VTTCue(e.startTime,e.endTime,e.text);for(var r in e)t[r]=e[r]}var n=this.tech_.textTracks();if(n)for(var o=0;o<n.length;o++)n[o]!==this&&n[o].removeCue(t);this.cues_.push(t),this.cues.setCues_(this.cues_)},t.prototype.removeCue=function(e){for(var t=!1,r=0,n=this.cues_.length;r<n;r++){var o=this.cues_[r];o===e&&(this.cues_.splice(r,1),t=!0)}t&&this.cues.setCues_(this.cues_)},t}(_track2.default);TextTrack.prototype.allowedEvents_={cuechange:"cuechange"},exports.default=TextTrack;
},{"../utils/browser.js":442,"../utils/fn.js":447,"../utils/log.js":450,"../utils/merge-options":451,"../utils/url.js":456,"./text-track-cue-list":431,"./track-enums":437,"./track.js":439,"global/window":194,"xhr":473}],437:[function(require,module,exports){
arguments[4][292][0].apply(exports,arguments)
},{"dup":292}],438:[function(require,module,exports){
arguments[4][293][0].apply(exports,arguments)
},{"../event-target":406,"../utils/browser.js":442,"dup":293,"global/document":193}],439:[function(require,module,exports){
arguments[4][294][0].apply(exports,arguments)
},{"../event-target":406,"../utils/browser.js":442,"../utils/guid.js":449,"dup":294,"global/document":193}],440:[function(require,module,exports){
arguments[4][295][0].apply(exports,arguments)
},{"../utils/browser.js":442,"./track-list":438,"dup":295,"global/document":193}],441:[function(require,module,exports){
arguments[4][296][0].apply(exports,arguments)
},{"../utils/browser.js":442,"../utils/merge-options":451,"./track":439,"./track-enums":437,"dup":296}],442:[function(require,module,exports){
arguments[4][297][0].apply(exports,arguments)
},{"./dom":445,"dup":297,"global/window":194}],443:[function(require,module,exports){
arguments[4][298][0].apply(exports,arguments)
},{"./time-ranges.js":454,"dup":298}],444:[function(require,module,exports){
arguments[4][299][0].apply(exports,arguments)
},{"dup":299,"global/window":194}],445:[function(require,module,exports){
arguments[4][300][0].apply(exports,arguments)
},{"./guid.js":449,"./log.js":450,"./obj":452,"dup":300,"global/document":193,"global/window":194,"tsml":218}],446:[function(require,module,exports){
arguments[4][301][0].apply(exports,arguments)
},{"./dom.js":445,"./guid.js":449,"./log.js":450,"dup":301,"global/document":193,"global/window":194}],447:[function(require,module,exports){
arguments[4][302][0].apply(exports,arguments)
},{"./guid.js":449,"dup":302}],448:[function(require,module,exports){
arguments[4][303][0].apply(exports,arguments)
},{"dup":303}],449:[function(require,module,exports){
arguments[4][304][0].apply(exports,arguments)
},{"dup":304}],450:[function(require,module,exports){
arguments[4][305][0].apply(exports,arguments)
},{"./browser":442,"./obj":452,"dup":305,"global/window":194}],451:[function(require,module,exports){
arguments[4][306][0].apply(exports,arguments)
},{"./obj":452,"dup":306}],452:[function(require,module,exports){
"use strict";function each(t,e){keys(t).forEach(function(n){return e(t[n],n)})}function reduce(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return keys(t).reduce(function(n,o){return e(n,t[o],o)},n)}function assign(t){for(var e=arguments.length,n=Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return Object.assign?Object.assign.apply(Object,[t].concat(n)):(n.forEach(function(e){e&&each(e,function(e,n){t[n]=e})}),t)}function isObject(t){return!!t&&"object"===("undefined"==typeof t?"undefined":_typeof(t))}function isPlain(t){return isObject(t)&&"[object Object]"===toString.call(t)&&t.constructor===Object}exports.__esModule=!0;var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};exports.each=each,exports.reduce=reduce,exports.assign=assign,exports.isObject=isObject,exports.isPlain=isPlain;var toString=Object.prototype.toString,keys=function(t){return isObject(t)?Object.keys(t):[]};
},{}],453:[function(require,module,exports){
arguments[4][308][0].apply(exports,arguments)
},{"dup":308,"global/document":193}],454:[function(require,module,exports){
arguments[4][309][0].apply(exports,arguments)
},{"./log.js":450,"dup":309}],455:[function(require,module,exports){
arguments[4][310][0].apply(exports,arguments)
},{"dup":310}],456:[function(require,module,exports){
arguments[4][311][0].apply(exports,arguments)
},{"dup":311,"global/document":193,"global/window":194}],457:[function(require,module,exports){
"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function videojs(e,t,o){var r=void 0;if("string"==typeof e){if(0===e.indexOf("#")&&(e=e.slice(1)),videojs.getPlayers()[e])return t&&_log2.default.warn('Player "'+e+'" is already initialised. Options will not be applied.'),o&&videojs.getPlayers()[e].ready(o),videojs.getPlayers()[e];r=Dom.getEl(e)}else r=e;if(!r||!r.nodeName)throw new TypeError("The element or ID supplied is not valid. (videojs)");if(r.player||_player2.default.players[r.playerId])return r.player||_player2.default.players[r.playerId];t=t||{},videojs.hooks("beforesetup").forEach(function(e){var o=e(r,(0,_mergeOptions3.default)(t));return!(0,_obj.isObject)(o)||Array.isArray(o)?void _log2.default.error("please return an object in beforesetup hooks"):void(t=(0,_mergeOptions3.default)(t,o))});var i=_component2.default.getComponent("Player"),s=new i(r,t,o);return videojs.hooks("setup").forEach(function(e){return e(s)}),s}exports.__esModule=!0;var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_window=require("global/window"),_window2=_interopRequireDefault(_window),_document=require("global/document"),_document2=_interopRequireDefault(_document),_setup=require("./setup"),setup=_interopRequireWildcard(_setup),_stylesheet=require("./utils/stylesheet.js"),stylesheet=_interopRequireWildcard(_stylesheet),_component=require("./component"),_component2=_interopRequireDefault(_component),_eventTarget=require("./event-target"),_eventTarget2=_interopRequireDefault(_eventTarget),_events=require("./utils/events.js"),Events=_interopRequireWildcard(_events),_player=require("./player"),_player2=_interopRequireDefault(_player),_plugins=require("./plugins.js"),_plugins2=_interopRequireDefault(_plugins),_mergeOptions2=require("./utils/merge-options.js"),_mergeOptions3=_interopRequireDefault(_mergeOptions2),_fn=require("./utils/fn.js"),Fn=_interopRequireWildcard(_fn),_textTrack=require("./tracks/text-track.js"),_textTrack2=_interopRequireDefault(_textTrack),_audioTrack=require("./tracks/audio-track.js"),_audioTrack2=_interopRequireDefault(_audioTrack),_videoTrack=require("./tracks/video-track.js"),_videoTrack2=_interopRequireDefault(_videoTrack),_timeRanges=require("./utils/time-ranges.js"),_formatTime=require("./utils/format-time.js"),_formatTime2=_interopRequireDefault(_formatTime),_log=require("./utils/log.js"),_log2=_interopRequireDefault(_log),_dom=require("./utils/dom.js"),Dom=_interopRequireWildcard(_dom),_browser=require("./utils/browser.js"),browser=_interopRequireWildcard(_browser),_url=require("./utils/url.js"),Url=_interopRequireWildcard(_url),_obj=require("./utils/obj"),_computedStyle=require("./utils/computed-style.js"),_computedStyle2=_interopRequireDefault(_computedStyle),_extend=require("./extend.js"),_extend2=_interopRequireDefault(_extend),_xhr=require("xhr"),_xhr2=_interopRequireDefault(_xhr),_tech=require("./tech/tech.js"),_tech2=_interopRequireDefault(_tech);if("undefined"==typeof HTMLVideoElement&&Dom.isReal()&&(_document2.default.createElement("video"),_document2.default.createElement("audio"),_document2.default.createElement("track")),videojs.hooks_={},videojs.hooks=function(e,t){return videojs.hooks_[e]=videojs.hooks_[e]||[],t&&(videojs.hooks_[e]=videojs.hooks_[e].concat(t)),videojs.hooks_[e]},videojs.hook=function(e,t){videojs.hooks(e,t)},videojs.removeHook=function(e,t){var o=videojs.hooks(e).indexOf(t);return!(o<=-1)&&(videojs.hooks_[e]=videojs.hooks_[e].slice(),videojs.hooks_[e].splice(o,1),!0)},_window2.default.VIDEOJS_NO_DYNAMIC_STYLE!==!0&&Dom.isReal()){var style=Dom.$(".vjs-styles-defaults");if(!style){style=stylesheet.createStyleElement("vjs-styles-defaults");var head=Dom.$("head");head&&head.insertBefore(style,head.firstChild),stylesheet.setTextContent(style,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")}}setup.autoSetupTimeout(1,videojs),videojs.VERSION="5.18.0",videojs.options=_player2.default.prototype.options_,videojs.getPlayers=function(){return _player2.default.players},videojs.players=_player2.default.players,videojs.getComponent=_component2.default.getComponent,videojs.registerComponent=function(e,t){_tech2.default.isTech(t)&&_log2.default.warn("The "+e+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),_component2.default.registerComponent.call(_component2.default,e,t)},videojs.getTech=_tech2.default.getTech,videojs.registerTech=_tech2.default.registerTech,videojs.browser=browser,videojs.TOUCH_ENABLED=browser.TOUCH_ENABLED,videojs.extend=_extend2.default,videojs.mergeOptions=_mergeOptions3.default,videojs.bind=Fn.bind,videojs.plugin=_plugins2.default,videojs.addLanguage=function(e,t){var o;return e=(""+e).toLowerCase(),videojs.options.languages=(0,_mergeOptions3.default)(videojs.options.languages,(o={},o[e]=t,o)),videojs.options.languages[e]},videojs.log=_log2.default,videojs.createTimeRange=videojs.createTimeRanges=_timeRanges.createTimeRanges,videojs.formatTime=_formatTime2.default,videojs.parseUrl=Url.parseUrl,videojs.isCrossOrigin=Url.isCrossOrigin,videojs.EventTarget=_eventTarget2.default,videojs.on=Events.on,videojs.one=Events.one,videojs.off=Events.off,videojs.trigger=Events.trigger,videojs.xhr=_xhr2.default,videojs.TextTrack=_textTrack2.default,videojs.AudioTrack=_audioTrack2.default,videojs.VideoTrack=_videoTrack2.default,videojs.isEl=Dom.isEl,videojs.isTextNode=Dom.isTextNode,videojs.createEl=Dom.createEl,videojs.hasClass=Dom.hasElClass,videojs.addClass=Dom.addElClass,videojs.removeClass=Dom.removeElClass,videojs.toggleClass=Dom.toggleElClass,videojs.setAttributes=Dom.setElAttributes,videojs.getAttributes=Dom.getElAttributes,videojs.emptyEl=Dom.emptyEl,videojs.appendContent=Dom.appendContent,videojs.insertContent=Dom.insertContent,videojs.computedStyle=_computedStyle2.default,"function"==typeof define&&define.amd?define("videojs",[],function(){return videojs}):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"object"===("undefined"==typeof module?"undefined":_typeof(module))&&(module.exports=videojs),exports.default=videojs;
},{"./component":369,"./event-target":406,"./extend.js":407,"./player":415,"./plugins.js":416,"./setup":420,"./tech/tech.js":426,"./tracks/audio-track.js":428,"./tracks/text-track.js":436,"./tracks/video-track.js":441,"./utils/browser.js":442,"./utils/computed-style.js":444,"./utils/dom.js":445,"./utils/events.js":446,"./utils/fn.js":447,"./utils/format-time.js":448,"./utils/log.js":450,"./utils/merge-options.js":451,"./utils/obj":452,"./utils/stylesheet.js":453,"./utils/time-ranges.js":454,"./utils/url.js":456,"global/document":193,"global/window":194,"xhr":473}],458:[function(require,module,exports){
var vttjs=module.exports={WebVTT:require("./vtt.js").WebVTT,VTTCue:require("./vttcue-extended.js").VTTCue,VTTRegion:require("./vttregion-extended.js").VTTRegion};window.vttjs=vttjs,window.WebVTT=vttjs.WebVTT;var cueShim=vttjs.VTTCue,regionShim=vttjs.VTTRegion,oldVTTCue=window.VTTCue,oldVTTRegion=window.VTTRegion;vttjs.shim=function(){vttjs.VTTCue=cueShim,vttjs.VTTRegion=regionShim},vttjs.restore=function(){vttjs.VTTCue=oldVTTCue,vttjs.VTTRegion=oldVTTRegion};
},{"./vtt.js":459,"./vttcue-extended.js":460,"./vttregion-extended.js":462}],459:[function(require,module,exports){
!function(t){function e(t,e){this.name="ParsingError",this.code=t.code,this.message=e||t.message}function i(t){function e(t,e,i,r){return 3600*(0|t)+60*(0|e)+(0|i)+(0|r)/1e3}var i=t.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return i?i[3]?e(i[1],i[2],i[3].replace(":",""),i[4]):i[1]>59?e(i[1],i[2],0,i[4]):e(0,i[1],i[2],i[4]):null}function r(){this.values=d(null)}function n(t,e,i,r){var n=r?t.split(r):[t];for(var o in n)if("string"==typeof n[o]){var s=n[o].split(i);if(2===s.length){var a=s[0],l=s[1];e(a,l)}}}function o(t,o,s){function a(){var r=i(t);if(null===r)throw new e(e.Errors.BadTimeStamp,"Malformed timestamp: "+c);return t=t.replace(/^[^\sa-zA-Z-]+/,""),r}function l(t,e){var i=new r;n(t,function(t,e){switch(t){case"region":for(var r=s.length-1;r>=0;r--)if(s[r].id===e){i.set(t,s[r].region);break}break;case"vertical":i.alt(t,e,["rl","lr"]);break;case"line":var n=e.split(","),o=n[0];i.integer(t,o),i.percent(t,o)?i.set("snapToLines",!1):null,i.alt(t,o,["auto"]),2===n.length&&i.alt("lineAlign",n[1],["start","middle","end"]);break;case"position":n=e.split(","),i.percent(t,n[0]),2===n.length&&i.alt("positionAlign",n[1],["start","middle","end"]);break;case"size":i.percent(t,e);break;case"align":i.alt(t,e,["start","middle","end","left","right"])}},/:/,/\s/),e.region=i.get("region",null),e.vertical=i.get("vertical",""),e.line=i.get("line","auto"),e.lineAlign=i.get("lineAlign","start"),e.snapToLines=i.get("snapToLines",!0),e.size=i.get("size",100),e.align=i.get("align","middle"),e.position=i.get("position",{start:0,left:0,middle:50,end:100,right:100},e.align),e.positionAlign=i.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},e.align)}function h(){t=t.replace(/^\s+/,"")}var c=t;if(h(),o.startTime=a(),h(),"-->"!==t.substr(0,3))throw new e(e.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+c);t=t.substr(3),h(),o.endTime=a(),h(),l(t,o)}function s(t,e){function r(){function t(t){return e=e.substr(t.length),t}if(!e)return null;var i=e.match(/^([^<]*)(<[^>]+>?)?/);return t(i[1]?i[1]:i[2])}function n(t){return v[t]}function o(t){for(;g=t.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)t=t.replace(g[0],n);return t}function s(t,e){return!b[e.localName]||b[e.localName]===t.localName}function a(e,i){var r=m[e];if(!r)return null;var n=t.document.createElement(r);n.localName=r;var o=y[e];return o&&i&&(n[o]=i.trim()),n}for(var l,h=t.document.createElement("div"),c=h,u=[];null!==(l=r());)if("<"!==l[0])c.appendChild(t.document.createTextNode(o(l)));else{if("/"===l[1]){u.length&&u[u.length-1]===l.substr(2).replace(">","")&&(u.pop(),c=c.parentNode);continue}var f,p=i(l.substr(1,l.length-2));if(p){f=t.document.createProcessingInstruction("timestamp",p),c.appendChild(f);continue}var g=l.match(/^<([^.\s\/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!g)continue;if(f=a(g[1],g[3]),!f)continue;if(!s(c,f))continue;g[2]&&(f.className=g[2].substr(1).replace("."," ")),u.push(g[1]),c.appendChild(f),c=f}return h}function a(t){for(var e=0;e<w.length;e++){var i=w[e];if(t>=i[0]&&t<=i[1])return!0}return!1}function l(t){function e(t,e){for(var i=e.childNodes.length-1;i>=0;i--)t.push(e.childNodes[i])}function i(t){if(!t||!t.length)return null;var r=t.pop(),n=r.textContent||r.innerText;if(n){var o=n.match(/^.*(\n|\r)/);return o?(t.length=0,o[0]):n}return"ruby"===r.tagName?i(t):r.childNodes?(e(t,r),i(t)):void 0}var r,n=[],o="";if(!t||!t.childNodes)return"ltr";for(e(n,t);o=i(n);)for(var s=0;s<o.length;s++)if(r=o.charCodeAt(s),a(r))return"rtl";return"ltr"}function h(t){if("number"==typeof t.line&&(t.snapToLines||t.line>=0&&t.line<=100))return t.line;if(!t.track||!t.track.textTrackList||!t.track.textTrackList.mediaElement)return-1;for(var e=t.track,i=e.textTrackList,r=0,n=0;n<i.length&&i[n]!==e;n++)"showing"===i[n].mode&&r++;return++r*-1}function c(){}function u(t,e,i){var r=/MSIE\s8\.0/.test(navigator.userAgent),n="rgba(255, 255, 255, 1)",o="rgba(0, 0, 0, 0.8)";r&&(n="rgb(255, 255, 255)",o="rgb(0, 0, 0)"),c.call(this),this.cue=e,this.cueDiv=s(t,e.text);var a={color:n,backgroundColor:o,position:"relative",left:0,right:0,top:0,bottom:0,display:"inline"};r||(a.writingMode=""===e.vertical?"horizontal-tb":"lr"===e.vertical?"vertical-lr":"vertical-rl",a.unicodeBidi="plaintext"),this.applyStyles(a,this.cueDiv),this.div=t.document.createElement("div"),a={textAlign:"middle"===e.align?"center":e.align,font:i.font,whiteSpace:"pre-line",position:"absolute"},r||(a.direction=l(this.cueDiv),a.writingMode=""===e.vertical?"horizontal-tb":"lr"===e.vertical?"vertical-lr":"vertical-rl".stylesunicodeBidi="plaintext"),this.applyStyles(a),this.div.appendChild(this.cueDiv);var h=0;switch(e.positionAlign){case"start":h=e.position;break;case"middle":h=e.position-e.size/2;break;case"end":h=e.position-e.size}""===e.vertical?this.applyStyles({left:this.formatStyle(h,"%"),width:this.formatStyle(e.size,"%")}):this.applyStyles({top:this.formatStyle(h,"%"),height:this.formatStyle(e.size,"%")}),this.move=function(t){this.applyStyles({top:this.formatStyle(t.top,"px"),bottom:this.formatStyle(t.bottom,"px"),left:this.formatStyle(t.left,"px"),right:this.formatStyle(t.right,"px"),height:this.formatStyle(t.height,"px"),width:this.formatStyle(t.width,"px")})}}function f(t){var e,i,r,n,o=/MSIE\s8\.0/.test(navigator.userAgent);if(t.div){i=t.div.offsetHeight,r=t.div.offsetWidth,n=t.div.offsetTop;var s=(s=t.div.childNodes)&&(s=s[0])&&s.getClientRects&&s.getClientRects();t=t.div.getBoundingClientRect(),e=s?Math.max(s[0]&&s[0].height||0,t.height/s.length):0}this.left=t.left,this.right=t.right,this.top=t.top||n,this.height=t.height||i,this.bottom=t.bottom||n+(t.height||i),this.width=t.width||r,this.lineHeight=void 0!==e?e:t.lineHeight,o&&!this.lineHeight&&(this.lineHeight=13)}function p(t,e,i,r){function n(t,e){for(var n,o=new f(t),s=1,a=0;a<e.length;a++){for(;t.overlapsOppositeAxis(i,e[a])||t.within(i)&&t.overlapsAny(r);)t.move(e[a]);if(t.within(i))return t;var l=t.intersectPercentage(i);s>l&&(n=new f(t),s=l),t=new f(o)}return n||o}var o=new f(e),s=e.cue,a=h(s),l=[];if(s.snapToLines){var c;switch(s.vertical){case"":l=["+y","-y"],c="height";break;case"rl":l=["+x","-x"],c="width";break;case"lr":l=["-x","+x"],c="width"}var u=o.lineHeight,p=u*Math.round(a),g=i[c]+u,d=l[0];Math.abs(p)>g&&(p=p<0?-1:1,p*=Math.ceil(g/u)*u),a<0&&(p+=""===s.vertical?i.height:i.width,l=l.reverse()),o.move(d,p)}else{var v=o.lineHeight/i.height*100;switch(s.lineAlign){case"middle":a-=v/2;break;case"end":a-=v}switch(s.vertical){case"":e.applyStyles({top:e.formatStyle(a,"%")});break;case"rl":e.applyStyles({left:e.formatStyle(a,"%")});break;case"lr":e.applyStyles({right:e.formatStyle(a,"%")})}l=["+y","-x","+x","-y"],o=new f(e)}var m=n(o,l);e.move(m.toCSSCompatValues(i))}function g(){}var d=Object.create||function(){function t(){}return function(e){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return t.prototype=e,new t}}();e.prototype=d(Error.prototype),e.prototype.constructor=e,e.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},r.prototype={set:function(t,e){this.get(t)||""===e||(this.values[t]=e)},get:function(t,e,i){return i?this.has(t)?this.values[t]:e[i]:this.has(t)?this.values[t]:e},has:function(t){return t in this.values},alt:function(t,e,i){for(var r=0;r<i.length;++r)if(e===i[r]){this.set(t,e);break}},integer:function(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))},percent:function(t,e){var i;return!!((i=e.match(/^([\d]{1,3})(\.[\d]*)?%$/))&&(e=parseFloat(e),e>=0&&e<=100))&&(this.set(t,e),!0)}};var v={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"","&rlm;":"","&nbsp;":""},m={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},y={v:"title",lang:"lang"},b={rt:"ruby"},w=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];c.prototype.applyStyles=function(t,e){e=e||this.div;for(var i in t)t.hasOwnProperty(i)&&(e.style[i]=t[i])},c.prototype.formatStyle=function(t,e){return 0===t?0:t+e},u.prototype=d(c.prototype),u.prototype.constructor=u,f.prototype.move=function(t,e){switch(e=void 0!==e?e:this.lineHeight,t){case"+x":this.left+=e,this.right+=e;break;case"-x":this.left-=e,this.right-=e;break;case"+y":this.top+=e,this.bottom+=e;break;case"-y":this.top-=e,this.bottom-=e}},f.prototype.overlaps=function(t){return this.left<t.right&&this.right>t.left&&this.top<t.bottom&&this.bottom>t.top},f.prototype.overlapsAny=function(t){for(var e=0;e<t.length;e++)if(this.overlaps(t[e]))return!0;return!1},f.prototype.within=function(t){return this.top>=t.top&&this.bottom<=t.bottom&&this.left>=t.left&&this.right<=t.right},f.prototype.overlapsOppositeAxis=function(t,e){switch(e){case"+x":return this.left<t.left;case"-x":return this.right>t.right;case"+y":return this.top<t.top;case"-y":return this.bottom>t.bottom}},f.prototype.intersectPercentage=function(t){var e=Math.max(0,Math.min(this.right,t.right)-Math.max(this.left,t.left)),i=Math.max(0,Math.min(this.bottom,t.bottom)-Math.max(this.top,t.top)),r=e*i;return r/(this.height*this.width)},f.prototype.toCSSCompatValues=function(t){return{top:this.top-t.top,bottom:t.bottom-this.bottom,left:this.left-t.left,right:t.right-this.right,height:this.height,width:this.width}},f.getSimpleBoxPosition=function(t){var e=t.div?t.div.offsetHeight:t.tagName?t.offsetHeight:0,i=t.div?t.div.offsetWidth:t.tagName?t.offsetWidth:0,r=t.div?t.div.offsetTop:t.tagName?t.offsetTop:0;t=t.div?t.div.getBoundingClientRect():t.tagName?t.getBoundingClientRect():t;var n={left:t.left,right:t.right,top:t.top||r,height:t.height||e,bottom:t.bottom||r+(t.height||e),width:t.width||i};return n},g.StringDecoder=function(){return{decode:function(t){if(!t)return"";if("string"!=typeof t)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}},g.convertCueToDOMTree=function(t,e){return t&&e?s(t,e):null};var T=.05,x="sans-serif",E="1.5%";g.processCues=function(t,e,i){function r(t){for(var e=0;e<t.length;e++)if(t[e].hasBeenReset||!t[e].displayState)return!0;return!1}if(!t||!e||!i)return null;for(;i.firstChild;)i.removeChild(i.firstChild);var n=t.document.createElement("div");if(n.style.position="absolute",n.style.left="0",n.style.right="0",n.style.top="0",n.style.bottom="0",n.style.margin=E,i.appendChild(n),r(e)){var o=[],s=f.getSimpleBoxPosition(n),a=Math.round(s.height*T*100)/100,l={font:a+"px "+x};!function(){for(var i,r,a=0;a<e.length;a++)r=e[a],i=new u(t,r,l),n.appendChild(i.div),p(t,i,s,o),r.displayState=i.div,o.push(f.getSimpleBoxPosition(i))}()}else for(var h=0;h<e.length;h++)n.appendChild(e[h].displayState)},g.Parser=function(t,e,i){i||(i=e,e={}),e||(e={}),this.window=t,this.vttjs=e,this.state="INITIAL",this.buffer="",this.decoder=i||new TextDecoder("utf8"),this.regionList=[]},g.Parser.prototype={reportOrThrowError:function(t){if(!(t instanceof e))throw t;this.onparsingerror&&this.onparsingerror(t)},parse:function(t){function i(){for(var t=l.buffer,e=0;e<t.length&&"\r"!==t[e]&&"\n"!==t[e];)++e;var i=t.substr(0,e);return"\r"===t[e]&&++e,"\n"===t[e]&&++e,l.buffer=t.substr(e),i}function s(t){var e=new r;if(n(t,function(t,i){switch(t){case"id":e.set(t,i);break;case"width":e.percent(t,i);break;case"lines":e.integer(t,i);break;case"regionanchor":case"viewportanchor":var n=i.split(",");if(2!==n.length)break;var o=new r;if(o.percent("x",n[0]),o.percent("y",n[1]),!o.has("x")||!o.has("y"))break;e.set(t+"X",o.get("x")),e.set(t+"Y",o.get("y"));break;case"scroll":e.alt(t,i,["up"])}},/=/,/\s/),e.has("id")){var i=new(l.vttjs.VTTRegion||l.window.VTTRegion);i.width=e.get("width",100),i.lines=e.get("lines",3),i.regionAnchorX=e.get("regionanchorX",0),i.regionAnchorY=e.get("regionanchorY",100),i.viewportAnchorX=e.get("viewportanchorX",0),i.viewportAnchorY=e.get("viewportanchorY",100),i.scroll=e.get("scroll",""),l.onregion&&l.onregion(i),l.regionList.push({id:e.get("id"),region:i})}}function a(t){n(t,function(t,e){switch(t){case"Region":s(e)}},/:/)}var l=this;t&&(l.buffer+=l.decoder.decode(t,{stream:!0}));try{var h;if("INITIAL"===l.state){if(!/\r\n|\n/.test(l.buffer))return this;h=i();var c=h.match(/^WEBVTT([ \t].*)?$/);if(!c||!c[0])throw new e(e.Errors.BadSignature);l.state="HEADER"}for(var u=!1;l.buffer;){if(!/\r\n|\n/.test(l.buffer))return this;switch(u?u=!1:h=i(),l.state){case"HEADER":/:/.test(h)?a(h):h||(l.state="ID");continue;case"NOTE":h||(l.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(h)){l.state="NOTE";break}if(!h)continue;if(l.cue=new(l.vttjs.VTTCue||l.window.VTTCue)(0,0,""),l.state="CUE",h.indexOf("-->")===-1){l.cue.id=h;continue}case"CUE":try{o(h,l.cue,l.regionList)}catch(t){l.reportOrThrowError(t),l.cue=null,l.state="BADCUE";continue}l.state="CUETEXT";continue;case"CUETEXT":var f=h.indexOf("-->")!==-1;if(!h||f&&(u=!0)){l.oncue&&l.oncue(l.cue),l.cue=null,l.state="ID";continue}l.cue.text&&(l.cue.text+="\n"),l.cue.text+=h;continue;case"BADCUE":h||(l.state="ID");continue}}}catch(t){l.reportOrThrowError(t),"CUETEXT"===l.state&&l.cue&&l.oncue&&l.oncue(l.cue),l.cue=null,l.state="INITIAL"===l.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var t=this;try{if(t.buffer+=t.decoder.decode(),(t.cue||"HEADER"===t.state)&&(t.buffer+="\n\n",t.parse()),"INITIAL"===t.state)throw new e(e.Errors.BadSignature)}catch(e){t.reportOrThrowError(e)}return t.onflush&&t.onflush(),this}},t.WebVTT=g}(this,this.vttjs||{});
},{}],460:[function(require,module,exports){
"undefined"!=typeof module&&module.exports&&(this.VTTCue=this.VTTCue||require("./vttcue").VTTCue),function(e){e.VTTCue.prototype.toJSON=function(){var e={},t=this;return Object.keys(this).forEach(function(r){"getCueAsHTML"!==r&&"hasBeenReset"!==r&&"displayState"!==r&&(e[r]=t[r])}),e},e.VTTCue.create=function(t){if(!t.hasOwnProperty("startTime")||!t.hasOwnProperty("endTime")||!t.hasOwnProperty("text"))throw new Error("You must at least have start time, end time, and text.");var r=new e.VTTCue(t.startTime,t.endTime,t.text);for(var n in t)r.hasOwnProperty(n)&&(r[n]=t[n]);return r},e.VTTCue.fromJSON=function(e){return this.create(JSON.parse(e))}}(this);
},{"./vttcue":461}],461:[function(require,module,exports){
!function(e,t){function n(e){if("string"!=typeof e)return!1;var t=u[e.toLowerCase()];return!!t&&e.toLowerCase()}function r(e){if("string"!=typeof e)return!1;var t=f[e.toLowerCase()];return!!t&&e.toLowerCase()}function i(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}function o(e,t,o){var u=this,f=/MSIE\s8\.0/.test(navigator.userAgent),a={};f?u=document.createElement("custom"):a.enumerable=!0,u.hasBeenReset=!1;var c="",d=!1,h=e,l=t,g=o,p=null,w="",b=!0,y="auto",v="start",m=50,O="middle",T=50,j="middle";if(Object.defineProperty(u,"id",i({},a,{get:function(){return c},set:function(e){c=""+e}})),Object.defineProperty(u,"pauseOnExit",i({},a,{get:function(){return d},set:function(e){d=!!e}})),Object.defineProperty(u,"startTime",i({},a,{get:function(){return h},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");h=e,this.hasBeenReset=!0}})),Object.defineProperty(u,"endTime",i({},a,{get:function(){return l},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");l=e,this.hasBeenReset=!0}})),Object.defineProperty(u,"text",i({},a,{get:function(){return g},set:function(e){g=""+e,this.hasBeenReset=!0}})),Object.defineProperty(u,"region",i({},a,{get:function(){return p},set:function(e){p=e,this.hasBeenReset=!0}})),Object.defineProperty(u,"vertical",i({},a,{get:function(){return w},set:function(e){var t=n(e);if(t===!1)throw new SyntaxError("An invalid or illegal string was specified.");w=t,this.hasBeenReset=!0}})),Object.defineProperty(u,"snapToLines",i({},a,{get:function(){return b},set:function(e){b=!!e,this.hasBeenReset=!0}})),Object.defineProperty(u,"line",i({},a,{get:function(){return y},set:function(e){if("number"!=typeof e&&e!==s)throw new SyntaxError("An invalid number or illegal string was specified.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(u,"lineAlign",i({},a,{get:function(){return v},set:function(e){var t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(u,"position",i({},a,{get:function(){return m},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");m=e,this.hasBeenReset=!0}})),Object.defineProperty(u,"positionAlign",i({},a,{get:function(){return O},set:function(e){var t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");O=t,this.hasBeenReset=!0}})),Object.defineProperty(u,"size",i({},a,{get:function(){return T},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");T=e,this.hasBeenReset=!0}})),Object.defineProperty(u,"align",i({},a,{get:function(){return j},set:function(e){var t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");j=t,this.hasBeenReset=!0}})),u.displayState=void 0,f)return u}var s="auto",u={"":!0,lr:!0,rl:!0},f={start:!0,middle:!0,end:!0,left:!0,right:!0};o.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},e.VTTCue=e.VTTCue||o,t.VTTCue=o}(this,this.vttjs||{});
},{}],462:[function(require,module,exports){
"undefined"!=typeof module&&module.exports&&(this.VTTRegion=require("./vttregion").VTTRegion),function(e){e.VTTRegion.create=function(n){var r=new e.VTTRegion;for(var o in n)r.hasOwnProperty(o)&&(r[o]=n[o]);return r},e.VTTRegion.fromJSON=function(e){return this.create(JSON.parse(e))}}(this);
},{"./vttregion":463}],463:[function(require,module,exports){
!function(e,n){function r(e){if("string"!=typeof e)return!1;var n=i[e.toLowerCase()];return!!n&&e.toLowerCase()}function t(e){return"number"==typeof e&&e>=0&&e<=100}function o(){var e=100,n=3,o=0,i=100,u=0,f=100,c="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return e},set:function(n){if(!t(n))throw new Error("Width must be between 0 and 100.");e=n}},lines:{enumerable:!0,get:function(){return n},set:function(e){if("number"!=typeof e)throw new TypeError("Lines must be set to a number.");n=e}},regionAnchorY:{enumerable:!0,get:function(){return i},set:function(e){if(!t(e))throw new Error("RegionAnchorX must be between 0 and 100.");i=e}},regionAnchorX:{enumerable:!0,get:function(){return o},set:function(e){if(!t(e))throw new Error("RegionAnchorY must be between 0 and 100.");o=e}},viewportAnchorY:{enumerable:!0,get:function(){return f},set:function(e){if(!t(e))throw new Error("ViewportAnchorY must be between 0 and 100.");f=e}},viewportAnchorX:{enumerable:!0,get:function(){return u},set:function(e){if(!t(e))throw new Error("ViewportAnchorX must be between 0 and 100.");u=e}},scroll:{enumerable:!0,get:function(){return c},set:function(e){var n=r(e);if(n===!1)throw new SyntaxError("An invalid or illegal string was specified.");c=n}}})}var i={"":!0,up:!0};e.VTTRegion=e.VTTRegion||o,n.VTTRegion=o}(this,this.vttjs||{});
},{}],464:[function(require,module,exports){
module.exports={WebVTT:require("./vtt.js").WebVTT,VTTCue:require("./vttcue-extended.js").VTTCue,VTTRegion:require("./vttregion-extended.js").VTTRegion};
},{"./vtt.js":465,"./vttcue-extended.js":466,"./vttregion-extended.js":468}],465:[function(require,module,exports){
!function(t){function e(t,e){this.name="ParsingError",this.code=t.code,this.message=e||t.message}function i(t){function e(t,e,i,r){return 3600*(0|t)+60*(0|e)+(0|i)+(0|r)/1e3}var i=t.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return i?i[3]?e(i[1],i[2],i[3].replace(":",""),i[4]):i[1]>59?e(i[1],i[2],0,i[4]):e(0,i[1],i[2],i[4]):null}function r(){this.values=g(null)}function n(t,e,i,r){var n=r?t.split(r):[t];for(var o in n)if("string"==typeof n[o]){var s=n[o].split(i);if(2===s.length){var a=s[0],l=s[1];e(a,l)}}}function o(t,o,s){function a(){var r=i(t);if(null===r)throw new e(e.Errors.BadTimeStamp,"Malformed timestamp: "+c);return t=t.replace(/^[^\sa-zA-Z-]+/,""),r}function l(t,e){var i=new r;n(t,function(t,e){switch(t){case"region":for(var r=s.length-1;r>=0;r--)if(s[r].id===e){i.set(t,s[r].region);break}break;case"vertical":i.alt(t,e,["rl","lr"]);break;case"line":var n=e.split(","),o=n[0];i.integer(t,o),i.percent(t,o)?i.set("snapToLines",!1):null,i.alt(t,o,["auto"]),2===n.length&&i.alt("lineAlign",n[1],["start","middle","end"]);break;case"position":n=e.split(","),i.percent(t,n[0]),2===n.length&&i.alt("positionAlign",n[1],["start","middle","end"]);break;case"size":i.percent(t,e);break;case"align":i.alt(t,e,["start","middle","end","left","right"])}},/:/,/\s/),e.region=i.get("region",null),e.vertical=i.get("vertical",""),e.line=i.get("line","auto"),e.lineAlign=i.get("lineAlign","start"),e.snapToLines=i.get("snapToLines",!0),e.size=i.get("size",100),e.align=i.get("align","middle"),e.position=i.get("position",{start:0,left:0,middle:50,end:100,right:100},e.align),e.positionAlign=i.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},e.align)}function h(){t=t.replace(/^\s+/,"")}var c=t;if(h(),o.startTime=a(),h(),"-->"!==t.substr(0,3))throw new e(e.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+c);t=t.substr(3),h(),o.endTime=a(),h(),l(t,o)}function s(t,e){function r(){function t(t){return e=e.substr(t.length),t}if(!e)return null;var i=e.match(/^([^<]*)(<[^>]+>?)?/);return t(i[1]?i[1]:i[2])}function n(t){return d[t]}function o(t){for(;g=t.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)t=t.replace(g[0],n);return t}function s(t,e){return!y[e.localName]||y[e.localName]===t.localName}function a(e,i){var r=v[e];if(!r)return null;var n=t.document.createElement(r);n.localName=r;var o=m[e];return o&&i&&(n[o]=i.trim()),n}for(var l,h=t.document.createElement("div"),c=h,u=[];null!==(l=r());)if("<"!==l[0])c.appendChild(t.document.createTextNode(o(l)));else{if("/"===l[1]){u.length&&u[u.length-1]===l.substr(2).replace(">","")&&(u.pop(),c=c.parentNode);continue}var f,p=i(l.substr(1,l.length-2));if(p){f=t.document.createProcessingInstruction("timestamp",p),c.appendChild(f);continue}var g=l.match(/^<([^.\s\/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!g)continue;if(f=a(g[1],g[3]),!f)continue;if(!s(c,f))continue;g[2]&&(f.className=g[2].substr(1).replace("."," ")),u.push(g[1]),c.appendChild(f),c=f}return h}function a(t){function e(t,e){for(var i=e.childNodes.length-1;i>=0;i--)t.push(e.childNodes[i])}function i(t){if(!t||!t.length)return null;var r=t.pop(),n=r.textContent||r.innerText;if(n){var o=n.match(/^.*(\n|\r)/);return o?(t.length=0,o[0]):n}return"ruby"===r.tagName?i(t):r.childNodes?(e(t,r),i(t)):void 0}var r,n=[],o="";if(!t||!t.childNodes)return"ltr";for(e(n,t);o=i(n);)for(var s=0;s<o.length;s++){r=o.charCodeAt(s);for(var a=0;a<b.length;a++)if(b[a]===r)return"rtl"}return"ltr"}function l(t){if("number"==typeof t.line&&(t.snapToLines||t.line>=0&&t.line<=100))return t.line;if(!t.track||!t.track.textTrackList||!t.track.textTrackList.mediaElement)return-1;for(var e=t.track,i=e.textTrackList,r=0,n=0;n<i.length&&i[n]!==e;n++)"showing"===i[n].mode&&r++;return++r*-1}function h(){}function c(t,e,i){var r=/MSIE\s8\.0/.test(navigator.userAgent),n="rgba(255, 255, 255, 1)",o="rgba(0, 0, 0, 0.8)";r&&(n="rgb(255, 255, 255)",o="rgb(0, 0, 0)"),h.call(this),this.cue=e,this.cueDiv=s(t,e.text);var l={color:n,backgroundColor:o,position:"relative",left:0,right:0,top:0,bottom:0,display:"inline"};r||(l.writingMode=""===e.vertical?"horizontal-tb":"lr"===e.vertical?"vertical-lr":"vertical-rl",l.unicodeBidi="plaintext"),this.applyStyles(l,this.cueDiv),this.div=t.document.createElement("div"),l={textAlign:"middle"===e.align?"center":e.align,font:i.font,whiteSpace:"pre-line",position:"absolute"},r||(l.direction=a(this.cueDiv),l.writingMode=""===e.vertical?"horizontal-tb":"lr"===e.vertical?"vertical-lr":"vertical-rl".stylesunicodeBidi="plaintext"),this.applyStyles(l),this.div.appendChild(this.cueDiv);var c=0;switch(e.positionAlign){case"start":c=e.position;break;case"middle":c=e.position-e.size/2;break;case"end":c=e.position-e.size}""===e.vertical?this.applyStyles({left:this.formatStyle(c,"%"),width:this.formatStyle(e.size,"%")}):this.applyStyles({top:this.formatStyle(c,"%"),height:this.formatStyle(e.size,"%")}),this.move=function(t){this.applyStyles({top:this.formatStyle(t.top,"px"),bottom:this.formatStyle(t.bottom,"px"),left:this.formatStyle(t.left,"px"),right:this.formatStyle(t.right,"px"),height:this.formatStyle(t.height,"px"),width:this.formatStyle(t.width,"px")})}}function u(t){var e,i,r,n,o=/MSIE\s8\.0/.test(navigator.userAgent);if(t.div){i=t.div.offsetHeight,r=t.div.offsetWidth,n=t.div.offsetTop;var s=(s=t.div.childNodes)&&(s=s[0])&&s.getClientRects&&s.getClientRects();t=t.div.getBoundingClientRect(),e=s?Math.max(s[0]&&s[0].height||0,t.height/s.length):0}this.left=t.left,this.right=t.right,this.top=t.top||n,this.height=t.height||i,this.bottom=t.bottom||n+(t.height||i),this.width=t.width||r,this.lineHeight=void 0!==e?e:t.lineHeight,o&&!this.lineHeight&&(this.lineHeight=13)}function f(t,e,i,r){function n(t,e){for(var n,o=new u(t),s=1,a=0;a<e.length;a++){for(;t.overlapsOppositeAxis(i,e[a])||t.within(i)&&t.overlapsAny(r);)t.move(e[a]);if(t.within(i))return t;var l=t.intersectPercentage(i);s>l&&(n=new u(t),s=l),t=new u(o)}return n||o}var o=new u(e),s=e.cue,a=l(s),h=[];if(s.snapToLines){var c;switch(s.vertical){case"":h=["+y","-y"],c="height";break;case"rl":h=["+x","-x"],c="width";break;case"lr":h=["-x","+x"],c="width"}var f=o.lineHeight,p=f*Math.round(a),g=i[c]+f,d=h[0];Math.abs(p)>g&&(p=p<0?-1:1,p*=Math.ceil(g/f)*f),a<0&&(p+=""===s.vertical?i.height:i.width,h=h.reverse()),o.move(d,p)}else{var v=o.lineHeight/i.height*100;switch(s.lineAlign){case"middle":a-=v/2;break;case"end":a-=v}switch(s.vertical){case"":e.applyStyles({top:e.formatStyle(a,"%")});break;case"rl":e.applyStyles({left:e.formatStyle(a,"%")});break;case"lr":e.applyStyles({right:e.formatStyle(a,"%")})}h=["+y","-x","+x","-y"],o=new u(e)}var m=n(o,h);e.move(m.toCSSCompatValues(i))}function p(){}var g=Object.create||function(){function t(){}return function(e){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return t.prototype=e,new t}}();e.prototype=g(Error.prototype),e.prototype.constructor=e,e.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},r.prototype={set:function(t,e){this.get(t)||""===e||(this.values[t]=e)},get:function(t,e,i){return i?this.has(t)?this.values[t]:e[i]:this.has(t)?this.values[t]:e},has:function(t){return t in this.values},alt:function(t,e,i){for(var r=0;r<i.length;++r)if(e===i[r]){this.set(t,e);break}},integer:function(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))},percent:function(t,e){var i;return!!((i=e.match(/^([\d]{1,3})(\.[\d]*)?%$/))&&(e=parseFloat(e),e>=0&&e<=100))&&(this.set(t,e),!0)}};var d={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"","&rlm;":"","&nbsp;":""},v={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},m={v:"title",lang:"lang"},y={rt:"ruby"},b=[1470,1472,1475,1478,1488,1489,1490,1491,1492,1493,1494,1495,1496,1497,1498,1499,1500,1501,1502,1503,1504,1505,1506,1507,1508,1509,1510,1511,1512,1513,1514,1520,1521,1522,1523,1524,1544,1547,1549,1563,1566,1567,1568,1569,1570,1571,1572,1573,1574,1575,1576,1577,1578,1579,1580,1581,1582,1583,1584,1585,1586,1587,1588,1589,1590,1591,1592,1593,1594,1595,1596,1597,1598,1599,1600,1601,1602,1603,1604,1605,1606,1607,1608,1609,1610,1645,1646,1647,1649,1650,1651,1652,1653,1654,1655,1656,1657,1658,1659,1660,1661,1662,1663,1664,1665,1666,1667,1668,1669,1670,1671,1672,1673,1674,1675,1676,1677,1678,1679,1680,1681,1682,1683,1684,1685,1686,1687,1688,1689,1690,1691,1692,1693,1694,1695,1696,1697,1698,1699,1700,1701,1702,1703,1704,1705,1706,1707,1708,1709,1710,1711,1712,1713,1714,1715,1716,1717,1718,1719,1720,1721,1722,1723,1724,1725,1726,1727,1728,1729,1730,1731,1732,1733,1734,1735,1736,1737,1738,1739,1740,1741,1742,1743,1744,1745,1746,1747,1748,1749,1765,1766,1774,1775,1786,1787,1788,1789,1790,1791,1792,1793,1794,1795,1796,1797,1798,1799,1800,1801,1802,1803,1804,1805,1807,1808,1810,1811,1812,1813,1814,1815,1816,1817,1818,1819,1820,1821,1822,1823,1824,1825,1826,1827,1828,1829,1830,1831,1832,1833,1834,1835,1836,1837,1838,1839,1869,1870,1871,1872,1873,1874,1875,1876,1877,1878,1879,1880,1881,1882,1883,1884,1885,1886,1887,1888,1889,1890,1891,1892,1893,1894,1895,1896,1897,1898,1899,1900,1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1969,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2e3,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024,2025,2026,2036,2037,2042,2048,2049,2050,2051,2052,2053,2054,2055,2056,2057,2058,2059,2060,2061,2062,2063,2064,2065,2066,2067,2068,2069,2074,2084,2088,2096,2097,2098,2099,2100,2101,2102,2103,2104,2105,2106,2107,2108,2109,2110,2112,2113,2114,2115,2116,2117,2118,2119,2120,2121,2122,2123,2124,2125,2126,2127,2128,2129,2130,2131,2132,2133,2134,2135,2136,2142,2208,2210,2211,2212,2213,2214,2215,2216,2217,2218,2219,2220,8207,64285,64287,64288,64289,64290,64291,64292,64293,64294,64295,64296,64298,64299,64300,64301,64302,64303,64304,64305,64306,64307,64308,64309,64310,64312,64313,64314,64315,64316,64318,64320,64321,64323,64324,64326,64327,64328,64329,64330,64331,64332,64333,64334,64335,64336,64337,64338,64339,64340,64341,64342,64343,64344,64345,64346,64347,64348,64349,64350,64351,64352,64353,64354,64355,64356,64357,64358,64359,64360,64361,64362,64363,64364,64365,64366,64367,64368,64369,64370,64371,64372,64373,64374,64375,64376,64377,64378,64379,64380,64381,64382,64383,64384,64385,64386,64387,64388,64389,64390,64391,64392,64393,64394,64395,64396,64397,64398,64399,64400,64401,64402,64403,64404,64405,64406,64407,64408,64409,64410,64411,64412,64413,64414,64415,64416,64417,64418,64419,64420,64421,64422,64423,64424,64425,64426,64427,64428,64429,64430,64431,64432,64433,64434,64435,64436,64437,64438,64439,64440,64441,64442,64443,64444,64445,64446,64447,64448,64449,64467,64468,64469,64470,64471,64472,64473,64474,64475,64476,64477,64478,64479,64480,64481,64482,64483,64484,64485,64486,64487,64488,64489,64490,64491,64492,64493,64494,64495,64496,64497,64498,64499,64500,64501,64502,64503,64504,64505,64506,64507,64508,64509,64510,64511,64512,64513,64514,64515,64516,64517,64518,64519,64520,64521,64522,64523,64524,64525,64526,64527,64528,64529,64530,64531,64532,64533,64534,64535,64536,64537,64538,64539,64540,64541,64542,64543,64544,64545,64546,64547,64548,64549,64550,64551,64552,64553,64554,64555,64556,64557,64558,64559,64560,64561,64562,64563,64564,64565,64566,64567,64568,64569,64570,64571,64572,64573,64574,64575,64576,64577,64578,64579,64580,64581,64582,64583,64584,64585,64586,64587,64588,64589,64590,64591,64592,64593,64594,64595,64596,64597,64598,64599,64600,64601,64602,64603,64604,64605,64606,64607,64608,64609,64610,64611,64612,64613,64614,64615,64616,64617,64618,64619,64620,64621,64622,64623,64624,64625,64626,64627,64628,64629,64630,64631,64632,64633,64634,64635,64636,64637,64638,64639,64640,64641,64642,64643,64644,64645,64646,64647,64648,64649,64650,64651,64652,64653,64654,64655,64656,64657,64658,64659,64660,64661,64662,64663,64664,64665,64666,64667,64668,64669,64670,64671,64672,64673,64674,64675,64676,64677,64678,64679,64680,64681,64682,64683,64684,64685,64686,64687,64688,64689,64690,64691,64692,64693,64694,64695,64696,64697,64698,64699,64700,64701,64702,64703,64704,64705,64706,64707,64708,64709,64710,64711,64712,64713,64714,64715,64716,64717,64718,64719,64720,64721,64722,64723,64724,64725,64726,64727,64728,64729,64730,64731,64732,64733,64734,64735,64736,64737,64738,64739,64740,64741,64742,64743,64744,64745,64746,64747,64748,64749,64750,64751,64752,64753,64754,64755,64756,64757,64758,64759,64760,64761,64762,64763,64764,64765,64766,64767,64768,64769,64770,64771,64772,64773,64774,64775,64776,64777,64778,64779,64780,64781,64782,64783,64784,64785,64786,64787,64788,64789,64790,64791,64792,64793,64794,64795,64796,64797,64798,64799,64800,64801,64802,64803,64804,64805,64806,64807,64808,64809,64810,64811,64812,64813,64814,64815,64816,64817,64818,64819,64820,64821,64822,64823,64824,64825,64826,64827,64828,64829,64848,64849,64850,64851,64852,64853,64854,64855,64856,64857,64858,64859,64860,64861,64862,64863,64864,64865,64866,64867,64868,64869,64870,64871,64872,64873,64874,64875,64876,64877,64878,64879,64880,64881,64882,64883,64884,64885,64886,64887,64888,64889,64890,64891,64892,64893,64894,64895,64896,64897,64898,64899,64900,64901,64902,64903,64904,64905,64906,64907,64908,64909,64910,64911,64914,64915,64916,64917,64918,64919,64920,64921,64922,64923,64924,64925,64926,64927,64928,64929,64930,64931,64932,64933,64934,64935,64936,64937,64938,64939,64940,64941,64942,64943,64944,64945,64946,64947,64948,64949,64950,64951,64952,64953,64954,64955,64956,64957,64958,64959,64960,64961,64962,64963,64964,64965,64966,64967,65008,65009,65010,65011,65012,65013,65014,65015,65016,65017,65018,65019,65020,65136,65137,65138,65139,65140,65142,65143,65144,65145,65146,65147,65148,65149,65150,65151,65152,65153,65154,65155,65156,65157,65158,65159,65160,65161,65162,65163,65164,65165,65166,65167,65168,65169,65170,65171,65172,65173,65174,65175,65176,65177,65178,65179,65180,65181,65182,65183,65184,65185,65186,65187,65188,65189,65190,65191,65192,65193,65194,65195,65196,65197,65198,65199,65200,65201,65202,65203,65204,65205,65206,65207,65208,65209,65210,65211,65212,65213,65214,65215,65216,65217,65218,65219,65220,65221,65222,65223,65224,65225,65226,65227,65228,65229,65230,65231,65232,65233,65234,65235,65236,65237,65238,65239,65240,65241,65242,65243,65244,65245,65246,65247,65248,65249,65250,65251,65252,65253,65254,65255,65256,65257,65258,65259,65260,65261,65262,65263,65264,65265,65266,65267,65268,65269,65270,65271,65272,65273,65274,65275,65276,67584,67585,67586,67587,67588,67589,67592,67594,67595,67596,67597,67598,67599,67600,67601,67602,67603,67604,67605,67606,67607,67608,67609,67610,67611,67612,67613,67614,67615,67616,67617,67618,67619,67620,67621,67622,67623,67624,67625,67626,67627,67628,67629,67630,67631,67632,67633,67634,67635,67636,67637,67639,67640,67644,67647,67648,67649,67650,67651,67652,67653,67654,67655,67656,67657,67658,67659,67660,67661,67662,67663,67664,67665,67666,67667,67668,67669,67671,67672,67673,67674,67675,67676,67677,67678,67679,67840,67841,67842,67843,67844,67845,67846,67847,67848,67849,67850,67851,67852,67853,67854,67855,67856,67857,67858,67859,67860,67861,67862,67863,67864,67865,67866,67867,67872,67873,67874,67875,67876,67877,67878,67879,67880,67881,67882,67883,67884,67885,67886,67887,67888,67889,67890,67891,67892,67893,67894,67895,67896,67897,67903,67968,67969,67970,67971,67972,67973,67974,67975,67976,67977,67978,67979,67980,67981,67982,67983,67984,67985,67986,67987,67988,67989,67990,67991,67992,67993,67994,67995,67996,67997,67998,67999,68e3,68001,68002,68003,68004,68005,68006,68007,68008,68009,68010,68011,68012,68013,68014,68015,68016,68017,68018,68019,68020,68021,68022,68023,68030,68031,68096,68112,68113,68114,68115,68117,68118,68119,68121,68122,68123,68124,68125,68126,68127,68128,68129,68130,68131,68132,68133,68134,68135,68136,68137,68138,68139,68140,68141,68142,68143,68144,68145,68146,68147,68160,68161,68162,68163,68164,68165,68166,68167,68176,68177,68178,68179,68180,68181,68182,68183,68184,68192,68193,68194,68195,68196,68197,68198,68199,68200,68201,68202,68203,68204,68205,68206,68207,68208,68209,68210,68211,68212,68213,68214,68215,68216,68217,68218,68219,68220,68221,68222,68223,68352,68353,68354,68355,68356,68357,68358,68359,68360,68361,68362,68363,68364,68365,68366,68367,68368,68369,68370,68371,68372,68373,68374,68375,68376,68377,68378,68379,68380,68381,68382,68383,68384,68385,68386,68387,68388,68389,68390,68391,68392,68393,68394,68395,68396,68397,68398,68399,68400,68401,68402,68403,68404,68405,68416,68417,68418,68419,68420,68421,68422,68423,68424,68425,68426,68427,68428,68429,68430,68431,68432,68433,68434,68435,68436,68437,68440,68441,68442,68443,68444,68445,68446,68447,68448,68449,68450,68451,68452,68453,68454,68455,68456,68457,68458,68459,68460,68461,68462,68463,68464,68465,68466,68472,68473,68474,68475,68476,68477,68478,68479,68608,68609,68610,68611,68612,68613,68614,68615,68616,68617,68618,68619,68620,68621,68622,68623,68624,68625,68626,68627,68628,68629,68630,68631,68632,68633,68634,68635,68636,68637,68638,68639,68640,68641,68642,68643,68644,68645,68646,68647,68648,68649,68650,68651,68652,68653,68654,68655,68656,68657,68658,68659,68660,68661,68662,68663,68664,68665,68666,68667,68668,68669,68670,68671,68672,68673,68674,68675,68676,68677,68678,68679,68680,126464,126465,126466,126467,126469,126470,126471,126472,126473,126474,126475,126476,126477,126478,126479,126480,126481,126482,126483,126484,126485,126486,126487,126488,126489,126490,126491,126492,126493,126494,126495,126497,126498,126500,126503,126505,126506,126507,126508,126509,126510,126511,126512,126513,126514,126516,126517,126518,126519,126521,126523,126530,126535,126537,126539,126541,126542,126543,126545,126546,126548,126551,126553,126555,126557,126559,126561,126562,126564,126567,126568,126569,126570,126572,126573,126574,126575,126576,126577,126578,126580,126581,126582,126583,126585,126586,126587,126588,126590,126592,126593,126594,126595,126596,126597,126598,126599,126600,126601,126603,126604,126605,126606,126607,126608,126609,126610,126611,126612,126613,126614,126615,126616,126617,126618,126619,126625,126626,126627,126629,126630,126631,126632,126633,126635,126636,126637,126638,126639,126640,126641,126642,126643,126644,126645,126646,126647,126648,126649,126650,126651,1114109];h.prototype.applyStyles=function(t,e){e=e||this.div;for(var i in t)t.hasOwnProperty(i)&&(e.style[i]=t[i])},h.prototype.formatStyle=function(t,e){return 0===t?0:t+e},c.prototype=g(h.prototype),c.prototype.constructor=c,u.prototype.move=function(t,e){switch(e=void 0!==e?e:this.lineHeight,t){case"+x":this.left+=e,this.right+=e;break;case"-x":this.left-=e,this.right-=e;break;case"+y":this.top+=e,this.bottom+=e;break;case"-y":this.top-=e,this.bottom-=e}},u.prototype.overlaps=function(t){return this.left<t.right&&this.right>t.left&&this.top<t.bottom&&this.bottom>t.top},u.prototype.overlapsAny=function(t){for(var e=0;e<t.length;e++)if(this.overlaps(t[e]))return!0;return!1},u.prototype.within=function(t){return this.top>=t.top&&this.bottom<=t.bottom&&this.left>=t.left&&this.right<=t.right},u.prototype.overlapsOppositeAxis=function(t,e){switch(e){case"+x":return this.left<t.left;case"-x":return this.right>t.right;case"+y":return this.top<t.top;case"-y":return this.bottom>t.bottom}},u.prototype.intersectPercentage=function(t){var e=Math.max(0,Math.min(this.right,t.right)-Math.max(this.left,t.left)),i=Math.max(0,Math.min(this.bottom,t.bottom)-Math.max(this.top,t.top)),r=e*i;return r/(this.height*this.width)},u.prototype.toCSSCompatValues=function(t){return{top:this.top-t.top,bottom:t.bottom-this.bottom,left:this.left-t.left,right:t.right-this.right,height:this.height,width:this.width}},u.getSimpleBoxPosition=function(t){var e=t.div?t.div.offsetHeight:t.tagName?t.offsetHeight:0,i=t.div?t.div.offsetWidth:t.tagName?t.offsetWidth:0,r=t.div?t.div.offsetTop:t.tagName?t.offsetTop:0;t=t.div?t.div.getBoundingClientRect():t.tagName?t.getBoundingClientRect():t;var n={left:t.left,right:t.right,top:t.top||r,height:t.height||e,bottom:t.bottom||r+(t.height||e),width:t.width||i};return n},p.StringDecoder=function(){return{decode:function(t){if(!t)return"";if("string"!=typeof t)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}},p.convertCueToDOMTree=function(t,e){return t&&e?s(t,e):null};var w=.05,T="sans-serif",x="1.5%";p.processCues=function(t,e,i){function r(t){for(var e=0;e<t.length;e++)if(t[e].hasBeenReset||!t[e].displayState)return!0;return!1}if(!t||!e||!i)return null;for(;i.firstChild;)i.removeChild(i.firstChild);var n=t.document.createElement("div");if(n.style.position="absolute",n.style.left="0",n.style.right="0",n.style.top="0",n.style.bottom="0",n.style.margin=x,i.appendChild(n),r(e)){var o=[],s=u.getSimpleBoxPosition(n),a=Math.round(s.height*w*100)/100,l={font:a+"px "+T};!function(){for(var i,r,a=0;a<e.length;a++)r=e[a],i=new c(t,r,l),n.appendChild(i.div),f(t,i,s,o),r.displayState=i.div,o.push(u.getSimpleBoxPosition(i))}()}else for(var h=0;h<e.length;h++)n.appendChild(e[h].displayState)},p.Parser=function(t,e,i){i||(i=e,e={}),e||(e={}),this.window=t,this.vttjs=e,this.state="INITIAL",this.buffer="",this.decoder=i||new TextDecoder("utf8"),this.regionList=[]},p.Parser.prototype={reportOrThrowError:function(t){if(!(t instanceof e))throw t;this.onparsingerror&&this.onparsingerror(t)},parse:function(t){function i(){for(var t=l.buffer,e=0;e<t.length&&"\r"!==t[e]&&"\n"!==t[e];)++e;var i=t.substr(0,e);return"\r"===t[e]&&++e,"\n"===t[e]&&++e,l.buffer=t.substr(e),i}function s(t){var e=new r;if(n(t,function(t,i){switch(t){case"id":e.set(t,i);break;case"width":e.percent(t,i);break;case"lines":e.integer(t,i);break;case"regionanchor":case"viewportanchor":var n=i.split(",");if(2!==n.length)break;var o=new r;if(o.percent("x",n[0]),o.percent("y",n[1]),!o.has("x")||!o.has("y"))break;e.set(t+"X",o.get("x")),e.set(t+"Y",o.get("y"));break;case"scroll":e.alt(t,i,["up"])}},/=/,/\s/),e.has("id")){var i=new(l.vttjs.VTTRegion||l.window.VTTRegion);i.width=e.get("width",100),i.lines=e.get("lines",3),i.regionAnchorX=e.get("regionanchorX",0),i.regionAnchorY=e.get("regionanchorY",100),i.viewportAnchorX=e.get("viewportanchorX",0),i.viewportAnchorY=e.get("viewportanchorY",100),i.scroll=e.get("scroll",""),l.onregion&&l.onregion(i),l.regionList.push({id:e.get("id"),region:i})}}function a(t){n(t,function(t,e){switch(t){case"Region":s(e)}},/:/)}var l=this;t&&(l.buffer+=l.decoder.decode(t,{stream:!0}));try{var h;if("INITIAL"===l.state){if(!/\r\n|\n/.test(l.buffer))return this;h=i();var c=h.match(/^WEBVTT([ \t].*)?$/);if(!c||!c[0])throw new e(e.Errors.BadSignature);l.state="HEADER"}for(var u=!1;l.buffer;){if(!/\r\n|\n/.test(l.buffer))return this;switch(u?u=!1:h=i(),l.state){case"HEADER":/:/.test(h)?a(h):h||(l.state="ID");continue;case"NOTE":h||(l.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(h)){l.state="NOTE";break}if(!h)continue;if(l.cue=new(l.vttjs.VTTCue||l.window.VTTCue)(0,0,""),l.state="CUE",h.indexOf("-->")===-1){l.cue.id=h;continue}case"CUE":try{o(h,l.cue,l.regionList)}catch(t){l.reportOrThrowError(t),l.cue=null,l.state="BADCUE";continue}l.state="CUETEXT";continue;case"CUETEXT":var f=h.indexOf("-->")!==-1;if(!h||f&&(u=!0)){l.oncue&&l.oncue(l.cue),l.cue=null,l.state="ID";continue}l.cue.text&&(l.cue.text+="\n"),l.cue.text+=h;continue;case"BADCUE":h||(l.state="ID");continue}}}catch(t){l.reportOrThrowError(t),"CUETEXT"===l.state&&l.cue&&l.oncue&&l.oncue(l.cue),l.cue=null,l.state="INITIAL"===l.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var t=this;try{if(t.buffer+=t.decoder.decode(),(t.cue||"HEADER"===t.state)&&(t.buffer+="\n\n",t.parse()),"INITIAL"===t.state)throw new e(e.Errors.BadSignature)}catch(e){t.reportOrThrowError(e)}return t.onflush&&t.onflush(),this}},t.WebVTT=p}(this,this.vttjs||{});
},{}],466:[function(require,module,exports){
arguments[4][460][0].apply(exports,arguments)
},{"./vttcue":467,"dup":460}],467:[function(require,module,exports){
arguments[4][461][0].apply(exports,arguments)
},{"dup":461}],468:[function(require,module,exports){
arguments[4][462][0].apply(exports,arguments)
},{"./vttregion":469,"dup":462}],469:[function(require,module,exports){
arguments[4][463][0].apply(exports,arguments)
},{"dup":463}],470:[function(require,module,exports){
(function (global){
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.WebVRManager=e()}}(function(){return function e(t,i,n){function s(r,a){if(!i[r]){if(!t[r]){var c="function"==typeof require&&require;if(!a&&c)return c(r,!0);if(o)return o(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var u=i[r]={exports:{}};t[r][0].call(u.exports,function(e){var i=t[r][1][e];return s(i?i:e)},u,u.exports,e,t,i,n)}return i[r].exports}for(var o="function"==typeof require&&require,r=0;r<n.length;r++)s(n[r]);return s}({1:[function(e,t,i){function n(e){var t=e||document.body;this.loadIcons_();var i=this.createButton();i.src=this.ICONS.fullscreen,i.title="Fullscreen mode";var n=i.style;n.top=0,n.right=0,i.addEventListener("click",this.createClickHandler_("fs")),t.appendChild(i),this.fsButton=i;var s=this.createButton();s.src=this.ICONS.cardboard,s.title="Virtual reality mode";var n=s.style;n.top=0,n.right="48px",s.addEventListener("click",this.createClickHandler_("vr")),t.appendChild(s),this.vrButton=s,this.isVisible=!0}var s=e("./emitter.js"),o=e("./modes.js"),r=e("./util.js");n.prototype=new s,n.prototype.createButton=function(){var e=document.createElement("img");e.className="webvr-button";var t=e.style;return t.position="absolute",t.width="24px",t.height="24px",t.backgroundSize="cover",t.backgroundColor="transparent",t.border=0,t.userSelect="none",t.webkitUserSelect="none",t.MozUserSelect="none",t.cursor="pointer",t.padding="12px",t.zIndex=1,t.display="none",t.boxSizing="content-box",e.draggable=!1,e.addEventListener("dragstart",function(e){e.preventDefault()}),e.addEventListener("mouseenter",function(e){t.filter=t.webkitFilter="drop-shadow(0 0 5px rgba(255,255,255,1))"}),e.addEventListener("mouseleave",function(e){t.filter=t.webkitFilter=""}),e},n.prototype.setMode=function(e,t){if(t=t||WebVRConfig.FORCE_ENABLE_VR,this.isVisible){switch(e){case o.NORMAL:this.fsButton.style.display="block",this.fsButton.src=this.ICONS.fullscreen,this.vrButton.style.display=t?"block":"none";break;case o.MAGIC_WINDOW:this.fsButton.style.display="block",this.fsButton.src=this.ICONS.exitFullscreen,this.vrButton.style.display="none";break;case o.VR:this.fsButton.style.display="none",this.vrButton.style.display="none"}var i=this.fsButton.style.display;this.fsButton.style.display="inline-block",this.fsButton.offsetHeight,this.fsButton.style.display=i}},n.prototype.setVisibility=function(e){this.isVisible=e,this.fsButton.style.display=e?"block":"none",this.vrButton.style.display=e?"block":"none"},n.prototype.createClickHandler_=function(e){return function(t){t.stopPropagation(),t.preventDefault(),this.emit(e)}.bind(this)},n.prototype.loadIcons_=function(){this.ICONS={},this.ICONS.cardboard=r.base64("image/svg+xml","PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNHB4IiBoZWlnaHQ9IjI0cHgiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iI0ZGRkZGRiI+CiAgICA8cGF0aCBkPSJNMjAuNzQgNkgzLjIxQzIuNTUgNiAyIDYuNTcgMiA3LjI4djEwLjQ0YzAgLjcuNTUgMS4yOCAxLjIzIDEuMjhoNC43OWMuNTIgMCAuOTYtLjMzIDEuMTQtLjc5bDEuNC0zLjQ4Yy4yMy0uNTkuNzktMS4wMSAxLjQ0LTEuMDFzMS4yMS40MiAxLjQ1IDEuMDFsMS4zOSAzLjQ4Yy4xOS40Ni42My43OSAxLjExLjc5aDQuNzljLjcxIDAgMS4yNi0uNTcgMS4yNi0xLjI4VjcuMjhjMC0uNy0uNTUtMS4yOC0xLjI2LTEuMjh6TTcuNSAxNC42MmMtMS4xNyAwLTIuMTMtLjk1LTIuMTMtMi4xMiAwLTEuMTcuOTYtMi4xMyAyLjEzLTIuMTMgMS4xOCAwIDIuMTIuOTYgMi4xMiAyLjEzcy0uOTUgMi4xMi0yLjEyIDIuMTJ6bTkgMGMtMS4xNyAwLTIuMTMtLjk1LTIuMTMtMi4xMiAwLTEuMTcuOTYtMi4xMyAyLjEzLTIuMTNzMi4xMi45NiAyLjEyIDIuMTMtLjk1IDIuMTItMi4xMiAyLjEyeiIvPgogICAgPHBhdGggZmlsbD0ibm9uZSIgZD0iTTAgMGgyNHYyNEgwVjB6Ii8+Cjwvc3ZnPgo="),this.ICONS.fullscreen=r.base64("image/svg+xml","PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNHB4IiBoZWlnaHQ9IjI0cHgiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iI0ZGRkZGRiI+CiAgICA8cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+CiAgICA8cGF0aCBkPSJNNyAxNEg1djVoNXYtMkg3di0zem0tMi00aDJWN2gzVjVINXY1em0xMiA3aC0zdjJoNXYtNWgtMnYzek0xNCA1djJoM3YzaDJWNWgtNXoiLz4KPC9zdmc+Cg=="),this.ICONS.exitFullscreen=r.base64("image/svg+xml","PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNHB4IiBoZWlnaHQ9IjI0cHgiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iI0ZGRkZGRiI+CiAgICA8cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+CiAgICA8cGF0aCBkPSJNNSAxNmgzdjNoMnYtNUg1djJ6bTMtOEg1djJoNVY1SDh2M3ptNiAxMWgydi0zaDN2LTJoLTV2NXptMi0xMVY1aC0ydjVoNVY4aC0zeiIvPgo8L3N2Zz4K"),this.ICONS.settings=r.base64("image/svg+xml","PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNHB4IiBoZWlnaHQ9IjI0cHgiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iI0ZGRkZGRiI+CiAgICA8cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+CiAgICA8cGF0aCBkPSJNMTkuNDMgMTIuOThjLjA0LS4zMi4wNy0uNjQuMDctLjk4cy0uMDMtLjY2LS4wNy0uOThsMi4xMS0xLjY1Yy4xOS0uMTUuMjQtLjQyLjEyLS42NGwtMi0zLjQ2Yy0uMTItLjIyLS4zOS0uMy0uNjEtLjIybC0yLjQ5IDFjLS41Mi0uNC0xLjA4LS43My0xLjY5LS45OGwtLjM4LTIuNjVDMTQuNDYgMi4xOCAxNC4yNSAyIDE0IDJoLTRjLS4yNSAwLS40Ni4xOC0uNDkuNDJsLS4zOCAyLjY1Yy0uNjEuMjUtMS4xNy41OS0xLjY5Ljk4bC0yLjQ5LTFjLS4yMy0uMDktLjQ5IDAtLjYxLjIybC0yIDMuNDZjLS4xMy4yMi0uMDcuNDkuMTIuNjRsMi4xMSAxLjY1Yy0uMDQuMzItLjA3LjY1LS4wNy45OHMuMDMuNjYuMDcuOThsLTIuMTEgMS42NWMtLjE5LjE1LS4yNC40Mi0uMTIuNjRsMiAzLjQ2Yy4xMi4yMi4zOS4zLjYxLjIybDIuNDktMWMuNTIuNCAxLjA4LjczIDEuNjkuOThsLjM4IDIuNjVjLjAzLjI0LjI0LjQyLjQ5LjQyaDRjLjI1IDAgLjQ2LS4xOC40OS0uNDJsLjM4LTIuNjVjLjYxLS4yNSAxLjE3LS41OSAxLjY5LS45OGwyLjQ5IDFjLjIzLjA5LjQ5IDAgLjYxLS4yMmwyLTMuNDZjLjEyLS4yMi4wNy0uNDktLjEyLS42NGwtMi4xMS0xLjY1ek0xMiAxNS41Yy0xLjkzIDAtMy41LTEuNTctMy41LTMuNXMxLjU3LTMuNSAzLjUtMy41IDMuNSAxLjU3IDMuNSAzLjUtMS41NyAzLjUtMy41IDMuNXoiLz4KPC9zdmc+Cg==")},t.exports=n},{"./emitter.js":2,"./modes.js":3,"./util.js":4}],2:[function(e,t,i){function n(){this.callbacks={}}n.prototype.emit=function(e){var t=this.callbacks[e];if(t){var i=[].slice.call(arguments);i.shift();for(var n=0;n<t.length;n++)t[n].apply(this,i)}},n.prototype.on=function(e,t){e in this.callbacks?this.callbacks[e].push(t):this.callbacks[e]=[t]},t.exports=n},{}],3:[function(e,t,i){var n={UNKNOWN:0,NORMAL:1,MAGIC_WINDOW:2,VR:3};t.exports=n},{}],4:[function(e,t,i){var n={};n.base64=function(e,t){return"data:"+e+";base64,"+t},n.isMobile=function(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e},n.isFirefox=function(){return/firefox/i.test(navigator.userAgent)},n.isIOS=function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},n.isIFrame=function(){try{return window.self!==window.top}catch(e){return!0}},n.appendQueryParameter=function(e,t,i){var n=e.indexOf("?")<0?"?":"&";return e+=n+t+"="+i},n.getQueryParameter=function(e){var e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),t=new RegExp("[\\?&]"+e+"=([^&#]*)"),i=t.exec(location.search);return null===i?"":decodeURIComponent(i[1].replace(/\+/g," "))},n.isLandscapeMode=function(){return 90==window.orientation||window.orientation==-90},n.getScreenWidth=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},n.getScreenHeight=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},t.exports=n},{}],5:[function(e,t,i){function n(e,t,i){this.params=i||{},this.mode=r.UNKNOWN,this.hideButton=this.params.hideButton||!1,this.predistorted=!!this.params.predistorted,this.renderer=e,this.effect=t;var n=document.querySelector(".webvr-polyfill-fullscreen-wrapper");this.button=new s(n),this.isFullscreenDisabled=!!a.getQueryParameter("no_fullscreen"),this.startMode=r.NORMAL;var o=parseInt(a.getQueryParameter("start_mode"));isNaN(o)||(this.startMode=o),this.hideButton&&this.button.setVisibility(!1),this.getDeviceByType_(VRDisplay).then(function(e){switch(this.hmd=e,this.isVRCompatibleOverride||(this.isVRCompatible=!e.isPolyfilled||a.isMobile()),this.startMode){case r.MAGIC_WINDOW:this.setMode_(r.MAGIC_WINDOW);break;case r.VR:this.enterVRMode_(),this.setMode_(r.VR);break;default:this.setMode_(r.NORMAL)}this.emit("initialized")}.bind(this)),this.button.on("fs",this.onFSClick_.bind(this)),this.button.on("vr",this.onVRClick_.bind(this)),document.addEventListener("webkitfullscreenchange",this.onFullscreenChange_.bind(this)),document.addEventListener("mozfullscreenchange",this.onFullscreenChange_.bind(this)),document.addEventListener("msfullscreenchange",this.onFullscreenChange_.bind(this)),window.addEventListener("vrdisplaypresentchange",this.onVRDisplayPresentChange_.bind(this)),window.addEventListener("vrdisplaydeviceparamschange",this.onVRDisplayDeviceParamsChange_.bind(this))}var s=e("./button-manager.js"),o=e("./emitter.js"),r=e("./modes.js"),a=e("./util.js");n.prototype=new o,n.Modes=r,n.prototype.render=function(e,t,i){e instanceof Array?this.effect.render(e[0],t):this.effect.render(e,t)},n.prototype.setVRCompatibleOverride=function(e){this.isVRCompatible=e,this.isVRCompatibleOverride=!0,this.button.setMode(this.mode,this.isVRCompatible)},n.prototype.setFullscreenCallback=function(e){this.fullscreenCallback=e},n.prototype.setVRCallback=function(e){this.vrCallback=e},n.prototype.setExitFullscreenCallback=function(e){this.exitFullscreenCallback=e},n.prototype.getDeviceByType_=function(e){return new Promise(function(t,i){navigator.getVRDisplays().then(function(i){for(var n=0;n<i.length;n++)if(i[n]instanceof e){t(i[n]);break}t(null)},function(){t(null)})})},n.prototype.enterVRMode_=function(){this.hmd.requestPresent([{source:this.renderer.domElement,predistorted:this.predistorted}])},n.prototype.setMode_=function(e){var t=this.mode;return e==this.mode?void console.warn("Not changing modes, already in %s",e):(this.mode=e,this.button.setMode(e,this.isVRCompatible),void this.emit("modechange",e,t))},n.prototype.onFSClick_=function(){switch(this.mode){case r.NORMAL:if(a.isIOS()&&a.isIFrame()){if(!this.fullscreenCallback){var e=window.location.href;return e=a.appendQueryParameter(e,"no_fullscreen","true"),e=a.appendQueryParameter(e,"start_mode",r.MAGIC_WINDOW),void(top.location.href=e)}this.fullscreenCallback()}this.setMode_(r.MAGIC_WINDOW),this.requestFullscreen_();break;case r.MAGIC_WINDOW:if(this.isFullscreenDisabled)return void window.history.back();this.exitFullscreenCallback&&this.exitFullscreenCallback(),this.setMode_(r.NORMAL),this.exitFullscreen_()}},n.prototype.onVRClick_=function(){if(this.mode==r.NORMAL&&a.isIOS()&&a.isIFrame()){if(!this.vrCallback){var e=window.location.href;return e=a.appendQueryParameter(e,"no_fullscreen","true"),e=a.appendQueryParameter(e,"start_mode",r.VR),void(top.location.href=e)}this.vrCallback()}this.enterVRMode_()},n.prototype.requestFullscreen_=function(){var e=document.body;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()},n.prototype.exitFullscreen_=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()},n.prototype.onVRDisplayPresentChange_=function(e){console.log("onVRDisplayPresentChange_",e),this.hmd.isPresenting?this.setMode_(r.VR):this.setMode_(r.NORMAL)},n.prototype.onVRDisplayDeviceParamsChange_=function(e){console.log("onVRDisplayDeviceParamsChange_",e)},n.prototype.onFullscreenChange_=function(e){null!==document.webkitFullscreenElement&&null!==document.mozFullScreenElement||this.setMode_(r.NORMAL)},t.exports=n},{"./button-manager.js":1,"./emitter.js":2,"./modes.js":3,"./util.js":4}]},{},[5])(5)});
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],471:[function(require,module,exports){
!function e(M,i,t){function A(r,N){if(!i[r]){if(!M[r]){var D="function"==typeof require&&require;if(!N&&D)return D(r,!0);if(s)return s(r,!0);var n=new Error("Cannot find module '"+r+"'");throw n.code="MODULE_NOT_FOUND",n}var u=i[r]={exports:{}};M[r][0].call(u.exports,function(e){var i=M[r][1][e];return A(i?i:e)},u,u.exports,e,M,i,t)}return i[r].exports}for(var s="function"==typeof require&&require,r=0;r<t.length;r++)A(t[r]);return A}({1:[function(e,M,i){"use strict";function t(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function A(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var M={},i=0;i<10;i++)M["_"+String.fromCharCode(i)]=i;var t=Object.getOwnPropertyNames(M).map(function(e){return M[e]});if("0123456789"!==t.join(""))return!1;var A={};return"abcdefghijklmnopqrst".split("").forEach(function(e){A[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},A)).join("")}catch(e){return!1}}var s=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;M.exports=A()?Object.assign:function(e,M){for(var i,A,N=t(e),D=1;D<arguments.length;D++){i=Object(arguments[D]);for(var n in i)s.call(i,n)&&(N[n]=i[n]);if(Object.getOwnPropertySymbols){A=Object.getOwnPropertySymbols(i);for(var u=0;u<A.length;u++)r.call(i,A[u])&&(N[A[u]]=i[A[u]])}}return N}},{}],2:[function(e,M,i){function t(){this.leftProjectionMatrix=new Float32Array(16),this.leftViewMatrix=new Float32Array(16),this.rightProjectionMatrix=new Float32Array(16),this.rightViewMatrix=new Float32Array(16),this.pose=null}function A(){this.isPolyfilled=!0,this.displayId=u++,this.displayName="webvr-polyfill displayName",this.depthNear=.01,this.depthFar=1e4,this.isConnected=!0,this.isPresenting=!1,this.capabilities={hasPosition:!1,hasOrientation:!1,hasExternalDisplay:!1,canPresent:!1,maxLayers:1},this.stageParameters=null,this.waitingForPresent_=!1,this.layer_=null,this.fullscreenElement_=null,this.fullscreenWrapper_=null,this.fullscreenElementCachedStyle_=null,this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null,this.wakelock_=new n}function s(){this.isPolyfilled=!0,this.hardwareUnitId="webvr-polyfill hardwareUnitId",this.deviceId="webvr-polyfill deviceId",this.deviceName="webvr-polyfill deviceName"}function r(){}function N(){}var D=e("./util.js"),n=e("./wakelock.js"),u=1e3,a=!1,o=[0,0,.5,1],g=[.5,0,.5,1];A.prototype.getFrameData=function(e){return D.frameDataFromPose(e,this.getPose(),this)},A.prototype.getPose=function(){return this.getImmediatePose()},A.prototype.requestAnimationFrame=function(e){return window.requestAnimationFrame(e)},A.prototype.cancelAnimationFrame=function(e){return window.cancelAnimationFrame(e)},A.prototype.wrapForFullscreen=function(e){function M(){if(A.fullscreenElement_){var e=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0"];A.fullscreenElement_.setAttribute("style",e.join("; ")+";")}}if(D.isIOS())return e;if(!this.fullscreenWrapper_){this.fullscreenWrapper_=document.createElement("div");var i=["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important","left: 0 !important","right: 0 !important","border: 0","margin: 0","padding: 0","z-index: 999999 !important","position: fixed"];this.fullscreenWrapper_.setAttribute("style",i.join("; ")+";"),this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper")}if(this.fullscreenElement_==e)return this.fullscreenWrapper_;this.removeFullscreenWrapper(),this.fullscreenElement_=e;var t=this.fullscreenElement_.parentElement;t.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_),t.removeChild(this.fullscreenElement_),this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild),this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");var A=this;return M(),this.fullscreenWrapper_},A.prototype.removeFullscreenWrapper=function(){if(this.fullscreenElement_){var e=this.fullscreenElement_;this.fullscreenElementCachedStyle_?e.setAttribute("style",this.fullscreenElementCachedStyle_):e.removeAttribute("style"),this.fullscreenElement_=null,this.fullscreenElementCachedStyle_=null;var M=this.fullscreenWrapper_.parentElement;return this.fullscreenWrapper_.removeChild(e),M.insertBefore(e,this.fullscreenWrapper_),M.removeChild(this.fullscreenWrapper_),e}},A.prototype.requestPresent=function(e){var M=this.isPresenting,i=this;return e instanceof Array||(a||(console.warn("Using a deprecated form of requestPresent. Should pass in an array of VRLayers."),a=!0),e=[e]),new Promise(function(t,A){function s(){var e=D.getFullscreenElement();i.isPresenting=I===e,i.isPresenting?(screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape-primary").catch(function(e){console.error("screen.orientation.lock() failed due to",e.message)}),i.waitingForPresent_=!1,i.beginPresent_(),t()):(screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),i.removeFullscreenWrapper(),i.wakelock_.release(),i.endPresent_(),i.removeFullscreenListeners_()),i.fireVRDisplayPresentChange_()}function r(){i.waitingForPresent_&&(i.removeFullscreenWrapper(),i.removeFullscreenListeners_(),i.wakelock_.release(),i.waitingForPresent_=!1,i.isPresenting=!1,A(new Error("Unable to present.")))}if(!i.capabilities.canPresent)return void A(new Error("VRDisplay is not capable of presenting."));if(0==e.length||e.length>i.capabilities.maxLayers)return void A(new Error("Invalid number of layers."));var N=e[0];if(!N.source)return void t();var n=N.leftBounds||o,u=N.rightBounds||g;if(M){var a=i.layer_;a.source!==N.source&&(a.source=N.source);for(var j=0;j<4;j++)a.leftBounds[j]!==n[j]&&(a.leftBounds[j]=n[j]),a.rightBounds[j]!==u[j]&&(a.rightBounds[j]=u[j]);return void t()}if(i.layer_={predistorted:N.predistorted,source:N.source,leftBounds:n.slice(0),rightBounds:u.slice(0)},i.waitingForPresent_=!1,i.layer_&&i.layer_.source){var I=i.wrapForFullscreen(i.layer_.source);i.addFullscreenListeners_(I,s,r),D.requestFullscreen(I)?(i.wakelock_.request(),i.waitingForPresent_=!0):D.isIOS()&&(i.wakelock_.request(),i.isPresenting=!0,i.beginPresent_(),i.fireVRDisplayPresentChange_(),t())}i.waitingForPresent_||D.isIOS()||(D.exitFullscreen(),A(new Error("Unable to present.")))})},A.prototype.exitPresent=function(){var e=this.isPresenting,M=this;return this.isPresenting=!1,this.layer_=null,this.wakelock_.release(),new Promise(function(i,t){e?(!D.exitFullscreen()&&D.isIOS()&&(M.endPresent_(),M.fireVRDisplayPresentChange_()),i()):t(new Error("Was not presenting to VRDisplay."))})},A.prototype.getLayers=function(){return this.layer_?[this.layer_]:[]},A.prototype.fireVRDisplayPresentChange_=function(){var e=new CustomEvent("vrdisplaypresentchange",{detail:{display:this}});window.dispatchEvent(e)},A.prototype.addFullscreenListeners_=function(e,M,i){this.removeFullscreenListeners_(),this.fullscreenEventTarget_=e,this.fullscreenChangeHandler_=M,this.fullscreenErrorHandler_=i,M&&(document.fullscreenEnabled?e.addEventListener("fullscreenchange",M,!1):document.webkitFullscreenEnabled?e.addEventListener("webkitfullscreenchange",M,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenchange",M,!1):document.msFullscreenEnabled&&e.addEventListener("msfullscreenchange",M,!1)),i&&(document.fullscreenEnabled?e.addEventListener("fullscreenerror",i,!1):document.webkitFullscreenEnabled?e.addEventListener("webkitfullscreenerror",i,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenerror",i,!1):document.msFullscreenEnabled&&e.addEventListener("msfullscreenerror",i,!1))},A.prototype.removeFullscreenListeners_=function(){if(this.fullscreenEventTarget_){var e=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var M=this.fullscreenChangeHandler_;e.removeEventListener("fullscreenchange",M,!1),e.removeEventListener("webkitfullscreenchange",M,!1),document.removeEventListener("mozfullscreenchange",M,!1),e.removeEventListener("msfullscreenchange",M,!1)}if(this.fullscreenErrorHandler_){var i=this.fullscreenErrorHandler_;e.removeEventListener("fullscreenerror",i,!1),e.removeEventListener("webkitfullscreenerror",i,!1),document.removeEventListener("mozfullscreenerror",i,!1),e.removeEventListener("msfullscreenerror",i,!1)}this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null}},A.prototype.beginPresent_=function(){},A.prototype.endPresent_=function(){},A.prototype.submitFrame=function(e){},A.prototype.getEyeParameters=function(e){return null},r.prototype=new s,N.prototype=new s,M.exports.VRFrameData=t,M.exports.VRDisplay=A,M.exports.VRDevice=s,M.exports.HMDVRDevice=r,M.exports.PositionSensorVRDevice=N},{"./util.js":22,"./wakelock.js":24}],3:[function(e,M,i){function t(e){this.gl=e,this.ctxAttribs=e.getContextAttributes(),this.meshWidth=20,this.meshHeight=20,this.bufferScale=WebVRConfig.BUFFER_SCALE,this.bufferWidth=e.drawingBufferWidth,this.bufferHeight=e.drawingBufferHeight,this.realBindFramebuffer=e.bindFramebuffer,this.realEnable=e.enable,this.realDisable=e.disable,this.realColorMask=e.colorMask,this.realClearColor=e.clearColor,this.realViewport=e.viewport,s.isIOS()||(this.realCanvasWidth=Object.getOwnPropertyDescriptor(e.canvas.__proto__,"width"),this.realCanvasHeight=Object.getOwnPropertyDescriptor(e.canvas.__proto__,"height")),this.isPatched=!1,this.lastBoundFramebuffer=null,this.cullFace=!1,this.depthTest=!1,this.blend=!1,this.scissorTest=!1,this.stencilTest=!1,this.viewport=[0,0,0,0],this.colorMask=[!0,!0,!0,!0],this.clearColor=[0,0,0,0],this.attribs={position:0,texCoord:1},this.program=s.linkProgram(e,N,D,this.attribs),this.uniforms=s.getProgramUniforms(e,this.program),this.viewportOffsetScale=new Float32Array(8),this.setTextureBounds(),this.vertexBuffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),this.indexCount=0,this.renderTarget=e.createTexture(),this.framebuffer=e.createFramebuffer(),this.depthStencilBuffer=null,this.depthBuffer=null,this.stencilBuffer=null,this.ctxAttribs.depth&&this.ctxAttribs.stencil?this.depthStencilBuffer=e.createRenderbuffer():this.ctxAttribs.depth?this.depthBuffer=e.createRenderbuffer():this.ctxAttribs.stencil&&(this.stencilBuffer=e.createRenderbuffer()),this.patch(),this.onResize(),WebVRConfig.CARDBOARD_UI_DISABLED||(this.cardboardUI=new A(e))}var A=e("./cardboard-ui.js"),s=e("./util.js"),r=e("./deps/wglu-preserve-state.js"),N=["attribute vec2 position;","attribute vec3 texCoord;","varying vec2 vTexCoord;","uniform vec4 viewportOffsetScale[2];","void main() {","  vec4 viewport = viewportOffsetScale[int(texCoord.z)];","  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;","  gl_Position = vec4( position, 1.0, 1.0 );","}"].join("\n"),D=["precision mediump float;","uniform sampler2D diffuse;","varying vec2 vTexCoord;","void main() {","  gl_FragColor = texture2D(diffuse, vTexCoord);","}"].join("\n");t.prototype.destroy=function(){var e=this.gl;this.unpatch(),e.deleteProgram(this.program),e.deleteBuffer(this.vertexBuffer),e.deleteBuffer(this.indexBuffer),e.deleteTexture(this.renderTarget),e.deleteFramebuffer(this.framebuffer),this.depthStencilBuffer&&e.deleteRenderbuffer(this.depthStencilBuffer),this.depthBuffer&&e.deleteRenderbuffer(this.depthBuffer),this.stencilBuffer&&e.deleteRenderbuffer(this.stencilBuffer),this.cardboardUI&&this.cardboardUI.destroy()},t.prototype.onResize=function(){var e=this.gl,M=this,i=[e.RENDERBUFFER_BINDING,e.TEXTURE_BINDING_2D,e.TEXTURE0];r(e,i,function(e){M.realBindFramebuffer.call(e,e.FRAMEBUFFER,null),M.scissorTest&&M.realDisable.call(e,e.SCISSOR_TEST),M.realColorMask.call(e,!0,!0,!0,!0),M.realViewport.call(e,0,0,e.drawingBufferWidth,e.drawingBufferHeight),M.realClearColor.call(e,0,0,0,1),e.clear(e.COLOR_BUFFER_BIT),M.realBindFramebuffer.call(e,e.FRAMEBUFFER,M.framebuffer),e.bindTexture(e.TEXTURE_2D,M.renderTarget),e.texImage2D(e.TEXTURE_2D,0,M.ctxAttribs.alpha?e.RGBA:e.RGB,M.bufferWidth,M.bufferHeight,0,M.ctxAttribs.alpha?e.RGBA:e.RGB,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,M.renderTarget,0),M.ctxAttribs.depth&&M.ctxAttribs.stencil?(e.bindRenderbuffer(e.RENDERBUFFER,M.depthStencilBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,M.bufferWidth,M.bufferHeight),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,M.depthStencilBuffer)):M.ctxAttribs.depth?(e.bindRenderbuffer(e.RENDERBUFFER,M.depthBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,M.bufferWidth,M.bufferHeight),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,M.depthBuffer)):M.ctxAttribs.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,M.stencilBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.STENCIL_INDEX8,M.bufferWidth,M.bufferHeight),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.STENCIL_ATTACHMENT,e.RENDERBUFFER,M.stencilBuffer)),!e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer incomplete!"),M.realBindFramebuffer.call(e,e.FRAMEBUFFER,M.lastBoundFramebuffer),M.scissorTest&&M.realEnable.call(e,e.SCISSOR_TEST),M.realColorMask.apply(e,M.colorMask),M.realViewport.apply(e,M.viewport),M.realClearColor.apply(e,M.clearColor)}),this.cardboardUI&&this.cardboardUI.onResize()},t.prototype.patch=function(){if(!this.isPatched){var e=this,M=this.gl.canvas,i=this.gl;s.isIOS()||(M.width=s.getScreenWidth()*this.bufferScale,M.height=s.getScreenHeight()*this.bufferScale,Object.defineProperty(M,"width",{configurable:!0,enumerable:!0,get:function(){return e.bufferWidth},set:function(i){e.bufferWidth=i,e.realCanvasWidth.set.call(M,i),e.onResize()}}),Object.defineProperty(M,"height",{configurable:!0,enumerable:!0,get:function(){return e.bufferHeight},set:function(i){e.bufferHeight=i,e.realCanvasHeight.set.call(M,i),e.onResize()}})),this.lastBoundFramebuffer=i.getParameter(i.FRAMEBUFFER_BINDING),null==this.lastBoundFramebuffer&&(this.lastBoundFramebuffer=this.framebuffer,this.gl.bindFramebuffer(i.FRAMEBUFFER,this.framebuffer)),this.gl.bindFramebuffer=function(M,t){e.lastBoundFramebuffer=t?t:e.framebuffer,e.realBindFramebuffer.call(i,M,e.lastBoundFramebuffer)},this.cullFace=i.getParameter(i.CULL_FACE),this.depthTest=i.getParameter(i.DEPTH_TEST),this.blend=i.getParameter(i.BLEND),this.scissorTest=i.getParameter(i.SCISSOR_TEST),this.stencilTest=i.getParameter(i.STENCIL_TEST),i.enable=function(M){switch(M){case i.CULL_FACE:e.cullFace=!0;break;case i.DEPTH_TEST:e.depthTest=!0;break;case i.BLEND:e.blend=!0;break;case i.SCISSOR_TEST:e.scissorTest=!0;break;case i.STENCIL_TEST:e.stencilTest=!0}e.realEnable.call(i,M)},i.disable=function(M){switch(M){case i.CULL_FACE:e.cullFace=!1;break;case i.DEPTH_TEST:e.depthTest=!1;break;case i.BLEND:e.blend=!1;break;case i.SCISSOR_TEST:e.scissorTest=!1;break;case i.STENCIL_TEST:e.stencilTest=!1}e.realDisable.call(i,M)},this.colorMask=i.getParameter(i.COLOR_WRITEMASK),i.colorMask=function(M,t,A,s){e.colorMask[0]=M,e.colorMask[1]=t,e.colorMask[2]=A,e.colorMask[3]=s,e.realColorMask.call(i,M,t,A,s)},this.clearColor=i.getParameter(i.COLOR_CLEAR_VALUE),i.clearColor=function(M,t,A,s){e.clearColor[0]=M,e.clearColor[1]=t,e.clearColor[2]=A,e.clearColor[3]=s,e.realClearColor.call(i,M,t,A,s)},this.viewport=i.getParameter(i.VIEWPORT),i.viewport=function(M,t,A,s){e.viewport[0]=M,e.viewport[1]=t,e.viewport[2]=A,e.viewport[3]=s,e.realViewport.call(i,M,t,A,s)},this.isPatched=!0,s.safariCssSizeWorkaround(M)}},t.prototype.unpatch=function(){if(this.isPatched){var e=this.gl,M=this.gl.canvas;s.isIOS()||(Object.defineProperty(M,"width",this.realCanvasWidth),Object.defineProperty(M,"height",this.realCanvasHeight)),M.width=this.bufferWidth,M.height=this.bufferHeight,e.bindFramebuffer=this.realBindFramebuffer,e.enable=this.realEnable,e.disable=this.realDisable,e.colorMask=this.realColorMask,e.clearColor=this.realClearColor,e.viewport=this.realViewport,this.lastBoundFramebuffer==this.framebuffer&&e.bindFramebuffer(e.FRAMEBUFFER,null),this.isPatched=!1,setTimeout(function(){s.safariCssSizeWorkaround(M)},1)}},t.prototype.setTextureBounds=function(e,M){e||(e=[0,0,.5,1]),M||(M=[.5,0,.5,1]),this.viewportOffsetScale[0]=e[0],this.viewportOffsetScale[1]=e[1],this.viewportOffsetScale[2]=e[2],this.viewportOffsetScale[3]=e[3],this.viewportOffsetScale[4]=M[0],this.viewportOffsetScale[5]=M[1],this.viewportOffsetScale[6]=M[2],this.viewportOffsetScale[7]=M[3]},t.prototype.submitFrame=function(){var e=this.gl,M=this,i=[];if(WebVRConfig.DIRTY_SUBMIT_FRAME_BINDINGS||i.push(e.CURRENT_PROGRAM,e.ARRAY_BUFFER_BINDING,e.ELEMENT_ARRAY_BUFFER_BINDING,e.TEXTURE_BINDING_2D,e.TEXTURE0),r(e,i,function(e){M.realBindFramebuffer.call(e,e.FRAMEBUFFER,null),M.cullFace&&M.realDisable.call(e,e.CULL_FACE),M.depthTest&&M.realDisable.call(e,e.DEPTH_TEST),M.blend&&M.realDisable.call(e,e.BLEND),M.scissorTest&&M.realDisable.call(e,e.SCISSOR_TEST),M.stencilTest&&M.realDisable.call(e,e.STENCIL_TEST),M.realColorMask.call(e,!0,!0,!0,!0),M.realViewport.call(e,0,0,e.drawingBufferWidth,e.drawingBufferHeight),(M.ctxAttribs.alpha||s.isIOS())&&(M.realClearColor.call(e,0,0,0,1),e.clear(e.COLOR_BUFFER_BIT)),e.useProgram(M.program),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,M.indexBuffer),e.bindBuffer(e.ARRAY_BUFFER,M.vertexBuffer),e.enableVertexAttribArray(M.attribs.position),e.enableVertexAttribArray(M.attribs.texCoord),e.vertexAttribPointer(M.attribs.position,2,e.FLOAT,!1,20,0),e.vertexAttribPointer(M.attribs.texCoord,3,e.FLOAT,!1,20,8),e.activeTexture(e.TEXTURE0),e.uniform1i(M.uniforms.diffuse,0),e.bindTexture(e.TEXTURE_2D,M.renderTarget),e.uniform4fv(M.uniforms.viewportOffsetScale,M.viewportOffsetScale),e.drawElements(e.TRIANGLES,M.indexCount,e.UNSIGNED_SHORT,0),M.cardboardUI&&M.cardboardUI.renderNoState(),M.realBindFramebuffer.call(M.gl,e.FRAMEBUFFER,M.framebuffer),M.ctxAttribs.preserveDrawingBuffer||(M.realClearColor.call(e,0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)),WebVRConfig.DIRTY_SUBMIT_FRAME_BINDINGS||M.realBindFramebuffer.call(e,e.FRAMEBUFFER,M.lastBoundFramebuffer),M.cullFace&&M.realEnable.call(e,e.CULL_FACE),M.depthTest&&M.realEnable.call(e,e.DEPTH_TEST),M.blend&&M.realEnable.call(e,e.BLEND),M.scissorTest&&M.realEnable.call(e,e.SCISSOR_TEST),M.stencilTest&&M.realEnable.call(e,e.STENCIL_TEST),M.realColorMask.apply(e,M.colorMask),M.realViewport.apply(e,M.viewport),!M.ctxAttribs.alpha&&M.ctxAttribs.preserveDrawingBuffer||M.realClearColor.apply(e,M.clearColor)}),s.isIOS()){var t=e.canvas;t.width==M.bufferWidth&&t.height==M.bufferHeight||(M.bufferWidth=t.width,M.bufferHeight=t.height,M.onResize())}},t.prototype.updateDeviceInfo=function(e){var M=this.gl,i=this,t=[M.ARRAY_BUFFER_BINDING,M.ELEMENT_ARRAY_BUFFER_BINDING];r(M,t,function(M){var t=i.computeMeshVertices_(i.meshWidth,i.meshHeight,e);if(M.bindBuffer(M.ARRAY_BUFFER,i.vertexBuffer),M.bufferData(M.ARRAY_BUFFER,t,M.STATIC_DRAW),!i.indexCount){var A=i.computeMeshIndices_(i.meshWidth,i.meshHeight);M.bindBuffer(M.ELEMENT_ARRAY_BUFFER,i.indexBuffer),M.bufferData(M.ELEMENT_ARRAY_BUFFER,A,M.STATIC_DRAW),i.indexCount=A.length}})},t.prototype.computeMeshVertices_=function(e,M,i){for(var t=new Float32Array(2*e*M*5),A=i.getLeftEyeVisibleTanAngles(),r=i.getLeftEyeNoLensTanAngles(),N=i.getLeftEyeVisibleScreenRect(r),D=0,n=0;n<2;n++){for(var u=0;u<M;u++)for(var a=0;a<e;a++,D++){var o=a/(e-1),g=u/(M-1),j=o,I=g,L=s.lerp(A[0],A[2],o),T=s.lerp(A[3],A[1],g),c=Math.sqrt(L*L+T*T),E=i.distortion.distortInverse(c),w=L*E/c,y=T*E/c;o=(w-r[0])/(r[2]-r[0]),g=(y-r[3])/(r[1]-r[3]);i.device.widthMeters/i.device.heightMeters;o=2*(N.x+o*N.width-.5),g=2*(N.y+g*N.height-.5),t[5*D+0]=o,t[5*D+1]=g,t[5*D+2]=j,t[5*D+3]=I,t[5*D+4]=n}var l=A[2]-A[0];A[0]=-(l+A[0]),A[2]=l-A[2],l=r[2]-r[0],r[0]=-(l+r[0]),r[2]=l-r[2],N.x=1-(N.x+N.width)}return t},t.prototype.computeMeshIndices_=function(e,M){for(var i=new Uint16Array(2*(e-1)*(M-1)*6),t=e/2,A=M/2,s=0,r=0,N=0;N<2;N++)for(var D=0;D<M;D++)for(var n=0;n<e;n++,s++)0!=n&&0!=D&&(n<=t==D<=A?(i[r++]=s,i[r++]=s-e-1,i[r++]=s-e,i[r++]=s-e-1,i[r++]=s,i[r++]=s-1):(i[r++]=s-1,i[r++]=s-e,i[r++]=s,i[r++]=s-e,i[r++]=s-1,i[r++]=s-e-1));return i},t.prototype.getOwnPropertyDescriptor_=function(e,M){var i=Object.getOwnPropertyDescriptor(e,M);return void 0!==i.get&&void 0!==i.set||(i.configurable=!0,i.enumerable=!0,i.get=function(){return this.getAttribute(M)},i.set=function(e){this.setAttribute(M,e)}),i},M.exports=t},{"./cardboard-ui.js":4,"./deps/wglu-preserve-state.js":6,"./util.js":22}],4:[function(e,M,i){function t(e){this.gl=e,this.attribs={position:0},this.program=A.linkProgram(e,r,N,this.attribs),this.uniforms=A.getProgramUniforms(e,this.program),this.vertexBuffer=e.createBuffer(),this.gearOffset=0,this.gearVertexCount=0,this.arrowOffset=0,this.arrowVertexCount=0,this.projMat=new Float32Array(16),this.listener=null,this.onResize()}var A=e("./util.js"),s=e("./deps/wglu-preserve-state.js"),r=["attribute vec2 position;","uniform mat4 projectionMat;","void main() {","  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );","}"].join("\n"),N=["precision mediump float;","uniform vec4 color;","void main() {","  gl_FragColor = color;","}"].join("\n"),D=Math.PI/180,n=60,u=12,a=20,o=1,g=.75,j=.3125,I=4,L=28,T=1.5;t.prototype.destroy=function(){var e=this.gl;this.listener&&e.canvas.removeEventListener("click",this.listener,!1),e.deleteProgram(this.program),e.deleteBuffer(this.vertexBuffer)},t.prototype.listen=function(e,M){var i=this.gl.canvas;this.listener=function(t){var A=i.clientWidth/2,s=L*T;t.clientX>A-s&&t.clientX<A+s&&t.clientY>i.clientHeight-s?e(t):t.clientX<s&&t.clientY<s&&M(t)},i.addEventListener("click",this.listener,!1)},t.prototype.onResize=function(){var e=this.gl,M=this,i=[e.ARRAY_BUFFER_BINDING];s(e,i,function(e){function i(e,M){var i=(90-e)*D,t=Math.cos(i),A=Math.sin(i);s.push(j*t*w+r,j*A*w+w),s.push(M*t*w+r,M*A*w+w)}function t(M,i){s.push(y+M,e.drawingBufferHeight-y-i)}var s=[],r=e.drawingBufferWidth/2,N=e.drawingBufferWidth/(screen.width*window.devicePixelRatio);A.isIOS()||(N*=window.devicePixelRatio);var c=I*N/2,E=L*T*N,w=L*N/2,y=(L*T-L)*N;s.push(r-c,E),s.push(r-c,e.drawingBufferHeight),s.push(r+c,E),s.push(r+c,e.drawingBufferHeight),M.gearOffset=s.length/2;for(var l=0;l<=6;l++){var z=l*n;i(z,o),i(z+u,o),i(z+a,g),i(z+(n-a),g),i(z+(n-u),o)}M.gearVertexCount=s.length/2-M.gearOffset,M.arrowOffset=s.length/2;var h=c/Math.sin(45*D);t(0,w),t(w,0),t(w+h,h),t(h,w+h),t(h,w-h),t(0,w),t(w,2*w),t(w+h,2*w-h),t(h,w-h),t(0,w),t(h,w-c),t(L*N,w-c),t(h,w+c),t(L*N,w+c),M.arrowVertexCount=s.length/2-M.arrowOffset,e.bindBuffer(e.ARRAY_BUFFER,M.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(s),e.STATIC_DRAW)})},t.prototype.render=function(){var e=this.gl,M=this,i=[e.CULL_FACE,e.DEPTH_TEST,e.BLEND,e.SCISSOR_TEST,e.STENCIL_TEST,e.COLOR_WRITEMASK,e.VIEWPORT,e.CURRENT_PROGRAM,e.ARRAY_BUFFER_BINDING];s(e,i,function(e){e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.BLEND),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.colorMask(!0,!0,!0,!0),e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight),M.renderNoState()})},t.prototype.renderNoState=function(){var e=this.gl;e.useProgram(this.program),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.enableVertexAttribArray(this.attribs.position),e.vertexAttribPointer(this.attribs.position,2,e.FLOAT,!1,8,0),e.uniform4f(this.uniforms.color,1,1,1,1),A.orthoMatrix(this.projMat,0,e.drawingBufferWidth,0,e.drawingBufferHeight,.1,1024),e.uniformMatrix4fv(this.uniforms.projectionMat,!1,this.projMat),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.drawArrays(e.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount),e.drawArrays(e.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)},M.exports=t},{"./deps/wglu-preserve-state.js":6,"./util.js":22}],5:[function(e,M,i){function t(){this.displayName="Cardboard VRDisplay (webvr-polyfill)",this.capabilities.hasOrientation=!0,this.capabilities.canPresent=!0,this.bufferScale_=WebVRConfig.BUFFER_SCALE,this.poseSensor_=new D,this.distorter_=null,this.cardboardUI_=null,this.dpdb_=new N(!0,this.onDeviceParamsUpdated_.bind(this)),this.deviceInfo_=new r(this.dpdb_.getDeviceParams()),this.viewerSelector_=new u,this.viewerSelector_.on("change",this.onViewerChanged_.bind(this)),this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer()),WebVRConfig.ROTATE_INSTRUCTIONS_DISABLED||(this.rotateInstructions_=new n),o.isIOS()&&window.addEventListener("resize",this.onResize_.bind(this))}var A=e("./cardboard-distorter.js"),s=e("./cardboard-ui.js"),r=e("./device-info.js"),N=e("./dpdb/dpdb.js"),D=e("./sensor-fusion/fusion-pose-sensor.js"),n=e("./rotate-instructions.js"),u=e("./viewer-selector.js"),a=e("./base.js").VRDisplay,o=e("./util.js"),g={LEFT:"left",RIGHT:"right"};t.prototype=new a,t.prototype.getImmediatePose=function(){return{position:this.poseSensor_.getPosition(),orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},t.prototype.resetPose=function(){this.poseSensor_.resetPose()},t.prototype.getEyeParameters=function(e){var M,i=[.5*this.deviceInfo_.viewer.interLensDistance,0,0];if(e==g.LEFT)i[0]*=-1,M=this.deviceInfo_.getFieldOfViewLeftEye();else{if(e!=g.RIGHT)return console.error("Invalid eye provided: %s",e),null;M=this.deviceInfo_.getFieldOfViewRightEye()}return{fieldOfView:M,offset:i,renderWidth:.5*this.deviceInfo_.device.width*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_}},t.prototype.onDeviceParamsUpdated_=function(e){console.log("DPDB reported that device params were updated."),this.deviceInfo_.updateDeviceParams(e),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_)},t.prototype.updateBounds_=function(){this.layer_&&this.distorter_&&(this.layer_.leftBounds||this.layer_.rightBounds)&&this.distorter_.setTextureBounds(this.layer_.leftBounds,this.layer_.rightBounds)},t.prototype.beginPresent_=function(){var e=this.layer_.source.getContext("webgl");e||(e=this.layer_.source.getContext("experimental-webgl")),e||(e=this.layer_.source.getContext("webgl2")),e&&(this.layer_.predistorted?WebVRConfig.CARDBOARD_UI_DISABLED||(e.canvas.width=o.getScreenWidth()*this.bufferScale_,e.canvas.height=o.getScreenHeight()*this.bufferScale_,this.cardboardUI_=new s(e)):(this.distorter_=new A(e),this.distorter_.updateDeviceInfo(this.deviceInfo_),this.cardboardUI_=this.distorter_.cardboardUI),this.cardboardUI_&&this.cardboardUI_.listen(function(e){this.viewerSelector_.show(this.layer_.source.parentElement),e.stopPropagation(),e.preventDefault()}.bind(this),function(e){this.exitPresent(),e.stopPropagation(),e.preventDefault()}.bind(this)),this.rotateInstructions_&&(o.isLandscapeMode()&&o.isMobile()?this.rotateInstructions_.showTemporarily(3e3,this.layer_.source.parentElement):this.rotateInstructions_.update()),this.orientationHandler=this.onOrientationChange_.bind(this),window.addEventListener("orientationchange",this.orientationHandler),this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this),window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler),this.fireVRDisplayDeviceParamsChange_())},t.prototype.endPresent_=function(){this.distorter_&&(this.distorter_.destroy(),this.distorter_=null),this.cardboardUI_&&(this.cardboardUI_.destroy(),this.cardboardUI_=null),this.rotateInstructions_&&this.rotateInstructions_.hide(),this.viewerSelector_.hide(),window.removeEventListener("orientationchange",this.orientationHandler),window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)},t.prototype.submitFrame=function(e){if(this.distorter_)this.distorter_.submitFrame();else if(this.cardboardUI_&&this.layer_){var M=this.layer_.source.getContext("webgl").canvas;M.width==this.lastWidth&&M.height==this.lastHeight||this.cardboardUI_.onResize(),this.lastWidth=M.width,this.lastHeight=M.height,this.cardboardUI_.render()}},t.prototype.onOrientationChange_=function(e){console.log("onOrientationChange_"),this.viewerSelector_.hide(),this.rotateInstructions_&&this.rotateInstructions_.update(),this.onResize_()},t.prototype.onResize_=function(e){if(this.layer_){var M=this.layer_.source.getContext("webgl"),i=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0 10px 10px 0"];M.canvas.setAttribute("style",i.join("; ")+";"),o.safariCssSizeWorkaround(M.canvas)}},t.prototype.onViewerChanged_=function(e){this.deviceInfo_.setViewer(e),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_),this.fireVRDisplayDeviceParamsChange_()},t.prototype.fireVRDisplayDeviceParamsChange_=function(){var e=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(e)},M.exports=t},{"./base.js":2,"./cardboard-distorter.js":3,"./cardboard-ui.js":4,"./device-info.js":7,"./dpdb/dpdb.js":11,"./rotate-instructions.js":16,"./sensor-fusion/fusion-pose-sensor.js":18,"./util.js":22,"./viewer-selector.js":23}],6:[function(e,M,i){function t(e,M,i){if(!M)return void i(e);for(var t=[],A=null,s=0;s<M.length;++s){var r=M[s];switch(r){case e.TEXTURE_BINDING_2D:case e.TEXTURE_BINDING_CUBE_MAP:var N=M[++s];if(N<e.TEXTURE0||N>e.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit"),t.push(null,null);break}A||(A=e.getParameter(e.ACTIVE_TEXTURE)),e.activeTexture(N),t.push(e.getParameter(r),null);break;case e.ACTIVE_TEXTURE:A=e.getParameter(e.ACTIVE_TEXTURE),t.push(null);break;default:t.push(e.getParameter(r))}}i(e);for(var s=0;s<M.length;++s){var r=M[s],D=t[s];switch(r){case e.ACTIVE_TEXTURE:break;case e.ARRAY_BUFFER_BINDING:e.bindBuffer(e.ARRAY_BUFFER,D);break;case e.COLOR_CLEAR_VALUE:e.clearColor(D[0],D[1],D[2],D[3]);break;case e.COLOR_WRITEMASK:e.colorMask(D[0],D[1],D[2],D[3]);break;case e.CURRENT_PROGRAM:e.useProgram(D);break;case e.ELEMENT_ARRAY_BUFFER_BINDING:e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,D);break;case e.FRAMEBUFFER_BINDING:e.bindFramebuffer(e.FRAMEBUFFER,D);break;case e.RENDERBUFFER_BINDING:e.bindRenderbuffer(e.RENDERBUFFER,D);break;case e.TEXTURE_BINDING_2D:var N=M[++s];if(N<e.TEXTURE0||N>e.TEXTURE31)break;e.activeTexture(N),e.bindTexture(e.TEXTURE_2D,D);break;case e.TEXTURE_BINDING_CUBE_MAP:var N=M[++s];if(N<e.TEXTURE0||N>e.TEXTURE31)break;e.activeTexture(N),e.bindTexture(e.TEXTURE_CUBE_MAP,D);break;case e.VIEWPORT:e.viewport(D[0],D[1],D[2],D[3]);break;case e.BLEND:case e.CULL_FACE:case e.DEPTH_TEST:case e.SCISSOR_TEST:case e.STENCIL_TEST:D?e.enable(r):e.disable(r);break;default:console.log("No GL restore behavior for 0x"+r.toString(16))}A&&e.activeTexture(A)}}M.exports=t},{}],7:[function(e,M,i){function t(e){this.width=e.width||D.getScreenWidth(),this.height=e.height||D.getScreenHeight(),this.widthMeters=e.widthMeters,this.heightMeters=e.heightMeters,this.bevelMeters=e.bevelMeters}function A(e){this.viewer=a.CardboardV2,this.updateDeviceParams(e),this.distortion=new r(this.viewer.distortionCoefficients)}function s(e){this.id=e.id,this.label=e.label,this.fov=e.fov,this.interLensDistance=e.interLensDistance,this.baselineLensDistance=e.baselineLensDistance,this.screenLensDistance=e.screenLensDistance,this.distortionCoefficients=e.distortionCoefficients,this.inverseCoefficients=e.inverseCoefficients}var r=e("./distortion/distortion.js"),N=e("./math-util.js"),D=e("./util.js"),n=new t({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),u=new t({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004}),a={CardboardV1:new s({id:"CardboardV1",label:"Cardboard I/O 2014",
fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new s({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-16981803e-13]})};A.prototype.updateDeviceParams=function(e){this.device=this.determineDevice_(e)||this.device},A.prototype.getDevice=function(){return this.device},A.prototype.setViewer=function(e){this.viewer=e,this.distortion=new r(this.viewer.distortionCoefficients)},A.prototype.determineDevice_=function(e){if(!e)return D.isIOS()?(console.warn("Using fallback iOS device measurements."),u):(console.warn("Using fallback Android device measurements."),n);var M=.0254,i=M/e.xdpi,A=M/e.ydpi,s=D.getScreenWidth(),r=D.getScreenHeight();return new t({widthMeters:i*s,heightMeters:A*r,bevelMeters:.001*e.bevelMm})},A.prototype.getDistortedFieldOfViewLeftEye=function(){var e=this.viewer,M=this.device,i=this.distortion,t=e.screenLensDistance,A=(M.widthMeters-e.interLensDistance)/2,s=e.interLensDistance/2,r=e.baselineLensDistance-M.bevelMeters,D=M.heightMeters-r,n=N.radToDeg*Math.atan(i.distort(A/t)),u=N.radToDeg*Math.atan(i.distort(s/t)),a=N.radToDeg*Math.atan(i.distort(r/t)),o=N.radToDeg*Math.atan(i.distort(D/t));return{leftDegrees:Math.min(n,e.fov),rightDegrees:Math.min(u,e.fov),downDegrees:Math.min(a,e.fov),upDegrees:Math.min(o,e.fov)}},A.prototype.getLeftEyeVisibleTanAngles=function(){var e=this.viewer,M=this.device,i=this.distortion,t=Math.tan(-N.degToRad*e.fov),A=Math.tan(N.degToRad*e.fov),s=Math.tan(N.degToRad*e.fov),r=Math.tan(-N.degToRad*e.fov),D=M.widthMeters/4,n=M.heightMeters/2,u=e.baselineLensDistance-M.bevelMeters-n,a=e.interLensDistance/2-D,o=-u,g=e.screenLensDistance,j=i.distort((a-D)/g),I=i.distort((o+n)/g),L=i.distort((a+D)/g),T=i.distort((o-n)/g),c=new Float32Array(4);return c[0]=Math.max(t,j),c[1]=Math.min(A,I),c[2]=Math.min(s,L),c[3]=Math.max(r,T),c},A.prototype.getLeftEyeNoLensTanAngles=function(){var e=this.viewer,M=this.device,i=this.distortion,t=new Float32Array(4),A=i.distortInverse(Math.tan(-N.degToRad*e.fov)),s=i.distortInverse(Math.tan(N.degToRad*e.fov)),r=i.distortInverse(Math.tan(N.degToRad*e.fov)),D=i.distortInverse(Math.tan(-N.degToRad*e.fov)),n=M.widthMeters/4,u=M.heightMeters/2,a=e.baselineLensDistance-M.bevelMeters-u,o=e.interLensDistance/2-n,g=-a,j=e.screenLensDistance,I=(o-n)/j,L=(g+u)/j,T=(o+n)/j,c=(g-u)/j;return t[0]=Math.max(A,I),t[1]=Math.min(s,L),t[2]=Math.min(r,T),t[3]=Math.max(D,c),t},A.prototype.getLeftEyeVisibleScreenRect=function(e){var M=this.viewer,i=this.device,t=M.screenLensDistance,A=(i.widthMeters-M.interLensDistance)/2,s=M.baselineLensDistance-i.bevelMeters,r=(e[0]*t+A)/i.widthMeters,N=(e[1]*t+s)/i.heightMeters,D=(e[2]*t+A)/i.widthMeters,n=(e[3]*t+s)/i.heightMeters;return{x:r,y:n,width:D-r,height:N-n}},A.prototype.getFieldOfViewLeftEye=function(e){return e?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()},A.prototype.getFieldOfViewRightEye=function(e){var M=this.getFieldOfViewLeftEye(e);return{leftDegrees:M.rightDegrees,rightDegrees:M.leftDegrees,upDegrees:M.upDegrees,downDegrees:M.downDegrees}},A.prototype.getUndistortedFieldOfViewLeftEye=function(){var e=this.getUndistortedParams_();return{leftDegrees:N.radToDeg*Math.atan(e.outerDist),rightDegrees:N.radToDeg*Math.atan(e.innerDist),downDegrees:N.radToDeg*Math.atan(e.bottomDist),upDegrees:N.radToDeg*Math.atan(e.topDist)}},A.prototype.getUndistortedViewportLeftEye=function(){var e=this.getUndistortedParams_(),M=this.viewer,i=this.device,t=M.screenLensDistance,A=i.widthMeters/t,s=i.heightMeters/t,r=i.width/A,N=i.height/s,D=Math.round((e.eyePosX-e.outerDist)*r),n=Math.round((e.eyePosY-e.bottomDist)*N);return{x:D,y:n,width:Math.round((e.eyePosX+e.innerDist)*r)-D,height:Math.round((e.eyePosY+e.topDist)*N)-n}},A.prototype.getUndistortedParams_=function(){var e=this.viewer,M=this.device,i=this.distortion,t=e.screenLensDistance,A=e.interLensDistance/2/t,s=M.widthMeters/t,r=M.heightMeters/t,D=s/2-A,n=(e.baselineLensDistance-M.bevelMeters)/t,u=e.fov,a=i.distortInverse(Math.tan(N.degToRad*u)),o=Math.min(D,a),g=Math.min(A,a),j=Math.min(n,a),I=Math.min(r-n,a);return{outerDist:o,innerDist:g,topDist:I,bottomDist:j,eyePosX:D,eyePosY:n}},A.Viewers=a,M.exports=A},{"./distortion/distortion.js":9,"./math-util.js":14,"./util.js":22}],8:[function(e,M,i){function t(e){this.display=e,this.hardwareUnitId=e.displayId,this.deviceId="webvr-polyfill:HMD:"+e.displayId,this.deviceName=e.displayName+" (HMD)"}function A(e){this.display=e,this.hardwareUnitId=e.displayId,this.deviceId="webvr-polyfill:PositionSensor: "+e.displayId,this.deviceName=e.displayName+" (PositionSensor)"}var s=(e("./base.js").VRDisplay,e("./base.js").HMDVRDevice),r=e("./base.js").PositionSensorVRDevice;t.prototype=new s,t.prototype.getEyeParameters=function(e){var M=this.display.getEyeParameters(e);return{currentFieldOfView:M.fieldOfView,maximumFieldOfView:M.fieldOfView,minimumFieldOfView:M.fieldOfView,recommendedFieldOfView:M.fieldOfView,eyeTranslation:{x:M.offset[0],y:M.offset[1],z:M.offset[2]},renderRect:{x:"right"==e?M.renderWidth:0,y:0,width:M.renderWidth,height:M.renderHeight}}},t.prototype.setFieldOfView=function(e,M,i,t){},A.prototype=new r,A.prototype.getState=function(){var e=this.display.getPose();return{position:e.position?{x:e.position[0],y:e.position[1],z:e.position[2]}:null,orientation:e.orientation?{x:e.orientation[0],y:e.orientation[1],z:e.orientation[2],w:e.orientation[3]}:null,linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},A.prototype.resetState=function(){return this.positionDevice.resetPose()},M.exports.VRDisplayHMDDevice=t,M.exports.VRDisplayPositionSensorDevice=A},{"./base.js":2}],9:[function(e,M,i){function t(e){this.coefficients=e}t.prototype.distortInverse=function(e){for(var M=0,i=1,t=e-this.distort(M);Math.abs(i-M)>1e-4;){var A=e-this.distort(i),s=i-A*((i-M)/(A-t));M=i,i=s,t=A}return i},t.prototype.distort=function(e){for(var M=e*e,i=0,t=0;t<this.coefficients.length;t++)i=M*(i+this.coefficients[t]);return(i+1)*e},t.prototype.solveLinear_=function(e,M){for(var i=e.length,t=0;t<i-1;++t)for(var A=t+1;A<i;++A){for(var s=e[t][A]/e[t][t],r=t+1;r<i;++r)e[r][A]-=s*e[r][t];M[A]-=s*M[t]}for(var N=new Array(i),t=i-1;t>=0;--t){for(var D=M[t],r=t+1;r<i;++r)D-=e[r][t]*N[r];N[t]=D/e[t][t]}return N},t.prototype.solveLeastSquares_=function(e,M){var i,t,A,s,r=e.length,N=e[0].length;if(r!=M.Length)throw new Error("Matrix / vector dimension mismatch");var D=new Array(N);for(A=0;A<N;++A)for(D[A]=new Array(N),t=0;t<N;++t){for(s=0,i=0;i<r;++i)s+=e[t][i]*e[A][i];D[A][t]=s}var n=new Array(N);for(t=0;t<N;++t){for(s=0,i=0;i<r;++i)s+=e[t][i]*M[i];n[t]=s}return this.solveLinear_(D,n)},t.prototype.approximateInverse=function(e,M){e=e||1,M=M||100;var i,A,s=6,r=new Array(s);for(A=0;A<s;++A)r[A]=new Array(M);var N=new Array(M);for(i=0;i<M;++i){var D=e*(i+1)/M,n=this.distort(D),u=n;for(A=0;A<s;++A)u*=n*n,r[A][i]=u;N[i]=D-n}var a=this.solveLeastSquares_(r,N);return new t(a)},M.exports=t},{}],10:[function(e,M,i){var t={format:1,last_updated:"2016-01-20T00:18:35Z",devices:[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 "}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 "}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3}]};M.exports=t},{}],11:[function(e,M,i){function t(e,M){if(this.dpdb=s,this.recalculateDeviceParams_(),e){this.onDeviceParamsUpdated=M,console.log("Fetching DPDB...");var i=new XMLHttpRequest,t=this;i.open("GET",N,!0),i.addEventListener("load",function(){t.loading=!1,i.status>=200&&i.status<=299?(console.log("Successfully loaded online DPDB."),t.dpdb=JSON.parse(i.response),t.recalculateDeviceParams_()):console.error("Error loading online DPDB!")}),i.send()}}function A(e){this.xdpi=e.xdpi,this.ydpi=e.ydpi,this.bevelMm=e.bevelMm}var s=e("./dpdb-cache.js"),r=e("../util.js"),N="https://storage.googleapis.com/cardboard-dpdb/dpdb.json";t.prototype.getDeviceParams=function(){return this.deviceParams},t.prototype.recalculateDeviceParams_=function(){console.log("Recalculating device params.");var e=this.calcDeviceParams_();console.log("New device parameters:"),console.log(e),e?(this.deviceParams=e,this.onDeviceParamsUpdated&&this.onDeviceParamsUpdated(this.deviceParams)):console.error("Failed to recalculate device parameters.")},t.prototype.calcDeviceParams_=function(){var e=this.dpdb;if(!e)return console.error("DPDB not available."),null;if(1!=e.format)return console.error("DPDB has unexpected format version."),null;if(!e.devices||!e.devices.length)return console.error("DPDB does not have a devices section."),null;var M=navigator.userAgent||navigator.vendor||window.opera,i=r.getScreenWidth(),t=r.getScreenHeight();if(console.log("User agent: "+M),console.log("Pixel width: "+i),console.log("Pixel height: "+t),!e.devices)return console.error("DPDB has no devices section."),null;for(var s=0;s<e.devices.length;s++){var N=e.devices[s];if(N.rules)if("ios"==N.type||"android"==N.type){if(r.isIOS()==("ios"==N.type)){for(var D=!1,n=0;n<N.rules.length;n++){var u=N.rules[n];if(this.matchRule_(u,M,i,t)){console.log("Rule matched:"),console.log(u),D=!0;break}}if(D){var a=N.dpi[0]||N.dpi,o=N.dpi[1]||N.dpi;return new A({xdpi:a,ydpi:o,bevelMm:N.bw})}}}else console.warn("Device["+s+"] has invalid type.");else console.warn("Device["+s+"] has no rules section.")}return console.warn("No DPDB device match."),null},t.prototype.matchRule_=function(e,M,i,t){if(!e.ua&&!e.res)return!1;if(e.ua&&M.indexOf(e.ua)<0)return!1;if(e.res){if(!e.res[0]||!e.res[1])return!1;var A=e.res[0],s=e.res[1];if(Math.min(i,t)!=Math.min(A,s)||Math.max(i,t)!=Math.max(A,s))return!1}return!0},M.exports=t},{"../util.js":22,"./dpdb-cache.js":10}],12:[function(e,M,i){function t(){this.callbacks={}}t.prototype.emit=function(e){var M=this.callbacks[e];if(M){var i=[].slice.call(arguments);i.shift();for(var t=0;t<M.length;t++)M[t].apply(this,i)}},t.prototype.on=function(e,M){e in this.callbacks?this.callbacks[e].push(M):this.callbacks[e]=[M]},M.exports=t},{}],13:[function(e,M,i){var t=e("./util.js"),A=e("./webvr-polyfill.js").WebVRPolyfill;window.WebVRConfig=t.extend({FORCE_ENABLE_VR:!1,K_FILTER:.98,PREDICTION_TIME_S:.04,TOUCH_PANNER_DISABLED:!0,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,MOUSE_KEYBOARD_CONTROLS_DISABLED:!1,DEFER_INITIALIZATION:!1,ENABLE_DEPRECATED_API:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1},window.WebVRConfig),window.WebVRConfig.DEFER_INITIALIZATION?window.InitializeWebVRPolyfill=function(){new A}:new A},{"./util.js":22,"./webvr-polyfill.js":25}],14:[function(e,M,i){var t=window.MathUtil||{};t.degToRad=Math.PI/180,t.radToDeg=180/Math.PI,t.Vector2=function(e,M){this.x=e||0,this.y=M||0},t.Vector2.prototype={constructor:t.Vector2,set:function(e,M){return this.x=e,this.y=M,this},copy:function(e){return this.x=e.x,this.y=e.y,this},subVectors:function(e,M){return this.x=e.x-M.x,this.y=e.y-M.y,this}},t.Vector3=function(e,M,i){this.x=e||0,this.y=M||0,this.z=i||0},t.Vector3.prototype={constructor:t.Vector3,set:function(e,M,i){return this.x=e,this.y=M,this.z=i,this},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var e=this.length();if(0!==e){var M=1/e;this.multiplyScalar(M)}else this.x=0,this.y=0,this.z=0;return this},multiplyScalar:function(e){this.x*=e,this.y*=e,this.z*=e},applyQuaternion:function(e){var M=this.x,i=this.y,t=this.z,A=e.x,s=e.y,r=e.z,N=e.w,D=N*M+s*t-r*i,n=N*i+r*M-A*t,u=N*t+A*i-s*M,a=-A*M-s*i-r*t;return this.x=D*N+a*-A+n*-r-u*-s,this.y=n*N+a*-s+u*-A-D*-r,this.z=u*N+a*-r+D*-s-n*-A,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},crossVectors:function(e,M){var i=e.x,t=e.y,A=e.z,s=M.x,r=M.y,N=M.z;return this.x=t*N-A*r,this.y=A*s-i*N,this.z=i*r-t*s,this}},t.Quaternion=function(e,M,i,t){this.x=e||0,this.y=M||0,this.z=i||0,this.w=void 0!==t?t:1},t.Quaternion.prototype={constructor:t.Quaternion,set:function(e,M,i,t){return this.x=e,this.y=M,this.z=i,this.w=t,this},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},setFromEulerXYZ:function(e,M,i){var t=Math.cos(e/2),A=Math.cos(M/2),s=Math.cos(i/2),r=Math.sin(e/2),N=Math.sin(M/2),D=Math.sin(i/2);return this.x=r*A*s+t*N*D,this.y=t*N*s-r*A*D,this.z=t*A*D+r*N*s,this.w=t*A*s-r*N*D,this},setFromEulerYXZ:function(e,M,i){var t=Math.cos(e/2),A=Math.cos(M/2),s=Math.cos(i/2),r=Math.sin(e/2),N=Math.sin(M/2),D=Math.sin(i/2);return this.x=r*A*s+t*N*D,this.y=t*N*s-r*A*D,this.z=t*A*D-r*N*s,this.w=t*A*s+r*N*D,this},setFromAxisAngle:function(e,M){var i=M/2,t=Math.sin(i);return this.x=e.x*t,this.y=e.y*t,this.z=e.z*t,this.w=Math.cos(i),this},multiply:function(e){return this.multiplyQuaternions(this,e)},multiplyQuaternions:function(e,M){var i=e.x,t=e.y,A=e.z,s=e.w,r=M.x,N=M.y,D=M.z,n=M.w;return this.x=i*n+s*r+t*D-A*N,this.y=t*n+s*N+A*r-i*D,this.z=A*n+s*D+i*N-t*r,this.w=s*n-i*r-t*N-A*D,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=1):(e=1/e,this.x=this.x*e,this.y=this.y*e,this.z=this.z*e,this.w=this.w*e),this},slerp:function(e,M){if(0===M)return this;if(1===M)return this.copy(e);var i=this.x,t=this.y,A=this.z,s=this.w,r=s*e.w+i*e.x+t*e.y+A*e.z;if(r<0?(this.w=-e.w,this.x=-e.x,this.y=-e.y,this.z=-e.z,r=-r):this.copy(e),r>=1)return this.w=s,this.x=i,this.y=t,this.z=A,this;var N=Math.acos(r),D=Math.sqrt(1-r*r);if(Math.abs(D)<.001)return this.w=.5*(s+this.w),this.x=.5*(i+this.x),this.y=.5*(t+this.y),this.z=.5*(A+this.z),this;var n=Math.sin((1-M)*N)/D,u=Math.sin(M*N)/D;return this.w=s*n+this.w*u,this.x=i*n+this.x*u,this.y=t*n+this.y*u,this.z=A*n+this.z*u,this},setFromUnitVectors:function(){var e,M,i=1e-6;return function(A,s){return void 0===e&&(e=new t.Vector3),M=A.dot(s)+1,M<i?(M=0,Math.abs(A.x)>Math.abs(A.z)?e.set(-A.y,A.x,0):e.set(0,-A.z,A.y)):e.crossVectors(A,s),this.x=e.x,this.y=e.y,this.z=e.z,this.w=M,this.normalize(),this}}()},M.exports=t},{}],15:[function(e,M,i){function t(){this.displayName="Mouse and Keyboard VRDisplay (webvr-polyfill)",this.capabilities.hasOrientation=!0,window.addEventListener("keydown",this.onKeyDown_.bind(this)),window.addEventListener("mousemove",this.onMouseMove_.bind(this)),window.addEventListener("mousedown",this.onMouseDown_.bind(this)),window.addEventListener("mouseup",this.onMouseUp_.bind(this)),this.phi_=0,this.theta_=0,this.targetAngle_=null,this.angleAnimation_=null,this.orientation_=new s.Quaternion,this.rotateStart_=new s.Vector2,this.rotateEnd_=new s.Vector2,this.rotateDelta_=new s.Vector2,this.isDragging_=!1,this.orientationOut_=new Float32Array(4)}var A=e("./base.js").VRDisplay,s=e("./math-util.js"),r=e("./util.js"),N=.15,D=80,n=.5,u=.3;t.prototype=new A,t.prototype.getImmediatePose=function(){return this.orientation_.setFromEulerYXZ(this.phi_,this.theta_,0),this.orientationOut_[0]=this.orientation_.x,this.orientationOut_[1]=this.orientation_.y,this.orientationOut_[2]=this.orientation_.z,this.orientationOut_[3]=this.orientation_.w,{position:null,orientation:this.orientationOut_,linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},t.prototype.onKeyDown_=function(e){38==e.keyCode?this.animatePhi_(this.phi_+N):39==e.keyCode?this.animateTheta_(this.theta_-N):40==e.keyCode?this.animatePhi_(this.phi_-N):37==e.keyCode&&this.animateTheta_(this.theta_+N)},t.prototype.animateTheta_=function(e){this.animateKeyTransitions_("theta_",e)},t.prototype.animatePhi_=function(e){e=r.clamp(e,-Math.PI/2,Math.PI/2),this.animateKeyTransitions_("phi_",e)},t.prototype.animateKeyTransitions_=function(e,M){this.angleAnimation_&&cancelAnimationFrame(this.angleAnimation_);var i=this[e],t=new Date;this.angleAnimation_=requestAnimationFrame(function A(){var s=new Date-t;if(s>=D)return this[e]=M,void cancelAnimationFrame(this.angleAnimation_);this.angleAnimation_=requestAnimationFrame(A.bind(this));var r=s/D;this[e]=i+(M-i)*r}.bind(this))},t.prototype.onMouseDown_=function(e){this.rotateStart_.set(e.clientX,e.clientY),this.isDragging_=!0},t.prototype.onMouseMove_=function(e){if(this.isDragging_||this.isPointerLocked_()){if(this.isPointerLocked_()){var M=e.movementX||e.mozMovementX||0,i=e.movementY||e.mozMovementY||0;this.rotateEnd_.set(this.rotateStart_.x-M,this.rotateStart_.y-i)}else this.rotateEnd_.set(e.clientX,e.clientY);this.rotateDelta_.subVectors(this.rotateEnd_,this.rotateStart_),this.rotateStart_.copy(this.rotateEnd_),this.phi_+=2*Math.PI*this.rotateDelta_.y/screen.height*u,this.theta_+=2*Math.PI*this.rotateDelta_.x/screen.width*n,this.phi_=r.clamp(this.phi_,-Math.PI/2,Math.PI/2)}},t.prototype.onMouseUp_=function(e){this.isDragging_=!1},t.prototype.isPointerLocked_=function(){var e=document.pointerLockElement||document.mozPointerLockElement||document.webkitPointerLockElement;return void 0!==e},t.prototype.resetPose=function(){this.phi_=0,this.theta_=0},M.exports=t},{"./base.js":2,"./math-util.js":14,"./util.js":22}],16:[function(e,M,i){function t(){this.loadIcon_();var e=document.createElement("div"),M=e.style;M.position="fixed",M.top=0,M.right=0,M.bottom=0,M.left=0,M.backgroundColor="gray",M.fontFamily="sans-serif",M.zIndex=1e6;var i=document.createElement("img");i.src=this.icon;var M=i.style;M.marginLeft="25%",M.marginTop="25%",M.width="50%",e.appendChild(i);var t=document.createElement("div"),M=t.style;M.textAlign="center",M.fontSize="16px",M.lineHeight="24px",M.margin="24px 25%",M.width="50%",t.innerHTML="Place your phone into your Cardboard viewer.",e.appendChild(t);var A=document.createElement("div"),M=A.style;M.backgroundColor="#CFD8DC",M.position="fixed",M.bottom=0,M.width="100%",M.height="48px",M.padding="14px 24px",M.boxSizing="border-box",M.color="#656A6B",e.appendChild(A);var s=document.createElement("div");s.style.float="left",s.innerHTML="No Cardboard viewer?";var r=document.createElement("a");r.href="https://www.google.com/get/cardboard/get-cardboard/",r.innerHTML="get one",r.target="_blank";var M=r.style;M.float="right",M.fontWeight=600,M.textTransform="uppercase",M.borderLeft="1px solid gray",M.paddingLeft="24px",M.textDecoration="none",M.color="#656A6B",A.appendChild(s),A.appendChild(r),this.overlay=e,this.text=t,this.hide()}var A=e("./util.js");t.prototype.show=function(e){e||this.overlay.parentElement?e&&(this.overlay.parentElement&&this.overlay.parentElement!=e&&this.overlay.parentElement.removeChild(this.overlay),e.appendChild(this.overlay)):document.body.appendChild(this.overlay),this.overlay.style.display="block";var M=this.overlay.querySelector("img"),i=M.style;A.isLandscapeMode()?(i.width="20%",i.marginLeft="40%",i.marginTop="3%"):(i.width="50%",i.marginLeft="25%",i.marginTop="25%")},t.prototype.hide=function(){this.overlay.style.display="none"},t.prototype.showTemporarily=function(e,M){this.show(M),this.timer=setTimeout(this.hide.bind(this),e)},t.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)},t.prototype.update=function(){this.disableShowTemporarily(),!A.isLandscapeMode()&&A.isMobile()?this.show():this.hide()},t.prototype.loadIcon_=function(){this.icon=A.base64("image/svg+xml","PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgd2lkdGg9IjE5OHB4IiBoZWlnaHQ9IjI0MHB4IiB2aWV3Qm94PSIwIDAgMTk4IDI0MCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4bWxuczpza2V0Y2g9Imh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaC9ucyI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDMuMy4zICgxMjA4MSkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+CiAgICA8dGl0bGU+dHJhbnNpdGlvbjwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxkZWZzPjwvZGVmcz4KICAgIDxnIGlkPSJQYWdlLTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHNrZXRjaDp0eXBlPSJNU1BhZ2UiPgogICAgICAgIDxnIGlkPSJ0cmFuc2l0aW9uIiBza2V0Y2g6dHlwZT0iTVNBcnRib2FyZEdyb3VwIj4KICAgICAgICAgICAgPGcgaWQ9IkltcG9ydGVkLUxheWVycy1Db3B5LTQtKy1JbXBvcnRlZC1MYXllcnMtQ29weS0rLUltcG9ydGVkLUxheWVycy1Db3B5LTItQ29weSIgc2tldGNoOnR5cGU9Ik1TTGF5ZXJHcm91cCI+CiAgICAgICAgICAgICAgICA8ZyBpZD0iSW1wb3J0ZWQtTGF5ZXJzLUNvcHktNCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsIDEwNy4wMDAwMDApIiBza2V0Y2g6dHlwZT0iTVNTaGFwZUdyb3VwIj4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTQ5LjYyNSwyLjUyNyBDMTQ5LjYyNSwyLjUyNyAxNTUuODA1LDYuMDk2IDE1Ni4zNjIsNi40MTggTDE1Ni4zNjIsNy4zMDQgQzE1Ni4zNjIsNy40ODEgMTU2LjM3NSw3LjY2NCAxNTYuNCw3Ljg1MyBDMTU2LjQxLDcuOTM0IDE1Ni40Miw4LjAxNSAxNTYuNDI3LDguMDk1IEMxNTYuNTY3LDkuNTEgMTU3LjQwMSwxMS4wOTMgMTU4LjUzMiwxMi4wOTQgTDE2NC4yNTIsMTcuMTU2IEwxNjQuMzMzLDE3LjA2NiBDMTY0LjMzMywxNy4wNjYgMTY4LjcxNSwxNC41MzYgMTY5LjU2OCwxNC4wNDIgQzE3MS4wMjUsMTQuODgzIDE5NS41MzgsMjkuMDM1IDE5NS41MzgsMjkuMDM1IEwxOTUuNTM4LDgzLjAzNiBDMTk1LjUzOCw4My44MDcgMTk1LjE1Miw4NC4yNTMgMTk0LjU5LDg0LjI1MyBDMTk0LjM1Nyw4NC4yNTMgMTk0LjA5NSw4NC4xNzcgMTkzLjgxOCw4NC4wMTcgTDE2OS44NTEsNzAuMTc5IEwxNjkuODM3LDcwLjIwMyBMMTQyLjUxNSw4NS45NzggTDE0MS42NjUsODQuNjU1IEMxMzYuOTM0LDgzLjEyNiAxMzEuOTE3LDgxLjkxNSAxMjYuNzE0LDgxLjA0NSBDMTI2LjcwOSw4MS4wNiAxMjYuNzA3LDgxLjA2OSAxMjYuNzA3LDgxLjA2OSBMMTIxLjY0LDk4LjAzIEwxMTMuNzQ5LDEwMi41ODYgTDExMy43MTIsMTAyLjUyMyBMMTEzLjcxMiwxMzAuMTEzIEMxMTMuNzEyLDEzMC44ODUgMTEzLjMyNiwxMzEuMzMgMTEyLjc2NCwxMzEuMzMgQzExMi41MzIsMTMxLjMzIDExMi4yNjksMTMxLjI1NCAxMTEuOTkyLDEzMS4wOTQgTDY5LjUxOSwxMDYuNTcyIEM2OC41NjksMTA2LjAyMyA2Ny43OTksMTA0LjY5NSA2Ny43OTksMTAzLjYwNSBMNjcuNzk5LDEwMi41NyBMNjcuNzc4LDEwMi42MTcgQzY3LjI3LDEwMi4zOTMgNjYuNjQ4LDEwMi4yNDkgNjUuOTYyLDEwMi4yMTggQzY1Ljg3NSwxMDIuMjE0IDY1Ljc4OCwxMDIuMjEyIDY1LjcwMSwxMDIuMjEyIEM2NS42MDYsMTAyLjIxMiA2NS41MTEsMTAyLjIxNSA2NS40MTYsMTAyLjIxOSBDNjUuMTk1LDEwMi4yMjkgNjQuOTc0LDEwMi4yMzUgNjQuNzU0LDEwMi4yMzUgQzY0LjMzMSwxMDIuMjM1IDYzLjkxMSwxMDIuMjE2IDYzLjQ5OCwxMDIuMTc4IEM2MS44NDMsMTAyLjAyNSA2MC4yOTgsMTAxLjU3OCA1OS4wOTQsMTAwLjg4MiBMMTIuNTE4LDczLjk5MiBMMTIuNTIzLDc0LjAwNCBMMi4yNDUsNTUuMjU0IEMxLjI0NCw1My40MjcgMi4wMDQsNTEuMDM4IDMuOTQzLDQ5LjkxOCBMNTkuOTU0LDE3LjU3MyBDNjAuNjI2LDE3LjE4NSA2MS4zNSwxNy4wMDEgNjIuMDUzLDE3LjAwMSBDNjMuMzc5LDE3LjAwMSA2NC42MjUsMTcuNjYgNjUuMjgsMTguODU0IEw2NS4yODUsMTguODUxIEw2NS41MTIsMTkuMjY0IEw2NS41MDYsMTkuMjY4IEM2NS45MDksMjAuMDAzIDY2LjQwNSwyMC42OCA2Ni45ODMsMjEuMjg2IEw2Ny4yNiwyMS41NTYgQzY5LjE3NCwyMy40MDYgNzEuNzI4LDI0LjM1NyA3NC4zNzMsMjQuMzU3IEM3Ni4zMjIsMjQuMzU3IDc4LjMyMSwyMy44NCA4MC4xNDgsMjIuNzg1IEM4MC4xNjEsMjIuNzg1IDg3LjQ2NywxOC41NjYgODcuNDY3LDE4LjU2NiBDODguMTM5LDE4LjE3OCA4OC44NjMsMTcuOTk0IDg5LjU2NiwxNy45OTQgQzkwLjg5MiwxNy45OTQgOTIuMTM4LDE4LjY1MiA5Mi43OTIsMTkuODQ3IEw5Ni4wNDIsMjUuNzc1IEw5Ni4wNjQsMjUuNzU3IEwxMDIuODQ5LDI5LjY3NCBMMTAyLjc0NCwyOS40OTIgTDE0OS42MjUsMi41MjcgTTE0OS42MjUsMC44OTIgQzE0OS4zNDMsMC44OTIgMTQ5LjA2MiwwLjk2NSAxNDguODEsMS4xMSBMMTAyLjY0MSwyNy42NjYgTDk3LjIzMSwyNC41NDIgTDk0LjIyNiwxOS4wNjEgQzkzLjMxMywxNy4zOTQgOTEuNTI3LDE2LjM1OSA4OS41NjYsMTYuMzU4IEM4OC41NTUsMTYuMzU4IDg3LjU0NiwxNi42MzIgODYuNjQ5LDE3LjE1IEM4My44NzgsMTguNzUgNzkuNjg3LDIxLjE2OSA3OS4zNzQsMjEuMzQ1IEM3OS4zNTksMjEuMzUzIDc5LjM0NSwyMS4zNjEgNzkuMzMsMjEuMzY5IEM3Ny43OTgsMjIuMjU0IDc2LjA4NCwyMi43MjIgNzQuMzczLDIyLjcyMiBDNzIuMDgxLDIyLjcyMiA2OS45NTksMjEuODkgNjguMzk3LDIwLjM4IEw2OC4xNDUsMjAuMTM1IEM2Ny43MDYsMTkuNjcyIDY3LjMyMywxOS4xNTYgNjcuMDA2LDE4LjYwMSBDNjYuOTg4LDE4LjU1OSA2Ni45NjgsMTguNTE5IDY2Ljk0NiwxOC40NzkgTDY2LjcxOSwxOC4wNjUgQzY2LjY5LDE4LjAxMiA2Ni42NTgsMTcuOTYgNjYuNjI0LDE3LjkxMSBDNjUuNjg2LDE2LjMzNyA2My45NTEsMTUuMzY2IDYyLjA1MywxNS4zNjYgQzYxLjA0MiwxNS4zNjYgNjAuMDMzLDE1LjY0IDU5LjEzNiwxNi4xNTggTDMuMTI1LDQ4LjUwMiBDMC40MjYsNTAuMDYxIC0wLjYxMyw1My40NDIgMC44MTEsNTYuMDQgTDExLjA4OSw3NC43OSBDMTEuMjY2LDc1LjExMyAxMS41MzcsNzUuMzUzIDExLjg1LDc1LjQ5NCBMNTguMjc2LDEwMi4yOTggQzU5LjY3OSwxMDMuMTA4IDYxLjQzMywxMDMuNjMgNjMuMzQ4LDEwMy44MDYgQzYzLjgxMiwxMDMuODQ4IDY0LjI4NSwxMDMuODcgNjQuNzU0LDEwMy44NyBDNjUsMTAzLjg3IDY1LjI0OSwxMDMuODY0IDY1LjQ5NCwxMDMuODUyIEM2NS41NjMsMTAzLjg0OSA2NS42MzIsMTAzLjg0NyA2NS43MDEsMTAzLjg0NyBDNjUuNzY0LDEwMy44NDcgNjUuODI4LDEwMy44NDkgNjUuODksMTAzLjg1MiBDNjUuOTg2LDEwMy44NTYgNjYuMDgsMTAzLjg2MyA2Ni4xNzMsMTAzLjg3NCBDNjYuMjgyLDEwNS40NjcgNjcuMzMyLDEwNy4xOTcgNjguNzAyLDEwNy45ODggTDExMS4xNzQsMTMyLjUxIEMxMTEuNjk4LDEzMi44MTIgMTEyLjIzMiwxMzIuOTY1IDExMi43NjQsMTMyLjk2NSBDMTE0LjI2MSwxMzIuOTY1IDExNS4zNDcsMTMxLjc2NSAxMTUuMzQ3LDEzMC4xMTMgTDExNS4zNDcsMTAzLjU1MSBMMTIyLjQ1OCw5OS40NDYgQzEyMi44MTksOTkuMjM3IDEyMy4wODcsOTguODk4IDEyMy4yMDcsOTguNDk4IEwxMjcuODY1LDgyLjkwNSBDMTMyLjI3OSw4My43MDIgMTM2LjU1Nyw4NC43NTMgMTQwLjYwNyw4Ni4wMzMgTDE0MS4xNCw4Ni44NjIgQzE0MS40NTEsODcuMzQ2IDE0MS45NzcsODcuNjEzIDE0Mi41MTYsODcuNjEzIEMxNDIuNzk0LDg3LjYxMyAxNDMuMDc2LDg3LjU0MiAxNDMuMzMzLDg3LjM5MyBMMTY5Ljg2NSw3Mi4wNzYgTDE5Myw4NS40MzMgQzE5My41MjMsODUuNzM1IDE5NC4wNTgsODUuODg4IDE5NC41OSw4NS44ODggQzE5Ni4wODcsODUuODg4IDE5Ny4xNzMsODQuNjg5IDE5Ny4xNzMsODMuMDM2IEwxOTcuMTczLDI5LjAzNSBDMTk3LjE3MywyOC40NTEgMTk2Ljg2MSwyNy45MTEgMTk2LjM1NSwyNy42MTkgQzE5Ni4zNTUsMjcuNjE5IDE3MS44NDMsMTMuNDY3IDE3MC4zODUsMTIuNjI2IEMxNzAuMTMyLDEyLjQ4IDE2OS44NSwxMi40MDcgMTY5LjU2OCwxMi40MDcgQzE2OS4yODUsMTIuNDA3IDE2OS4wMDIsMTIuNDgxIDE2OC43NDksMTIuNjI3IEMxNjguMTQzLDEyLjk3OCAxNjUuNzU2LDE0LjM1NyAxNjQuNDI0LDE1LjEyNSBMMTU5LjYxNSwxMC44NyBDMTU4Ljc5NiwxMC4xNDUgMTU4LjE1NCw4LjkzNyAxNTguMDU0LDcuOTM0IEMxNTguMDQ1LDcuODM3IDE1OC4wMzQsNy43MzkgMTU4LjAyMSw3LjY0IEMxNTguMDA1LDcuNTIzIDE1Ny45OTgsNy40MSAxNTcuOTk4LDcuMzA0IEwxNTcuOTk4LDYuNDE4IEMxNTcuOTk4LDUuODM0IDE1Ny42ODYsNS4yOTUgMTU3LjE4MSw1LjAwMiBDMTU2LjYyNCw0LjY4IDE1MC40NDIsMS4xMTEgMTUwLjQ0MiwxLjExMSBDMTUwLjE4OSwwLjk2NSAxNDkuOTA3LDAuODkyIDE0OS42MjUsMC44OTIiIGlkPSJGaWxsLTEiIGZpbGw9IiM0NTVBNjQiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNOTYuMDI3LDI1LjYzNiBMMTQyLjYwMyw1Mi41MjcgQzE0My44MDcsNTMuMjIyIDE0NC41ODIsNTQuMTE0IDE0NC44NDUsNTUuMDY4IEwxNDQuODM1LDU1LjA3NSBMNjMuNDYxLDEwMi4wNTcgTDYzLjQ2LDEwMi4wNTcgQzYxLjgwNiwxMDEuOTA1IDYwLjI2MSwxMDEuNDU3IDU5LjA1NywxMDAuNzYyIEwxMi40ODEsNzMuODcxIEw5Ni4wMjcsMjUuNjM2IiBpZD0iRmlsbC0yIiBmaWxsPSIjRkFGQUZBIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTYzLjQ2MSwxMDIuMTc0IEM2My40NTMsMTAyLjE3NCA2My40NDYsMTAyLjE3NCA2My40MzksMTAyLjE3MiBDNjEuNzQ2LDEwMi4wMTYgNjAuMjExLDEwMS41NjMgNTguOTk4LDEwMC44NjMgTDEyLjQyMiw3My45NzMgQzEyLjM4Niw3My45NTIgMTIuMzY0LDczLjkxNCAxMi4zNjQsNzMuODcxIEMxMi4zNjQsNzMuODMgMTIuMzg2LDczLjc5MSAxMi40MjIsNzMuNzcgTDk1Ljk2OCwyNS41MzUgQzk2LjAwNCwyNS41MTQgOTYuMDQ5LDI1LjUxNCA5Ni4wODUsMjUuNTM1IEwxNDIuNjYxLDUyLjQyNiBDMTQzLjg4OCw1My4xMzQgMTQ0LjY4Miw1NC4wMzggMTQ0Ljk1Nyw1NS4wMzcgQzE0NC45Nyw1NS4wODMgMTQ0Ljk1Myw1NS4xMzMgMTQ0LjkxNSw1NS4xNjEgQzE0NC45MTEsNTUuMTY1IDE0NC44OTgsNTUuMTc0IDE0NC44OTQsNTUuMTc3IEw2My41MTksMTAyLjE1OCBDNjMuNTAxLDEwMi4xNjkgNjMuNDgxLDEwMi4xNzQgNjMuNDYxLDEwMi4xNzQgTDYzLjQ2MSwxMDIuMTc0IFogTTEyLjcxNCw3My44NzEgTDU5LjExNSwxMDAuNjYxIEM2MC4yOTMsMTAxLjM0MSA2MS43ODYsMTAxLjc4MiA2My40MzUsMTAxLjkzNyBMMTQ0LjcwNyw1NS4wMTUgQzE0NC40MjgsNTQuMTA4IDE0My42ODIsNTMuMjg1IDE0Mi41NDQsNTIuNjI4IEw5Ni4wMjcsMjUuNzcxIEwxMi43MTQsNzMuODcxIEwxMi43MTQsNzMuODcxIFoiIGlkPSJGaWxsLTMiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTQ4LjMyNyw1OC40NzEgQzE0OC4xNDUsNTguNDggMTQ3Ljk2Miw1OC40OCAxNDcuNzgxLDU4LjQ3MiBDMTQ1Ljg4Nyw1OC4zODkgMTQ0LjQ3OSw1Ny40MzQgMTQ0LjYzNiw1Ni4zNCBDMTQ0LjY4OSw1NS45NjcgMTQ0LjY2NCw1NS41OTcgMTQ0LjU2NCw1NS4yMzUgTDYzLjQ2MSwxMDIuMDU3IEM2NC4wODksMTAyLjExNSA2NC43MzMsMTAyLjEzIDY1LjM3OSwxMDIuMDk5IEM2NS41NjEsMTAyLjA5IDY1Ljc0MywxMDIuMDkgNjUuOTI1LDEwMi4wOTggQzY3LjgxOSwxMDIuMTgxIDY5LjIyNywxMDMuMTM2IDY5LjA3LDEwNC4yMyBMMTQ4LjMyNyw1OC40NzEiIGlkPSJGaWxsLTQiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNjkuMDcsMTA0LjM0NyBDNjkuMDQ4LDEwNC4zNDcgNjkuMDI1LDEwNC4zNCA2OS4wMDUsMTA0LjMyNyBDNjguOTY4LDEwNC4zMDEgNjguOTQ4LDEwNC4yNTcgNjguOTU1LDEwNC4yMTMgQzY5LDEwMy44OTYgNjguODk4LDEwMy41NzYgNjguNjU4LDEwMy4yODggQzY4LjE1MywxMDIuNjc4IDY3LjEwMywxMDIuMjY2IDY1LjkyLDEwMi4yMTQgQzY1Ljc0MiwxMDIuMjA2IDY1LjU2MywxMDIuMjA3IDY1LjM4NSwxMDIuMjE1IEM2NC43NDIsMTAyLjI0NiA2NC4wODcsMTAyLjIzMiA2My40NSwxMDIuMTc0IEM2My4zOTksMTAyLjE2OSA2My4zNTgsMTAyLjEzMiA2My4zNDcsMTAyLjA4MiBDNjMuMzM2LDEwMi4wMzMgNjMuMzU4LDEwMS45ODEgNjMuNDAyLDEwMS45NTYgTDE0NC41MDYsNTUuMTM0IEMxNDQuNTM3LDU1LjExNiAxNDQuNTc1LDU1LjExMyAxNDQuNjA5LDU1LjEyNyBDMTQ0LjY0Miw1NS4xNDEgMTQ0LjY2OCw1NS4xNyAxNDQuNjc3LDU1LjIwNCBDMTQ0Ljc4MSw1NS41ODUgMTQ0LjgwNiw1NS45NzIgMTQ0Ljc1MSw1Ni4zNTcgQzE0NC43MDYsNTYuNjczIDE0NC44MDgsNTYuOTk0IDE0NS4wNDcsNTcuMjgyIEMxNDUuNTUzLDU3Ljg5MiAxNDYuNjAyLDU4LjMwMyAxNDcuNzg2LDU4LjM1NSBDMTQ3Ljk2NCw1OC4zNjMgMTQ4LjE0Myw1OC4zNjMgMTQ4LjMyMSw1OC4zNTQgQzE0OC4zNzcsNTguMzUyIDE0OC40MjQsNTguMzg3IDE0OC40MzksNTguNDM4IEMxNDguNDU0LDU4LjQ5IDE0OC40MzIsNTguNTQ1IDE0OC4zODUsNTguNTcyIEw2OS4xMjksMTA0LjMzMSBDNjkuMTExLDEwNC4zNDIgNjkuMDksMTA0LjM0NyA2OS4wNywxMDQuMzQ3IEw2OS4wNywxMDQuMzQ3IFogTTY1LjY2NSwxMDEuOTc1IEM2NS43NTQsMTAxLjk3NSA2NS44NDIsMTAxLjk3NyA2NS45MywxMDEuOTgxIEM2Ny4xOTYsMTAyLjAzNyA2OC4yODMsMTAyLjQ2OSA2OC44MzgsMTAzLjEzOSBDNjkuMDY1LDEwMy40MTMgNjkuMTg4LDEwMy43MTQgNjkuMTk4LDEwNC4wMjEgTDE0Ny44ODMsNTguNTkyIEMxNDcuODQ3LDU4LjU5MiAxNDcuODExLDU4LjU5MSAxNDcuNzc2LDU4LjU4OSBDMTQ2LjUwOSw1OC41MzMgMTQ1LjQyMiw1OC4xIDE0NC44NjcsNTcuNDMxIEMxNDQuNTg1LDU3LjA5MSAxNDQuNDY1LDU2LjcwNyAxNDQuNTIsNTYuMzI0IEMxNDQuNTYzLDU2LjAyMSAxNDQuNTUyLDU1LjcxNiAxNDQuNDg4LDU1LjQxNCBMNjMuODQ2LDEwMS45NyBDNjQuMzUzLDEwMi4wMDIgNjQuODY3LDEwMi4wMDYgNjUuMzc0LDEwMS45ODIgQzY1LjQ3MSwxMDEuOTc3IDY1LjU2OCwxMDEuOTc1IDY1LjY2NSwxMDEuOTc1IEw2NS42NjUsMTAxLjk3NSBaIiBpZD0iRmlsbC01IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTIuMjA4LDU1LjEzNCBDMS4yMDcsNTMuMzA3IDEuOTY3LDUwLjkxNyAzLjkwNiw0OS43OTcgTDU5LjkxNywxNy40NTMgQzYxLjg1NiwxNi4zMzMgNjQuMjQxLDE2LjkwNyA2NS4yNDMsMTguNzM0IEw2NS40NzUsMTkuMTQ0IEM2NS44NzIsMTkuODgyIDY2LjM2OCwyMC41NiA2Ni45NDUsMjEuMTY1IEw2Ny4yMjMsMjEuNDM1IEM3MC41NDgsMjQuNjQ5IDc1LjgwNiwyNS4xNTEgODAuMTExLDIyLjY2NSBMODcuNDMsMTguNDQ1IEM4OS4zNywxNy4zMjYgOTEuNzU0LDE3Ljg5OSA5Mi43NTUsMTkuNzI3IEw5Ni4wMDUsMjUuNjU1IEwxMi40ODYsNzMuODg0IEwyLjIwOCw1NS4xMzQgWiIgaWQ9IkZpbGwtNiIgZmlsbD0iI0ZBRkFGQSI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMi40ODYsNzQuMDAxIEMxMi40NzYsNzQuMDAxIDEyLjQ2NSw3My45OTkgMTIuNDU1LDczLjk5NiBDMTIuNDI0LDczLjk4OCAxMi4zOTksNzMuOTY3IDEyLjM4NCw3My45NCBMMi4xMDYsNTUuMTkgQzEuMDc1LDUzLjMxIDEuODU3LDUwLjg0NSAzLjg0OCw0OS42OTYgTDU5Ljg1OCwxNy4zNTIgQzYwLjUyNSwxNi45NjcgNjEuMjcxLDE2Ljc2NCA2Mi4wMTYsMTYuNzY0IEM2My40MzEsMTYuNzY0IDY0LjY2NiwxNy40NjYgNjUuMzI3LDE4LjY0NiBDNjUuMzM3LDE4LjY1NCA2NS4zNDUsMTguNjYzIDY1LjM1MSwxOC42NzQgTDY1LjU3OCwxOS4wODggQzY1LjU4NCwxOS4xIDY1LjU4OSwxOS4xMTIgNjUuNTkxLDE5LjEyNiBDNjUuOTg1LDE5LjgzOCA2Ni40NjksMjAuNDk3IDY3LjAzLDIxLjA4NSBMNjcuMzA1LDIxLjM1MSBDNjkuMTUxLDIzLjEzNyA3MS42NDksMjQuMTIgNzQuMzM2LDI0LjEyIEM3Ni4zMTMsMjQuMTIgNzguMjksMjMuNTgyIDgwLjA1MywyMi41NjMgQzgwLjA2NCwyMi41NTcgODAuMDc2LDIyLjU1MyA4MC4wODgsMjIuNTUgTDg3LjM3MiwxOC4zNDQgQzg4LjAzOCwxNy45NTkgODguNzg0LDE3Ljc1NiA4OS41MjksMTcuNzU2IEM5MC45NTYsMTcuNzU2IDkyLjIwMSwxOC40NzIgOTIuODU4LDE5LjY3IEw5Ni4xMDcsMjUuNTk5IEM5Ni4xMzgsMjUuNjU0IDk2LjExOCwyNS43MjQgOTYuMDYzLDI1Ljc1NiBMMTIuNTQ1LDczLjk4NSBDMTIuNTI2LDczLjk5NiAxMi41MDYsNzQuMDAxIDEyLjQ4Niw3NC4wMDEgTDEyLjQ4Niw3NC4wMDEgWiBNNjIuMDE2LDE2Ljk5NyBDNjEuMzEyLDE2Ljk5NyA2MC42MDYsMTcuMTkgNTkuOTc1LDE3LjU1NCBMMy45NjUsNDkuODk5IEMyLjA4Myw1MC45ODUgMS4zNDEsNTMuMzA4IDIuMzEsNTUuMDc4IEwxMi41MzEsNzMuNzIzIEw5NS44NDgsMjUuNjExIEw5Mi42NTMsMTkuNzgyIEM5Mi4wMzgsMTguNjYgOTAuODcsMTcuOTkgODkuNTI5LDE3Ljk5IEM4OC44MjUsMTcuOTkgODguMTE5LDE4LjE4MiA4Ny40ODksMTguNTQ3IEw4MC4xNzIsMjIuNzcyIEM4MC4xNjEsMjIuNzc4IDgwLjE0OSwyMi43ODIgODAuMTM3LDIyLjc4NSBDNzguMzQ2LDIzLjgxMSA3Ni4zNDEsMjQuMzU0IDc0LjMzNiwyNC4zNTQgQzcxLjU4OCwyNC4zNTQgNjkuMDMzLDIzLjM0NyA2Ny4xNDIsMjEuNTE5IEw2Ni44NjQsMjEuMjQ5IEM2Ni4yNzcsMjAuNjM0IDY1Ljc3NCwxOS45NDcgNjUuMzY3LDE5LjIwMyBDNjUuMzYsMTkuMTkyIDY1LjM1NiwxOS4xNzkgNjUuMzU0LDE5LjE2NiBMNjUuMTYzLDE4LjgxOSBDNjUuMTU0LDE4LjgxMSA2NS4xNDYsMTguODAxIDY1LjE0LDE4Ljc5IEM2NC41MjUsMTcuNjY3IDYzLjM1NywxNi45OTcgNjIuMDE2LDE2Ljk5NyBMNjIuMDE2LDE2Ljk5NyBaIiBpZD0iRmlsbC03IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTQyLjQzNCw0OC44MDggTDQyLjQzNCw0OC44MDggQzM5LjkyNCw0OC44MDcgMzcuNzM3LDQ3LjU1IDM2LjU4Miw0NS40NDMgQzM0Ljc3MSw0Mi4xMzkgMzYuMTQ0LDM3LjgwOSAzOS42NDEsMzUuNzg5IEw1MS45MzIsMjguNjkxIEM1My4xMDMsMjguMDE1IDU0LjQxMywyNy42NTggNTUuNzIxLDI3LjY1OCBDNTguMjMxLDI3LjY1OCA2MC40MTgsMjguOTE2IDYxLjU3MywzMS4wMjMgQzYzLjM4NCwzNC4zMjcgNjIuMDEyLDM4LjY1NyA1OC41MTQsNDAuNjc3IEw0Ni4yMjMsNDcuNzc1IEM0NS4wNTMsNDguNDUgNDMuNzQyLDQ4LjgwOCA0Mi40MzQsNDguODA4IEw0Mi40MzQsNDguODA4IFogTTU1LjcyMSwyOC4xMjUgQzU0LjQ5NSwyOC4xMjUgNTMuMjY1LDI4LjQ2MSA1Mi4xNjYsMjkuMDk2IEwzOS44NzUsMzYuMTk0IEMzNi41OTYsMzguMDg3IDM1LjMwMiw0Mi4xMzYgMzYuOTkyLDQ1LjIxOCBDMzguMDYzLDQ3LjE3MyA0MC4wOTgsNDguMzQgNDIuNDM0LDQ4LjM0IEM0My42NjEsNDguMzQgNDQuODksNDguMDA1IDQ1Ljk5LDQ3LjM3IEw1OC4yODEsNDAuMjcyIEM2MS41NiwzOC4zNzkgNjIuODUzLDM0LjMzIDYxLjE2NCwzMS4yNDggQzYwLjA5MiwyOS4yOTMgNTguMDU4LDI4LjEyNSA1NS43MjEsMjguMTI1IEw1NS43MjEsMjguMTI1IFoiIGlkPSJGaWxsLTgiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTQ5LjU4OCwyLjQwNyBDMTQ5LjU4OCwyLjQwNyAxNTUuNzY4LDUuOTc1IDE1Ni4zMjUsNi4yOTcgTDE1Ni4zMjUsNy4xODQgQzE1Ni4zMjUsNy4zNiAxNTYuMzM4LDcuNTQ0IDE1Ni4zNjIsNy43MzMgQzE1Ni4zNzMsNy44MTQgMTU2LjM4Miw3Ljg5NCAxNTYuMzksNy45NzUgQzE1Ni41Myw5LjM5IDE1Ny4zNjMsMTAuOTczIDE1OC40OTUsMTEuOTc0IEwxNjUuODkxLDE4LjUxOSBDMTY2LjA2OCwxOC42NzUgMTY2LjI0OSwxOC44MTQgMTY2LjQzMiwxOC45MzQgQzE2OC4wMTEsMTkuOTc0IDE2OS4zODIsMTkuNCAxNjkuNDk0LDE3LjY1MiBDMTY5LjU0MywxNi44NjggMTY5LjU1MSwxNi4wNTcgMTY5LjUxNywxNS4yMjMgTDE2OS41MTQsMTUuMDYzIEwxNjkuNTE0LDEzLjkxMiBDMTcwLjc4LDE0LjY0MiAxOTUuNTAxLDI4LjkxNSAxOTUuNTAxLDI4LjkxNSBMMTk1LjUwMSw4Mi45MTUgQzE5NS41MDEsODQuMDA1IDE5NC43MzEsODQuNDQ1IDE5My43ODEsODMuODk3IEwxNTEuMzA4LDU5LjM3NCBDMTUwLjM1OCw1OC44MjYgMTQ5LjU4OCw1Ny40OTcgMTQ5LjU4OCw1Ni40MDggTDE0OS41ODgsMjIuMzc1IiBpZD0iRmlsbC05IiBmaWxsPSIjRkFGQUZBIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE5NC41NTMsODQuMjUgQzE5NC4yOTYsODQuMjUgMTk0LjAxMyw4NC4xNjUgMTkzLjcyMiw4My45OTcgTDE1MS4yNSw1OS40NzYgQzE1MC4yNjksNTguOTA5IDE0OS40NzEsNTcuNTMzIDE0OS40NzEsNTYuNDA4IEwxNDkuNDcxLDIyLjM3NSBMMTQ5LjcwNSwyMi4zNzUgTDE0OS43MDUsNTYuNDA4IEMxNDkuNzA1LDU3LjQ1OSAxNTAuNDUsNTguNzQ0IDE1MS4zNjYsNTkuMjc0IEwxOTMuODM5LDgzLjc5NSBDMTk0LjI2Myw4NC4wNCAxOTQuNjU1LDg0LjA4MyAxOTQuOTQyLDgzLjkxNyBDMTk1LjIyNyw4My43NTMgMTk1LjM4NCw4My4zOTcgMTk1LjM4NCw4Mi45MTUgTDE5NS4zODQsMjguOTgyIEMxOTQuMTAyLDI4LjI0MiAxNzIuMTA0LDE1LjU0MiAxNjkuNjMxLDE0LjExNCBMMTY5LjYzNCwxNS4yMiBDMTY5LjY2OCwxNi4wNTIgMTY5LjY2LDE2Ljg3NCAxNjkuNjEsMTcuNjU5IEMxNjkuNTU2LDE4LjUwMyAxNjkuMjE0LDE5LjEyMyAxNjguNjQ3LDE5LjQwNSBDMTY4LjAyOCwxOS43MTQgMTY3LjE5NywxOS41NzggMTY2LjM2NywxOS4wMzIgQzE2Ni4xODEsMTguOTA5IDE2NS45OTUsMTguNzY2IDE2NS44MTQsMTguNjA2IEwxNTguNDE3LDEyLjA2MiBDMTU3LjI1OSwxMS4wMzYgMTU2LjQxOCw5LjQzNyAxNTYuMjc0LDcuOTg2IEMxNTYuMjY2LDcuOTA3IDE1Ni4yNTcsNy44MjcgMTU2LjI0Nyw3Ljc0OCBDMTU2LjIyMSw3LjU1NSAxNTYuMjA5LDcuMzY1IDE1Ni4yMDksNy4xODQgTDE1Ni4yMDksNi4zNjQgQzE1NS4zNzUsNS44ODMgMTQ5LjUyOSwyLjUwOCAxNDkuNTI5LDIuNTA4IEwxNDkuNjQ2LDIuMzA2IEMxNDkuNjQ2LDIuMzA2IDE1NS44MjcsNS44NzQgMTU2LjM4NCw2LjE5NiBMMTU2LjQ0Miw2LjIzIEwxNTYuNDQyLDcuMTg0IEMxNTYuNDQyLDcuMzU1IDE1Ni40NTQsNy41MzUgMTU2LjQ3OCw3LjcxNyBDMTU2LjQ4OSw3LjggMTU2LjQ5OSw3Ljg4MiAxNTYuNTA3LDcuOTYzIEMxNTYuNjQ1LDkuMzU4IDE1Ny40NTUsMTAuODk4IDE1OC41NzIsMTEuODg2IEwxNjUuOTY5LDE4LjQzMSBDMTY2LjE0MiwxOC41ODQgMTY2LjMxOSwxOC43MiAxNjYuNDk2LDE4LjgzNyBDMTY3LjI1NCwxOS4zMzYgMTY4LDE5LjQ2NyAxNjguNTQzLDE5LjE5NiBDMTY5LjAzMywxOC45NTMgMTY5LjMyOSwxOC40MDEgMTY5LjM3NywxNy42NDUgQzE2OS40MjcsMTYuODY3IDE2OS40MzQsMTYuMDU0IDE2OS40MDEsMTUuMjI4IEwxNjkuMzk3LDE1LjA2NSBMMTY5LjM5NywxMy43MSBMMTY5LjU3MiwxMy44MSBDMTcwLjgzOSwxNC41NDEgMTk1LjU1OSwyOC44MTQgMTk1LjU1OSwyOC44MTQgTDE5NS42MTgsMjguODQ3IEwxOTUuNjE4LDgyLjkxNSBDMTk1LjYxOCw4My40ODQgMTk1LjQyLDgzLjkxMSAxOTUuMDU5LDg0LjExOSBDMTk0LjkwOCw4NC4yMDYgMTk0LjczNyw4NC4yNSAxOTQuNTUzLDg0LjI1IiBpZD0iRmlsbC0xMCIgZmlsbD0iIzYwN0Q4QiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNDUuNjg1LDU2LjE2MSBMMTY5LjgsNzAuMDgzIEwxNDMuODIyLDg1LjA4MSBMMTQyLjM2LDg0Ljc3NCBDMTM1LjgyNiw4Mi42MDQgMTI4LjczMiw4MS4wNDYgMTIxLjM0MSw4MC4xNTggQzExNi45NzYsNzkuNjM0IDExMi42NzgsODEuMjU0IDExMS43NDMsODMuNzc4IEMxMTEuNTA2LDg0LjQxNCAxMTEuNTAzLDg1LjA3MSAxMTEuNzMyLDg1LjcwNiBDMTEzLjI3LDg5Ljk3MyAxMTUuOTY4LDk0LjA2OSAxMTkuNzI3LDk3Ljg0MSBMMTIwLjI1OSw5OC42ODYgQzEyMC4yNiw5OC42ODUgOTQuMjgyLDExMy42ODMgOTQuMjgyLDExMy42ODMgTDcwLjE2Nyw5OS43NjEgTDE0NS42ODUsNTYuMTYxIiBpZD0iRmlsbC0xMSIgZmlsbD0iI0ZGRkZGRiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik05NC4yODIsMTEzLjgxOCBMOTQuMjIzLDExMy43ODUgTDY5LjkzMyw5OS43NjEgTDcwLjEwOCw5OS42NiBMMTQ1LjY4NSw1Ni4wMjYgTDE0NS43NDMsNTYuMDU5IEwxNzAuMDMzLDcwLjA4MyBMMTQzLjg0Miw4NS4yMDUgTDE0My43OTcsODUuMTk1IEMxNDMuNzcyLDg1LjE5IDE0Mi4zMzYsODQuODg4IDE0Mi4zMzYsODQuODg4IEMxMzUuNzg3LDgyLjcxNCAxMjguNzIzLDgxLjE2MyAxMjEuMzI3LDgwLjI3NCBDMTIwLjc4OCw4MC4yMDkgMTIwLjIzNiw4MC4xNzcgMTE5LjY4OSw4MC4xNzcgQzExNS45MzEsODAuMTc3IDExMi42MzUsODEuNzA4IDExMS44NTIsODMuODE5IEMxMTEuNjI0LDg0LjQzMiAxMTEuNjIxLDg1LjA1MyAxMTEuODQyLDg1LjY2NyBDMTEzLjM3Nyw4OS45MjUgMTE2LjA1OCw5My45OTMgMTE5LjgxLDk3Ljc1OCBMMTE5LjgyNiw5Ny43NzkgTDEyMC4zNTIsOTguNjE0IEMxMjAuMzU0LDk4LjYxNyAxMjAuMzU2LDk4LjYyIDEyMC4zNTgsOTguNjI0IEwxMjAuNDIyLDk4LjcyNiBMMTIwLjMxNyw5OC43ODcgQzEyMC4yNjQsOTguODE4IDk0LjU5OSwxMTMuNjM1IDk0LjM0LDExMy43ODUgTDk0LjI4MiwxMTMuODE4IEw5NC4yODIsMTEzLjgxOCBaIE03MC40MDEsOTkuNzYxIEw5NC4yODIsMTEzLjU0OSBMMTE5LjA4NCw5OS4yMjkgQzExOS42Myw5OC45MTQgMTE5LjkzLDk4Ljc0IDEyMC4xMDEsOTguNjU0IEwxMTkuNjM1LDk3LjkxNCBDMTE1Ljg2NCw5NC4xMjcgMTEzLjE2OCw5MC4wMzMgMTExLjYyMiw4NS43NDYgQzExMS4zODIsODUuMDc5IDExMS4zODYsODQuNDA0IDExMS42MzMsODMuNzM4IEMxMTIuNDQ4LDgxLjUzOSAxMTUuODM2LDc5Ljk0MyAxMTkuNjg5LDc5Ljk0MyBDMTIwLjI0Niw3OS45NDMgMTIwLjgwNiw3OS45NzYgMTIxLjM1NSw4MC4wNDIgQzEyOC43NjcsODAuOTMzIDEzNS44NDYsODIuNDg3IDE0Mi4zOTYsODQuNjYzIEMxNDMuMjMyLDg0LjgzOCAxNDMuNjExLDg0LjkxNyAxNDMuNzg2LDg0Ljk2NyBMMTY5LjU2Niw3MC4wODMgTDE0NS42ODUsNTYuMjk1IEw3MC40MDEsOTkuNzYxIEw3MC40MDEsOTkuNzYxIFoiIGlkPSJGaWxsLTEyIiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE2Ny4yMywxOC45NzkgTDE2Ny4yMyw2OS44NSBMMTM5LjkwOSw4NS42MjMgTDEzMy40NDgsNzEuNDU2IEMxMzIuNTM4LDY5LjQ2IDEzMC4wMiw2OS43MTggMTI3LjgyNCw3Mi4wMyBDMTI2Ljc2OSw3My4xNCAxMjUuOTMxLDc0LjU4NSAxMjUuNDk0LDc2LjA0OCBMMTE5LjAzNCw5Ny42NzYgTDkxLjcxMiwxMTMuNDUgTDkxLjcxMiw2Mi41NzkgTDE2Ny4yMywxOC45NzkiIGlkPSJGaWxsLTEzIiBmaWxsPSIjRkZGRkZGIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTkxLjcxMiwxMTMuNTY3IEM5MS42OTIsMTEzLjU2NyA5MS42NzIsMTEzLjU2MSA5MS42NTMsMTEzLjU1MSBDOTEuNjE4LDExMy41MyA5MS41OTUsMTEzLjQ5MiA5MS41OTUsMTEzLjQ1IEw5MS41OTUsNjIuNTc5IEM5MS41OTUsNjIuNTM3IDkxLjYxOCw2Mi40OTkgOTEuNjUzLDYyLjQ3OCBMMTY3LjE3MiwxOC44NzggQzE2Ny4yMDgsMTguODU3IDE2Ny4yNTIsMTguODU3IDE2Ny4yODgsMTguODc4IEMxNjcuMzI0LDE4Ljg5OSAxNjcuMzQ3LDE4LjkzNyAxNjcuMzQ3LDE4Ljk3OSBMMTY3LjM0Nyw2OS44NSBDMTY3LjM0Nyw2OS44OTEgMTY3LjMyNCw2OS45MyAxNjcuMjg4LDY5Ljk1IEwxMzkuOTY3LDg1LjcyNSBDMTM5LjkzOSw4NS43NDEgMTM5LjkwNSw4NS43NDUgMTM5Ljg3Myw4NS43MzUgQzEzOS44NDIsODUuNzI1IDEzOS44MTYsODUuNzAyIDEzOS44MDIsODUuNjcyIEwxMzMuMzQyLDcxLjUwNCBDMTMyLjk2Nyw3MC42ODIgMTMyLjI4LDcwLjIyOSAxMzEuNDA4LDcwLjIyOSBDMTMwLjMxOSw3MC4yMjkgMTI5LjA0NCw3MC45MTUgMTI3LjkwOCw3Mi4xMSBDMTI2Ljg3NCw3My4yIDEyNi4wMzQsNzQuNjQ3IDEyNS42MDYsNzYuMDgyIEwxMTkuMTQ2LDk3LjcwOSBDMTE5LjEzNyw5Ny43MzggMTE5LjExOCw5Ny43NjIgMTE5LjA5Miw5Ny43NzcgTDkxLjc3LDExMy41NTEgQzkxLjc1MiwxMTMuNTYxIDkxLjczMiwxMTMuNTY3IDkxLjcxMiwxMTMuNTY3IEw5MS43MTIsMTEzLjU2NyBaIE05MS44MjksNjIuNjQ3IEw5MS44MjksMTEzLjI0OCBMMTE4LjkzNSw5Ny41OTggTDEyNS4zODIsNzYuMDE1IEMxMjUuODI3LDc0LjUyNSAxMjYuNjY0LDczLjA4MSAxMjcuNzM5LDcxLjk1IEMxMjguOTE5LDcwLjcwOCAxMzAuMjU2LDY5Ljk5NiAxMzEuNDA4LDY5Ljk5NiBDMTMyLjM3Nyw2OS45OTYgMTMzLjEzOSw3MC40OTcgMTMzLjU1NCw3MS40MDcgTDEzOS45NjEsODUuNDU4IEwxNjcuMTEzLDY5Ljc4MiBMMTY3LjExMywxOS4xODEgTDkxLjgyOSw2Mi42NDcgTDkxLjgyOSw2Mi42NDcgWiIgaWQ9IkZpbGwtMTQiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTY4LjU0MywxOS4yMTMgTDE2OC41NDMsNzAuMDgzIEwxNDEuMjIxLDg1Ljg1NyBMMTM0Ljc2MSw3MS42ODkgQzEzMy44NTEsNjkuNjk0IDEzMS4zMzMsNjkuOTUxIDEyOS4xMzcsNzIuMjYzIEMxMjguMDgyLDczLjM3NCAxMjcuMjQ0LDc0LjgxOSAxMjYuODA3LDc2LjI4MiBMMTIwLjM0Niw5Ny45MDkgTDkzLjAyNSwxMTMuNjgzIEw5My4wMjUsNjIuODEzIEwxNjguNTQzLDE5LjIxMyIgaWQ9IkZpbGwtMTUiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNOTMuMDI1LDExMy44IEM5My4wMDUsMTEzLjggOTIuOTg0LDExMy43OTUgOTIuOTY2LDExMy43ODUgQzkyLjkzMSwxMTMuNzY0IDkyLjkwOCwxMTMuNzI1IDkyLjkwOCwxMTMuNjg0IEw5Mi45MDgsNjIuODEzIEM5Mi45MDgsNjIuNzcxIDkyLjkzMSw2Mi43MzMgOTIuOTY2LDYyLjcxMiBMMTY4LjQ4NCwxOS4xMTIgQzE2OC41MiwxOS4wOSAxNjguNTY1LDE5LjA5IDE2OC42MDEsMTkuMTEyIEMxNjguNjM3LDE5LjEzMiAxNjguNjYsMTkuMTcxIDE2OC42NiwxOS4yMTIgTDE2OC42Niw3MC4wODMgQzE2OC42Niw3MC4xMjUgMTY4LjYzNyw3MC4xNjQgMTY4LjYwMSw3MC4xODQgTDE0MS4yOCw4NS45NTggQzE0MS4yNTEsODUuOTc1IDE0MS4yMTcsODUuOTc5IDE0MS4xODYsODUuOTY4IEMxNDEuMTU0LDg1Ljk1OCAxNDEuMTI5LDg1LjkzNiAxNDEuMTE1LDg1LjkwNiBMMTM0LjY1NSw3MS43MzggQzEzNC4yOCw3MC45MTUgMTMzLjU5Myw3MC40NjMgMTMyLjcyLDcwLjQ2MyBDMTMxLjYzMiw3MC40NjMgMTMwLjM1Nyw3MS4xNDggMTI5LjIyMSw3Mi4zNDQgQzEyOC4xODYsNzMuNDMzIDEyNy4zNDcsNzQuODgxIDEyNi45MTksNzYuMzE1IEwxMjAuNDU4LDk3Ljk0MyBDMTIwLjQ1LDk3Ljk3MiAxMjAuNDMxLDk3Ljk5NiAxMjAuNDA1LDk4LjAxIEw5My4wODMsMTEzLjc4NSBDOTMuMDY1LDExMy43OTUgOTMuMDQ1LDExMy44IDkzLjAyNSwxMTMuOCBMOTMuMDI1LDExMy44IFogTTkzLjE0Miw2Mi44ODEgTDkzLjE0MiwxMTMuNDgxIEwxMjAuMjQ4LDk3LjgzMiBMMTI2LjY5NSw3Ni4yNDggQzEyNy4xNCw3NC43NTggMTI3Ljk3Nyw3My4zMTUgMTI5LjA1Miw3Mi4xODMgQzEzMC4yMzEsNzAuOTQyIDEzMS41NjgsNzAuMjI5IDEzMi43Miw3MC4yMjkgQzEzMy42ODksNzAuMjI5IDEzNC40NTIsNzAuNzMxIDEzNC44NjcsNzEuNjQxIEwxNDEuMjc0LDg1LjY5MiBMMTY4LjQyNiw3MC4wMTYgTDE2OC40MjYsMTkuNDE1IEw5My4xNDIsNjIuODgxIEw5My4xNDIsNjIuODgxIFoiIGlkPSJGaWxsLTE2IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE2OS44LDcwLjA4MyBMMTQyLjQ3OCw4NS44NTcgTDEzNi4wMTgsNzEuNjg5IEMxMzUuMTA4LDY5LjY5NCAxMzIuNTksNjkuOTUxIDEzMC4zOTMsNzIuMjYzIEMxMjkuMzM5LDczLjM3NCAxMjguNSw3NC44MTkgMTI4LjA2NCw3Ni4yODIgTDEyMS42MDMsOTcuOTA5IEw5NC4yODIsMTEzLjY4MyBMOTQuMjgyLDYyLjgxMyBMMTY5LjgsMTkuMjEzIEwxNjkuOCw3MC4wODMgWiIgaWQ9IkZpbGwtMTciIGZpbGw9IiNGQUZBRkEiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNOTQuMjgyLDExMy45MTcgQzk0LjI0MSwxMTMuOTE3IDk0LjIwMSwxMTMuOTA3IDk0LjE2NSwxMTMuODg2IEM5NC4wOTMsMTEzLjg0NSA5NC4wNDgsMTEzLjc2NyA5NC4wNDgsMTEzLjY4NCBMOTQuMDQ4LDYyLjgxMyBDOTQuMDQ4LDYyLjczIDk0LjA5Myw2Mi42NTIgOTQuMTY1LDYyLjYxMSBMMTY5LjY4MywxOS4wMSBDMTY5Ljc1NSwxOC45NjkgMTY5Ljg0NCwxOC45NjkgMTY5LjkxNywxOS4wMSBDMTY5Ljk4OSwxOS4wNTIgMTcwLjAzMywxOS4xMjkgMTcwLjAzMywxOS4yMTIgTDE3MC4wMzMsNzAuMDgzIEMxNzAuMDMzLDcwLjE2NiAxNjkuOTg5LDcwLjI0NCAxNjkuOTE3LDcwLjI4NSBMMTQyLjU5NSw4Ni4wNiBDMTQyLjUzOCw4Ni4wOTIgMTQyLjQ2OSw4Ni4xIDE0Mi40MDcsODYuMDggQzE0Mi4zNDQsODYuMDYgMTQyLjI5Myw4Ni4wMTQgMTQyLjI2Niw4NS45NTQgTDEzNS44MDUsNzEuNzg2IEMxMzUuNDQ1LDcwLjk5NyAxMzQuODEzLDcwLjU4IDEzMy45NzcsNzAuNTggQzEzMi45MjEsNzAuNTggMTMxLjY3Niw3MS4yNTIgMTMwLjU2Miw3Mi40MjQgQzEyOS41NCw3My41MDEgMTI4LjcxMSw3NC45MzEgMTI4LjI4Nyw3Ni4zNDggTDEyMS44MjcsOTcuOTc2IEMxMjEuODEsOTguMDM0IDEyMS43NzEsOTguMDgyIDEyMS43Miw5OC4xMTIgTDk0LjM5OCwxMTMuODg2IEM5NC4zNjIsMTEzLjkwNyA5NC4zMjIsMTEzLjkxNyA5NC4yODIsMTEzLjkxNyBMOTQuMjgyLDExMy45MTcgWiBNOTQuNTE1LDYyLjk0OCBMOTQuNTE1LDExMy4yNzkgTDEyMS40MDYsOTcuNzU0IEwxMjcuODQsNzYuMjE1IEMxMjguMjksNzQuNzA4IDEyOS4xMzcsNzMuMjQ3IDEzMC4yMjQsNzIuMTAzIEMxMzEuNDI1LDcwLjgzOCAxMzIuNzkzLDcwLjExMiAxMzMuOTc3LDcwLjExMiBDMTM0Ljk5NSw3MC4xMTIgMTM1Ljc5NSw3MC42MzggMTM2LjIzLDcxLjU5MiBMMTQyLjU4NCw4NS41MjYgTDE2OS41NjYsNjkuOTQ4IEwxNjkuNTY2LDE5LjYxNyBMOTQuNTE1LDYyLjk0OCBMOTQuNTE1LDYyLjk0OCBaIiBpZD0iRmlsbC0xOCIgZmlsbD0iIzYwN0Q4QiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMDkuODk0LDkyLjk0MyBMMTA5Ljg5NCw5Mi45NDMgQzEwOC4xMiw5Mi45NDMgMTA2LjY1Myw5Mi4yMTggMTA1LjY1LDkwLjgyMyBDMTA1LjU4Myw5MC43MzEgMTA1LjU5Myw5MC42MSAxMDUuNjczLDkwLjUyOSBDMTA1Ljc1Myw5MC40NDggMTA1Ljg4LDkwLjQ0IDEwNS45NzQsOTAuNTA2IEMxMDYuNzU0LDkxLjA1MyAxMDcuNjc5LDkxLjMzMyAxMDguNzI0LDkxLjMzMyBDMTEwLjA0Nyw5MS4zMzMgMTExLjQ3OCw5MC44OTQgMTEyLjk4LDkwLjAyNyBDMTE4LjI5MSw4Ni45NiAxMjIuNjExLDc5LjUwOSAxMjIuNjExLDczLjQxNiBDMTIyLjYxMSw3MS40ODkgMTIyLjE2OSw2OS44NTYgMTIxLjMzMyw2OC42OTIgQzEyMS4yNjYsNjguNiAxMjEuMjc2LDY4LjQ3MyAxMjEuMzU2LDY4LjM5MiBDMTIxLjQzNiw2OC4zMTEgMTIxLjU2Myw2OC4yOTkgMTIxLjY1Niw2OC4zNjUgQzEyMy4zMjcsNjkuNTM3IDEyNC4yNDcsNzEuNzQ2IDEyNC4yNDcsNzQuNTg0IEMxMjQuMjQ3LDgwLjgyNiAxMTkuODIxLDg4LjQ0NyAxMTQuMzgyLDkxLjU4NyBDMTEyLjgwOCw5Mi40OTUgMTExLjI5OCw5Mi45NDMgMTA5Ljg5NCw5Mi45NDMgTDEwOS44OTQsOTIuOTQzIFogTTEwNi45MjUsOTEuNDAxIEMxMDcuNzM4LDkyLjA1MiAxMDguNzQ1LDkyLjI3OCAxMDkuODkzLDkyLjI3OCBMMTA5Ljg5NCw5Mi4yNzggQzExMS4yMTUsOTIuMjc4IDExMi42NDcsOTEuOTUxIDExNC4xNDgsOTEuMDg0IEMxMTkuNDU5LDg4LjAxNyAxMjMuNzgsODAuNjIxIDEyMy43OCw3NC41MjggQzEyMy43OCw3Mi41NDkgMTIzLjMxNyw3MC45MjkgMTIyLjQ1NCw2OS43NjcgQzEyMi44NjUsNzAuODAyIDEyMy4wNzksNzIuMDQyIDEyMy4wNzksNzMuNDAyIEMxMjMuMDc5LDc5LjY0NSAxMTguNjUzLDg3LjI4NSAxMTMuMjE0LDkwLjQyNSBDMTExLjY0LDkxLjMzNCAxMTAuMTMsOTEuNzQyIDEwOC43MjQsOTEuNzQyIEMxMDguMDgzLDkxLjc0MiAxMDcuNDgxLDkxLjU5MyAxMDYuOTI1LDkxLjQwMSBMMTA2LjkyNSw5MS40MDEgWiIgaWQ9IkZpbGwtMTkiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTEzLjA5Nyw5MC4yMyBDMTE4LjQ4MSw4Ny4xMjIgMTIyLjg0NSw3OS41OTQgMTIyLjg0NSw3My40MTYgQzEyMi44NDUsNzEuMzY1IDEyMi4zNjIsNjkuNzI0IDEyMS41MjIsNjguNTU2IEMxMTkuNzM4LDY3LjMwNCAxMTcuMTQ4LDY3LjM2MiAxMTQuMjY1LDY5LjAyNiBDMTA4Ljg4MSw3Mi4xMzQgMTA0LjUxNyw3OS42NjIgMTA0LjUxNyw4NS44NCBDMTA0LjUxNyw4Ny44OTEgMTA1LDg5LjUzMiAxMDUuODQsOTAuNyBDMTA3LjYyNCw5MS45NTIgMTEwLjIxNCw5MS44OTQgMTEzLjA5Nyw5MC4yMyIgaWQ9IkZpbGwtMjAiIGZpbGw9IiNGQUZBRkEiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTA4LjcyNCw5MS42MTQgTDEwOC43MjQsOTEuNjE0IEMxMDcuNTgyLDkxLjYxNCAxMDYuNTY2LDkxLjQwMSAxMDUuNzA1LDkwLjc5NyBDMTA1LjY4NCw5MC43ODMgMTA1LjY2NSw5MC44MTEgMTA1LjY1LDkwLjc5IEMxMDQuNzU2LDg5LjU0NiAxMDQuMjgzLDg3Ljg0MiAxMDQuMjgzLDg1LjgxNyBDMTA0LjI4Myw3OS41NzUgMTA4LjcwOSw3MS45NTMgMTE0LjE0OCw2OC44MTIgQzExNS43MjIsNjcuOTA0IDExNy4yMzIsNjcuNDQ5IDExOC42MzgsNjcuNDQ5IEMxMTkuNzgsNjcuNDQ5IDEyMC43OTYsNjcuNzU4IDEyMS42NTYsNjguMzYyIEMxMjEuNjc4LDY4LjM3NyAxMjEuNjk3LDY4LjM5NyAxMjEuNzEyLDY4LjQxOCBDMTIyLjYwNiw2OS42NjIgMTIzLjA3OSw3MS4zOSAxMjMuMDc5LDczLjQxNSBDMTIzLjA3OSw3OS42NTggMTE4LjY1Myw4Ny4xOTggMTEzLjIxNCw5MC4zMzggQzExMS42NCw5MS4yNDcgMTEwLjEzLDkxLjYxNCAxMDguNzI0LDkxLjYxNCBMMTA4LjcyNCw5MS42MTQgWiBNMTA2LjAwNiw5MC41MDUgQzEwNi43OCw5MS4wMzcgMTA3LjY5NCw5MS4yODEgMTA4LjcyNCw5MS4yODEgQzExMC4wNDcsOTEuMjgxIDExMS40NzgsOTAuODY4IDExMi45OCw5MC4wMDEgQzExOC4yOTEsODYuOTM1IDEyMi42MTEsNzkuNDk2IDEyMi42MTEsNzMuNDAzIEMxMjIuNjExLDcxLjQ5NCAxMjIuMTc3LDY5Ljg4IDEyMS4zNTYsNjguNzE4IEMxMjAuNTgyLDY4LjE4NSAxMTkuNjY4LDY3LjkxOSAxMTguNjM4LDY3LjkxOSBDMTE3LjMxNSw2Ny45MTkgMTE1Ljg4Myw2OC4zNiAxMTQuMzgyLDY5LjIyNyBDMTA5LjA3MSw3Mi4yOTMgMTA0Ljc1MSw3OS43MzMgMTA0Ljc1MSw4NS44MjYgQzEwNC43NTEsODcuNzM1IDEwNS4xODUsODkuMzQzIDEwNi4wMDYsOTAuNTA1IEwxMDYuMDA2LDkwLjUwNSBaIiBpZD0iRmlsbC0yMSIgZmlsbD0iIzYwN0Q4QiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNDkuMzE4LDcuMjYyIEwxMzkuMzM0LDE2LjE0IEwxNTUuMjI3LDI3LjE3MSBMMTYwLjgxNiwyMS4wNTkgTDE0OS4zMTgsNy4yNjIiIGlkPSJGaWxsLTIyIiBmaWxsPSIjRkFGQUZBIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE2OS42NzYsMTMuODQgTDE1OS45MjgsMTkuNDY3IEMxNTYuMjg2LDIxLjU3IDE1MC40LDIxLjU4IDE0Ni43ODEsMTkuNDkxIEMxNDMuMTYxLDE3LjQwMiAxNDMuMTgsMTQuMDAzIDE0Ni44MjIsMTEuOSBMMTU2LjMxNyw2LjI5MiBMMTQ5LjU4OCwyLjQwNyBMNjcuNzUyLDQ5LjQ3OCBMMTEzLjY3NSw3NS45OTIgTDExNi43NTYsNzQuMjEzIEMxMTcuMzg3LDczLjg0OCAxMTcuNjI1LDczLjMxNSAxMTcuMzc0LDcyLjgyMyBDMTE1LjAxNyw2OC4xOTEgMTE0Ljc4MSw2My4yNzcgMTE2LjY5MSw1OC41NjEgQzEyMi4zMjksNDQuNjQxIDE0MS4yLDMzLjc0NiAxNjUuMzA5LDMwLjQ5MSBDMTczLjQ3OCwyOS4zODggMTgxLjk4OSwyOS41MjQgMTkwLjAxMywzMC44ODUgQzE5MC44NjUsMzEuMDMgMTkxLjc4OSwzMC44OTMgMTkyLjQyLDMwLjUyOCBMMTk1LjUwMSwyOC43NSBMMTY5LjY3NiwxMy44NCIgaWQ9IkZpbGwtMjMiIGZpbGw9IiNGQUZBRkEiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTEzLjY3NSw3Ni40NTkgQzExMy41OTQsNzYuNDU5IDExMy41MTQsNzYuNDM4IDExMy40NDIsNzYuMzk3IEw2Ny41MTgsNDkuODgyIEM2Ny4zNzQsNDkuNzk5IDY3LjI4NCw0OS42NDUgNjcuMjg1LDQ5LjQ3OCBDNjcuMjg1LDQ5LjMxMSA2Ny4zNzQsNDkuMTU3IDY3LjUxOSw0OS4wNzMgTDE0OS4zNTUsMi4wMDIgQzE0OS40OTksMS45MTkgMTQ5LjY3NywxLjkxOSAxNDkuODIxLDIuMDAyIEwxNTYuNTUsNS44ODcgQzE1Ni43NzQsNi4wMTcgMTU2Ljg1LDYuMzAyIDE1Ni43MjIsNi41MjYgQzE1Ni41OTIsNi43NDkgMTU2LjMwNyw2LjgyNiAxNTYuMDgzLDYuNjk2IEwxNDkuNTg3LDIuOTQ2IEw2OC42ODcsNDkuNDc5IEwxMTMuNjc1LDc1LjQ1MiBMMTE2LjUyMyw3My44MDggQzExNi43MTUsNzMuNjk3IDExNy4xNDMsNzMuMzk5IDExNi45NTgsNzMuMDM1IEMxMTQuNTQyLDY4LjI4NyAxMTQuMyw2My4yMjEgMTE2LjI1OCw1OC4zODUgQzExOS4wNjQsNTEuNDU4IDEyNS4xNDMsNDUuMTQzIDEzMy44NCw0MC4xMjIgQzE0Mi40OTcsMzUuMTI0IDE1My4zNTgsMzEuNjMzIDE2NS4yNDcsMzAuMDI4IEMxNzMuNDQ1LDI4LjkyMSAxODIuMDM3LDI5LjA1OCAxOTAuMDkxLDMwLjQyNSBDMTkwLjgzLDMwLjU1IDE5MS42NTIsMzAuNDMyIDE5Mi4xODYsMzAuMTI0IEwxOTQuNTY3LDI4Ljc1IEwxNjkuNDQyLDE0LjI0NCBDMTY5LjIxOSwxNC4xMTUgMTY5LjE0MiwxMy44MjkgMTY5LjI3MSwxMy42MDYgQzE2OS40LDEzLjM4MiAxNjkuNjg1LDEzLjMwNiAxNjkuOTA5LDEzLjQzNSBMMTk1LjczNCwyOC4zNDUgQzE5NS44NzksMjguNDI4IDE5NS45NjgsMjguNTgzIDE5NS45NjgsMjguNzUgQzE5NS45NjgsMjguOTE2IDE5NS44NzksMjkuMDcxIDE5NS43MzQsMjkuMTU0IEwxOTIuNjUzLDMwLjkzMyBDMTkxLjkzMiwzMS4zNSAxOTAuODksMzEuNTA4IDE4OS45MzUsMzEuMzQ2IEMxODEuOTcyLDI5Ljk5NSAxNzMuNDc4LDI5Ljg2IDE2NS4zNzIsMzAuOTU0IEMxNTMuNjAyLDMyLjU0MyAxNDIuODYsMzUuOTkzIDEzNC4zMDcsNDAuOTMxIEMxMjUuNzkzLDQ1Ljg0NyAxMTkuODUxLDUyLjAwNCAxMTcuMTI0LDU4LjczNiBDMTE1LjI3LDYzLjMxNCAxMTUuNTAxLDY4LjExMiAxMTcuNzksNzIuNjExIEMxMTguMTYsNzMuMzM2IDExNy44NDUsNzQuMTI0IDExNi45OSw3NC42MTcgTDExMy45MDksNzYuMzk3IEMxMTMuODM2LDc2LjQzOCAxMTMuNzU2LDc2LjQ1OSAxMTMuNjc1LDc2LjQ1OSIgaWQ9IkZpbGwtMjQiIGZpbGw9IiM0NTVBNjQiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTUzLjMxNiwyMS4yNzkgQzE1MC45MDMsMjEuMjc5IDE0OC40OTUsMjAuNzUxIDE0Ni42NjQsMTkuNjkzIEMxNDQuODQ2LDE4LjY0NCAxNDMuODQ0LDE3LjIzMiAxNDMuODQ0LDE1LjcxOCBDMTQzLjg0NCwxNC4xOTEgMTQ0Ljg2LDEyLjc2MyAxNDYuNzA1LDExLjY5OCBMMTU2LjE5OCw2LjA5MSBDMTU2LjMwOSw2LjAyNSAxNTYuNDUyLDYuMDYyIDE1Ni41MTgsNi4xNzMgQzE1Ni41ODMsNi4yODQgMTU2LjU0Nyw2LjQyNyAxNTYuNDM2LDYuNDkzIEwxNDYuOTQsMTIuMTAyIEMxNDUuMjQ0LDEzLjA4MSAxNDQuMzEyLDE0LjM2NSAxNDQuMzEyLDE1LjcxOCBDMTQ0LjMxMiwxNy4wNTggMTQ1LjIzLDE4LjMyNiAxNDYuODk3LDE5LjI4OSBDMTUwLjQ0NiwyMS4zMzggMTU2LjI0LDIxLjMyNyAxNTkuODExLDE5LjI2NSBMMTY5LjU1OSwxMy42MzcgQzE2OS42NywxMy41NzMgMTY5LjgxMywxMy42MTEgMTY5Ljg3OCwxMy43MjMgQzE2OS45NDMsMTMuODM0IDE2OS45MDQsMTMuOTc3IDE2OS43OTMsMTQuMDQyIEwxNjAuMDQ1LDE5LjY3IEMxNTguMTg3LDIwLjc0MiAxNTUuNzQ5LDIxLjI3OSAxNTMuMzE2LDIxLjI3OSIgaWQ9IkZpbGwtMjUiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTEzLjY3NSw3NS45OTIgTDY3Ljc2Miw0OS40ODQiIGlkPSJGaWxsLTI2IiBmaWxsPSIjNDU1QTY0Ij48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTExMy42NzUsNzYuMzQyIEMxMTMuNjE1LDc2LjM0MiAxMTMuNTU1LDc2LjMyNyAxMTMuNSw3Ni4yOTUgTDY3LjU4Nyw0OS43ODcgQzY3LjQxOSw0OS42OSA2Ny4zNjIsNDkuNDc2IDY3LjQ1OSw0OS4zMDkgQzY3LjU1Niw0OS4xNDEgNjcuNzcsNDkuMDgzIDY3LjkzNyw0OS4xOCBMMTEzLjg1LDc1LjY4OCBDMTE0LjAxOCw3NS43ODUgMTE0LjA3NSw3NiAxMTMuOTc4LDc2LjE2NyBDMTEzLjkxNCw3Ni4yNzkgMTEzLjc5Niw3Ni4zNDIgMTEzLjY3NSw3Ni4zNDIiIGlkPSJGaWxsLTI3IiBmaWxsPSIjNDU1QTY0Ij48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTY3Ljc2Miw0OS40ODQgTDY3Ljc2MiwxMDMuNDg1IEM2Ny43NjIsMTA0LjU3NSA2OC41MzIsMTA1LjkwMyA2OS40ODIsMTA2LjQ1MiBMMTExLjk1NSwxMzAuOTczIEMxMTIuOTA1LDEzMS41MjIgMTEzLjY3NSwxMzEuMDgzIDExMy42NzUsMTI5Ljk5MyBMMTEzLjY3NSw3NS45OTIiIGlkPSJGaWxsLTI4IiBmaWxsPSIjRkFGQUZBIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTExMi43MjcsMTMxLjU2MSBDMTEyLjQzLDEzMS41NjEgMTEyLjEwNywxMzEuNDY2IDExMS43OCwxMzEuMjc2IEw2OS4zMDcsMTA2Ljc1NSBDNjguMjQ0LDEwNi4xNDIgNjcuNDEyLDEwNC43MDUgNjcuNDEyLDEwMy40ODUgTDY3LjQxMiw0OS40ODQgQzY3LjQxMiw0OS4yOSA2Ny41NjksNDkuMTM0IDY3Ljc2Miw0OS4xMzQgQzY3Ljk1Niw0OS4xMzQgNjguMTEzLDQ5LjI5IDY4LjExMyw0OS40ODQgTDY4LjExMywxMDMuNDg1IEM2OC4xMTMsMTA0LjQ0NSA2OC44MiwxMDUuNjY1IDY5LjY1NywxMDYuMTQ4IEwxMTIuMTMsMTMwLjY3IEMxMTIuNDc0LDEzMC44NjggMTEyLjc5MSwxMzAuOTEzIDExMywxMzAuNzkyIEMxMTMuMjA2LDEzMC42NzMgMTEzLjMyNSwxMzAuMzgxIDExMy4zMjUsMTI5Ljk5MyBMMTEzLjMyNSw3NS45OTIgQzExMy4zMjUsNzUuNzk4IDExMy40ODIsNzUuNjQxIDExMy42NzUsNzUuNjQxIEMxMTMuODY5LDc1LjY0MSAxMTQuMDI1LDc1Ljc5OCAxMTQuMDI1LDc1Ljk5MiBMMTE0LjAyNSwxMjkuOTkzIEMxMTQuMDI1LDEzMC42NDggMTEzLjc4NiwxMzEuMTQ3IDExMy4zNSwxMzEuMzk5IEMxMTMuMTYyLDEzMS41MDcgMTEyLjk1MiwxMzEuNTYxIDExMi43MjcsMTMxLjU2MSIgaWQ9IkZpbGwtMjkiIGZpbGw9IiM0NTVBNjQiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTEyLjg2LDQwLjUxMiBDMTEyLjg2LDQwLjUxMiAxMTIuODYsNDAuNTEyIDExMi44NTksNDAuNTEyIEMxMTAuNTQxLDQwLjUxMiAxMDguMzYsMzkuOTkgMTA2LjcxNywzOS4wNDEgQzEwNS4wMTIsMzguMDU3IDEwNC4wNzQsMzYuNzI2IDEwNC4wNzQsMzUuMjkyIEMxMDQuMDc0LDMzLjg0NyAxMDUuMDI2LDMyLjUwMSAxMDYuNzU0LDMxLjUwNCBMMTE4Ljc5NSwyNC41NTEgQzEyMC40NjMsMjMuNTg5IDEyMi42NjksMjMuMDU4IDEyNS4wMDcsMjMuMDU4IEMxMjcuMzI1LDIzLjA1OCAxMjkuNTA2LDIzLjU4MSAxMzEuMTUsMjQuNTMgQzEzMi44NTQsMjUuNTE0IDEzMy43OTMsMjYuODQ1IDEzMy43OTMsMjguMjc4IEMxMzMuNzkzLDI5LjcyNCAxMzIuODQxLDMxLjA2OSAxMzEuMTEzLDMyLjA2NyBMMTE5LjA3MSwzOS4wMTkgQzExNy40MDMsMzkuOTgyIDExNS4xOTcsNDAuNTEyIDExMi44Niw0MC41MTIgTDExMi44Niw0MC41MTIgWiBNMTI1LjAwNywyMy43NTkgQzEyMi43OSwyMy43NTkgMTIwLjcwOSwyNC4yNTYgMTE5LjE0NiwyNS4xNTggTDEwNy4xMDQsMzIuMTEgQzEwNS42MDIsMzIuOTc4IDEwNC43NzQsMzQuMTA4IDEwNC43NzQsMzUuMjkyIEMxMDQuNzc0LDM2LjQ2NSAxMDUuNTg5LDM3LjU4MSAxMDcuMDY3LDM4LjQzNCBDMTA4LjYwNSwzOS4zMjMgMTEwLjY2MywzOS44MTIgMTEyLjg1OSwzOS44MTIgTDExMi44NiwzOS44MTIgQzExNS4wNzYsMzkuODEyIDExNy4xNTgsMzkuMzE1IDExOC43MjEsMzguNDEzIEwxMzAuNzYyLDMxLjQ2IEMxMzIuMjY0LDMwLjU5MyAxMzMuMDkyLDI5LjQ2MyAxMzMuMDkyLDI4LjI3OCBDMTMzLjA5MiwyNy4xMDYgMTMyLjI3OCwyNS45OSAxMzAuOCwyNS4xMzYgQzEyOS4yNjEsMjQuMjQ4IDEyNy4yMDQsMjMuNzU5IDEyNS4wMDcsMjMuNzU5IEwxMjUuMDA3LDIzLjc1OSBaIiBpZD0iRmlsbC0zMCIgZmlsbD0iIzYwN0Q4QiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNjUuNjMsMTYuMjE5IEwxNTkuODk2LDE5LjUzIEMxNTYuNzI5LDIxLjM1OCAxNTEuNjEsMjEuMzY3IDE0OC40NjMsMTkuNTUgQzE0NS4zMTYsMTcuNzMzIDE0NS4zMzIsMTQuNzc4IDE0OC40OTksMTIuOTQ5IEwxNTQuMjMzLDkuNjM5IEwxNjUuNjMsMTYuMjE5IiBpZD0iRmlsbC0zMSIgZmlsbD0iI0ZBRkFGQSI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNTQuMjMzLDEwLjQ0OCBMMTY0LjIyOCwxNi4yMTkgTDE1OS41NDYsMTguOTIzIEMxNTguMTEyLDE5Ljc1IDE1Ni4xOTQsMjAuMjA2IDE1NC4xNDcsMjAuMjA2IEMxNTIuMTE4LDIwLjIwNiAxNTAuMjI0LDE5Ljc1NyAxNDguODE0LDE4Ljk0MyBDMTQ3LjUyNCwxOC4xOTkgMTQ2LjgxNCwxNy4yNDkgMTQ2LjgxNCwxNi4yNjkgQzE0Ni44MTQsMTUuMjc4IDE0Ny41MzcsMTQuMzE0IDE0OC44NSwxMy41NTYgTDE1NC4yMzMsMTAuNDQ4IE0xNTQuMjMzLDkuNjM5IEwxNDguNDk5LDEyLjk0OSBDMTQ1LjMzMiwxNC43NzggMTQ1LjMxNiwxNy43MzMgMTQ4LjQ2MywxOS41NSBDMTUwLjAzMSwyMC40NTUgMTUyLjA4NiwyMC45MDcgMTU0LjE0NywyMC45MDcgQzE1Ni4yMjQsMjAuOTA3IDE1OC4zMDYsMjAuNDQ3IDE1OS44OTYsMTkuNTMgTDE2NS42MywxNi4yMTkgTDE1NC4yMzMsOS42MzkiIGlkPSJGaWxsLTMyIiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE0NS40NDUsNzIuNjY3IEwxNDUuNDQ1LDcyLjY2NyBDMTQzLjY3Miw3Mi42NjcgMTQyLjIwNCw3MS44MTcgMTQxLjIwMiw3MC40MjIgQzE0MS4xMzUsNzAuMzMgMTQxLjE0NSw3MC4xNDcgMTQxLjIyNSw3MC4wNjYgQzE0MS4zMDUsNjkuOTg1IDE0MS40MzIsNjkuOTQ2IDE0MS41MjUsNzAuMDExIEMxNDIuMzA2LDcwLjU1OSAxNDMuMjMxLDcwLjgyMyAxNDQuMjc2LDcwLjgyMiBDMTQ1LjU5OCw3MC44MjIgMTQ3LjAzLDcwLjM3NiAxNDguNTMyLDY5LjUwOSBDMTUzLjg0Miw2Ni40NDMgMTU4LjE2Myw1OC45ODcgMTU4LjE2Myw1Mi44OTQgQzE1OC4xNjMsNTAuOTY3IDE1Ny43MjEsNDkuMzMyIDE1Ni44ODQsNDguMTY4IEMxNTYuODE4LDQ4LjA3NiAxNTYuODI4LDQ3Ljk0OCAxNTYuOTA4LDQ3Ljg2NyBDMTU2Ljk4OCw0Ny43ODYgMTU3LjExNCw0Ny43NzQgMTU3LjIwOCw0Ny44NCBDMTU4Ljg3OCw0OS4wMTIgMTU5Ljc5OCw1MS4yMiAxNTkuNzk4LDU0LjA1OSBDMTU5Ljc5OCw2MC4zMDEgMTU1LjM3Myw2OC4wNDYgMTQ5LjkzMyw3MS4xODYgQzE0OC4zNiw3Mi4wOTQgMTQ2Ljg1LDcyLjY2NyAxNDUuNDQ1LDcyLjY2NyBMMTQ1LjQ0NSw3Mi42NjcgWiBNMTQyLjQ3Niw3MSBDMTQzLjI5LDcxLjY1MSAxNDQuMjk2LDcyLjAwMiAxNDUuNDQ1LDcyLjAwMiBDMTQ2Ljc2Nyw3Mi4wMDIgMTQ4LjE5OCw3MS41NSAxNDkuNyw3MC42ODIgQzE1NS4wMSw2Ny42MTcgMTU5LjMzMSw2MC4xNTkgMTU5LjMzMSw1NC4wNjUgQzE1OS4zMzEsNTIuMDg1IDE1OC44NjgsNTAuNDM1IDE1OC4wMDYsNDkuMjcyIEMxNTguNDE3LDUwLjMwNyAxNTguNjMsNTEuNTMyIDE1OC42Myw1Mi44OTIgQzE1OC42Myw1OS4xMzQgMTU0LjIwNSw2Ni43NjcgMTQ4Ljc2NSw2OS45MDcgQzE0Ny4xOTIsNzAuODE2IDE0NS42ODEsNzEuMjgzIDE0NC4yNzYsNzEuMjgzIEMxNDMuNjM0LDcxLjI4MyAxNDMuMDMzLDcxLjE5MiAxNDIuNDc2LDcxIEwxNDIuNDc2LDcxIFoiIGlkPSJGaWxsLTMzIiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE0OC42NDgsNjkuNzA0IEMxNTQuMDMyLDY2LjU5NiAxNTguMzk2LDU5LjA2OCAxNTguMzk2LDUyLjg5MSBDMTU4LjM5Niw1MC44MzkgMTU3LjkxMyw0OS4xOTggMTU3LjA3NCw0OC4wMyBDMTU1LjI4OSw0Ni43NzggMTUyLjY5OSw0Ni44MzYgMTQ5LjgxNiw0OC41MDEgQzE0NC40MzMsNTEuNjA5IDE0MC4wNjgsNTkuMTM3IDE0MC4wNjgsNjUuMzE0IEMxNDAuMDY4LDY3LjM2NSAxNDAuNTUyLDY5LjAwNiAxNDEuMzkxLDcwLjE3NCBDMTQzLjE3Niw3MS40MjcgMTQ1Ljc2NSw3MS4zNjkgMTQ4LjY0OCw2OS43MDQiIGlkPSJGaWxsLTM0IiBmaWxsPSIjRkFGQUZBIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE0NC4yNzYsNzEuMjc2IEwxNDQuMjc2LDcxLjI3NiBDMTQzLjEzMyw3MS4yNzYgMTQyLjExOCw3MC45NjkgMTQxLjI1Nyw3MC4zNjUgQzE0MS4yMzYsNzAuMzUxIDE0MS4yMTcsNzAuMzMyIDE0MS4yMDIsNzAuMzExIEMxNDAuMzA3LDY5LjA2NyAxMzkuODM1LDY3LjMzOSAxMzkuODM1LDY1LjMxNCBDMTM5LjgzNSw1OS4wNzMgMTQ0LjI2LDUxLjQzOSAxNDkuNyw0OC4yOTggQzE1MS4yNzMsNDcuMzkgMTUyLjc4NCw0Ni45MjkgMTU0LjE4OSw0Ni45MjkgQzE1NS4zMzIsNDYuOTI5IDE1Ni4zNDcsNDcuMjM2IDE1Ny4yMDgsNDcuODM5IEMxNTcuMjI5LDQ3Ljg1NCAxNTcuMjQ4LDQ3Ljg3MyAxNTcuMjYzLDQ3Ljg5NCBDMTU4LjE1Nyw0OS4xMzggMTU4LjYzLDUwLjg2NSAxNTguNjMsNTIuODkxIEMxNTguNjMsNTkuMTMyIDE1NC4yMDUsNjYuNzY2IDE0OC43NjUsNjkuOTA3IEMxNDcuMTkyLDcwLjgxNSAxNDUuNjgxLDcxLjI3NiAxNDQuMjc2LDcxLjI3NiBMMTQ0LjI3Niw3MS4yNzYgWiBNMTQxLjU1OCw3MC4xMDQgQzE0Mi4zMzEsNzAuNjM3IDE0My4yNDUsNzEuMDA1IDE0NC4yNzYsNzEuMDA1IEMxNDUuNTk4LDcxLjAwNSAxNDcuMDMsNzAuNDY3IDE0OC41MzIsNjkuNiBDMTUzLjg0Miw2Ni41MzQgMTU4LjE2Myw1OS4wMzMgMTU4LjE2Myw1Mi45MzkgQzE1OC4xNjMsNTEuMDMxIDE1Ny43MjksNDkuMzg1IDE1Ni45MDcsNDguMjIzIEMxNTYuMTMzLDQ3LjY5MSAxNTUuMjE5LDQ3LjQwOSAxNTQuMTg5LDQ3LjQwOSBDMTUyLjg2Nyw0Ny40MDkgMTUxLjQzNSw0Ny44NDIgMTQ5LjkzMyw0OC43MDkgQzE0NC42MjMsNTEuNzc1IDE0MC4zMDIsNTkuMjczIDE0MC4zMDIsNjUuMzY2IEMxNDAuMzAyLDY3LjI3NiAxNDAuNzM2LDY4Ljk0MiAxNDEuNTU4LDcwLjEwNCBMMTQxLjU1OCw3MC4xMDQgWiIgaWQ9IkZpbGwtMzUiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTUwLjcyLDY1LjM2MSBMMTUwLjM1Nyw2NS4wNjYgQzE1MS4xNDcsNjQuMDkyIDE1MS44NjksNjMuMDQgMTUyLjUwNSw2MS45MzggQzE1My4zMTMsNjAuNTM5IDE1My45NzgsNTkuMDY3IDE1NC40ODIsNTcuNTYzIEwxNTQuOTI1LDU3LjcxMiBDMTU0LjQxMiw1OS4yNDUgMTUzLjczMyw2MC43NDUgMTUyLjkxLDYyLjE3MiBDMTUyLjI2Miw2My4yOTUgMTUxLjUyNSw2NC4zNjggMTUwLjcyLDY1LjM2MSIgaWQ9IkZpbGwtMzYiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTE1LjkxNyw4NC41MTQgTDExNS41NTQsODQuMjIgQzExNi4zNDQsODMuMjQ1IDExNy4wNjYsODIuMTk0IDExNy43MDIsODEuMDkyIEMxMTguNTEsNzkuNjkyIDExOS4xNzUsNzguMjIgMTE5LjY3OCw3Ni43MTcgTDEyMC4xMjEsNzYuODY1IEMxMTkuNjA4LDc4LjM5OCAxMTguOTMsNzkuODk5IDExOC4xMDYsODEuMzI2IEMxMTcuNDU4LDgyLjQ0OCAxMTYuNzIyLDgzLjUyMSAxMTUuOTE3LDg0LjUxNCIgaWQ9IkZpbGwtMzciIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTE0LDEzMC40NzYgTDExNCwxMzAuMDA4IEwxMTQsNzYuMDUyIEwxMTQsNzUuNTg0IEwxMTQsNzYuMDUyIEwxMTQsMTMwLjAwOCBMMTE0LDEzMC40NzYiIGlkPSJGaWxsLTM4IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgICAgICA8ZyBpZD0iSW1wb3J0ZWQtTGF5ZXJzLUNvcHkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYyLjAwMDAwMCwgMC4wMDAwMDApIiBza2V0Y2g6dHlwZT0iTVNTaGFwZUdyb3VwIj4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTkuODIyLDM3LjQ3NCBDMTkuODM5LDM3LjMzOSAxOS43NDcsMzcuMTk0IDE5LjU1NSwzNy4wODIgQzE5LjIyOCwzNi44OTQgMTguNzI5LDM2Ljg3MiAxOC40NDYsMzcuMDM3IEwxMi40MzQsNDAuNTA4IEMxMi4zMDMsNDAuNTg0IDEyLjI0LDQwLjY4NiAxMi4yNDMsNDAuNzkzIEMxMi4yNDUsNDAuOTI1IDEyLjI0NSw0MS4yNTQgMTIuMjQ1LDQxLjM3MSBMMTIuMjQ1LDQxLjQxNCBMMTIuMjM4LDQxLjU0MiBDOC4xNDgsNDMuODg3IDUuNjQ3LDQ1LjMyMSA1LjY0Nyw0NS4zMjEgQzUuNjQ2LDQ1LjMyMSAzLjU3LDQ2LjM2NyAyLjg2LDUwLjUxMyBDMi44Niw1MC41MTMgMS45NDgsNTcuNDc0IDEuOTYyLDcwLjI1OCBDMS45NzcsODIuODI4IDIuNTY4LDg3LjMyOCAzLjEyOSw5MS42MDkgQzMuMzQ5LDkzLjI5MyA2LjEzLDkzLjczNCA2LjEzLDkzLjczNCBDNi40NjEsOTMuNzc0IDYuODI4LDkzLjcwNyA3LjIxLDkzLjQ4NiBMODIuNDgzLDQ5LjkzNSBDODQuMjkxLDQ4Ljg2NiA4NS4xNSw0Ni4yMTYgODUuNTM5LDQzLjY1MSBDODYuNzUyLDM1LjY2MSA4Ny4yMTQsMTAuNjczIDg1LjI2NCwzLjc3MyBDODUuMDY4LDMuMDggODQuNzU0LDIuNjkgODQuMzk2LDIuNDkxIEw4Mi4zMSwxLjcwMSBDODEuNTgzLDEuNzI5IDgwLjg5NCwyLjE2OCA4MC43NzYsMi4yMzYgQzgwLjYzNiwyLjMxNyA0MS44MDcsMjQuNTg1IDIwLjAzMiwzNy4wNzIgTDE5LjgyMiwzNy40NzQiIGlkPSJGaWxsLTEiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNODIuMzExLDEuNzAxIEw4NC4zOTYsMi40OTEgQzg0Ljc1NCwyLjY5IDg1LjA2OCwzLjA4IDg1LjI2NCwzLjc3MyBDODcuMjEzLDEwLjY3MyA4Ni43NTEsMzUuNjYgODUuNTM5LDQzLjY1MSBDODUuMTQ5LDQ2LjIxNiA4NC4yOSw0OC44NjYgODIuNDgzLDQ5LjkzNSBMNy4yMSw5My40ODYgQzYuODk3LDkzLjY2NyA2LjU5NSw5My43NDQgNi4zMTQsOTMuNzQ0IEw2LjEzMSw5My43MzMgQzYuMTMxLDkzLjczNCAzLjM0OSw5My4yOTMgMy4xMjgsOTEuNjA5IEMyLjU2OCw4Ny4zMjcgMS45NzcsODIuODI4IDEuOTYzLDcwLjI1OCBDMS45NDgsNTcuNDc0IDIuODYsNTAuNTEzIDIuODYsNTAuNTEzIEMzLjU3LDQ2LjM2NyA1LjY0Nyw0NS4zMjEgNS42NDcsNDUuMzIxIEM1LjY0Nyw0NS4zMjEgOC4xNDgsNDMuODg3IDEyLjIzOCw0MS41NDIgTDEyLjI0NSw0MS40MTQgTDEyLjI0NSw0MS4zNzEgQzEyLjI0NSw0MS4yNTQgMTIuMjQ1LDQwLjkyNSAxMi4yNDMsNDAuNzkzIEMxMi4yNCw0MC42ODYgMTIuMzAyLDQwLjU4MyAxMi40MzQsNDAuNTA4IEwxOC40NDYsMzcuMDM2IEMxOC41NzQsMzYuOTYyIDE4Ljc0NiwzNi45MjYgMTguOTI3LDM2LjkyNiBDMTkuMTQ1LDM2LjkyNiAxOS4zNzYsMzYuOTc5IDE5LjU1NCwzNy4wODIgQzE5Ljc0NywzNy4xOTQgMTkuODM5LDM3LjM0IDE5LjgyMiwzNy40NzQgTDIwLjAzMywzNy4wNzIgQzQxLjgwNiwyNC41ODUgODAuNjM2LDIuMzE4IDgwLjc3NywyLjIzNiBDODAuODk0LDIuMTY4IDgxLjU4MywxLjcyOSA4Mi4zMTEsMS43MDEgTTgyLjMxMSwwLjcwNCBMODIuMjcyLDAuNzA1IEM4MS42NTQsMC43MjggODAuOTg5LDAuOTQ5IDgwLjI5OCwxLjM2MSBMODAuMjc3LDEuMzczIEM4MC4xMjksMS40NTggNTkuNzY4LDEzLjEzNSAxOS43NTgsMzYuMDc5IEMxOS41LDM1Ljk4MSAxOS4yMTQsMzUuOTI5IDE4LjkyNywzNS45MjkgQzE4LjU2MiwzNS45MjkgMTguMjIzLDM2LjAxMyAxNy45NDcsMzYuMTczIEwxMS45MzUsMzkuNjQ0IEMxMS40OTMsMzkuODk5IDExLjIzNiw0MC4zMzQgMTEuMjQ2LDQwLjgxIEwxMS4yNDcsNDAuOTYgTDUuMTY3LDQ0LjQ0NyBDNC43OTQsNDQuNjQ2IDIuNjI1LDQ1Ljk3OCAxLjg3Nyw1MC4zNDUgTDEuODcxLDUwLjM4NCBDMS44NjIsNTAuNDU0IDAuOTUxLDU3LjU1NyAwLjk2NSw3MC4yNTkgQzAuOTc5LDgyLjg3OSAxLjU2OCw4Ny4zNzUgMi4xMzcsOTEuNzI0IEwyLjEzOSw5MS43MzkgQzIuNDQ3LDk0LjA5NCA1LjYxNCw5NC42NjIgNS45NzUsOTQuNzE5IEw2LjAwOSw5NC43MjMgQzYuMTEsOTQuNzM2IDYuMjEzLDk0Ljc0MiA2LjMxNCw5NC43NDIgQzYuNzksOTQuNzQyIDcuMjYsOTQuNjEgNy43MSw5NC4zNSBMODIuOTgzLDUwLjc5OCBDODQuNzk0LDQ5LjcyNyA4NS45ODIsNDcuMzc1IDg2LjUyNSw0My44MDEgQzg3LjcxMSwzNS45ODcgODguMjU5LDEwLjcwNSA4Ni4yMjQsMy41MDIgQzg1Ljk3MSwyLjYwOSA4NS41MiwxLjk3NSA4NC44ODEsMS42MiBMODQuNzQ5LDEuNTU4IEw4Mi42NjQsMC43NjkgQzgyLjU1MSwwLjcyNSA4Mi40MzEsMC43MDQgODIuMzExLDAuNzA0IiBpZD0iRmlsbC0yIiBmaWxsPSIjNDU1QTY0Ij48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTY2LjI2NywxMS41NjUgTDY3Ljc2MiwxMS45OTkgTDExLjQyMyw0NC4zMjUiIGlkPSJGaWxsLTMiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTIuMjAyLDkwLjU0NSBDMTIuMDI5LDkwLjU0NSAxMS44NjIsOTAuNDU1IDExLjc2OSw5MC4yOTUgQzExLjYzMiw5MC4wNTcgMTEuNzEzLDg5Ljc1MiAxMS45NTIsODkuNjE0IEwzMC4zODksNzguOTY5IEMzMC42MjgsNzguODMxIDMwLjkzMyw3OC45MTMgMzEuMDcxLDc5LjE1MiBDMzEuMjA4LDc5LjM5IDMxLjEyNyw3OS42OTYgMzAuODg4LDc5LjgzMyBMMTIuNDUxLDkwLjQ3OCBMMTIuMjAyLDkwLjU0NSIgaWQ9IkZpbGwtNCIgZmlsbD0iIzYwN0Q4QiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMy43NjQsNDIuNjU0IEwxMy42NTYsNDIuNTkyIEwxMy43MDIsNDIuNDIxIEwxOC44MzcsMzkuNDU3IEwxOS4wMDcsMzkuNTAyIEwxOC45NjIsMzkuNjczIEwxMy44MjcsNDIuNjM3IEwxMy43NjQsNDIuNjU0IiBpZD0iRmlsbC01IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTguNTIsOTAuMzc1IEw4LjUyLDQ2LjQyMSBMOC41ODMsNDYuMzg1IEw3NS44NCw3LjU1NCBMNzUuODQsNTEuNTA4IEw3NS43NzgsNTEuNTQ0IEw4LjUyLDkwLjM3NSBMOC41Miw5MC4zNzUgWiBNOC43Nyw0Ni41NjQgTDguNzcsODkuOTQ0IEw3NS41OTEsNTEuMzY1IEw3NS41OTEsNy45ODUgTDguNzcsNDYuNTY0IEw4Ljc3LDQ2LjU2NCBaIiBpZD0iRmlsbC02IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTI0Ljk4Niw4My4xODIgQzI0Ljc1Niw4My4zMzEgMjQuMzc0LDgzLjU2NiAyNC4xMzcsODMuNzA1IEwxMi42MzIsOTAuNDA2IEMxMi4zOTUsOTAuNTQ1IDEyLjQyNiw5MC42NTggMTIuNyw5MC42NTggTDEzLjI2NSw5MC42NTggQzEzLjU0LDkwLjY1OCAxMy45NTgsOTAuNTQ1IDE0LjE5NSw5MC40MDYgTDI1LjcsODMuNzA1IEMyNS45MzcsODMuNTY2IDI2LjEyOCw4My40NTIgMjYuMTI1LDgzLjQ0OSBDMjYuMTIyLDgzLjQ0NyAyNi4xMTksODMuMjIgMjYuMTE5LDgyLjk0NiBDMjYuMTE5LDgyLjY3MiAyNS45MzEsODIuNTY5IDI1LjcwMSw4Mi43MTkgTDI0Ljk4Niw4My4xODIiIGlkPSJGaWxsLTciIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTMuMjY2LDkwLjc4MiBMMTIuNyw5MC43ODIgQzEyLjUsOTAuNzgyIDEyLjM4NCw5MC43MjYgMTIuMzU0LDkwLjYxNiBDMTIuMzI0LDkwLjUwNiAxMi4zOTcsOTAuMzk5IDEyLjU2OSw5MC4yOTkgTDI0LjA3NCw4My41OTcgQzI0LjMxLDgzLjQ1OSAyNC42ODksODMuMjI2IDI0LjkxOCw4My4wNzggTDI1LjYzMyw4Mi42MTQgQzI1LjcyMyw4Mi41NTUgMjUuODEzLDgyLjUyNSAyNS44OTksODIuNTI1IEMyNi4wNzEsODIuNTI1IDI2LjI0NCw4Mi42NTUgMjYuMjQ0LDgyLjk0NiBDMjYuMjQ0LDgzLjE2IDI2LjI0NSw4My4zMDkgMjYuMjQ3LDgzLjM4MyBMMjYuMjUzLDgzLjM4NyBMMjYuMjQ5LDgzLjQ1NiBDMjYuMjQ2LDgzLjUzMSAyNi4yNDYsODMuNTMxIDI1Ljc2Myw4My44MTIgTDE0LjI1OCw5MC41MTQgQzE0LDkwLjY2NSAxMy41NjQsOTAuNzgyIDEzLjI2Niw5MC43ODIgTDEzLjI2Niw5MC43ODIgWiBNMTIuNjY2LDkwLjUzMiBMMTIuNyw5MC41MzMgTDEzLjI2Niw5MC41MzMgQzEzLjUxOCw5MC41MzMgMTMuOTE1LDkwLjQyNSAxNC4xMzIsOTAuMjk5IEwyNS42MzcsODMuNTk3IEMyNS44MDUsODMuNDk5IDI1LjkzMSw4My40MjQgMjUuOTk4LDgzLjM4MyBDMjUuOTk0LDgzLjI5OSAyNS45OTQsODMuMTY1IDI1Ljk5NCw4Mi45NDYgTDI1Ljg5OSw4Mi43NzUgTDI1Ljc2OCw4Mi44MjQgTDI1LjA1NCw4My4yODcgQzI0LjgyMiw4My40MzcgMjQuNDM4LDgzLjY3MyAyNC4yLDgzLjgxMiBMMTIuNjk1LDkwLjUxNCBMMTIuNjY2LDkwLjUzMiBMMTIuNjY2LDkwLjUzMiBaIiBpZD0iRmlsbC04IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTEzLjI2Niw4OS44NzEgTDEyLjcsODkuODcxIEMxMi41LDg5Ljg3MSAxMi4zODQsODkuODE1IDEyLjM1NCw4OS43MDUgQzEyLjMyNCw4OS41OTUgMTIuMzk3LDg5LjQ4OCAxMi41NjksODkuMzg4IEwyNC4wNzQsODIuNjg2IEMyNC4zMzIsODIuNTM1IDI0Ljc2OCw4Mi40MTggMjUuMDY3LDgyLjQxOCBMMjUuNjMyLDgyLjQxOCBDMjUuODMyLDgyLjQxOCAyNS45NDgsODIuNDc0IDI1Ljk3OCw4Mi41ODQgQzI2LjAwOCw4Mi42OTQgMjUuOTM1LDgyLjgwMSAyNS43NjMsODIuOTAxIEwxNC4yNTgsODkuNjAzIEMxNCw4OS43NTQgMTMuNTY0LDg5Ljg3MSAxMy4yNjYsODkuODcxIEwxMy4yNjYsODkuODcxIFogTTEyLjY2Niw4OS42MjEgTDEyLjcsODkuNjIyIEwxMy4yNjYsODkuNjIyIEMxMy41MTgsODkuNjIyIDEzLjkxNSw4OS41MTUgMTQuMTMyLDg5LjM4OCBMMjUuNjM3LDgyLjY4NiBMMjUuNjY3LDgyLjY2OCBMMjUuNjMyLDgyLjY2NyBMMjUuMDY3LDgyLjY2NyBDMjQuODE1LDgyLjY2NyAyNC40MTgsODIuNzc1IDI0LjIsODIuOTAxIEwxMi42OTUsODkuNjAzIEwxMi42NjYsODkuNjIxIEwxMi42NjYsODkuNjIxIFoiIGlkPSJGaWxsLTkiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTIuMzcsOTAuODAxIEwxMi4zNyw4OS41NTQgTDEyLjM3LDkwLjgwMSIgaWQ9IkZpbGwtMTAiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNi4xMyw5My45MDEgQzUuMzc5LDkzLjgwOCA0LjgxNiw5My4xNjQgNC42OTEsOTIuNTI1IEMzLjg2LDg4LjI4NyAzLjU0LDgzLjc0MyAzLjUyNiw3MS4xNzMgQzMuNTExLDU4LjM4OSA0LjQyMyw1MS40MjggNC40MjMsNTEuNDI4IEM1LjEzNCw0Ny4yODIgNy4yMSw0Ni4yMzYgNy4yMSw0Ni4yMzYgQzcuMjEsNDYuMjM2IDgxLjY2NywzLjI1IDgyLjA2OSwzLjAxNyBDODIuMjkyLDIuODg4IDg0LjU1NiwxLjQzMyA4NS4yNjQsMy45NCBDODcuMjE0LDEwLjg0IDg2Ljc1MiwzNS44MjcgODUuNTM5LDQzLjgxOCBDODUuMTUsNDYuMzgzIDg0LjI5MSw0OS4wMzMgODIuNDgzLDUwLjEwMSBMNy4yMSw5My42NTMgQzYuODI4LDkzLjg3NCA2LjQ2MSw5My45NDEgNi4xMyw5My45MDEgQzYuMTMsOTMuOTAxIDMuMzQ5LDkzLjQ2IDMuMTI5LDkxLjc3NiBDMi41NjgsODcuNDk1IDEuOTc3LDgyLjk5NSAxLjk2Miw3MC40MjUgQzEuOTQ4LDU3LjY0MSAyLjg2LDUwLjY4IDIuODYsNTAuNjggQzMuNTcsNDYuNTM0IDUuNjQ3LDQ1LjQ4OSA1LjY0Nyw0NS40ODkgQzUuNjQ2LDQ1LjQ4OSA4LjA2NSw0NC4wOTIgMTIuMjQ1LDQxLjY3OSBMMTMuMTE2LDQxLjU2IEwxOS43MTUsMzcuNzMgTDE5Ljc2MSwzNy4yNjkgTDYuMTMsOTMuOTAxIiBpZD0iRmlsbC0xMSIgZmlsbD0iI0ZBRkFGQSI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik02LjMxNyw5NC4xNjEgTDYuMTAyLDk0LjE0OCBMNi4xMDEsOTQuMTQ4IEw1Ljg1Nyw5NC4xMDEgQzUuMTM4LDkzLjk0NSAzLjA4NSw5My4zNjUgMi44ODEsOTEuODA5IEMyLjMxMyw4Ny40NjkgMS43MjcsODIuOTk2IDEuNzEzLDcwLjQyNSBDMS42OTksNTcuNzcxIDIuNjA0LDUwLjcxOCAyLjYxMyw1MC42NDggQzMuMzM4LDQ2LjQxNyA1LjQ0NSw0NS4zMSA1LjUzNSw0NS4yNjYgTDEyLjE2Myw0MS40MzkgTDEzLjAzMyw0MS4zMiBMMTkuNDc5LDM3LjU3OCBMMTkuNTEzLDM3LjI0NCBDMTkuNTI2LDM3LjEwNyAxOS42NDcsMzcuMDA4IDE5Ljc4NiwzNy4wMjEgQzE5LjkyMiwzNy4wMzQgMjAuMDIzLDM3LjE1NiAyMC4wMDksMzcuMjkzIEwxOS45NSwzNy44ODIgTDEzLjE5OCw0MS44MDEgTDEyLjMyOCw0MS45MTkgTDUuNzcyLDQ1LjcwNCBDNS43NDEsNDUuNzIgMy43ODIsNDYuNzcyIDMuMTA2LDUwLjcyMiBDMy4wOTksNTAuNzgyIDIuMTk4LDU3LjgwOCAyLjIxMiw3MC40MjQgQzIuMjI2LDgyLjk2MyAyLjgwOSw4Ny40MiAzLjM3Myw5MS43MjkgQzMuNDY0LDkyLjQyIDQuMDYyLDkyLjg4MyA0LjY4Miw5My4xODEgQzQuNTY2LDkyLjk4NCA0LjQ4Niw5Mi43NzYgNC40NDYsOTIuNTcyIEMzLjY2NSw4OC41ODggMy4yOTEsODQuMzcgMy4yNzYsNzEuMTczIEMzLjI2Miw1OC41MiA0LjE2Nyw1MS40NjYgNC4xNzYsNTEuMzk2IEM0LjkwMSw0Ny4xNjUgNy4wMDgsNDYuMDU5IDcuMDk4LDQ2LjAxNCBDNy4wOTQsNDYuMDE1IDgxLjU0MiwzLjAzNCA4MS45NDQsMi44MDIgTDgxLjk3MiwyLjc4NSBDODIuODc2LDIuMjQ3IDgzLjY5MiwyLjA5NyA4NC4zMzIsMi4zNTIgQzg0Ljg4NywyLjU3MyA4NS4yODEsMy4wODUgODUuNTA0LDMuODcyIEM4Ny41MTgsMTEgODYuOTY0LDM2LjA5MSA4NS43ODUsNDMuODU1IEM4NS4yNzgsNDcuMTk2IDg0LjIxLDQ5LjM3IDgyLjYxLDUwLjMxNyBMNy4zMzUsOTMuODY5IEM2Ljk5OSw5NC4wNjMgNi42NTgsOTQuMTYxIDYuMzE3LDk0LjE2MSBMNi4zMTcsOTQuMTYxIFogTTYuMTcsOTMuNjU0IEM2LjQ2Myw5My42OSA2Ljc3NCw5My42MTcgNy4wODUsOTMuNDM3IEw4Mi4zNTgsNDkuODg2IEM4NC4xODEsNDguODA4IDg0Ljk2LDQ1Ljk3MSA4NS4yOTIsNDMuNzggQzg2LjQ2NiwzNi4wNDkgODcuMDIzLDExLjA4NSA4NS4wMjQsNC4wMDggQzg0Ljg0NiwzLjM3NyA4NC41NTEsMi45NzYgODQuMTQ4LDIuODE2IEM4My42NjQsMi42MjMgODIuOTgyLDIuNzY0IDgyLjIyNywzLjIxMyBMODIuMTkzLDMuMjM0IEM4MS43OTEsMy40NjYgNy4zMzUsNDYuNDUyIDcuMzM1LDQ2LjQ1MiBDNy4zMDQsNDYuNDY5IDUuMzQ2LDQ3LjUyMSA0LjY2OSw1MS40NzEgQzQuNjYyLDUxLjUzIDMuNzYxLDU4LjU1NiAzLjc3NSw3MS4xNzMgQzMuNzksODQuMzI4IDQuMTYxLDg4LjUyNCA0LjkzNiw5Mi40NzYgQzUuMDI2LDkyLjkzNyA1LjQxMiw5My40NTkgNS45NzMsOTMuNjE1IEM2LjA4Nyw5My42NCA2LjE1OCw5My42NTIgNi4xNjksOTMuNjU0IEw2LjE3LDkzLjY1NCBMNi4xNyw5My42NTQgWiIgaWQ9IkZpbGwtMTIiIGZpbGw9IiM0NTVBNjQiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNy4zMTcsNjguOTgyIEM3LjgwNiw2OC43MDEgOC4yMDIsNjguOTI2IDguMjAyLDY5LjQ4NyBDOC4yMDIsNzAuMDQ3IDcuODA2LDcwLjczIDcuMzE3LDcxLjAxMiBDNi44MjksNzEuMjk0IDYuNDMzLDcxLjA2OSA2LjQzMyw3MC41MDggQzYuNDMzLDY5Ljk0OCA2LjgyOSw2OS4yNjUgNy4zMTcsNjguOTgyIiBpZD0iRmlsbC0xMyIgZmlsbD0iI0ZGRkZGRiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik02LjkyLDcxLjEzMyBDNi42MzEsNzEuMTMzIDYuNDMzLDcwLjkwNSA2LjQzMyw3MC41MDggQzYuNDMzLDY5Ljk0OCA2LjgyOSw2OS4yNjUgNy4zMTcsNjguOTgyIEM3LjQ2LDY4LjkgNy41OTUsNjguODYxIDcuNzE0LDY4Ljg2MSBDOC4wMDMsNjguODYxIDguMjAyLDY5LjA5IDguMjAyLDY5LjQ4NyBDOC4yMDIsNzAuMDQ3IDcuODA2LDcwLjczIDcuMzE3LDcxLjAxMiBDNy4xNzQsNzEuMDk0IDcuMDM5LDcxLjEzMyA2LjkyLDcxLjEzMyBNNy43MTQsNjguNjc0IEM3LjU1Nyw2OC42NzQgNy4zOTIsNjguNzIzIDcuMjI0LDY4LjgyMSBDNi42NzYsNjkuMTM4IDYuMjQ2LDY5Ljg3OSA2LjI0Niw3MC41MDggQzYuMjQ2LDcwLjk5NCA2LjUxNyw3MS4zMiA2LjkyLDcxLjMyIEM3LjA3OCw3MS4zMiA3LjI0Myw3MS4yNzEgNy40MTEsNzEuMTc0IEM3Ljk1OSw3MC44NTcgOC4zODksNzAuMTE3IDguMzg5LDY5LjQ4NyBDOC4zODksNjkuMDAxIDguMTE3LDY4LjY3NCA3LjcxNCw2OC42NzQiIGlkPSJGaWxsLTE0IiBmaWxsPSIjODA5N0EyIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTYuOTIsNzAuOTQ3IEM2LjY0OSw3MC45NDcgNi42MjEsNzAuNjQgNi42MjEsNzAuNTA4IEM2LjYyMSw3MC4wMTcgNi45ODIsNjkuMzkyIDcuNDExLDY5LjE0NSBDNy41MjEsNjkuMDgyIDcuNjI1LDY5LjA0OSA3LjcxNCw2OS4wNDkgQzcuOTg2LDY5LjA0OSA4LjAxNSw2OS4zNTUgOC4wMTUsNjkuNDg3IEM4LjAxNSw2OS45NzggNy42NTIsNzAuNjAzIDcuMjI0LDcwLjg1MSBDNy4xMTUsNzAuOTE0IDcuMDEsNzAuOTQ3IDYuOTIsNzAuOTQ3IE03LjcxNCw2OC44NjEgQzcuNTk1LDY4Ljg2MSA3LjQ2LDY4LjkgNy4zMTcsNjguOTgyIEM2LjgyOSw2OS4yNjUgNi40MzMsNjkuOTQ4IDYuNDMzLDcwLjUwOCBDNi40MzMsNzAuOTA1IDYuNjMxLDcxLjEzMyA2LjkyLDcxLjEzMyBDNy4wMzksNzEuMTMzIDcuMTc0LDcxLjA5NCA3LjMxNyw3MS4wMTIgQzcuODA2LDcwLjczIDguMjAyLDcwLjA0NyA4LjIwMiw2OS40ODcgQzguMjAyLDY5LjA5IDguMDAzLDY4Ljg2MSA3LjcxNCw2OC44NjEiIGlkPSJGaWxsLTE1IiBmaWxsPSIjODA5N0EyIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTcuNDQ0LDg1LjM1IEM3LjcwOCw4NS4xOTggNy45MjEsODUuMzE5IDcuOTIxLDg1LjYyMiBDNy45MjEsODUuOTI1IDcuNzA4LDg2LjI5MiA3LjQ0NCw4Ni40NDQgQzcuMTgxLDg2LjU5NyA2Ljk2Nyw4Ni40NzUgNi45NjcsODYuMTczIEM2Ljk2Nyw4NS44NzEgNy4xODEsODUuNTAyIDcuNDQ0LDg1LjM1IiBpZD0iRmlsbC0xNiIgZmlsbD0iI0ZGRkZGRiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik03LjIzLDg2LjUxIEM3LjA3NCw4Ni41MSA2Ljk2Nyw4Ni4zODcgNi45NjcsODYuMTczIEM2Ljk2Nyw4NS44NzEgNy4xODEsODUuNTAyIDcuNDQ0LDg1LjM1IEM3LjUyMSw4NS4zMDUgNy41OTQsODUuMjg0IDcuNjU4LDg1LjI4NCBDNy44MTQsODUuMjg0IDcuOTIxLDg1LjQwOCA3LjkyMSw4NS42MjIgQzcuOTIxLDg1LjkyNSA3LjcwOCw4Ni4yOTIgNy40NDQsODYuNDQ0IEM3LjM2Nyw4Ni40ODkgNy4yOTQsODYuNTEgNy4yMyw4Ni41MSBNNy42NTgsODUuMDk4IEM3LjU1OCw4NS4wOTggNy40NTUsODUuMTI3IDcuMzUxLDg1LjE4OCBDNy4wMzEsODUuMzczIDYuNzgxLDg1LjgwNiA2Ljc4MSw4Ni4xNzMgQzYuNzgxLDg2LjQ4MiA2Ljk2Niw4Ni42OTcgNy4yMyw4Ni42OTcgQzcuMzMsODYuNjk3IDcuNDMzLDg2LjY2NiA3LjUzOCw4Ni42MDcgQzcuODU4LDg2LjQyMiA4LjEwOCw4NS45ODkgOC4xMDgsODUuNjIyIEM4LjEwOCw4NS4zMTMgNy45MjMsODUuMDk4IDcuNjU4LDg1LjA5OCIgaWQ9IkZpbGwtMTciIGZpbGw9IiM4MDk3QTIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNy4yMyw4Ni4zMjIgTDcuMTU0LDg2LjE3MyBDNy4xNTQsODUuOTM4IDcuMzMzLDg1LjYyOSA3LjUzOCw4NS41MTIgTDcuNjU4LDg1LjQ3MSBMNy43MzQsODUuNjIyIEM3LjczNCw4NS44NTYgNy41NTUsODYuMTY0IDcuMzUxLDg2LjI4MiBMNy4yMyw4Ni4zMjIgTTcuNjU4LDg1LjI4NCBDNy41OTQsODUuMjg0IDcuNTIxLDg1LjMwNSA3LjQ0NCw4NS4zNSBDNy4xODEsODUuNTAyIDYuOTY3LDg1Ljg3MSA2Ljk2Nyw4Ni4xNzMgQzYuOTY3LDg2LjM4NyA3LjA3NCw4Ni41MSA3LjIzLDg2LjUxIEM3LjI5NCw4Ni41MSA3LjM2Nyw4Ni40ODkgNy40NDQsODYuNDQ0IEM3LjcwOCw4Ni4yOTIgNy45MjEsODUuOTI1IDcuOTIxLDg1LjYyMiBDNy45MjEsODUuNDA4IDcuODE0LDg1LjI4NCA3LjY1OCw4NS4yODQiIGlkPSJGaWxsLTE4IiBmaWxsPSIjODA5N0EyIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTc3LjI3OCw3Ljc2OSBMNzcuMjc4LDUxLjQzNiBMMTAuMjA4LDkwLjE2IEwxMC4yMDgsNDYuNDkzIEw3Ny4yNzgsNy43NjkiIGlkPSJGaWxsLTE5IiBmaWxsPSIjNDU1QTY0Ij48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTEwLjA4Myw5MC4zNzUgTDEwLjA4Myw0Ni40MjEgTDEwLjE0Niw0Ni4zODUgTDc3LjQwMyw3LjU1NCBMNzcuNDAzLDUxLjUwOCBMNzcuMzQxLDUxLjU0NCBMMTAuMDgzLDkwLjM3NSBMMTAuMDgzLDkwLjM3NSBaIE0xMC4zMzMsNDYuNTY0IEwxMC4zMzMsODkuOTQ0IEw3Ny4xNTQsNTEuMzY1IEw3Ny4xNTQsNy45ODUgTDEwLjMzMyw0Ni41NjQgTDEwLjMzMyw0Ni41NjQgWiIgaWQ9IkZpbGwtMjAiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMjUuNzM3LDg4LjY0NyBMMTE4LjA5OCw5MS45ODEgTDExOC4wOTgsODQgTDEwNi42MzksODguNzEzIEwxMDYuNjM5LDk2Ljk4MiBMOTksMTAwLjMxNSBMMTEyLjM2OSwxMDMuOTYxIEwxMjUuNzM3LDg4LjY0NyIgaWQ9IkltcG9ydGVkLUxheWVycy1Db3B5LTIiIGZpbGw9IiM0NTVBNjQiIHNrZXRjaDp0eXBlPSJNU1NoYXBlR3JvdXAiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+");
},M.exports=t},{"./util.js":22}],17:[function(e,M,i){function t(e){this.kFilter=e,this.currentAccelMeasurement=new A,this.currentGyroMeasurement=new A,this.previousGyroMeasurement=new A,r.isIOS()?this.filterQ=new s.Quaternion(-1,0,0,1):this.filterQ=new s.Quaternion(1,0,0,1),this.previousFilterQ=new s.Quaternion,this.previousFilterQ.copy(this.filterQ),this.accelQ=new s.Quaternion,this.isOrientationInitialized=!1,this.estimatedGravity=new s.Vector3,this.measuredGravity=new s.Vector3,this.gyroIntegralQ=new s.Quaternion}var A=e("./sensor-sample.js"),s=e("../math-util.js"),r=e("../util.js"),N=!1;t.prototype.addAccelMeasurement=function(e,M){this.currentAccelMeasurement.set(e,M)},t.prototype.addGyroMeasurement=function(e,M){this.currentGyroMeasurement.set(e,M);var i=M-this.previousGyroMeasurement.timestampS;r.isTimestampDeltaValid(i)&&this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},t.prototype.run_=function(){if(!this.isOrientationInitialized)return this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),void(this.isOrientationInitialized=!0);var e=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,M=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,e);this.gyroIntegralQ.multiply(M),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(M);var i=new s.Quaternion;i.copy(this.filterQ),i.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(i),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var t=new s.Quaternion;t.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),t.inverse(),N&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",s.radToDeg*r.getQuaternionAngle(t),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var A=new s.Quaternion;A.copy(this.filterQ),A.multiply(t),this.filterQ.slerp(A,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},t.prototype.getOrientation=function(){return this.filterQ},t.prototype.accelToQuaternion_=function(e){var M=new s.Vector3;M.copy(e),M.normalize();var i=new s.Quaternion;return i.setFromUnitVectors(new s.Vector3(0,0,-1),M),i.inverse(),i},t.prototype.gyroToQuaternionDelta_=function(e,M){var i=new s.Quaternion,t=new s.Vector3;return t.copy(e),t.normalize(),i.setFromAxisAngle(t,e.length()*M),i},M.exports=t},{"../math-util.js":14,"../util.js":22,"./sensor-sample.js":20}],18:[function(e,M,i){function t(){this.deviceId="webvr-polyfill:fused",this.deviceName="VR Position Device (webvr-polyfill:fused)",this.accelerometer=new N.Vector3,this.gyroscope=new N.Vector3,window.addEventListener("devicemotion",this.onDeviceMotionChange_.bind(this)),window.addEventListener("orientationchange",this.onScreenOrientationChange_.bind(this)),this.filter=new A(WebVRConfig.K_FILTER),this.posePredictor=new s(WebVRConfig.PREDICTION_TIME_S),this.touchPanner=new r,this.filterToWorldQ=new N.Quaternion,D.isIOS()?this.filterToWorldQ.setFromAxisAngle(new N.Vector3(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new N.Vector3(1,0,0),-Math.PI/2),this.inverseWorldToScreenQ=new N.Quaternion,this.worldToScreenQ=new N.Quaternion,this.originalPoseAdjustQ=new N.Quaternion,this.originalPoseAdjustQ.setFromAxisAngle(new N.Vector3(0,0,1),-window.orientation*Math.PI/180),this.setScreenTransform_(),D.isLandscapeMode()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ),this.resetQ=new N.Quaternion,this.isFirefoxAndroid=D.isFirefoxAndroid(),this.isIOS=D.isIOS(),this.orientationOut_=new Float32Array(4)}var A=e("./complementary-filter.js"),s=e("./pose-predictor.js"),r=e("../touch-panner.js"),N=e("../math-util.js"),D=e("../util.js");t.prototype.getPosition=function(){return null},t.prototype.getOrientation=function(){var e=this.filter.getOrientation();this.predictedQ=this.posePredictor.getPrediction(e,this.gyroscope,this.previousTimestampS);var M=new N.Quaternion;return M.copy(this.filterToWorldQ),M.multiply(this.resetQ),WebVRConfig.TOUCH_PANNER_DISABLED||M.multiply(this.touchPanner.getOrientation()),M.multiply(this.predictedQ),M.multiply(this.worldToScreenQ),WebVRConfig.YAW_ONLY&&(M.x=0,M.z=0,M.normalize()),this.orientationOut_[0]=M.x,this.orientationOut_[1]=M.y,this.orientationOut_[2]=M.z,this.orientationOut_[3]=M.w,this.orientationOut_},t.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation()),this.resetQ.x=0,this.resetQ.y=0,this.resetQ.z*=-1,this.resetQ.normalize(),D.isLandscapeMode()&&this.resetQ.multiply(this.inverseWorldToScreenQ),this.resetQ.multiply(this.originalPoseAdjustQ),WebVRConfig.TOUCH_PANNER_DISABLED||this.touchPanner.resetSensor()},t.prototype.onDeviceMotionChange_=function(e){var M=e.accelerationIncludingGravity,i=e.rotationRate,t=e.timeStamp/1e3;this.isFirefoxAndroid&&(t/=1e3);var A=t-this.previousTimestampS;return A<=D.MIN_TIMESTEP||A>D.MAX_TIMESTEP?(console.warn("Invalid timestamps detected. Time step between successive gyroscope sensor samples is very small or not monotonic"),void(this.previousTimestampS=t)):(this.accelerometer.set(-M.x,-M.y,-M.z),this.gyroscope.set(i.alpha,i.beta,i.gamma),(this.isIOS||this.isFirefoxAndroid)&&this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addAccelMeasurement(this.accelerometer,t),this.filter.addGyroMeasurement(this.gyroscope,t),void(this.previousTimestampS=t))},t.prototype.onScreenOrientationChange_=function(e){this.setScreenTransform_()},t.prototype.setScreenTransform_=function(){switch(this.worldToScreenQ.set(0,0,0,1),window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new N.Vector3(0,0,1),-Math.PI/2);break;case-90:this.worldToScreenQ.setFromAxisAngle(new N.Vector3(0,0,1),Math.PI/2);break;case 180:}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},M.exports=t},{"../math-util.js":14,"../touch-panner.js":21,"../util.js":22,"./complementary-filter.js":17,"./pose-predictor.js":19}],19:[function(e,M,i){function t(e){this.predictionTimeS=e,this.previousQ=new A.Quaternion,this.previousTimestampS=null,this.deltaQ=new A.Quaternion,this.outQ=new A.Quaternion}var A=e("../math-util.js"),s=!1;t.prototype.getPrediction=function(e,M,i){if(!this.previousTimestampS)return this.previousQ.copy(e),this.previousTimestampS=i,e;var t=new A.Vector3;t.copy(M),t.normalize();var r=M.length();if(r<20*A.degToRad)return s&&console.log("Moving slowly, at %s deg/s: no prediction",(A.radToDeg*r).toFixed(1)),this.outQ.copy(e),this.previousQ.copy(e),this.outQ;var N=(i-this.previousTimestampS,r*this.predictionTimeS);return this.deltaQ.setFromAxisAngle(t,N),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(e),this.previousTimestampS=i,this.outQ},M.exports=t},{"../math-util.js":14}],20:[function(e,M,i){function t(e,M){this.set(e,M)}t.prototype.set=function(e,M){this.sample=e,this.timestampS=M},t.prototype.copy=function(e){this.set(e.sample,e.timestampS)},M.exports=t},{}],21:[function(e,M,i){function t(){window.addEventListener("touchstart",this.onTouchStart_.bind(this)),window.addEventListener("touchmove",this.onTouchMove_.bind(this)),window.addEventListener("touchend",this.onTouchEnd_.bind(this)),this.isTouching=!1,this.rotateStart=new A.Vector2,this.rotateEnd=new A.Vector2,this.rotateDelta=new A.Vector2,this.theta=0,this.orientation=new A.Quaternion}var A=e("./math-util.js"),s=e("./util.js"),r=.5;t.prototype.getOrientation=function(){return this.orientation.setFromEulerXYZ(0,0,this.theta),this.orientation},t.prototype.resetSensor=function(){this.theta=0},t.prototype.onTouchStart_=function(e){1==e.touches.length&&(this.rotateStart.set(e.touches[0].pageX,e.touches[0].pageY),this.isTouching=!0)},t.prototype.onTouchMove_=function(e){if(this.isTouching){this.rotateEnd.set(e.touches[0].pageX,e.touches[0].pageY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateStart.copy(this.rotateEnd),s.isIOS()&&(this.rotateDelta.x*=-1);var M=document.body;this.theta+=2*Math.PI*this.rotateDelta.x/M.clientWidth*r}},t.prototype.onTouchEnd_=function(e){this.isTouching=!1},M.exports=t},{"./math-util.js":14,"./util.js":22}],22:[function(e,M,i){var t=e("object-assign"),A=window.Util||{};A.MIN_TIMESTEP=.001,A.MAX_TIMESTEP=1,A.base64=function(e,M){return"data:"+e+";base64,"+M},A.clamp=function(e,M,i){return Math.min(Math.max(M,e),i)},A.lerp=function(e,M,i){return e+(M-e)*i},A.isIOS=function(){var e=/iPad|iPhone|iPod/.test(navigator.platform);return function(){return e}}(),A.isSafari=function(){var e=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return function(){return e}}(),A.isFirefoxAndroid=function(){var e=navigator.userAgent.indexOf("Firefox")!==-1&&navigator.userAgent.indexOf("Android")!==-1;return function(){return e}}(),A.isLandscapeMode=function(){return 90==window.orientation||window.orientation==-90},A.isTimestampDeltaValid=function(e){return!isNaN(e)&&(!(e<=A.MIN_TIMESTEP)&&!(e>A.MAX_TIMESTEP))},A.getScreenWidth=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},A.getScreenHeight=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},A.requestFullscreen=function(e){if(e.requestFullscreen)e.requestFullscreen();else if(e.webkitRequestFullscreen)e.webkitRequestFullscreen();else if(e.mozRequestFullScreen)e.mozRequestFullScreen();else{if(!e.msRequestFullscreen)return!1;e.msRequestFullscreen()}return!0},A.exitFullscreen=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else{if(!document.msExitFullscreen)return!1;document.msExitFullscreen()}return!0},A.getFullscreenElement=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},A.linkProgram=function(e,M,i,t){var A=e.createShader(e.VERTEX_SHADER);e.shaderSource(A,M),e.compileShader(A);var s=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(s,i),e.compileShader(s);var r=e.createProgram();e.attachShader(r,A),e.attachShader(r,s);for(var N in t)e.bindAttribLocation(r,t[N],N);return e.linkProgram(r),e.deleteShader(A),e.deleteShader(s),r},A.getProgramUniforms=function(e,M){for(var i={},t=e.getProgramParameter(M,e.ACTIVE_UNIFORMS),A="",s=0;s<t;s++){var r=e.getActiveUniform(M,s);A=r.name.replace("[0]",""),i[A]=e.getUniformLocation(M,A)}return i},A.orthoMatrix=function(e,M,i,t,A,s,r){var N=1/(M-i),D=1/(t-A),n=1/(s-r);return e[0]=-2*N,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*D,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*n,e[11]=0,e[12]=(M+i)*N,e[13]=(A+t)*D,e[14]=(r+s)*n,e[15]=1,e},A.isMobile=function(){var e=!1;return function(M){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(M)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(M.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e},A.extend=t,A.safariCssSizeWorkaround=function(e){if(A.isIOS()){var M=e.style.width,i=e.style.height;e.style.width=parseInt(M)+1+"px",e.style.height=parseInt(i)+"px",console.log("Resetting width to...",M),setTimeout(function(){console.log("Done. Width is now",M),e.style.width=M,e.style.height=i},100)}window.Util=A,window.canvas=e},A.frameDataFromPose=function(){function e(e,M,i,t){var r=Math.tan(M?M.upDegrees*A:s),N=Math.tan(M?M.downDegrees*A:s),D=Math.tan(M?M.leftDegrees*A:s),n=Math.tan(M?M.rightDegrees*A:s),u=2/(D+n),a=2/(r+N);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=-((D-n)*u*.5),e[9]=(r-N)*a*.5,e[10]=t/(i-t),e[11]=-1,e[12]=0,e[13]=0,e[14]=t*i/(i-t),e[15]=0,e}function M(e,M,i){var t=M[0],A=M[1],s=M[2],r=M[3],N=t+t,D=A+A,n=s+s,u=t*N,a=t*D,o=t*n,g=A*D,j=A*n,I=s*n,L=r*N,T=r*D,c=r*n;return e[0]=1-(g+I),e[1]=a+c,e[2]=o-T,e[3]=0,e[4]=a-c,e[5]=1-(u+I),e[6]=j+L,e[7]=0,e[8]=o+T,e[9]=j-L,e[10]=1-(u+g),e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e}function i(e,M,i){var t,A,s,r,N,D,n,u,a,o,g,j,I=i[0],L=i[1],T=i[2];return M===e?(e[12]=M[0]*I+M[4]*L+M[8]*T+M[12],e[13]=M[1]*I+M[5]*L+M[9]*T+M[13],e[14]=M[2]*I+M[6]*L+M[10]*T+M[14],e[15]=M[3]*I+M[7]*L+M[11]*T+M[15]):(t=M[0],A=M[1],s=M[2],r=M[3],N=M[4],D=M[5],n=M[6],u=M[7],a=M[8],o=M[9],g=M[10],j=M[11],e[0]=t,e[1]=A,e[2]=s,e[3]=r,e[4]=N,e[5]=D,e[6]=n,e[7]=u,e[8]=a,e[9]=o,e[10]=g,e[11]=j,e[12]=t*I+N*L+a*T+M[12],e[13]=A*I+D*L+o*T+M[13],e[14]=s*I+n*L+g*T+M[14],e[15]=r*I+u*L+j*T+M[15]),e}function t(t,A,s,D,n){e(t,D?D.fieldOfView:null,n.depthNear,n.depthFar);var u=s.orientation||r,a=s.position||N;M(A,u,a),D&&i(A,A,D.offset),mat4_invert(A,A)}var A=Math.PI/180,s=.25*Math.PI;mat4_invert=function(e,M){var i=M[0],t=M[1],A=M[2],s=M[3],r=M[4],N=M[5],D=M[6],n=M[7],u=M[8],a=M[9],o=M[10],g=M[11],j=M[12],I=M[13],L=M[14],T=M[15],c=i*N-t*r,E=i*D-A*r,w=i*n-s*r,y=t*D-A*N,l=t*n-s*N,z=A*n-s*D,h=u*I-a*j,d=u*L-o*j,x=u*T-g*j,O=a*L-o*I,C=a*T-g*I,S=o*T-g*L,p=c*S-E*C+w*O+y*x-l*d+z*h;return p?(p=1/p,e[0]=(N*S-D*C+n*O)*p,e[1]=(A*C-t*S-s*O)*p,e[2]=(I*z-L*l+T*y)*p,e[3]=(o*l-a*z-g*y)*p,e[4]=(D*x-r*S-n*d)*p,e[5]=(i*S-A*x+s*d)*p,e[6]=(L*w-j*z-T*E)*p,e[7]=(u*z-o*w+g*E)*p,e[8]=(r*C-N*x+n*h)*p,e[9]=(t*x-i*C-s*h)*p,e[10]=(j*l-I*w+T*c)*p,e[11]=(a*w-u*l-g*c)*p,e[12]=(N*d-r*O-D*h)*p,e[13]=(i*O-t*d+A*h)*p,e[14]=(I*E-j*y-L*c)*p,e[15]=(u*y-a*E+o*c)*p,e):null};var r=new Float32Array([0,0,0,1]),N=new Float32Array([0,0,0]);return function(e,M,i){return!(!e||!M)&&(e.pose=M,e.timestamp=M.timestamp,t(e.leftProjectionMatrix,e.leftViewMatrix,M,i.getEyeParameters("left"),i),t(e.rightProjectionMatrix,e.rightViewMatrix,M,i.getEyeParameters("right"),i),!0)}}(),M.exports=A},{"object-assign":1}],23:[function(e,M,i){function t(){try{this.selectedKey=localStorage.getItem(N)||r}catch(e){console.error("Failed to load viewer profile: %s",e)}this.dialog=this.createDialog_(s.Viewers),this.root=null}var A=e("./emitter.js"),s=(e("./util.js"),e("./device-info.js")),r="CardboardV1",N="WEBVR_CARDBOARD_VIEWER",D="webvr-polyfill-viewer-selector";t.prototype=new A,t.prototype.show=function(e){this.root=e,e.appendChild(this.dialog);var M=this.dialog.querySelector("#"+this.selectedKey);M.checked=!0,this.dialog.style.display="block"},t.prototype.hide=function(){this.root&&this.root.contains(this.dialog)&&this.root.removeChild(this.dialog),this.dialog.style.display="none"},t.prototype.getCurrentViewer=function(){return s.Viewers[this.selectedKey]},t.prototype.getSelectedKey_=function(){var e=this.dialog.querySelector("input[name=field]:checked");return e?e.id:null},t.prototype.onSave_=function(){if(this.selectedKey=this.getSelectedKey_(),!this.selectedKey||!s.Viewers[this.selectedKey])return void console.error("ViewerSelector.onSave_: this should never happen!");this.emit("change",s.Viewers[this.selectedKey]);try{localStorage.setItem(N,this.selectedKey)}catch(e){console.error("Failed to save viewer profile: %s",e)}this.hide()},t.prototype.createDialog_=function(e){var M=document.createElement("div");M.classList.add(D),M.style.display="none";var i=document.createElement("div"),t=i.style;t.position="fixed",t.left=0,t.top=0,t.width="100%",t.height="100%",t.background="rgba(0, 0, 0, 0.3)",i.addEventListener("click",this.hide.bind(this));var A=280,s=document.createElement("div"),t=s.style;t.boxSizing="border-box",t.position="fixed",t.top="24px",t.left="50%",t.marginLeft=-A/2+"px",t.width=A+"px",t.padding="24px",t.overflow="hidden",t.background="#fafafa",t.fontFamily="'Roboto', sans-serif",t.boxShadow="0px 5px 20px #666",s.appendChild(this.createH1_("Select your viewer"));for(var r in e)s.appendChild(this.createChoice_(r,e[r].label));return s.appendChild(this.createButton_("Save",this.onSave_.bind(this))),M.appendChild(i),M.appendChild(s),M},t.prototype.createH1_=function(e){var M=document.createElement("h1"),i=M.style;return i.color="black",i.fontSize="20px",i.fontWeight="bold",i.marginTop=0,i.marginBottom="24px",M.innerHTML=e,M},t.prototype.createChoice_=function(e,M){var i=document.createElement("div");i.style.marginTop="8px",i.style.color="black";var t=document.createElement("input");t.style.fontSize="30px",t.setAttribute("id",e),t.setAttribute("type","radio"),t.setAttribute("value",e),t.setAttribute("name","field");var A=document.createElement("label");return A.style.marginLeft="4px",A.setAttribute("for",e),A.innerHTML=M,i.appendChild(t),i.appendChild(A),i},t.prototype.createButton_=function(e,M){var i=document.createElement("button");i.innerHTML=e;var t=i.style;return t.float="right",t.textTransform="uppercase",t.color="#1094f7",t.fontSize="14px",t.letterSpacing=0,t.border=0,t.background="none",t.marginTop="16px",i.addEventListener("click",M),i},M.exports=t},{"./device-info.js":7,"./emitter.js":12,"./util.js":22}],24:[function(e,M,i){function t(){var e=document.createElement("video");e.addEventListener("ended",function(){e.play()}),this.request=function(){e.paused&&(e.src=r.base64("video/mp4","AAAAGGZ0eXBpc29tAAAAAG1wNDFhdmMxAAAIA21vb3YAAABsbXZoZAAAAADSa9v60mvb+gABX5AAlw/gAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAdkdHJhawAAAFx0a2hkAAAAAdJr2/rSa9v6AAAAAQAAAAAAlw/gAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAQAAAAHAAAAAAAJGVkdHMAAAAcZWxzdAAAAAAAAAABAJcP4AAAAAAAAQAAAAAG3G1kaWEAAAAgbWRoZAAAAADSa9v60mvb+gAPQkAGjneAFccAAAAAAC1oZGxyAAAAAAAAAAB2aWRlAAAAAAAAAAAAAAAAVmlkZW9IYW5kbGVyAAAABodtaW5mAAAAFHZtaGQAAAABAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAAZHc3RibAAAAJdzdHNkAAAAAAAAAAEAAACHYXZjMQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAMABwASAAAAEgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABj//wAAADFhdmNDAWQAC//hABlnZAALrNlfllw4QAAAAwBAAAADAKPFCmWAAQAFaOvssiwAAAAYc3R0cwAAAAAAAAABAAAAbgAPQkAAAAAUc3RzcwAAAAAAAAABAAAAAQAAA4BjdHRzAAAAAAAAAG4AAAABAD0JAAAAAAEAehIAAAAAAQA9CQAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEATEtAAAAAAQAehIAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEATEtAAAAAAQAehIAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEATEtAAAAAAQAehIAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEATEtAAAAAAQAehIAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEATEtAAAAAAQAehIAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEATEtAAAAAAQAehIAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEATEtAAAAAAQAehIAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEATEtAAAAAAQAehIAAAAABAAAAAAAAAAEAD0JAAAAAAQBMS0AAAAABAB6EgAAAAAEAAAAAAAAAAQAPQkAAAAABAExLQAAAAAEAHoSAAAAAAQAAAAAAAAABAA9CQAAAAAEALcbAAAAAHHN0c2MAAAAAAAAAAQAAAAEAAABuAAAAAQAAAcxzdHN6AAAAAAAAAAAAAABuAAADCQAAABgAAAAOAAAADgAAAAwAAAASAAAADgAAAAwAAAAMAAAAEgAAAA4AAAAMAAAADAAAABIAAAAOAAAADAAAAAwAAAASAAAADgAAAAwAAAAMAAAAEgAAAA4AAAAMAAAADAAAABIAAAAOAAAADAAAAAwAAAASAAAADgAAAAwAAAAMAAAAEgAAAA4AAAAMAAAADAAAABIAAAAOAAAADAAAAAwAAAASAAAADgAAAAwAAAAMAAAAEgAAAA4AAAAMAAAADAAAABIAAAAOAAAADAAAAAwAAAASAAAADgAAAAwAAAAMAAAAEgAAAA4AAAAMAAAADAAAABIAAAAOAAAADAAAAAwAAAASAAAADgAAAAwAAAAMAAAAEgAAAA4AAAAMAAAADAAAABIAAAAOAAAADAAAAAwAAAASAAAADgAAAAwAAAAMAAAAEgAAAA4AAAAMAAAADAAAABIAAAAOAAAADAAAAAwAAAASAAAADgAAAAwAAAAMAAAAEgAAAA4AAAAMAAAADAAAABIAAAAOAAAADAAAAAwAAAASAAAADgAAAAwAAAAMAAAAEgAAAA4AAAAMAAAADAAAABMAAAAUc3RjbwAAAAAAAAABAAAIKwAAACt1ZHRhAAAAI6llbmMAFwAAdmxjIDIuMi4xIHN0cmVhbSBvdXRwdXQAAAAId2lkZQAACRRtZGF0AAACrgX//6vcRem95tlIt5Ys2CDZI+7veDI2NCAtIGNvcmUgMTQyIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTMgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MzoweDEzIG1lPWhleCBzdWJtZT03IHBzeT0xIHBzeV9yZD0xLjAwOjAuMDAgbWl4ZWRfcmVmPTEgbWVfcmFuZ2U9MTYgY2hyb21hX21lPTEgdHJlbGxpcz0xIDh4OGRjdD0xIGNxbT0wIGRlYWR6b25lPTIxLDExIGZhc3RfcHNraXA9MSBjaHJvbWFfcXBfb2Zmc2V0PS0yIHRocmVhZHM9MTIgbG9va2FoZWFkX3RocmVhZHM9MSBzbGljZWRfdGhyZWFkcz0wIG5yPTAgZGVjaW1hdGU9MSBpbnRlcmxhY2VkPTAgYmx1cmF5X2NvbXBhdD0wIGNvbnN0cmFpbmVkX2ludHJhPTAgYmZyYW1lcz0zIGJfcHlyYW1pZD0yIGJfYWRhcHQ9MSBiX2JpYXM9MCBkaXJlY3Q9MSB3ZWlnaHRiPTEgb3Blbl9nb3A9MCB3ZWlnaHRwPTIga2V5aW50PTI1MCBrZXlpbnRfbWluPTEgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD00MCByYz1hYnIgbWJ0cmVlPTEgYml0cmF0ZT0xMDAgcmF0ZXRvbD0xLjAgcWNvbXA9MC42MCBxcG1pbj0xMCBxcG1heD01MSBxcHN0ZXA9NCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAU2WIhAAQ/8ltlOe+cTZuGkKg+aRtuivcDZ0pBsfsEi9p/i1yU9DxS2lq4dXTinViF1URBKXgnzKBd/Uh1bkhHtMrwrRcOJslD01UB+fyaL6ef+DBAAAAFEGaJGxBD5B+v+a+4QqF3MgBXz9MAAAACkGeQniH/+94r6EAAAAKAZ5hdEN/8QytwAAAAAgBnmNqQ3/EgQAAAA5BmmhJqEFomUwIIf/+4QAAAApBnoZFESw//76BAAAACAGepXRDf8SBAAAACAGep2pDf8SAAAAADkGarEmoQWyZTAgh//7gAAAACkGeykUVLD//voEAAAAIAZ7pdEN/xIAAAAAIAZ7rakN/xIAAAAAOQZrwSahBbJlMCCH//uEAAAAKQZ8ORRUsP/++gQAAAAgBny10Q3/EgQAAAAgBny9qQ3/EgAAAAA5BmzRJqEFsmUwIIf/+4AAAAApBn1JFFSw//76BAAAACAGfcXRDf8SAAAAACAGfc2pDf8SAAAAADkGbeEmoQWyZTAgh//7hAAAACkGflkUVLD//voAAAAAIAZ+1dEN/xIEAAAAIAZ+3akN/xIEAAAAOQZu8SahBbJlMCCH//uAAAAAKQZ/aRRUsP/++gQAAAAgBn/l0Q3/EgAAAAAgBn/tqQ3/EgQAAAA5Bm+BJqEFsmUwIIf/+4QAAAApBnh5FFSw//76AAAAACAGePXRDf8SAAAAACAGeP2pDf8SBAAAADkGaJEmoQWyZTAgh//7gAAAACkGeQkUVLD//voEAAAAIAZ5hdEN/xIAAAAAIAZ5jakN/xIEAAAAOQZpoSahBbJlMCCH//uEAAAAKQZ6GRRUsP/++gQAAAAgBnqV0Q3/EgQAAAAgBnqdqQ3/EgAAAAA5BmqxJqEFsmUwIIf/+4AAAAApBnspFFSw//76BAAAACAGe6XRDf8SAAAAACAGe62pDf8SAAAAADkGa8EmoQWyZTAgh//7hAAAACkGfDkUVLD//voEAAAAIAZ8tdEN/xIEAAAAIAZ8vakN/xIAAAAAOQZs0SahBbJlMCCH//uAAAAAKQZ9SRRUsP/++gQAAAAgBn3F0Q3/EgAAAAAgBn3NqQ3/EgAAAAA5Bm3hJqEFsmUwIIf/+4QAAAApBn5ZFFSw//76AAAAACAGftXRDf8SBAAAACAGft2pDf8SBAAAADkGbvEmoQWyZTAgh//7gAAAACkGf2kUVLD//voEAAAAIAZ/5dEN/xIAAAAAIAZ/7akN/xIEAAAAOQZvgSahBbJlMCCH//uEAAAAKQZ4eRRUsP/++gAAAAAgBnj10Q3/EgAAAAAgBnj9qQ3/EgQAAAA5BmiRJqEFsmUwIIf/+4AAAAApBnkJFFSw//76BAAAACAGeYXRDf8SAAAAACAGeY2pDf8SBAAAADkGaaEmoQWyZTAgh//7hAAAACkGehkUVLD//voEAAAAIAZ6ldEN/xIEAAAAIAZ6nakN/xIAAAAAOQZqsSahBbJlMCCH//uAAAAAKQZ7KRRUsP/++gQAAAAgBnul0Q3/EgAAAAAgBnutqQ3/EgAAAAA5BmvBJqEFsmUwIIf/+4QAAAApBnw5FFSw//76BAAAACAGfLXRDf8SBAAAACAGfL2pDf8SAAAAADkGbNEmoQWyZTAgh//7gAAAACkGfUkUVLD//voEAAAAIAZ9xdEN/xIAAAAAIAZ9zakN/xIAAAAAOQZt4SahBbJlMCCH//uEAAAAKQZ+WRRUsP/++gAAAAAgBn7V0Q3/EgQAAAAgBn7dqQ3/EgQAAAA5Bm7xJqEFsmUwIIf/+4AAAAApBn9pFFSw//76BAAAACAGf+XRDf8SAAAAACAGf+2pDf8SBAAAADkGb4EmoQWyZTAgh//7hAAAACkGeHkUVLD//voAAAAAIAZ49dEN/xIAAAAAIAZ4/akN/xIEAAAAOQZokSahBbJlMCCH//uAAAAAKQZ5CRRUsP/++gQAAAAgBnmF0Q3/EgAAAAAgBnmNqQ3/EgQAAAA5BmmhJqEFsmUwIIf/+4QAAAApBnoZFFSw//76BAAAACAGepXRDf8SBAAAACAGep2pDf8SAAAAADkGarEmoQWyZTAgh//7gAAAACkGeykUVLD//voEAAAAIAZ7pdEN/xIAAAAAIAZ7rakN/xIAAAAAPQZruSahBbJlMFEw3//7B"),e.play())},this.release=function(){e.pause(),e.src=""}}function A(){var e=null;this.request=function(){e||(e=setInterval(function(){window.location=window.location,setTimeout(window.stop,0)},3e4))},this.release=function(){e&&(clearInterval(e),e=null)}}function s(){var e=navigator.userAgent||navigator.vendor||window.opera;return e.match(/iPhone/i)||e.match(/iPod/i)?A:t}var r=e("./util.js");M.exports=s()},{"./util.js":22}],25:[function(e,M,i){function t(){this.displays=[],this.devices=[],this.devicesPopulated=!1,this.nativeWebVRAvailable=this.isWebVRAvailable(),this.nativeLegacyWebVRAvailable=this.isDeprecatedWebVRAvailable(),this.nativeLegacyWebVRAvailable||(this.nativeWebVRAvailable||this.enablePolyfill(),WebVRConfig.ENABLE_DEPRECATED_API&&this.enableDeprecatedPolyfill()),A()}function A(){"VRDisplay"in window&&!("VRFrameData"in window)&&(window.VRFrameData=n,"depthNear"in window.VRDisplay.prototype||(window.VRDisplay.prototype.depthNear=.01),"depthFar"in window.VRDisplay.prototype||(window.VRDisplay.prototype.depthFar=1e4),window.VRDisplay.prototype.getFrameData=function(e){return s.frameDataFromPose(e,this.getPose(),this)})}var s=e("./util.js"),r=e("./cardboard-vr-display.js"),N=e("./mouse-keyboard-vr-display.js"),D=e("./base.js").VRDisplay,n=e("./base.js").VRFrameData,u=e("./base.js").HMDVRDevice,a=e("./base.js").PositionSensorVRDevice,o=e("./display-wrappers.js").VRDisplayHMDDevice,g=e("./display-wrappers.js").VRDisplayPositionSensorDevice;t.prototype.isWebVRAvailable=function(){return"getVRDisplays"in navigator},t.prototype.isDeprecatedWebVRAvailable=function(){return"getVRDevices"in navigator||"mozGetVRDevices"in navigator},t.prototype.populateDevices=function(){if(!this.devicesPopulated){var e=null;this.isCardboardCompatible()&&(e=new r,this.displays.push(e),WebVRConfig.ENABLE_DEPRECATED_API&&(this.devices.push(new o(e)),this.devices.push(new g(e)))),this.isMobile()||WebVRConfig.MOUSE_KEYBOARD_CONTROLS_DISABLED||(e=new N,this.displays.push(e),WebVRConfig.ENABLE_DEPRECATED_API&&(this.devices.push(new o(e)),this.devices.push(new g(e)))),this.devicesPopulated=!0}},t.prototype.enablePolyfill=function(){navigator.getVRDisplays=this.getVRDisplays.bind(this),window.VRDisplay=D;var e=this;Object.defineProperty(navigator,"vrEnabled",{get:function(){return e.isCardboardCompatible()&&(document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled||!1)}}),window.VRFrameData=n},t.prototype.enableDeprecatedPolyfill=function(){navigator.getVRDevices=this.getVRDevices.bind(this),window.HMDVRDevice=u,window.PositionSensorVRDevice=a},t.prototype.getVRDisplays=function(){this.populateDevices();var e=this.displays;return new Promise(function(M,i){try{M(e)}catch(e){i(e)}})},t.prototype.getVRDevices=function(){console.warn("getVRDevices is deprecated. Please update your code to use getVRDisplays instead.");var e=this;return new Promise(function(M,i){try{if(!e.devicesPopulated){if(e.nativeWebVRAvailable)return navigator.getVRDisplays(function(i){for(var t=0;t<i.length;++t)e.devices.push(new o(i[t])),e.devices.push(new g(i[t]));e.devicesPopulated=!0,M(e.devices)},i);if(e.nativeLegacyWebVRAvailable)return(navigator.getVRDDevices||navigator.mozGetVRDevices)(function(i){for(var t=0;t<i.length;++t)i[t]instanceof u&&e.devices.push(i[t]),i[t]instanceof a&&e.devices.push(i[t]);e.devicesPopulated=!0,M(e.devices)},i)}e.populateDevices(),M(e.devices)}catch(e){i(e)}})},t.prototype.isMobile=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},t.prototype.isCardboardCompatible=function(){return this.isMobile()||WebVRConfig.FORCE_ENABLE_VR},M.exports.WebVRPolyfill=t},{"./base.js":2,"./cardboard-vr-display.js":5,"./display-wrappers.js":8,"./mouse-keyboard-vr-display.js":15,"./util.js":22}]},{},[13]);
},{}],472:[function(require,module,exports){
var bundleFn=arguments[3],sources=arguments[4],cache=arguments[5],stringify=JSON.stringify;module.exports=function(r){for(var e,t=Object.keys(cache),n=0,o=t.length;n<o;n++){var i=t[n];if(cache[i].exports===r){e=i;break}}if(!e){e=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var s={},n=0,o=t.length;n<o;n++){var i=t[n];s[i]=i}sources[e]=[Function(["require","module","exports"],"("+r+")(self)"),s]}var a=Math.floor(Math.pow(16,8)*Math.random()).toString(16),u={};u[e]=e,sources[a]=[Function(["require"],"require("+stringify(e)+")(self)"),u];var c="("+bundleFn+")({"+Object.keys(sources).map(function(r){return stringify(r)+":["+sources[r][0]+","+stringify(sources[r][1])+"]"}).join(",")+"},{},["+stringify(a)+"])",f=window.URL||window.webkitURL||window.mozURL||window.msURL;return new Worker(f.createObjectURL(new Blob([c],{type:"text/javascript"})))};
},{}],473:[function(require,module,exports){
"use strict";function forEachArray(e,t){for(var r=0;r<e.length;r++)t(e[r])}function isEmpty(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function initParams(e,t,r){var n=e;return isFunction(t)?(r=t,"string"==typeof e&&(n={uri:e})):n=xtend(t,{uri:e}),n.callback=r,n}function createXHR(e,t,r){return t=initParams(e,t,r),_createXHR(t)}function _createXHR(e){function t(){4===u.readyState&&o()}function r(){var e=void 0;if(e=u.response?u.response:u.responseText||getXml(u),h)try{e=JSON.parse(e)}catch(e){}return e}function n(e){return clearTimeout(p),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,a(e,i)}function o(){if(!d){var t;clearTimeout(p),t=e.useXDR&&void 0===u.status?200:1223===u.status?204:u.status;var n=i,o=null;return 0!==t?(n={body:r(),statusCode:t,method:f,headers:{},url:l,rawRequest:u},u.getAllResponseHeaders&&(n.headers=parseHeaders(u.getAllResponseHeaders()))):o=new Error("Internal XMLHttpRequest Error"),a(o,n,n.body)}}if("undefined"==typeof e.callback)throw new Error("callback argument missing");var s=!1,a=function(t,r,n){s||(s=!0,e.callback(t,r,n))},i={body:void 0,headers:{},statusCode:0,method:f,url:l,rawRequest:u},u=e.xhr||null;u||(u=e.cors||e.useXDR?new createXHR.XDomainRequest:new createXHR.XMLHttpRequest);var c,d,p,l=u.url=e.uri||e.url,f=u.method=e.method||"GET",m=e.body||e.data||null,R=u.headers=e.headers||{},X=!!e.sync,h=!1;if("json"in e&&(h=!0,R.accept||R.Accept||(R.Accept="application/json"),"GET"!==f&&"HEAD"!==f&&(R["content-type"]||R["Content-Type"]||(R["Content-Type"]="application/json"),m=JSON.stringify(e.json))),u.onreadystatechange=t,u.onload=o,u.onerror=n,u.onprogress=function(){},u.ontimeout=n,u.open(f,l,!X,e.username,e.password),X||(u.withCredentials=!!e.withCredentials),!X&&e.timeout>0&&(p=setTimeout(function(){d=!0,u.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",n(e)},e.timeout)),u.setRequestHeader)for(c in R)R.hasOwnProperty(c)&&u.setRequestHeader(c,R[c]);else if(e.headers&&!isEmpty(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(u.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(u),u.send(m),u}function getXml(e){if("document"===e.responseType)return e.responseXML;var t=204===e.status&&e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;return""!==e.responseType||t?null:e.responseXML}function noop(){}var window=require("global/window"),isFunction=require("is-function"),parseHeaders=require("parse-headers"),xtend=require("xtend");module.exports=createXHR,createXHR.XMLHttpRequest=window.XMLHttpRequest||noop,createXHR.XDomainRequest="withCredentials"in new createXHR.XMLHttpRequest?createXHR.XMLHttpRequest:window.XDomainRequest,forEachArray(["get","put","post","patch","head","delete"],function(e){createXHR["delete"===e?"del":e]=function(t,r,n){return r=initParams(t,r,n),r.method=e.toUpperCase(),_createXHR(r)}});
},{"global/window":194,"is-function":195,"parse-headers":208,"xtend":474}],474:[function(require,module,exports){
function extend(){for(var r={},e=0;e<arguments.length;e++){var t=arguments[e];for(var n in t)hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r}module.exports=extend;var hasOwnProperty=Object.prototype.hasOwnProperty;
},{}],475:[function(require,module,exports){
(function (global){
var videojs=global.videojs=require("video.js");require("dashjs"),require("videojs-contrib-dash"),require("videojs-contrib-hls"),global.THREE=require("three"),require("three/examples/js/controls/VRControls.js"),require("three/examples/js/effects/VREffect.js"),global.WebVRConfig=require("./webvr.config.js");var WebVrPolyfill=require("webvr-polyfill"),WebVRManager=require("webvr-boilerplate");window.WebVRManager=WebVRManager,require("./videojs.vr.js");
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./videojs.vr.js":476,"./webvr.config.js":477,"dashjs":12,"three":214,"three/examples/js/controls/VRControls.js":215,"three/examples/js/effects/VREffect.js":216,"video.js":312,"videojs-contrib-dash":314,"videojs-contrib-hls":330,"webvr-boilerplate":470,"webvr-polyfill":471}],476:[function(require,module,exports){
!function(e){var t=function(e){var t,n,r;for(n=1;n<arguments.length;n++){t=arguments[n];for(r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}return e},n={projection:"360_LR"},r=function(r){function o(e){var t={x:0,y:0,z:0};if(v&&v.remove(u),"360"===e)l=new THREE.SphereBufferGeometry(256,32,32),u=new THREE.Mesh(l,c),u.position.set(t.x,t.y,t.z),u.scale.x=-1,u.quaternion.setFromAxisAngle({x:0,y:1,z:0},-Math.PI/2),v.add(u);else if("360_LR"===e||"360_TB"===e){var n=new THREE.SphereGeometry(256,32,32);n.scale(-1,1,1);for(var r=n.faceVertexUvs[0],o=0;o<r.length;o++)for(var i=0;i<3;i++)"360_LR"===e?r[o][i].x*=.5:r[o][i].y*=.5;l=(new THREE.BufferGeometry).fromGeometry(n),u=new THREE.Mesh(l,c),u.rotation.y=-Math.PI/2,u.layers.set(1),v.add(u);var n=new THREE.SphereGeometry(256,32,32);n.scale(-1,1,1);for(var r=n.faceVertexUvs[0],o=0;o<r.length;o++)for(var i=0;i<3;i++)"360_LR"===e?(r[o][i].x*=.5,r[o][i].x+=.5):(r[o][i].y*=.5,r[o][i].y+=.5);l=(new THREE.BufferGeometry).fromGeometry(n),u=new THREE.Mesh(l,c),u.rotation.y=-Math.PI/2,u.layers.set(2),v.add(u)}else if("360_CUBE"===e){l=new THREE.CubeGeometry(256,256,256);var a=[new THREE.Vector2(0,.5),new THREE.Vector2(.333,.5),new THREE.Vector2(.333,1),new THREE.Vector2(0,1)],s=[new THREE.Vector2(.333,.5),new THREE.Vector2(.666,.5),new THREE.Vector2(.666,1),new THREE.Vector2(.333,1)],d=[new THREE.Vector2(.666,.5),new THREE.Vector2(1,.5),new THREE.Vector2(1,1),new THREE.Vector2(.666,1)],E=[new THREE.Vector2(0,0),new THREE.Vector2(.333,1),new THREE.Vector2(.333,.5),new THREE.Vector2(0,.5)],f=[new THREE.Vector2(.333,1),new THREE.Vector2(.666,1),new THREE.Vector2(.666,.5),new THREE.Vector2(.333,.5)],w=[new THREE.Vector2(.666,1),new THREE.Vector2(1,0),new THREE.Vector2(1,.5),new THREE.Vector2(.666,.5)];l.faceVertexUvs[0]=[],l.faceVertexUvs[0][0]=[a[0],a[1],a[3]],l.faceVertexUvs[0][1]=[a[1],a[2],a[3]],l.faceVertexUvs[0][2]=[s[0],s[1],s[3]],l.faceVertexUvs[0][3]=[s[1],s[2],s[3]],l.faceVertexUvs[0][4]=[d[0],d[1],d[3]],l.faceVertexUvs[0][5]=[d[1],d[2],d[3]],l.faceVertexUvs[0][6]=[E[0],E[1],E[3]],l.faceVertexUvs[0][7]=[E[1],E[2],E[3]],l.faceVertexUvs[0][8]=[f[0],f[1],f[3]],l.faceVertexUvs[0][9]=[f[1],f[2],f[3]],l.faceVertexUvs[0][10]=[w[0],w[1],w[3]],l.faceVertexUvs[0][11]=[w[1],w[2],w[3]],u=new THREE.Mesh(l,c),u.position.set(t.x,t.y,t.z),v.add(u)}}function i(){function e(){V.setSize(window.innerWidth,window.innerHeight),x.aspect=window.innerWidth/window.innerHeight,x.updateProjectionMatrix()}function t(){P.enterVRMode_(),P.setMode_(3)}function n(){j.isPresenting&&j.exitPresent()}function r(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)}function i(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function a(e){var t=!1,n=h.currentType();return"application/x-mpegURL"==n&&(t=!0,console.log("Detected HLS Stream")),t}function s(){(window.orientation==-90||90==window.orientation)&&screen.height>screen.width?x.aspect=screen.height/screen.width:x.aspect=screen.width/screen.height,x.updateProjectionMatrix()}function l(){h.paused()?h.play():h.pause()}function u(e,t){return"x"==t?180-p(Math.atan2(e.x,e.z)):"y"==t?180-p(Math.atan2(e.y,e.z)):void 0}function p(e){return 180*e/Math.PI}var V,H,T,x,y;Date.now();x=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1e3),E=new THREE.Vector3,"360_LR"!==R&&"360_TB"!==R||x.layers.enable(1),v=new THREE.Scene,d=new THREE.VRControls(x),H=new THREE.VideoTexture(m),H.generateMipmaps=!1,H.minFilter=THREE.LinearFilter,H.magFilter=THREE.LinearFilter,a()&&i()&&r()?(console.log("Safari + iOS + HLS = flipY and colorspace hack"),H.format=THREE.RGBAFormat,H.flipY=!1):a()&&i()?(console.log("Safari + HLS = flipY hack"),H.format=THREE.RGBFormat,H.flipY=!1):H.format=THREE.RGBFormat,c=H.format===THREE.RGBAFormat&&H.flipY===!1?new THREE.ShaderMaterial({uniforms:{texture:{value:H}},vertexShader:["varying vec2 vUV;","void main() {","\tvUV = vec2( uv.x, 1.0 - uv.y );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D texture;","varying vec2 vUV;","void main() {"," gl_FragColor = texture2D( texture, vUV  ).bgra;","}"].join("\n")}):H.format===THREE.RGBFormat&&H.flipY===!1?new THREE.ShaderMaterial({uniforms:{texture:{value:H}},vertexShader:["varying vec2 vUV;","void main() {","\tvUV = vec2( uv.x, 1.0 - uv.y );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D texture;","varying vec2 vUV;","void main() {"," gl_FragColor = texture2D( texture, vUV  );","}"].join("\n")}):new THREE.MeshBasicMaterial({map:H,overdraw:!0,side:THREE.DoubleSide}),o(R),x.position.set(0,0,0),T=new THREE.WebGLRenderer({devicePixelRatio:window.devicePixelRatio,alpha:!1,clearColor:16777215,antialias:!0}),T.setSize(window.innerWidth,window.innerHeight),V=new THREE.VREffect(T),V.setSize(window.innerWidth,window.innerHeight);var j=null,M=[],P=new WebVRManager(T,V,{hideButton:!1});y=T.domElement,y.style.width="inherit",y.style.height="inherit",g.insertBefore(y,g.firstChild),m.style.display="none",window.addEventListener("resize",e,!1),window.addEventListener("vrdisplaypresentchange",e,!0),window.addEventListener("vrdisplayactivate",t,!0),window.addEventListener("vrdisplaydeactivate",n,!0),navigator.getVRDisplays?navigator.getVRDisplays().then(function(e){e.length>0?(console.log("WebVR supported, VRDisplays found."),j=e[0],console.log(j)):console.log("WebVR supported, but no VRDisplays found.")}):navigator.getVRDevices?console.log("Your browser supports WebVR but not the latest version. See <a href='http://webvr.info'>webvr.info</a> for more info."):console.log("Your browser does not support WebVR. See <a href='http://webvr.info'>webvr.info</a> for assistance."),window.addEventListener("orientationchange",s,!1),function e(){if(m.readyState===m.HAVE_ENOUGH_DATA&&H&&(H.needsUpdate=!0),d.update(),P.render(v,x),j){j.requestAnimationFrame(e);for(var t=navigator.getGamepads(),n=0;n<t.length;++n){var r=t[n];if(r&&r.timestamp&&r.timestamp!==M[n])for(var o=0;o<r.buttons.length;++o)if(r.buttons[o].pressed){l(),M[n]=r.timestamp;break}}}else window.requestAnimationFrame(e);x.getWorldDirection(E),f=u(E,"x"),w=u(E,"y")}(),h.vr={cameraVector:E}}function a(){var t=e.extend(e.getComponent("MenuButton"),{constructor:function(t,n){t.availableProjections=n.availableProjections||[],e.getComponent("MenuButton").call(this,t,n);var r=this.el().firstChild,o=e.createEl("div",{className:"vjs-control-content"});this.el().replaceChild(o,r),o.appendChild(r)}});e.registerComponent("ProjectionSelector",t);var n=e.extend(e.getComponent("Button"),{constructor:function(e,t){this.availableProjections=t.availableProjections||[]},className:"vjs-res-button vjs-menu-button vjs-control",role:"button","aria-live":"polite",tabIndex:0});e.registerComponent("ProjectionSelection",n);var r=e.extend(e.getComponent("MenuItem"),{constructor:function(t,n){e.getComponent("MenuItem").call(this,t,n),this.off("click")}});e.registerComponent("ProjectionTitleMenuItem",r);var i=e.extend(e.getComponent("MenuItem"),{constructor:function(t,n){n.label=n.res,n.selected=n.res.toString()===t.getCurrentRes().toString(),e.getComponent("MenuItem").call(this,t,n),this.resolution=n.res,this.on("click",this.onClick),t.on("changeProjection",e.bind(this,function(){this.resolution===t.getCurrentRes()?this.selected(!0):this.selected(!1)}))}});i.prototype.onClick=function(){var e=this.player(),t=e.controlBar.projectionSelection.el().firstChild.children,n=t.length;for(e.current_proj=this.resolution,o(this.resolution),e.trigger("changeProjection");n>0;)if(n--,"vjs-current-res"===t[n].className){t[n].innerHTML=this.resolution;break}},e.registerComponent("ProjectionMenuItem",i),e.getComponent("ProjectionSelector").prototype.createItems=function(){var t=this.player(),n=[];return n.push(new e.getComponent("ProjectionTitleMenuItem")(t,{el:e.createEl("li",{className:"vjs-menu-title vjs-res-menu-title",innerHTML:"Projections"})})),t.availableProjections.forEach(function(r){n.push(new e.getComponent("ProjectionMenuItem")(t,{res:r}))}),n}}function s(e){h.getCurrentRes=function(){return h.current_proj||""},e.projectionSelection=e.addChild("ProjectionSelection")}var c,l,u,d,v,E,f,w,h=this,p=t({},n,r||{}),m=this.el().getElementsByTagName("video")[0],g=this.el(),R=p.projection;if(void 0!=m&&null!=m&&"NONE"!==R)return i(),a(),s(h.controlBar),{changeProjection:o}};videojs.plugin("vr",r)}(window.videojs);
},{}],477:[function(require,module,exports){
module.exports={FORCE_ENABLE_VR:!1,K_FILTER:.98,PREDICTION_TIME_S:.04,TOUCH_PANNER_DISABLED:!1,YAW_ONLY:!1,MOUSE_KEYBOARD_CONTROLS_DISABLED:!1,DEFER_INITIALIZATION:!1,ENABLE_DEPRECATED_API:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1};
},{}]},{},[475])

